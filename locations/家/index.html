<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"4d98cd967397aa98cda16f621b82f7778e66e4331813464a82501ae6834075aa66f48f69bb00b320745674611aa1a08a0205a2d91491b0b915eb49398644781fd68e2b75cc6f9e6e421d6b21d7eb63c497cef1b7f639fc3572e24fb51bd643d408fbca912255c8d8aff8d3a414cbdb8a8a9cf887e118bea4050e50a3e61e12866ccaa686a165553ef8af678d77bb6c97cdaedfabceb2751cffc7e41f073d17b3fc2eb3b738d2654a85b113319ca04970152fd325698d668a20d8a9d5a5bd4110dd66805f37161cb1606dad4444b67250a5e924a7422133a2a59e7a64d47a4e15db01599358ec471593ffd5878b8d07795780cef2210b7c9b463ada401295b6c85cb036313232f13d483521b49fdc6971b048b0bb85a5e13dd1b33bef00fa4f6cd03a64a82688e61532dc3a01c76888ceb272efb6e680d7957d8e10434825f32b35d569435750b21b28ebaa352f0138df77217e60a769788b76ff8ef1998d9ea96c3e7c3e42a103c331970b0e99a6213a90465646886189da356ef0467df12bfe101a6eae1abac7710764417944a531cb14ced38d80f165c23ef2bef2dcf936b13bc5000b99a9ed6f213325139207ced77468ce4251081861ca3dfe926c28c1e9538cbb615549da8d21fc99e511526bd5cfd3c369a2424666a49ebafffa67612a5ade9f95d5488c9e1e44e6271f2578a6d1b9c5f895afd63c85a2ac9f2b391f6aabad9d621b51acec10a7b237b74c6ae92388112483afab8f3855662ee84a1ab25f3725e1e9d6c84f971387ad6d12159b0c6b39274505639a811428f2ccfa072d3e1654f1165a4f532d76814536463fc5a2a0f3951ef41bc9b625cfaf3a0a7c6b5b5460b0bbd0fec5ed39783f9801d9c51e4e06bf02922c5c8e606b512fb342cbae86ec30470b3c65fec5f01f52b3d276e523702c2b2b6d493ccd47a9bf6a85decc0e99cedd9f5358ceb342a5bdf636bd6cb6b442f88aadfdd887fbd86c97024ec7e322bd87771eb041d3123f775fee889a0d13f64a007ee0490928eb04f0f74ba6bf21852ff19d3029a051189e307020133fe89747cbc696b64ce5a3cd0710ffe923e940cdb4113867a08fc2c0e4136d936cff7876facf3497adf8c1a651c222763a5fafb05b357141708243824493929f6294847a5eda4b606dd9061400a86d91dc6328e0391d07f8c659bb49f8906ba4c335ebb27c8096dd2176e309f188567ec5bf36653a811dd10a6ab708325d10c6cf1a4440edb143899ed0c1838f27dce8834f0ac6a27ad00618449d450fca5e3010769330ab2cd1def6e1a2ccb5190d6b0078ce89feaff91b09b8615eb041cd071bab4c472e91a1f962da06bf666b5b1c3bd33c9427323e153bf8aa98c6a3064114bc8c33ef1019bdb613e184804cb83def4061f83725e15bc19c6fea439ab8de8a698d635a9984c18309e5e80e0ccad6ceff0b2a983e660cf676d7420fc332a38072051893b84d5d846494e21d282f02f6597ebecd0eb22bfe1eb394495bcb088ca82c849bde6c83d2356421625ba444fefdd8495d8b7d39d574daea12878acdac89caa3f24beef687e3890b899884cba7ff9a195476cff91c8216e497cb4d4a28596659404b24ea35bb085ef0abaa58234ae9d04918aa45d9fb55037a330d625e455f873c0b8e934e4437301fb43fe2ae7e0461ea39bb8787cb8ecd5533f2330b74f04c921e50b4dab340fb2e16eec34f116ff94dd3399c526d2a88d195d88a2cade8d7a11a8c3f8aef1c96f2011e24b320b8ccf4fbd8b2dcc8d188470764b441f1817afa9af8a7d42c2fd3e9484bf4c2d807e34311328e36f4ad700b8249607c28b485cff5e535776862fae9958d198fba0fe4f1b0e1fe108fe9cf5540bc52851d0bb25d84c3b7f00bc4f033a0b5a05386857091709a0d386ddaf311d5eb523fa78716d32fb9c50f800232bd861d3478175c7975ba8589508e3d324bb8737d777896994c414c34da5c121d7dbc486d642516598286be6c2f87b1630dcc6d94ff7ccf369edd54997ce724692e5822f98d0cb9b45f6375423d08cfd237ad05e25deb4f119466c90e604b6897576675b4bf2d7d49f1cd42851439d95cab0a9ebef2eea6a951e0cd327bf9c432f131f81962c5798c4a0b4e28ecf1eda4c9eea041ecc1ee1f0fd598a5b6a1d2905763cb4dc25ab05acdd3cc9e7c7b734b5fceefbae980d35721a76bd754a495fbf70f1c4f0381a49ec3f90255169020f3f4c136440af837d69bcf3edaf0276efea0709d0d6e80d2002bbec3f2677584e9eb957bed563cf2eb4e072118827949ea3111aaf09bf1fe8766a220a33c311086274b36b0cadb5057a84994940fa368b36951d66c62298e82f9f39d76d42d1e50294e11f1f678220f0511ebbafd5b1654567681905f1ab068e53177aacb5cdb2642d697bcdf99dfbd4e882b8aa81e1711e0033f599085ab575ac228c200ce9a9d4dd4003bd45916fa0faac2e10c04695867ad19d3b362fc4596927b3c58577fa852e2259ef14ee80c98e0da4d21d6e58795b2be3591d12123586c6e7503e50fa712009ab9bc7c870abeab80bf6bf696735e8760b068e92a73b98a06c2dd80bb37229083d625aa247e21e5a33712029ec25fda1c6f2172fa708454e011a02519f48820cb519f6b744069038660f38124d937f4511471e50f0cc490b5598d31bfdbd9bceeb0316da1b3effebb6f24a5c5b8fa9c73f282e4e34c801ac107c9526bcc927b36b92b89bffb2e4f718735d248166a1bf0a256d731c09176d5bd083fdfdfa168ed79effb8699b11f5f62575d6045c1a5410bff3eb0e7f2bd6ef1fc86b80a07e2e01ac271ef611da2e78e95d2874aa26329e7971a85b01c3f8dc9c364aa975a5d31e93a89af1f4b3358b109225f3299ff36a967e4f6f8507079978f9158a4e9fffb4c50b100aa3c08a436b90615957dd6d9766a4991950103f94806e75c3d6307a382530fbf98e53e9ffe5996ee64fadd3fcf01447a63520154b0ccc503d152a7f9ba072735a0c80eecf737c7067aa050bf804b13d0247b2954ceddfa49b0420de740460a91d5e8c9a73a9c6f49af37710d28a65c138449c0437e2196da2c84e5f251489ce1b9299fa0d93af65c58f8ffda46c95e2a401c8769ec54e1aa61c93bbc2f4df4f0364dba7b52d2ad23066e72886f777ee70baa183191498e67fa8b2f92b0e1d38383fcd0d347c2a567a7829fda149e43124c4a50c6339650011ccbcdc36c83f486d125826a53e4fbff307e0ddc5b75a6a515dd02f148d9cf627f3a8260794081b26beb21264afb3fe7a0021ae5ee3bb78546204ccf0ee3acf25d58ae4de5b75c9f3f69fe0c869ee0e54dd71ce0e00e599d5e3ef24fae145174abf920de7b7317e894e8c59f49da30922a1a20585967d17a3496eda321ec1856f6bde9add3f34a38043400c258dd92248513debe1de612f6823d5624e14b9dbb38ab9fb2ad3777d5ef44ed9d4d984344d1a0281eb31130f0bf12582040b16883c11c122da1dd89727d7f0f412c0526d464cff44fb2838ffbed5de2675351211899676f3d3593ba8681595ee2defb80b09ca25f3b3b85396227fdbee2c92d23df222518938597df7ed219cd52c9f6ba77b121f7bc37dbbf6fe21ff01ffbf0611cf6ab619daafe097d9a910b4829db8a21afb6d9dc88b364b379975a554c3f661e6b72ce6cc5384ad5e5b31b4e9fd7edd952a732248b03d26dcfa1599c4fe2d5e16c81496e530eda1535b4bae9171a26a3a562b6c68b22ea7e932df2a0e2b3bea95eb8dd89c7224f805e27b2c05fbd0484517e07c905595b582579ae8b2e4de9fe32b7feea12c19263a6679e106a609efc7bf1ba21c70cede649526fd5f0f4cad3b7a097f16781734e3295d019cd199333cacaf0294ba7d789b3095bf59550cd1af132a3bd3ab5d63109367c81c15663491bd1dac0719012914c98b9e26a8afb3c80d30f0223864c359bfeba4430f090399bc5c285e88c2784f65b205b09353c274bd1b329cb2d87afca1ce4819e3fa7149692262044613274112ad56cb19a4ceb0593c47723f385d1560d140fdce0b923d085b980adf88b0e2548635d4445df25ac493bc6c7606dc87e417290b45489ac5183f24234105209c684a9d24bc0c0aebaccdbb4e1aad47d056522014e5eda871d29176d03cabba9a73753efd6246509a8314a809868f9b273574d0e537f853ff189173d0d4855d35a8e9c8c5b6f83e3dc20a3a74bab365c9d5b6f5f84e33b4bc110b2f7c68bab010eb089daaaa45cc4c32a1797563ddde790fa7744687553d7facd338c22b2b8373be6c26a66b78fb15c5e5b36254b1789fd70b348d464ac752e0733377300aa05e1b429b7a5ba937c37ab8057e712a4458d126b4c642b957ad796d4dbce4feec195b936fd4251918cbcf2b4a85676eeeedc2798919904a362375a4582e109b4af97f0184df253071ab549bc40dabeca3099c623b0f068038d25d526df80c4bf53ac0629fba394452a711b6729ca565444892089ab7ddb8835f52661c0f2028a9d3896cb325d910be3ae8aa8c40b10daa48d07259fa757161472a0bae1a744de170a26a02e35840bfc8a9c109e14a9e3ceacf88837d2504551cdf066e3f39ccab90373d1149a7fc70f9918fcefd66594128a8cb0745834d4d8a5d611011cbad46fcd0f864c29e3e824ec009ab3dbe877dfb756fe390fb0d3e6ab86200a44395cf6e0c10d9a2333be179f8ac61c8a32d58227b9e52ba4208185b0d21a859fc2c8aa0257e17f54b368d67347a80641d08e86644e1b9775e1888790de1ed0275ff0032dd080094aba6f8ee3c1223e7d2a2c6691277cd5862f49f6fd2fb52b53df2b5a44d0517fc9157071da891b1173f462123c8591169db4c2e6bb5c5dc84eba0060798d403a8886c7f68b812bfa3fd426064697122975f7b735855e296bb6d96bcac8a3bc711602325f6ab5fdcdabb10b66aa96c0421a604288dc9ef15f80ef2852255919709de6be4a03c3b27d492f816ec4fd8e197e9d92fcb2df62d168907e7a0107f1f64b51909c4ea2e3f7b838d5e07eba281ca040eec3656e94fadc9d8db12cb93eccdfd2458ee8c6ca5e0c1f95f6abd7523b947d1ffcaaedc6115c0b57f0180fde2413617ca479b19d377b6575539339bb670cd6a17fc171afdf6af9eecfa081476ad52f85c6e49b0af7f8a7ad1e5fcea4ff22e3d6fa6e30291b6f38200320d1df5cdca086837a899137b779d97e2bfceded3ba6d046e96da34b9bf5e4e66cfbf89514ddeb78e2d8af89237d3ff1139514958530838d5c1c1955c76fd3aee3a7f6d11cddfd1b38959c937760ffbd4e16b855de7330e6b3f6f067de6c09cbbd404615c672473acaa907487f5b1b5e52835a4cbe7b41b64da6e26208c4f9d12b2f728867ae9784db4cd039829f558e51b9f29379cfbc92a83b50cdb5bdd1af5d6e23b372a947f4e8f968704fcc1a331b65e27a4adaa03cca57be5637b876b6485e7752c434f98b72e955eb8fa2bb896ecf5a1927a3d82af3d8e1cc90c62257de7e58e4fcafba796eb42175ee943c6036bf4dab0f1fd08cc232f82c4c21d7d295ba9d068950c4012aa058b6e7c66578d062b7ebbe0ec05c725565852ae5182223eaabebe91c148be7372cc63b9846bf3387502e0b106b058355d15e62f5e46a575d6eed6f3ddaa808fd6fb9f9232322b575962171b5c56f6d5a12fd9efee9c8c83accdecd121e52018d94499f4807391386886469eb5720563b0e9a7861942b15718e62cf46589298620611f75ad5e76d5d013a3d1d679ee5b5957936d2aa77b1b71c5cca4e816e9a79c347efa1d7d7d9abd00a8936e433194e1849653167718c749f4049aa9ab9ba574cf526f01f6cb711057ba130e2c5f94328ece4216a845fa6751f05208be5f649fd22685241b7596151aa273a47a682d2f93912bab6fbca02714fa3fa67fc4955e167e0cbce65bf5c556b556c7f03a395d1f7d5a410fd56c9b89c5f1a1815065a3013249009a9d0c89f3275fe07a7713f0e83f1331988acf31e3ddf912a3af3e58ec9a77e1417373338c6713238b8feb42eb472cc5342c2a9aa13fbbb7fc66ac32ddb8b5ff6e5d319c00530cda7cfbd71c505c26f7d1e91fc399925bd67be8d062ddbbce44614dafacb3b3c4bc56970bf9823d249b834ff5cb9bd712dbc628a8ba6e73112383d8e8cfbf11a0a93394cfc256b28034f01515bd40a1143fcf791c29563ce4c9dc7515965d309d53c115717228a7377dad876af2b39ef64655612b938280e6cf8dc100bc091538f269aaff87104d0afb9b07c9b8b4a31e80222ff71dcbb4b3c32289b7fa9cbbd140b6b38eaad4fade2b849a6897f12a7f7fc1ab55285c14911faa25b1882332c70d8db5b020bad7b7e303a816c453ad184f08ec966f5dd4516402edb80e76f4f568673e79522ebc705d668a8690af45e73e25788dc9b6497810bf9e792e2ff19690849a8af1e22fef8b67bbd80ff111156f65779e7e0fa6a0837fd24d0bfd2f2a7297a79805cce9a68980eb79867c5f0c7cb9c9c872d53623023c698d40915888c41d3544c4ae799c4bd4b38bc098993256ad70362bf4758351a809c9716cfcb79fb7d33587635fdc3dc09301595354a32b91fe22a23982ede2256cb02b7564ea6166c63d71f0492c535decd9ff45715934e84476524c2d40339e8e94131ca4d528d688702b0401fe4a2bc1d3a2937d61271cad936fe4f033ff51e7101934ec6a192d459e66e1b5233ce41538e5bbf268380ff32f0126a0c30b1a0bac25b520ee5451906f0600dfb37c6458a0f41a48b754df3b55f76a11f8eaa3ff0582e30dcbe1abdfc6ca802530abe2140ab564e57e72f1f1bd4a8aad5db5beecb49134594b122e54679607b3ed727cfb3b5b403308ccc4b3c5167755ac77b36275cd025b83a7da78473b62f49011c7a5d45c0f21eaecf57062f186644d52db58514ac30b6c75e5ba69601bb13fb16376f635352aa59fb94cd8bd1fe6f954ec915edad8869a3c1f0736592c9d00d1790c5fdc7238b08c3d87c6d0247ee73ae5348e892ea36849031a9150c0f71505e62bc53f563b1ea14760bd3f4f820e26f68b1a6d99f3f39620b55d7c0db15b64baef3426c7d64f212a3bcc63963ad6cd1a9a8e8cbbe62dbfe211aaf246509ebd1e921cce86030318f01936b362814be959dd5c560623a080eb96029acea8de5549c20977e26bd566e8d673a9daa0d31c8b6670c1710aa6e45de5f0d23e13680210b6b6dba6d8d64458c8ff27c25518cdf753591ea0ad365b44cb8bbaa5a2a7f0d18d39155753b6c711c0b65abd3d90f421c159495c00193cf117ca4dc6a0a44366114988b876e2705b021602f0f56c6d1afa9c8b9f4d551f0b27167a2c2c0924605d0d981274b93c7ba506f1e9db37a03e22b180738ed8a82fd2adf09bbc65fc3a97881648feba6d20b31c50c2b4b1085ab9117105e78fd197aaa5a133dba6e1d3e2afed4bfbbc7c5c41f4d5174a8dbc237d460065c8fc3c3cb446b421261e68a680b6cbefd16bcf21d5ecc20287e586cec04e51a84bdbfe9c73ab43ac247a56d039ac176a7fc25fc2bc55e7da2c2b2cb2e685cf74699c5853090dff9e3bc5341a1ed5dc5198a81136c3ac2e37ef16fa4a6fc6820221ccebd11767ed332d1201eda59d9605a5916e15ba10177b677872e1c1be450d50f97ad5f549230d23af92f6c6f45a1bc19a64ce94b6ef92f4f3a8cb7b5fe015210df779b513824e59ae5e96f127d4fbbd35b109cf439c6aefd4406b6430acc7b7ed41b7102b5d42495cf2fa46b6528a36ba7a78418fcef304a2ef8a72189cfdce718532c981830e250e7caeec0e5679e9c25cec2e3bad302b05613a9343e302be04e0d7f29b9cf9fa747fecbfa4dfb505ce31b3e84b09fa038c24b30757d1bc81eb178446ca67c46fdb936c388f7437ee7644d3c99b2c52c709a439cdc3deac5c3af79716299ebeabff18fc1ac8122dfe878e6231c834fb49cfd6402abfd45028b8691682ece432def0c019dacc7190bf5034b4b7156b5761ebf4ad9a51ff5b6f57c8548c037242e9e1694f703d77b43d291328f3bcf8ce9d157235049a904dd107483139c61b49476f6d1b76bf9366f578de4ecee8972402146439bcf71a530ce96df4947eb19b5ed8857a7cbd934fd1d535da018b3c47e197c660c90a29445981959a9527244c35a25ccd7344184d8de527bccc5b875b3c15062011844f852cbb477ce3c280033360d0438d4ced495310757575edcab838348a6f164cedaaf93bd8874ae28fe9779b5bf2a76a32b2296487b7ad4cdb41de0db68f70216a6154957f7a3b65f7a5f5c1ae201974f9e09240efbeb2902df5e4b9a7da0b82a761b978336315806ff9a9738e818627132de1e89b9a9c034e650e15afcabec312952c069dc5e8c9433b1a2e421d2709efa074443c973a0bcb72c4cbf90c11f1039a68703a0fbb63012080eb6e4c889885f39ef4edda1ee2bb066742a69832bf4d5a4800878e40361bef051f30c2c870c5c5bf52939bc1a2254feea48711f16afa88f8a842459ca1c5a1ef417f2dd0e00766efee0de47ce354e31e1b1e46b59ae4cba0748e5a9331e840c14cf206f63cc9f8ffd1c385176ebb68c323be70f198baab45ec0221ff46b4df89cc789c853d05459b88a4551ac2794661f17f9a2a948eb616abb94608798ec927a0d7e97741fb723868bf20f19908a0f5c8cf699bf6039a128157522ed86b4a501179506cf49bed1eb95259fe0ddb77fb31f9ae32f4bb504bdea9796c1f2328c5603edd6d9f5915616e44e6860b878338908e852b8012cdf030fc50bb1750215478d5460307f0ab2638a6157bea23416e889ac2f2f08952dcf3096d91a56c3a634fc1fc17cf2eb2b97a24f472b8e64271c5860f71c59bb8d6842e5d6f6ce456ea3040a9c427398d91071f20b7079d2c1aa40e0baef166a6dab7767a8838d0561635f432ddd267c125ba3d500412761758dfc8641e0e69d77fbacd4bef262d7230271372ec1bf976697365d2e386ba90a43c60de0310d4b7c01600083ce4db3ba8e8af596433d4a27d0526ebd5b930dbbfd4342491ea784ab9164b700b436fb797f8ae25a272f6afdeef279ec17d7c681f93ba5c3b490bca1a7ad4aace9299bf5960255a86a6ff6258aad01d2e2d30e17b5bdd5709c73103444c4dd73fdc59afbd57b6ade1ddcf146fa1213c17f8d1004170211606ba15721b71a5eea00fd46964f6a621099fa1e512be6597ad1057b659a8ca98073b021f5104f79695c4d9eb2aa701bac355eec3054eabb5f36c7e1926f578f68dc20cc4f8e786bdc4fc1b4439b97cd309fba36bf033c1bb8bbf872520e18c2636bdb67e7a2ced6e28ff6d20bb42078988b6adb1d99e458664d646ff13d7857695e4aa8d916727bde1c2fe844edf122d31ed665623e76420ef83f1e4825c6931e5c77a39ec5512d68a7628bb041692dcf317fe3ab5989c6b50300f1add6f6c95d8ed2199d237aa15a74bdb14e39ad1a3c64c4a762c72469fb9a55f5612d6d19d2885e883c4bacee4c689e307daf8e371638a20f5ff0f518834b700f24e5ac352322c7710b920782640a953deda210fb9b45bd5cb9ba14f204c05d1b6b2478d985c49bce8e9d0f4f891b931acdcab8da5a03295ab538f21141f06466dcfa66868e88e248a93148e4292031807ebd396ad2c27d437d6e1f1d973c181701b9e57b82f36779030a34bd06193639ee6d84e07d803e5e7506f7071b90e03ad4e1665caeac328f3e8cf64676b0405d65a945b104b47a08ef6b857eec2bf85d56618c0f9e3d3f2c24fb4629d31b853148031b7e5ded83ecd3ed72e52aeada070050643611c4d6a8daefe89fa2d5ccc07b994077883f84625027b7f72b72449ed3834dced71c6ae673b05cff0ecf3e1897a57f5f461c45f62d338899ca4582854357ba2e119e418f0ed12d5e2c3c15998385bcc36c91d18ec7a23acf07d5ed0fe00f7ff4cf4587cbfab8c9f5557558852b68eca896c04a0e81ee7664f4640c54098b5bea887a877f080d5fd6e02a309322ef1d234b6ba74eaee552312a109027697bfdcd6e077c9ca700eb429b314becea184d09281c6f2b1e7b42dc0057ad944af757448fc7ce1df15c3832022af127a7e23f56ef7dfa7d7637af27403fabb01dd4b6ece3d2c0b7b8fbbf3462d3eb6e3d393fb4cd5a15613d87ceb6a0e206ca0895f9217ad8be3a236a9ebef3354028415fb8f5b1c5f53db63573f839c2e232e69e65a229aab798a94f25581a3d79a2c0076c3714b2d1b061bbf2a605b8253597bbe74feec56266e6dbc05518d8a80d5699f032a910c2b93904694d93ef867bc0a31611db03b89b31af0fa3591afdd55f48113c6113deb7eef9ecad77cd0abe5a87550881f37a86d116cdc106e363f7eb5d7ddc994cc6c10ad394f521b30c5f8930d32fcd89fcb38c0627d86ae065e9ab089f3e32dfdc446979a3806c8b0e010ce185b0aee593970c1b9e077ed891bb0c469ae55b069735f11aa96f9e674e86472d794777d9a48f4ca4db953dcdd158facb2788b7ce2cd272629159cc421eb052c401b3f61bc98ead31a2ca0e1a1173f16fb873c0c9ed98de6913c5d9ac9d4f467d2358b042950e3e5d7ceda47734089615c8dc5883c2a7f3feef24b9d4bc9ee9a217f8b756ab86f22c775d8c2a117163b5e5036110b5702aef28747e7b59013d29afa9e836273c6483bf034c859d53c842718a0c8aefd26c0a44797220c46038f52279ad9cd7ee9ce1317e1b622d54124050455e10804ff2e98d7a918cab16388e14e1ce9a1997567b64786dc13741195aeccf37e8dea6ad41d711504a69bcae9935fdc813eb8f754bab08d6665e60f00cb595ff03cff303ae8e83bb637948f9df89b0930b46b20d0d40366be1384aa425b6c2dff180a821b46da846a47a8d8009440c3abd81f82769e5ce175b9769cd427783f8b168f21a6f789491d4f354dd397635b3935d8600eb4e1be3bc89aa214798c51a2e36d8d615e3e8c2054157a04a1a44c3c503131315a1612ab1ad2d13e7e5d096f28e1261d51fc6b4b68296886b67f0260ae51167f2ba9f5c90b4d6c41c6168c1c11edbac0df7e4bd6165545198c6317a10534a61e243231e3a63df853f054786988dadf2876b0d1ac6566dcd36520c950f26744b1b6d6301d8e1966bd135cea99e9311bfcee5042ae2895492aed5873ef307906a85a5bd7956037ef3d42742a57a87987f4411f04436869f658b7b6ad9fd7a27e837e9d852f8a6ab77cb8e93ef0c90a9f4985905a72061284e3721a2693da20d7b1bc280fbf65fb1d9716933ec07a9c70e327dbdd4de384b63d97c9697db2a0d27d8f9c5dae29b91f7d3d2a5268d828df9071024375cc95e2006ebf7e44706fc79d5f5dd041dd8117ba5adfe556c61af71d76150996d2d70f72d550389cff240db24dd411ea57b6796482216a4d58cfa3f4af2163ad1cf7c6b5fa62481f984251c9344d3f5e659832b322d177f5ed69414caa09dab197f0b623043f908e21c978e59265124e7ac7afc7b47fc459c73967911f562673049c3788766750bb5d472ef808c97d064fe46799e663e68dd3ced453019700fbfd4d0e2155220225053c89bb58f5544b940f2515f5ca06ec5b3106cf0be03fadffc64a4ef2c8e1e1f8d4d4cb58bccce43b069307ef06ccd4a20c760b965b91f7625d745f865fce95e9577efdd3c17472eb090d9f8a550e5b8ef408eaeadae7d6c8633cabc5bbf0ebaeac22e7370d8cd49525cfa02ea98955e5908db51630de24ec80bf95e41ee5fca0949c5eaea9c42817a630c6d73019abac2cd30b49a1f91e3856864a5262fa2622cd9377741e03c9173d6dfe5b9cad0a3df92ea80f659620f1a6a397d44f7c1fda351f28cac9341d2822c6043bc2e70316f1428ae764ead7b6dadad0c58e0eaf3fb1691aa9f114eadd1b0b6a379f1a299acbf00cbe4f4fea325ec20a18a7a47e1f89a7fc99ace457229e0983f53c1d7bc85cadb12ec86f2574dbd1797e90e5d94bb656fab928b3d758b6648d7a340eee98eda92cfc066c28f4eb42c93d185779cee1af37150e95ba3e5913af4e3e687f05bbe1ba5d84c1d2428dc8df7835e59644630f5a74027ea049d3a9a2ec6fa97cd0bb7cdcdeaa75486c1ccc113f6498b3d30cee6414cf32e6445232c85ac485046cfeee3feb72219b019d266b37f2464bd1a2fdb37a26f22006683ceaa2b66fab7e9752f17697cde7cb5e276ab141dba46ed1cdfc2f5501ae436154ce90fe8c0d4f144495bb0640e6d5cd1c84771cab019f2350ae6b3fb5dfeeeb59ac3f47d5917b4fc93b877080256ed1787fede667cb2cc36e84e79090b0ba9638df6637d0cdf177e49a35bf0eabdae5be49262ea69383a0baf27626aedc90a6c53e57e024e634f1ca6296b2b66bf339d78e22a0f3074449ec3e7f9d4d331335b2bf58bb00afdb51dd179a47a6d29df4ff41c93b88d68b78e30be35e6ed723197db7ec509cd5a6da76d214cacdb8ab831d3115bfafde529d69b0de18df06ad4968ff851f013ff1fbb940b15f23eeeb3e981f46722d137befb00552bf2356e7cc655d1b2085c09aecd01109f2797dd017a544675a452985557b87ffe4215dc4d80849847ee8711f5e8dad53e886b731b7467634f255899407c97ac16613d452c9f0f7bfca956f0b236d927bf43f8f09599234ac799c6bebcd674f4e5167dadc2bdcdc825286617dfd31731f0d8dd7f2596d9cdfd0d5d8e162bbb090b5050694a1e5f86596736ecc29d176675bb86a15616a631fe208e34fdba2d508ad0a555a4c02e76b641dba520c08b32a6d3eb94ce4c8f62e06bd983b896bb482f0cff93cd3ea4f16670018a1b8a2a44631c565fa837b674f4490cb1c7608c1386cc1ac360e5c4b61d9aa5dbdceb085e9bc9fbd77361098768c6c9831fc1888b20d9865a193ec4195591900c2d8026fa806b92c6254e7d191720189c0a06245be83e17aa29de9a59be774c69fe72c34d0fbc66554f710c603cf399804eaa411e18e5003142a92d8e59a4486ebd10aeda00e6421da81ef06afba29a5e0ae4c32e3b608a59dbecb93c98726aec213ecfbc45c7d692959be66bebac52eea1ffdedcaf4433a6d7e184fac760772b10006c24f5393ac8825a710737145b934d5dbfc50a6f2411dba526d81356a20b10ab5e46fee704530367a40489569deb29dc1a5f5ea195902625e1cde1e234388ef3d9ef2331241dbf3e57b29aefdbca3d29b4a20ae394101fff690fb02986e0dc9b8c12b6f149b9e478c14855828e18f4fd3cc14e81ea996ded4a72b8c9dfd3ea33076a07206662d86654958e38cb213920941a5b47e01371c764d95c60389529af4d650e1b7a2a2d9773be44e53451db8480dbb93bfdef09b35531b1c838857b5453b0466c2216b780e6c8f0159d556b9fb7ffe8e6d7cca74b23ab680bc3e8d4085ff6d0c88f314e4bad563e5927039aef4aacb8ce6acbd20305430e13c103293340cb492515389fdd7ecb43592e3db9f67d7dbe849afa37906861f25b296e8abe5045a86331248537cad8e300f486c8a6b839d8326fd315dc421f7f77a0ca576a0ab92c9fe9db99802b12ae84cbfaa1d188d9ad214d2378f8254be1827ff9b8e80223cab2b9f6a4aec51677cbcf5d0f38fad5fba47829dd53c43cd45a093b74446deddb5bfefea0f54b01486d23bcd4933aab49d5753cabd4dd55f5aaab846c04b8e90dce056d931b3dff1ee69118fb0a488ed2781795daea3c0561a3a0ae1e862e07c64e0eb06e09e10bae5863415a66d632573bb149b011bbc34e5c650cae836db31ca3492f765dec5bae901078531d8a5d3829bf35fe36a5d4d8ada179097b17b4994e4499f1cbd728af1ac12dae69d317719acba12827f2149e68682008c07aa23685b7f441c3d20a3125194d87126ed2e7c7b43c6b579a1185b16bdba26a4e5172beb3af0b4d9a2a3323da57b116301ffcbfa33edf1524007446f4f6761fd9e4fab67c16df13253f1c53d1b515778e6ce35b66ab9ecd2e55ab11bcb27d0e5c65e5b0641277b93d34205c07de4425a7def80bb7622d24bb7d3ff74ebfb0e13cc8d77950445b877006c34977e1747ed1da76f952b63eab02d2b5ff261b3b78abe6305857ce74d2de22d59fc47a2ea7fb4d7779fc7f8b01374b8f66c6c69d2ad076f38928766013197c06ad8bf792e6bb4f6e7276346f028da242cd55f0a26f7b32da576e3ce8e9fb651daa987a71a51bf1d6fbb09434c5479ce48e56af0887e89b4d9a627131b6463f93142ce3f069e2260b25462456cc82aac2fd21a9beaeaa37ecc2aa95ea09a7d0dbbd9a4c939df58ced3b0b7c1cc6f6e64cbfa1e1e342ff46b03d3ddb04ce22453faed9c9c33ab3ef7ac489af79328ce8ce50d8b56fce2f5a96704ee35994842df83b5120723cce7cab9f97edf1faae37827a3871340129fdd126b580424994b977591c6e540e977338bf73283150ab68fe9e06c6091412411700a2b73a55f9252da6151af7dab153cbaa73dc7f9498c4dd895bfa30b2445b0f5ec27a534399230c17a5ccc397c4556332af2834b99298e88ee7136a246b60255078f7744a264b885d54e2b7756ce72a89ecdf4f18e000cc69112c1e971460a385c180ce1960c18609ce7b9b920d0c3adee16a60add31955510fcbc00cadef3ff8939e4df755227aa45ba76fbcd1f8e4ab24f2edc0a38c52f20af6cdd6fb8fb91c0bbf5915d8b9fe363e2141b61de395d14b46d72101c0a3a869ab60b4a5e1742ffc5f9dba91d288240eaa1752362faf2a219946b5c08ea87a320daba985e38dcfab719ee4b798edf85e0df74e19311ed98c85252c5ca6209b27c0e3d2d31ddf2c05f0648dd9c2f25ce66827c58b6da0ee397d55f14b71a2ad532c43e695c312378fdea5160df2ee344c4eb816f184421e79a0ac9c76905f823211a013a0e9f7f4e1a42cb7654c9d34d4f9fb7041ac90011bf6cbafca45af2bf215136a3314abe3dcf3b3d0b63aac92d46337a9150b65b2e8e8f16c00c24ae32f9cc02d0420723b8974248f6c9e3894fb5bfa62216f540b42fdf5f1a041bbe536d41da7a9dadfbaaabcfef6a2c2f675656d3db6119a0be1c410bd1a41a0613bc50420fa8ffdfc0ad285948aa3809e61db084b8d1d89b25cd820b71c1bc3ba96644d6370c3e1a8f11cfb6e0268675e026eba3cbb6a9d6da1bb2012f63ae7dc8504defa65ee135c22a1e7f464057ac01cbb1af73b7ee67dccc3460ce255ad255327f37fd95edbd36e699ed70dd997af20e5da8c7c1156a40cac4a07b50f695b769027f84c8e955933216c7dd5e95237df95c69e8e89e5764b86125a7b8ff033e492ae9ce13e65a552aa4b735c2f94eec90b8c4053df9532de457ea9c84e306caa7b4d532905f7c71e501383e7b3656f8fe9bafdaabdc51cca761266754d25657b42ef2d3a85df3c9f649e0c0e21da4972dd5a33a0c3e9851d7177cd90f3710fdeba65576b892729b1db6c03c58902295190ac0a7e31bc0d7a1ebafcf1d4618d0bc04502dd536107466ebc467a924cdbb5261d86c8715e519e600f252eaf92428b7f97cba2342b8be6f1d0414922812a4dfb5e42f7b3c9a1e82f48f6738d917a22826fa7b1298e52bda5fa1918c459b81134162e25c31e161622d85dba00105cab4b425d676ba7b8ef633409087a9840a9eff4600433293fbd8715a78e4a5ee69c8cd3f25825f22d0fd214382fc3e3b96d3f19a5c6db3aa1c95880bc0736f54ecec77e4cf7e835b3552076e5919bf50e85f2502f3e965d5e747f64fbd8a5eab066940cde0bccbc2e4a529018cca4016a2814f1302937ba631e18313f5aafcd23d57d3b09337613ec7c521b92a430ac6cb2d223f547a88095e7e5fad8da2a0f1a53487fd4352ad6d85b5cafbf73ec31582182f5e26f9169fe113b02636b017edf8c028e99e6f9d85ba084e151ba9a4e215ea0486fcb180ca15aa4959f486102366c38c220b5092c0b474b6fd29dd034a79067a58ae2d801693c712398a0ca3bf40c1f0b04fe5f93b3374909611c9fdd16f994fbf6ba7079fdc2e6232fab11f04af568efef94379a79a251af9b70a29d26ea43347f469468e50ab0022bb1fe2e3f9a0c7e1b8d95051df58919d774180e206e785bd8a25a7835e8b4648992bed01e92388d99e67e61083a43df08dcd20965528cf3868079020f901ec1b84d66eeec7fbbe04770be3eb5e68fecfab32403e36dac1302893099b7c434db0965174916f5376452317185d8357dd5ae0f1188eedfc0cd292438e1ed5b784bcbb3e4ec210581e1c3f4bf54ce1d54cd8cd524d7cd0a12d3358d92cd914814d97ed26b5f035150d6159d780ab845ff9f389e708baeea62834719a478c824f6fb1474626fc47c0facbc0c1203ebe16643cd2e0af4bae805dc8f5816d0827309d234134737be5c2a5dcac622dd256ec47b2202a1ac5b7b9ec500195df898c5be5bced0990297a902a7707267620388761b1a346f3b01e6be46d077ec420c9b6764ddd59fc6d5c4dee470abb4a16986cc4fc574cfedb9568c59b8a0e6af98a8dd6303a7bed0c82d40c54d3772fc76704d4621409a7be468d3cfba02fe3b7c86803fd8b2a6f396c050bcc67f491f40f1acf225ce0a18bf95bfff8a67a9f9549316280046372ca9816d60d67bd26b8d6581613621d6f67bcf7621a974b9352b1d0a8f0461b14756a747e9f51f2cffe32b3a3032fdf323bd4ef0cd7e4f2b689f700d89b48dd851c41ef59887554fe547f1eca33c694338e3b960ed2fb983ffc54569b73a79d07cca85d60540c0627f308527225349e31569008ef020cee75ddc18c4fbfb0830ecdd1ee433286213cd7bbb183168a77b623a4bbb544cd6d103640c684205dc8d8f12e6fde660cf82221773c880f15b4a6c1e41d382cb9563caa3dc8acbac5922","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
