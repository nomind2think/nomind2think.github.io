<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"e6028d53a9809a95a81bfa8497d9124c7912075a9449b864a191b74353feed38dedd6064cf06d6fe54f6591e48366ee2322848d39ea1157a19b99b2303b0b3cbfad38f6b24f1aefe77d5477bb6c6a0024a3806b8d12a2bea965418f792182e5fa613cacc38ab1eaf287d720569e09807605529ea5e26442db8539ccad77027901b3724aae51f44c465ca10ab8d093cd9e4bb44d617d9b2e0928305ad5a85c744141e555c852a08e9a6c0a2759ec9c628c12180e23debe3e11f2db6a2c799ef642c6ebe035c460284e38dbf85bc60e35cc836678f88f6c0978a078dbcd30e5b9fe21370e6962d8e79a0150a8c0375e1b1f83fb2f34f47d0208edcf5e6b1dcad8791b1e0f6508526da6bc8a5782c47edecd036ae15545b3b77e53f9a647466fc51e3e2022397833f75e64bd26baec73c14ab6d2b08c02b67b1e85a663bfc83feb22e54317eedc38390938249d970d794b11d90b7ff0ddfc18eeb585f51427abcb98ec0ef33efe8d16e1942c40d0dd8f8582070949a17ed3616c3a560b8fb82683bdad46df1af37a19f84aea0eef03e68c68ceac0af0d1609ebc1b408c0496639d1e65303ae121fb66756cd8dfa4f6a56b15bf2b0a3e49a090a01440d0ee980bd45c9fe4a3f9b269084a07b0c22ec06b8bfd5848a3b54f8a2789e1715aadec485f91fb95375a6dfb169b938370913ae3ac4f8d60ef848e2145d860dbb84722302bb9125efb462f8c49b1c633d16ac5cb0e50bf7ece975632427cb3547841079d6e6ef658a596f40987a8f4bb1e9e47f011ab06781f4ca6870292931fcc9f871aa4acca525c4dc7084dc413625a999ad1c3d633e1cbb5966a26635c1c54d5a02e21e8629f53944b5ed784c49025a63efa2ea266411f488530235996099b26d1be295f165bef3d0efdba566ae066fc5c17b4604419442d9132577e8a3c4f5b24f3c2bfe6c23e75f0b694df7f80eb666d144522c3916a638e8524ca775f75a39f38bab106164d66dc5b8f19b77c3e8ed08f046b6f93e332400d3c46bcabc85d5af4e751c397c9847bc456ea12fdc47460895181fa184dfbbc5f6bcba9d8262ad7fec72cfc44e2d5dbd479293864a48c444e2da5f90353a90febbe9ac042d21aef52cdc23ca4a0d7d3b80a0a527dbefdfbbf904bf34da60fd26622f01c37560641b9905be64a355153be698836cf9a03a2c86167ab8d707dc403d0574641cdcca7fec495353259811f75d8ba7330e73ef5bbb4fbb89685d8a88e03ae018b1c9797392d2b40f1e55425b72b74f5fb3f20ea6c2406367ea23d87afed67acd41639c59d1319d2cbeb049da3992b2aab853f671a8b96370cefe6c97dacdce75c929b90af89c4e5b966ed39feb4b04b3162fb49b5378763c9e8bdb3234c08eebb4e26571194314685fe8d542cf10ef5d5387437d17bf8be36fe4f768c0205ced9af07c6514540a3449b1c623a30e20da44e6fb8afedb4cc4188355bea1ff4d66561299e4f06172cb57ad22bff50db3c956c76b540272843df27df6e9c0ca8e4cb6a9e6fcbfb5b2cb46a35d633f2c6d1f9775426a5c2f0be4af2c796d2d08c98463d91f5473c3b732516e4fbf2ad7b551486b35879a4216c5a8757dbe65df4271e5a066439fe3849de5c2556ac420a16ef96a45e190ad327fb880d41587eb8827aad83a5ded102c59d5e9c4510cb2a877e9b911e16e3b70f539e496a7c1cf8421b81dbfe67b44de7a2c95bb0153900314ab37a3a4237b8f9cf04b34d6c41714f433da5f947584eabe1429a4952bb548b864fb58abc8a96fd8fe0451829439c6b62608bd6723236885f9874d661482db731f78937d7934633d2dad37445f130d0ecd428d7b64cb05e420cb14e2400178d9f8f8d1713ca68fa6ecefe5c0b6da5354b0ed3a5bf962f156f2be63242e39b9c1bb32fb09cd08a7a02ba47448f8876b009de02879d6156a6772faa28e85e88465efb7e7e34dd5cd5694ca29dd77205786923216eee9f84c55bf84df4882a34681c7b0be35baa62053a70c478e3a028dfbbb139724ac6a90298897727168f1014edff1ecec37fd1b2ba137550419bae619d57677092b3c635215902e86ff932847733dfa8247d14d0995381fafdc814e34534554594dd05f170e0649e04c7be8d61f1180d2abbd57bf1f6c5825a30dd48ac64c0ca7791822b0e476a09b7825000971a00bbb8220386ebb2f2c8b52e03146adb4fdba5900114608460a938a4238f4db20863974d478e029ab02e8f8026afe59808050a98cb364150e8e3e506806e77568eae3d047be74f3b500a1607bfb7bbffd7ea2ccd1ee00b4eed21feaa8b34d8222bf968f5f66ca880c45cea48f8e3d94ce8e75ae5ca588270682c6d05ee1ab1ba5a8ec4be135048039f7b420c396fe1495eff0390de4f2bd3e71262a6ea43fe4102cf7862a1654b72d883aa78c46dcceeca6da21280db4e948ad29d639f1d4f7b7be316b5c4e8554f4198531794998366aa740651a86d38b3be587750df5b78c828a06efb535d3e142cab0e49e8ece932292da7bee84b97db5a0ff2d7eeffca8fb236dbd0a6216d8c55156854ac265df2590f9025b427e402debfc7c1d4394ff831f16cf012842a71f1c04f945a4b952c64311c1ca110c241c466b17f89447359583071094d2d908d24513aac9262a74e55f29b38ccd6cc1b2ba3c1439374a7762a5857a61ebc0da512c056c9370d9beb305cbd7299e1334f00692a02f49596e2994eda2ac0a4c6b03d75c0862d444b2f0fd77e87596760ad0f06b61702d465f8d9685b78aa56965679fe557ef3339add22d8bd446d24318375e637c4ecbb8769c38ab48dcde6dabfee8a8397460d0806bfe9cec2355f14e358c28d983557d6b4d52da859170c576b94518e1c0d98482fb030ef7a71b0fa2fa8ca3fa0539ee1756ff381aacabc982a475cd681b5fecb36ede14e779b4b5d2caecdde1fc00d703b3940f078903ed13a719df2152f13cb22f82ad234cc94c8a45757b2276fca2cea4f0ecec212a2045dc818bcc4b501f85d3737ee67c1f361d6994f83e4285dfbf017789a7f9f732906e42950f65b27cb78fe4118ab600fa344f826d189d4211665357cfcd7295f58dae28125e59d210bb0fcc2c4d028383de56b2556761337a139adffa6916b54aa7a0da0881eae26e85827559f3bfd675d0e4b41db43eecaa73988232ffc9c9cd9a36a2245f3b37ee1d62ed23a50eeea79075d7aa6d27a01292c19d4659746bad136e67182bd2e5b7875e9d4b9c989d429513981c23d1b0cbe250c3116a587ee3f1516a7d50f9a80f886efbc0003e0e4a5868f4295f7a6d034764290b56a1dc62b4820a4987f70abfbed3db43db7ffeba98a6bfdfca2b737648e6f8a764ff96e333581b24a89a49133567181a220406fb74f5c7efca0e7b94e2c09383cd5d6f5ba3b369dcc0766e898c546570136aa765778c22e2852bce1f7f1fa526e31917f674feaaeb842aece4b65eba91b866c2f9392c705ba8a576765b9abe878b809d79736c1e4e9ecd9f1ccff0c8904f0c284c7acaf5f1e35e4f9ee90ad47e4fa6ab2799b0d5d805efc12c01b3825e769a6be3d9fc83fd6309cdf3965e81271ac5ece30edbc9110b163f8bbd17564d2ff3ca337e4db1b25d8d924f55b1e63d3fc44fd57fbb36a2fd73f67715bb1f3dd251f36023c6591d816ac2e0a5eeaeef22305d9967e81dec02d3572fa7b7f36b5761abcd9ae861034a2496dba690fb5a929bfeb1b0594b484441bee3e65b24bc0634e6f045e6e4e41075826ad785592b4faecb0a511da015a02dacc3f13fb6b6fbd5438e8de268474bf4a017ecdf58dce4e08cbc581bd5a9a023cb335e10630ff5b4529f88e180f7d46f93f14879e4dc5c7f82c65dede7b631383b577426fa7a03b598b17c374d55abb4fe18890b00823e3314301375d721570b1de76872437c5933e1ffe5dc81647828ce0ed461759dea388a6c3fe359f1ba85794c39e88f365ed5b4fd3df6f7edadd5439aaa6910da82e161c88fef3f227924daee15a0473083a3aee2fbf3e626c0667392d6e3fa99603bffd099950551333b71b12b4af1835da73718d53cbaa185df4d94207e4990196ac0956179842cf51007d491dfb4869b8c67695ca7a6fa077988e372552b35d9c2946387fc6fd0179f722d323560e2bc2e2d8e7441873edd9b2dc7b7cac182a693c4df3b4ae82469803814018dfc24d9c309b508ff4142de43f5d06fdacb6a41804dfaeda7584bfdab97ce5884443d9c6ff8c404f2958f31436361ee728390dda350780377bb4d0f1cb7f09ce706d67e31d989370b633d7cfb143f84a96cc3b689c6aa9002f9e78d8018fd23f668a2352e6c5334bf7dfabb9cdf601e6217c72fe6929e71c675ca86823aefe1fd04d856f1553e850e7f7ea38e4031a17267f7122d923fba98dc7bcdbc59f1db0c44d083aea64b7db4d2af384e149400317b465ce6c122fc5218ccc4f95a562932cf067834a4b84b0fb49bdecf042adb1924cf992a6dd26d609a8f17e488682f148e35d6a38d9d7cf71a780054e2efbcbe250f5eb9ea07ba5329cae4c757c13cc06972b5497b6996158ddd854d5159b2ad345e493a7ca92d9b055f7758d38c5fa718d6c0fc89de6cd2a5294d38c14d50a525ae258926d9efeb66545ee1248196cd1d30fcbfb00e353c3551321221f4bef80572821ab1cf09f6e01ba4e27796f2aab29bf606d564d978ac9e5bda523bd49efac9ece89137fe25814abb6dd1c99fc10b569339e20dbf28c6261844220d1b6d13c8e048ced4152ece515ad3341c3d779fbda27f67fd2d9c9a2bc6a8fb3d5b6df300464d669fc240f3dacf35ecb2202fccc3f085f2adf0f463a0aa0369369a734b5e25121d2fc3a4ba89fce8723849c97057cbd47d9a49534fda8615187e5ea3a05665e56bdce5d0f738c91ea7032e9d6097c952a031425ca69e4d2b2b9b2ee6291a521a53a00336076035f0cc527d0df405f6de426b7e47052b48691a5fc115786e2bbf8446b0a00493164fc7fa2f3364459ad4805c8054e9fe2a3547de045e6050561d46416d8f4108457641fc5dc72af9907b2b77e100a12e6903a3b3b5b1e32dd18b56b6e551092fc075f7525df900fb6c8f1cdb02a585d5ce9486b3eab1fd033ed3ed6a79eaea4895b94ae8c1a9fd42ee302dc49492472901e6c2c6a71ab7c2d1a83d5235df4cc8f38176fdc988410bbc0ab6d29d5cb94a82eba15f1398ad6ff97f8a70303d7f67c631fcfc55f7022fb275c694ad487a622a972ece6135398f91490bea9d58bd4820c1538489d21003fb4ef5c372c54f28968052ac027cef660e021942afe5eb23e3ff5debb265792a5f5346562bcc7ee6963bfed63908968ab37ea3de520f9b05ec272ea5dec4ec6d6b17991457087f8f3bc7d456a3f9d753f4369b99004dc9a69fa1cb706bae7bd11be9174ff8f3fb42c9ebb2015b4333bcf00266833d12ca791283e96e0c23f22929977be96a4401d1f7136f71c356ee968efe09b67a7a37286a8ba6cb553d99b72533bd1d0abca86f9826317b69bd744a82375de577832c26a93ffc713785f7f96a7344945a9894167ce03ad885d982bed0553f93cfe8be0602f9147cb53e9332abe69c9ee78f8f9cb6491778a645e66f3fe306fa8b535b70f6d55978af358812c6892d099abb84ae59f6d557ec39e1ef3b4afeeb1c35e5d8238ee8bacf2d15b7062415fb34421182e81156e897585c375d0ce56bc56066a4a2e4dcce21190809b6f02a2bd9551846c0527b08ed2bccb63a3489ba86a87334f4569d17bb3400ec6eb5e8f7434aa9fe1327d58cbcb12947568094018df401b60d1e8d7e400f9551665c8bfe22572cb9887fba35dc968c4cafda3af98023dede9d2f5485240e6fcaa3ae542c6bf87f602004335dcae873938605d9fb4b0f762a725de66d5ceef15b2417a8cb15c2c8061cb6586719d36d766575ab4d61de133fd9ebbfea51ff6ffcace2df9a70a4729fc3b7a5d0264531b125ef119e0a1220d0a546fea61849f9632a91bf5c52550591af5d34306cbf95cb7633aabf102a9f40210c0568c6c1aa812f3237d1a0dad4e564ab46ef54fcef280255e21712432cfd555a2dc20b58199a59950c10e1b78d2edbca72c363f07f891d05f274663a5ec3d02df115f0d2c75818052f3880d4890ac0472d17f4d2fa077899262dde28bd5c94152f66c0043a7705a13a854dbb9b9833835503cd2db55f6b5dae8e3f67f70d142ef1c031c61fb64c4bbd5f68aa766146432823b4ad6cb7d3df171a3b6e1787d7af4d92fc49dc07473964fb09d34cf2bc5033ef46dcf9a169e3b42ed9f1f7d75976fd145b09adc96e05d8d8af6b28a54250d0dd12ae4d258ab506910b058c132f23b458975dadcada6984d58c0a0ed970e54599a2996d42d1211f71961b667099648b75f85ef5ec567acee6bba4669bae8a021c29d94f0998f13bfdf1d63c8bc4a12e2b943c90140ec58352617e07ea6cb9325882f7f2e614b07bec67eef6878d9b9e8711761805ad13f6ce86e21b76015055066a6d08cf9b31251cf4524f42991b5ef159ff20fcf2ff46fe69737cf7ab180d45f48cff396c601c8db91e91f47b1455aea7ba2e4e07373acc890e5faac685f523b55097ce270f734a956003076e6f982cd43ce8fe521c635d055fb762edbc1f12604f33a014ba83ac0899455dd56178f295b3209728610d9579c7307f45f77bb80e76792851efe12a2ad9db95c58edd849e6a7590acea6e680d5f6d56e552b46b163f0ef27bac37b2588e5d2219cf6c6ec6421d887dc0bce01405c29bb3c2403a958a8954aa1a6ddce81782a303f58d527d9fbd8f62b4c22f7a1acbb36da0ae784d749ebd791786a862d11dab9cbe86a4318220c905298ba19000eacc0cb5d06d299809e4530427d3ea16ee67c74d9e5df0909eae6756d1b0d69bd60a8753375c09b73a5d2674e97edeea0069e0a5722b58e9f5ba872b194758b1b7cb013ae604e00c0ecfe201df4bb61d4ae6154776502bd5a48e954f2196d4a741fa67d29345f2c4b918640022f679a3a1a418145ad9d58818012c9ea1980affe294489806916f21d1b5e1b7c3929b3f771cdae435bc9ff7befa9bf5ce3438bc2dd521cdef626074f685140ceb29ccbb1f911b1e4ba21dee242bac5f21eb84e3d8bdb57979aeca9e751df57c10e9ab5bcb7d1e82b0fac3c33489e095f9be4a5f6495dbba276063957815c16544607310502c84793bcc9d57d3a9c42f5d02f1ed46977583e101076d7a3fc62c514842a87341d004c25996ff177d21e2a982d97c0dce02ce9dbe767e80c05626feef6ae35145eb7e50873f09f9935d94535643218851edb0f1319f5f948a6644641416552c514f48691d055e8c4fad5dd416a1f5f5cc2354570cd181efbea241699666f71f6f090f61a5be1a1b94eff742c5ce2327255abf34c7485cc3a71e4d1afee2f72f8e70fcaaecc5e887ad7dfad6ec61a9dcea6eced555d7b3d7b13834e19f85d67a62487ce87e9f112eff2364f3afb5d7ae86f408808f479c79e5ca7f8928f2e51c176fe681a71b0e6333d91d39e0f7701a7bbd9bbf57c77942a165ea60c859123523162437a77184bfca0826ac5c79f8915daa39a62e0e55dd22c8a0c5cdd6fdcb663fa1c0eaf96454b7705e3cd92476d0d11ecc022a5b3f96b22daf905bb403d3d97fdc9294096602501bab23037067b18c7d8567d33a40389cae0d0a95e639930047516a7a00808734bae583e7e5c67ce8f4ca3bbc8d45a4cfbee60388ce1a6983710c3336d279363ea1c0b99ef4c26a1983eedac4ac33c6204d69bd4243ef05b21817f811194b14a42dbfbbeda399c38d6c8cb160f703820eb233af2e4b959ac5717eb28607b219a58fe039c66380a3538106d3957b55305be7a9eb55a9615a30a70661e54589ba6c26514292e4e40c21fce45c2ecd746e4bb4464d3311aaea1fa59f8cf72dd6fbe75ee280beef03b20610e9ad7dd18dda84093143d65434b1cca9d50f3bcc9710f157294ecd4ecd8616c229957f22f26fa6882d9d8cd211a67e5dfa4a404f9f2baa270ceff9c45dd48bcdd9da74c8e9c90f8e6fe6f54223b2219145f32b9715e25f73c15fdd5636865ce5c361200c496ad139e218aba4ede0e8b9c110ad9865cb2d1deebf7e15258b866999f57fcaef0187b42e0b5eb041d3f296acce50f891384d56cdda526f09f04313a0c32c4c4ff8531edfc6cc1224f84fa449cdd9c05ec66de6f74c1e581e727544ad1d1444994d1809cbe17122c1c5a027630ad65c1d6bf04748b58c7cc61d335f2b57395c6af5e12b1373e743aaf180987706fe3c5c90475c5bc59636fda918943a01b0fba46d2dae8be415196cadabb4edafff9163f398c92717feeb6b3ab1306bac3d024e2f488d19e0b517346a5c79099755edf6e0583c6afdb3600790b3bd565bf842a628024830149a8b53428b0a4f3c6a593e0fc6a84cd4810ba5a0001a0721b1c8e246726f06d3ac10ec26e4a56a8b3fba1d3f4f39588abeb3f9867d7ea1cdc4f3e460f1c976540eae7c32eef7e0e99544de73d5f5a755c232a9536d25698af1f1467568d18f760ded399c5286b089473d0fcae7d4ec552b32334fe5b1e32f6fc94e6f7dae2418ad07bd012fc6a00aa12d1756a282c677028f6f92c43aa917dfcba05d68e26d8b6ff9a207da9ee87d57e64824272511018ed139551b4d868f620888d4b622ba1769a9d0b7dbef5a67b0467d5293d8b9628ed69f9a2cc2f568f51476bf28e73c3367d329dade39c4d1be5171d331aec0e0f10b4f9a8412d4eee6a51b2664191823d955c38273af32eb4408332540d40567fb9dfd8cab161e55e8b4fe132194a44faded5a480bdc96614c32eff374a1413e379493a711fa4635bb5de0b6f25299c2a1cfc0dc6a9daa96915fdf3a39b0bc1f77750d8730f7ea1d4c0138390cf825a5c27c83049fd42d9816ea71aeb35b002b8302c9fb13bb00d51d6f484e0e5660cb690113c8d8c7d472591782bc0257a533de695dcf43bf7e635d758f4db5f4103ecc470635c8acda5d730c88cff6ee3119bd2311316a5c086862113319d02295c5575bc9c9bec121657a898d4803730fe6843d5aa1376167e1cdac9187369ba7de7b5c99d2c128b64241dd3f3342451e388ddcf609bdcd6f2d2d82840455d2f681322066ab92f91fd52d1dbeddc710458838f5569fc86ce4517b47915134d7286877d237c0ceff5c8af6f594be8eca259507eda6253a641032b36abc28f3204c851087c3d3afd555fcf4f1f6cef98f5c13ed72eefb397197a73f5487214ce0a31449ae1ac6726debe90590a10800bf1d54a5bb2cf4222f24d94f36231c0230b661bee7da90ef55a1d84ee713d54c31f540a08589baf21255801da65fea8218b94a9038872a73122b104a7cf1d20d797c0bb1648378db953922a5bcba40ee51689c3a43d6f8da7fa34009eb37d4c54f43305f1e460892eadcd186d938be05adf07be39b624e15f3c43d5e3a58cf42543c43c32c318c1847d1e0f839bca6aa1d552f528af5a156716c91d19f70d8b635f1eaaf64bbaacaeac796534ca31e0211a5bc61f21779e1a642bd9b029aa2700ec3b1d234478e288c1827ada8954e257189ef35c410b3010ac6a6cadb3eabad71732e829c0cdb200c1bfa0b818cf8ed05481b16f2a47bf44042dfdb650aaa25cc8802630bf5e2a82166ba681640a076e893b3261c659ca74d401fe440e2af036e7fd7bf7bc393ff0237a0b613e6a6b44b6b426c822e6922e6b84756a19b39b8a3957d5807c2dc12df4e454ce6bb68141ed9ca0b897f5b589aff9fae7d93100cbbb63f77b1a245cebffb535f2771f7e03471d7215e0054b8e6563b06c25c491f29a6c7f0e0d123c52050831716becf0811eca04174c36f8b2651826b617a20a722c14546b7cfe09f415c54a7ba1d5b1ff90667eb6970fbcca0381d227142a1a19802827f3c9b0ddeb61496145fcf302d6004010c6db72baedde56afe97dd6888db5673f5cb1b6d8146f6577ab8881ef9b19a4e8addf03b123c5fbb5993f37df619b1019923ff1f8450a0b711ed5cee899073c33778e414a4866f364126a235371a5f82b680dff806c6ccdf3e946ef86974eab77cec125285b55264eb7571a7eb44a2b7ab773898d311516ada6309fcc614e1ce1ff07dd8b3622231e757d6cfa598ef08106e8819be664ee1dce0560f0e32453fb172f95731eb2e301af256aab9fee00ec8ceac6e45bb8eb427580f68cc6fe3030bdfac2ff673a09bbe7798d1b737a6be59e6306608339b84a65a72dc32ed56ec38f8390ac7f560b96414e39ce7ffd730789da913df1dca7583a06df4060fc14314b5912dbbf3a867664fc3f79659b0acf6faecb251a6e0485acc23e6f082d0419aeef288a5cb0a06084e67f49a00cff13d69a1ad13c3064189591794b425117a0f7924bc4f638fa5819ff449a8a6f5786bfacba5b5aeea7336cd4190ce3e7ad2f48ebff6f38b862ac4c6d19adbba7c6cc7fdd479c3f1dc21bb1b6fe6b3ea7a5d0ff0b237387d6ff0b59fec6a55959c3099e91cbe135c2f2532f5d76db2ed657e3c6d4319e5197ff2d9b5ca6fdde008fef339d2cd8d1f5155b84039a0315db8cf7f0d53555507473face9f54527b98393df72424f6a66a408d996b215ff1b24bae1c6ad5ec15cbeaf0d18aedd4bd8cb8359c13c01dc57c03aa6455d349f3556b5d4ad74d39cd24f5ed2e90f5a96506445e4dd9c2736896a5ba8ceab9db259d37daf2c21ae75872ea2b9b3a8342ff692d70c99db7756b75cf900c379bf910115f8cdb646577511741a350552852fddde679f26c7e646877007caceba58baf3830e9139f786e803200e2ac81fe21b952e28daf373ebeaf641b03eb2deaadc41105f52a2b13f44e4385e7ea917d8708dcea7b85996ff05e98ce604ac0bea62222dd9048298bbf8cfce6095a99334d2e618ff58e781326ef49a4b9d0a062bb04d777b5504d92dccc6c8fcc386cdb628cf41379401c4edbab312c2c8e51eef71b17c578164db86c404762f9cfeaa9eeb71490bc7e3eef714ef083e3b20c35d26d9ffe31d65102d350a256bf44f5a58d14dd8cc74f186d8553ff7b908d0723f7b1d6071f0b828c4bf4565eb6f9ed705b9ba935838e41cae7b58421b81d5e4037515bb1b579858e82fd7fdce8e698a9c54ae480900b933e9c3216b26d95f615b6efe32ff6460d7553ecfe044173eb636bb6f23e28292db61d0cc35717fb6468ba137a80893ecfa3632722d9f3d931187391e4258af16caaeb919c8f0f28b531cf0246f53bb8b91c59196441a4d6b048e7202880cc0081e60d7af2ed38deaa39d9676258ec33658f4f3b7d4af445e6a1b978a7fa396ea75959a43725842016f3797860bb056faba2f6bfbbb2d82b16614840ad01a0dbfb5bc3ac99550368a41a0f788e5fb0fa5a0a37dcd4f6b7f1176b38529d853f1ef84f3ecaf3a9f88fa4159929025b4793b0008350cf9168ee15e106568485886d404344afef6dfde08b4de85ae569146f9b63b85ab0d62126a3590f16f2dfd220e792d9e088728ec85b9a3482e4e38f0ab66f76563027adb89cc103a6289bcd590eb3be9417ec8be85025c6eaf31241ef331bee8a067dd1670a0fab9a11dac45c6dca1243a917ca1941a057d837b072a28c9bffaab333ae79abb613cf253faeb2a827c8f72e2fea07a09451cadfa1ec29f321a48d744ab28ca7e6deea47c1b0e4eb69e687d749fa70f0a0f26c62d46081605a61d66c3c49d3b1bd5138fba2842dee37a18166ad81ad4076f708b442c84cd90bb0713c1182a994c29404b1e6c41f5a2bbcea942ef83d28342ca2cc0da6393e335d65a9220147a71a5df9bfdddc9a3c28828c3e616f1fc4e0d4e832622d4c27e693ee488ee61e95cd5d64c8c72280630e86815b9a2f53e4b1b43b25e827f5167df3473a2ab0e4a040cf9ef61dad36329825bfae0008be4cbddc22c472be0ae36b48592f76050a02a5782dabbab3bb4c9ef323307f9732c7c0ce6b54f1b0654f7e8c4cacae9b13ca137e4e62513f5cc609e95cb12ba8fbbe4f5385180788fa265853e85b286d909af445d2726ed289a33e71bf16c7d83e5ec2cab9f2b974c5e1d18c9689ec3676dcafb29efb904768ad38c99edf70527455417bcca8e737ce3efea434a8c8ed8cab9de6660c1b6e68cde127b77317925e68bfaba48542835ee5d9234f2f875bc0356d3907444813d2620c1a200efbc768c2b2de6dff4aa8c0946c0b8b2cf973c0bad00e3842c724c8cb8db98ae23ef42c1e9fe0e78235c92d139a9cb670ce1c1cb7a813c2cbe1044ebca9d8b18619a6fb954566762d769e95abf540390c4312a0afb39493cb499fe2350412d28a68926d064050124aa232ddb300e86961004d1e4f8dcfcc21a1f83c1ce71a31e443f5dfc98c27184e5ef3063fe7cdac8f4a50dc0af0ecd089474501c338738d164f5a409d037a1017a8fe07dc110d194b66c655c5b2678fba4259bd8eb92995398479fbdf57758e5fa68d1cf83aab00dd4121c08d4ccfa582e629244c277123808accc7ba804e34ac0d05f9175dcd298aeba94f378656f412f0ebecbf9af0ef5b24e207c1f846d6d797f57f9818b138da329453bd7b3d3814267c514ddd858b4cd779a6c1bd17ce47dd5794cc07f5888dd1c820b029287e9a32539187723bc39d2fb3a253cc25a3243a2a49461916d33c7bb2721baa6c76692d6b29c205eae4c75435564f5587d501c3ff8e8635a997c267420d9c577a675dd5cd36a74573cd019cc3994a17dd6eb60071251a231f13263f7dfcb3a44f3de470c286bb00f7651c09ab594aec1d9aa82834378013cf8ed41ac91509cc5ab0518c72bed1b476ff487716af4610982754c4d54e8f869d816d6fa7b21aac92b3691f574ac16292c1ea7051956d78dba17863a68f840569141276a27bf3cc59c3629cdf0b8e4a62c958dead7c4a6369dd86300fbad58e33b211a584a6c8e0a67cc1c329921361f6189a03975a972eb880e52c7ec92239d330168d1fc8eec7c662cae6b88a32d00c5752607f4f0180a1df49634f2a72a7c6d811fc5ae06ad2771ca3ad29d28746bdd0f6ec517bc45d76c3301a594a064742e69d845b5f776816964a27c47247857f21d1ea1dadf19bbd9454f0523fc7ab6842281817e128e509a8dfd21500f9f6a807a7b4027e5956b58cf9dc2912659db6573594f0047ce8606d8c9fc75745100de9c651a657780e4723ffe738c1415e6b178dcebf3b386c5a1d2380df23919e5fe00e87eaba7d51dea6bb95af29c5d67b1609c18fcc0754bdb5bd5dd7de0ff15eed7296f43f68972c9f15ede027587c936fcd072f15dec71ff0aa6ba4d4e42fd76c651248ef2076880d85efcfd4bb31c3dfcd01aa75c071fa0c053b3c22d4cc6e14fd0faea8998d0812f013e47c58a2da066021248fd3c6cf7914f40eeb07379909c0a3f07d6bbe2d528f679c1af57a8084af4fc8aa9350ae96525e6474578659171bbcbb8e298e52e5f55df4b5350d6b9c3c126632d754982f4d5505b96072556cfed0190901ee75bd98c36341a0616e0901283762cd8ac852d5b207cb48f1ddf3779d7c339c2dd6b85fb3d49bc35996f031fe6282d61e42c9e0c2bd97ec75c732d1b6b3bb8b08e7ab28b511b8511d65e4ff368b5948b9b8bb6733b1ce62d13bd9198defea359f76ca43f7e590335d2bf52a80e4623dba7604d47d1a58f1aaf854ad20670501559445db477303a878470130a32691ddbb84348ae121c352f19dc82dfc906c5c3c2cc2f54c7005d5638207ebff3b1bf185b31991e4e0222a00f1a5662f2179973b64f7cb8113fdbdfcb8e24ec26ba225ffa684acf760bca6e01b157e30228f0ebb22a1d292032573f34098843f31624151064c5ccb701580e02527679e0b53d91c539a3bbf264c22046ac463acfbe122ff3e32051c1c573024b41b5a19e7e77372dff35802e92dcc97463494c2f8ebca4d240eb9d3f29ce05221f6aa659f8b042644b48c6f4e606b348e0b0db9ddcbdf0a2c9eaac120531efb65a9e3b19f57947136bad503721719af00810e6efcd7421e37dfd4fc029f29018db06881d2daf48643a3cb7c3670f3895655a8a027231e832367f9f7586bb7ec1b14328aa0fca368020f5c97de75e746aece6961928e6727c6242cb90e755f7a3a6b8cbd8f5fe048bad669752a4951ce7eaca31541412ee10e259adb08cfd0766eaa256744f44d9376e1f47fdc52ab65527b3e52e41b535de33664568d41823cb276c0cc6d17f04dfb4c1ef548343f3160eed0e1105877a1b26d10d90015340c72dee62c90cd54c38628d12fd827b63c8966e8f5bb4bae8e2d4d1e1d3b6e5abc5e36a34ff2d8bed253be00734044bb690c5967b044255ba48da6317fc2d325dc1674aabaca3f654c3b3931734e9971e7983d6ee105da67778efd112963ed2f9a635e345ee61cab055e82f7abaf210432d2383fa786c1949e69dc341596189ff69b0799f9bc1d68033d78c0a2f967c5547820a6accb86609c7cb79ae3747d77cf151a1d441bb9dcf18809237b5ae97cff5c02b3511cf448fbc49d2141603b24adf8ac599753e2f155cadd8c7b36126ccaba52787043040244401ac09e88afcc2405ab049660057a614f46096c0c1d41fa10fe7b9292f9d1e074393ae9d8261d0418db481d54e5e3610f407e57bca21193976bf44d47782fa1e3f9c522668f6c7af01a2bf0df277837ee754e807d3cf5bcf11832093f60de1e31a57a99e20cc9ac9af90d9f8238841e25f6d722dc4aca81970b3f52feac50e81679f499cb892d9bbf8048ffbcdb344cd6f8e4202f42b1108d072b65e1c10099bb5b7f198c74c7ce8f464752ae213b2b47e622d5ee3365abc93b829ec6087eb7c472a7c7d679fa24bcad2e59c1cc26999abf21d095dfa9ea37e3f9d5ed37a7509e8549b4ad3a481785a680efdeb8a9b0efd0e159a4c902cb4526d020212acdcf2dd51f1103c2d7572e33e9c9d8ff883902236cc1e6d97410cc31ed5312a4efa66729f9501d00eee43d4fbc49bd8f1b5164ac061a075d021012ef50eba6672cabbe41474ae53c311bc7741018552afd78bb491c9617819501859fc6c3c2ce220482ef93a2ac8626bbb286a6ddfc61871f685fbd67eca06e51ded5326804268f734736f9fdd0a3bb4a12cfd6edab64dbdbed168182d1eb7d13aa3032ce06c65aacb8f6aed703dbdc602f67984308b5f2113b6e989115c5fc1fd2413b5c550316fb655511fb292d591908bdabc09bf5368bf34f3c39a21520e0d1eb3e74a7a44f5aae3925876de93d8719cf7197c1134c3f27570e0c20b7b61ec63f77bbe8eb50799d37b08c87cf136ecc0976cdded8d809b8faa0524849e38bf8e0b9babbbdfe96856e35d173b205723a098a5401dca5e2a77ee43114bd727270c1eb998310de26dd6ad316757acc3726234ba26b99370b56f93d6c54aebe664e911df68593ff2380a32db84ae0e748bf8e7d27554706e9c253454bb4549532b714d0d23e23f96d1b5dcde846519f4534d2207cb1d6149bce38d5f652539ab3f7918c1086b65125e659ca14e11dd545a5ba2125d8fa77e09f19ea9946e3abaa181bea97ad665a7e89b1ca9b99dae541b990b7e7a9a55f332d326d54940c3e3ca598f058f4ee1245a4a43b020b6cf66794d53d9ac79a4e29e608aea595984ea0b3d2389813ccd8b183d5d7ba4ae273d1117d0954f3b95eef1488af20a2e9e0e07e6d536565cde7277f017f3b2f679c9a0c7a49a5bf8a067d97011fc99a6fc828930a528b650f5fff48e4b20b1c554e24f3afcd39af569af658fff5fff1bb7aeb37330619bf8131980293ba17eb0f9a86570bdfb83b29d1aec8b1a2f1eb1c687de169394909fccc954767e8dd64d58ced9810f487fbf5f0693f306ec9f079c66c192ffb7e6a6e56ef836cdbbcd51d06e782c2a8e246868cd87218b1a76157a423b6b58a30e421085430befed2b1dee2dbe9d71f5eb6087a7a6123b5962558779fa736ecc53ca49b2cbd72281c0b3ef5d8bca0e4dbe9f0c6f7189641a731334ef5c2af1f0cbf751bc2fdec1333037ffd597fd134150cf0ca8f795e6c105ac89d8a23412504807e8c59cf2cf41a03cace9e38933d450e5dc6d2c8f99ebade0a511eaa9b6d014933ee8ed8a5ca7a63184dfafd21c7bd995a1fee9348f94f77c64730dbf04d2b0a7b61f67531ebec0722e4c8c740118a27e726dfff0d19712318c10e631c458635422b21b2ba705bf8e01345b2c4f62103e8ed81c122fd4f3aa9b607786f0090bb4c8a8cfb741751bf61e0a2a73c6b233c97494ee5c191d28ffedd5d9c9fab875de0e1eaafef0913c778b8585787b6a4892a03e794fa01eee2dbe53387e0ba6f483782579ef9698c1b3e3477778549bf4e53ebe2082e697e3cd01bd9789292f2cd92ecce4f8742f6ca2b047ae6a1ee52d0f95c19b19db49823c58354ddf711b0d8a0c5334be3f6bbf81f7213c588690de1ed65331a41a50d087376e8fbad555acd3a23f04144c06ae782b67ec76e424fed738e4980e70b5c9cb4a21c0e51c5745d5f1c1aa405bf9f621f149ab281b5407cd0cfa32e3ee112dfd04784aee55bb2eba9f399002bf69ce8c1f0857158c5dbadec5cfe91850c6e1349bdeb189d2d02002019bce1e45c542b24097fed797d3ba2761e65997ea2a52ab599051cdbd5445796f7839f0b69820dba498a646153175d527edb511dfd26077c204c94aa2b315c6eab520ddcc19a25c54c94c26c1eecaf4ad16c321862bcb5d3a428baec8125160d448c0bc2e0e0d7acfff9ff4850362b716df06190dfe4c2dd5d532cfc02688b2c922c584e4095f44f76772bee7863f6be51a08529c763b953324d960a8b6c347dae6d179d914f4fa1b8b0fba8274e1318b6b2ecc100de43351ff7b3ff1c41d41a886f3b8aa8a","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
