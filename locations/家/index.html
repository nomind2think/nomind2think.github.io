<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"7a3ce59d0ffa6ff52227e7e9d753b164e2cf0a7cf17fc7f7601270bed49cf84c400d14c6c9d3526545b1722b4bde54945e5c380ad2fb15139054a6a3e93cfe1cfb1819f7579094b353597ab7f4afdb1734ef53ecaa0fb24581e61338171546744fcbaffe8287b6923a616a8832e43984ba31f8c3d5e42d1855a517b51f219f7082ae3a479bb4a3f642b3b0353562112e40bed1b77ba78049b3d2806ff0042a9b0e866bde3f52a5cb439e6ee33c4d687b18c96e2ef4d1ecaf5d5a886ef13b2e4990e6f8e9adba40dccbdf61daa5081dc59db442483499494723227ef216d44292e9e97e75e7da1cdefd2191291e40962358db42c695fb2b3cc97d40e1812397f506d6b246eca9eee47c0d11ca638bfa0ceb60a0f53dad751932896a6593bad0611eb3148ef101a342a439a3fc15fb4651a238a1c3407569ec255e9a32b0335ba2e72d52b8bcc618a8b31f55ad3cecc37a37c4b3b6e3ef44cc0f9f56ee71c1e6329b5c8a04243df693cddd21c95242576f8f8cabde02d0309d88cb9ab0cfed5a3e357b8784ecb1ff009b96435c7758c1c9a029abb50cafea7d2ab59e3428ab9234aa1423872c6963db32370ae7c4be4850333c2e1824e9901c63dcb6858813bc9552b5788c44c4f511ad3b34eb0265de4fcda2bd41fa6795c1a79f82c43b181f2dd1e896f608d2f2bb56afe2778e13d582e834cc1f944b65741b471f2141283ee432e73e4c0f2252908bb45b1f00b369a328467288608f61905dfc054cd3eac2646ae685f865c4288fd8dda797751554c09fa45c0d4f090993bf309fb01bbb64b30922a918f645b60ad31c777cd132e07335ef326778a3eb7d57baca0b5245d6f24af39aac896586ecb05eef5f2722516e26d86a3897422b8fd1a7ad81c01df6159a17fcec41bba6f370413d277a85c538f03c8872d5d48f49221773d204bc7c3b5bdab4d40fbeb1001ee99b4cce9fa1bb0e21bf7d62ec00d9338b19a6cd94a787d05997e3f2d160638038049d7cc95baab0dc5c461e781a2399a501b262ae89636b17f64b2bb5979e232c5b8fc2af540ffd6416f64f2b6b9bc5f1f4c9e88bfe69d3d775471b5312982e6c99416be6f74a1ca1791abb80dfd778fddaf3384668df6f2e2381e449e58bd9c4ca9bbf0ed61a86ff34ca25990b340f8d7fcdea48021ea063c634496e661c3c7cc58f1953d1adc409714ea2bcd880b4761ce2f8820e916208844d84de4e0b0c33d30a9be107e3c9a6d817f02ead35f0b8131e56b077d65dbbf2d962399a54d0a242d6734cb0e5bc30cf7be50e6cef537a1aab1b436df5e2792e1fcef142972e02a197a4b1db5c4d6baed44f605a45bcdb8e0cde6834bb3d2a36985ffc9acbc05ae5795f234124bbbcc95a643a720e322ccb5660f299eefc76682c896354b1feda36a57f332493f424bb674b2e5ed395ed489ad7568786a1a50a8fe861d629f9bbb2a031069bc5f7e77095db251d6e3bf52b3ed85e5bc4ad67595f5151dedf9003cd6f7f91f6da39679bffdf11d7a9ae4fbc295e67d19b64880185a6f7789eae23296b782f4a5393e4ad6beb3ef6cf937b17ebcc1c57a0d57c76e28ea0952ea0307c059a1331559059ece11c9f1f6a673c5bd8c954a5ed17ec71e626acf16d020fe26ec92a0b83db06ecca19326c2fbab47687b5c521b0bde55be98c06cd36d7ae264db7022e3e4c8a4101496bf00a5d57d171792d46254fc76263cc0a995a41baaa3becbff39b42724d009b9bbdb0736179a9d7b2f33c9c6b58da18ef1627d86d82939ac3db811a2069c6c23dea069c442927a2b7b0ce32656b9cd0e1e0dfd90efecc7f788c2182af336b356cc95d19905ddbd0c6f87b4327f249c267df187c64e090b359ad834721ac2a23fea3fefc7d45cd433f6829772443f0179ee053c3ee53c22036b8ee87932a6de90aa8720c65dcc6e26153f2577f1a3e9bb7f2b77da23ad33e93282fd6ce84eca8dd3bf4056eaf3435a23cf15e68bc18abaaf452d17c8c5338c3473027fe9cf45e642274f4e81f2e7351c49341f4b248198ef1c6508c211d104f72a53fe2c5ce96aa8663f1e987a65a674836c1ecf3b199074d0a9a5489d1d4fac0e8efe40fb4b7425bcb360952ec136e972eb6f05686bc92419252679698009d942d53768b917928ec8ae74074c6904599e136b42bcb4361062865d93bcce3a839f3888fbf6b5f79ed4e384fb07e27527d3dccae36b00ab499116a6c6f5009f16c84d6273ef6b6bbaa4f992ed8fdc096ccedccc929a40a626e94f51325f6871fbc97a212e49b16d27863152ffbd28dce73f2aa4af80319b544c0b5cb6a61174ff7dae3c15a6bd09cb4f75ee91b15381381751d75d1cfb5882c221fd5ffdf4630721d26b9423df8131d56c537ec0799a700e13a193c2c402cba929a775d627806be7b8939bf162e6d64e9eb29f9a338b4c5ad3e3dc22dae81bbb8076dd7e98f608ac76bc007675bc2c847b20f844d4c4d2fdc054e38b32ff61e2734c1c13ed5f5e5e7afe8d775bf3121104d7b14043d985f7b43a78978cc3da25f6c4e7b7cbfb07eb6c179ac75a1d2a7badfbcc1b7547243cc76201833d3124175356d79015fc1377e095e410649b8555ea2ec77e08d9833eaba4c0e07f2ca737b04f75aea7bf1f8768f304b4b9fc369ea8d55cbc1c564dd39daf2c6b658e632589d1db104ce5079d98802a4c3d1b56f7d690003c53c7dc242319db9015b24dfe4f8eab50baa26fa517efb1e7f2bbb7585cdea67faa9f174f619ec0beaedd7e4f7785295dd6cd03d30ee36ab35ece2bded41898722a86c6484e70d748e2111b3708b2d97a96220ba6647367b198fb518e46d4eceeae94a797b722755e91dc9c09bc2bf43a8ec259acf4c54c13222b9676a6f99ad043f459b5b52a4beb2532f76b2f7d1bdcbded6e4f78b32cbcf4d184b4439de7a052bb736658f0cce4cbfd7ddb90287f2bc675ecd5243c9e96849c8ed753d49584de9a5c2514de119ff45e19b8a2d69de3bc40bb5c29da556f1f20d6f10bbff79571592d214524bdefc5bd801c23ae016c95f17cf13726f6d3fd5c1b7906309db0d6e96cd49a926bd83ad39e51e4fe619c3d4ebf3fd81829573f3d9b6dd8b7c1e3edb3d9fcfcabce23d33cfff500c53c36b6281ac442d34f37b25c09dad9b420bae3d230083b17f193220c73e62918d815a01b47e28d4438d86e49348a79c5256a8d603e1d914ea5ad1685897399cade06af5166aea74ce9a1ac31f83d7da56a00b5b15b80e0dbfd818ed99882ab4833f2a7868adcd7074581976dc1c44304caa76df42d87757cc6469c10d6f0c7640293bec211879c00cc773892af86245bf41468ab2c5d0cc7a706a2bde3bf278a68268f624e89ec01a6b9750024258cf65c2dab525e2e4f0edbc825c0635e80d1993ebb3aa3d3cda8f0a548b9518064360d500676c5ab7ae4b0521ed07c0f3e57a15b750694c8ee0a55d1f1c2eb77579cf33cab367d862a7d18ee876f66b87eb8080a6d1b52fb0c9f358f65e5d40710bb34aad4992f8cfd3e6b0a54c92510e89f2ce87d3ae6d281719133b65193b37acc50e3965bd826c8c13d05f9fbd4f7ee0e5a3f6da937a10ecf33afd979f6bc7fdcb507fcb8f7434449bae00320156ec007e6143736b4eb0c4057467ddd9e2ff2dd04e9c741cddbc57580323db7d89556382b248f0a3192f52c6e16448aaf8bd67c91fca6a99b768322490f2fc5ad34c49bba3b9e168aab2344a040b13645e2e52da80b18bf5e94cd9b5c0c96e2f8da971dd7fa883b7d5be7123610697e86accec440f170b04a330d988b3060fd33f23364813864b43a065fdf36e015cab5a7a7f33f24dcdf70ee4e376de54ef5cdb8c5a4d6ec9dfe02004540d5623d9ade085a855679fe93c90ffe7ab595a100fc6af5faece878a41f2e332a1c79f33964431a796956858cdc51b750475cce5eb0ecf48cb152f72b26f60e0d9ab17aad5695ed902a97f27c5d25097b2adb47203e5ecfc9c586e3b2fd3e7e98db5815a74d3abd21cb7eacfe917859873c4f9048c974d527c16c2d5722a77d25fcae5d9b7c892433d1ad10033fe7029618c54282634c61c6ae51ed1e937e15d29276a35076949d09ea95f39bf84f92dfb4c885db32647ac943edd306e038ebd48d52883cec899d55f857863cf88e1a4cdf58d526d1527be2c4f3da254feb1d3f5ad986b3f28c595755453178cd05b5b1d40ecc28d8f184100ac78cb7306de54a3e55c7d69d704cac9a66649c32f6283428ca0dd5fb66e7036b7ab870960a1bcaf1871c5c2917e4ccfbde69835b0f019cdbccc97e0cd154fa066ab1346c46bac8daa52ef1c47d2b673485b9379f8aefaefc474e60076887fd3c78f9975a704504042f7f2fd6903de2a621ac0af3544f7edec8377e9d2549641e9bf9f591ac79ca7d4e3a2fd91b40037b2ecc8c8e01b273f5c759412e9c0adac6435c5a2836e336c3e15f4635c65342e0ad40a446308045cd06bb97b40ea1af5e8c820ded7a9ea26fbdfeb147d5f1b20aaae8708ac176c6930116b63569df6be258920bc684d82a667d71efaf403f6e3a0ee6365759bcff01887c0a201509b44562c70cf0bd38248a14dcd7bd6f1677bc93c02ecc20b2a513d13aa635f96bd01b4d20f15b2f080bacc36abf5ebd5d62bfc6f287ae590a8a59353286b40fb704bf16ca869acb525f0d51b5d34600c65585488147d27cb730b7fc875d11840bdf198b847506d33593312e2b510e3b1a713b0205f806b57e150dba55c220d13b1c3491898485f3056f0e8892b6399314edc3b717adbae0b5d72311d45579782f0652e7a881a90a3572d993d8c8c0467f152cdd403d897347f48b5532250af6d297c8e5b4e1b5255bfd4b65ccf79c79e4178243d359038577dc1dc0fcff114f37af119bf710c8c88ff3b1a7c4bbf4a8eeb8d8253ab55afa8dc2dc2b53827df57bb96222b4da570a20e30075c529a743ca9b783c027af51141adb64262ad4f69c68664256b510d8ea0e5f49549e71a78d37abc6f9a21f4f84da8524709b005d5f563ab7f850515133583531f47d67af67e4b1c812b029505534ea5bdc858e9164118561dc433325748ac5ff186ef19768646019b4a09f3908e776d0eccce74ebe0e253252f5cf4d90f8f6e3244d260874bc814136b6c65d86d0efc7fbddddfb2d289ac825a6e752e66f889863c49314f56c2f7c599f4cceaadbf9b0d62c4338b27e60ecc360a4b21df6da90cc507d7839c110e194bc2d5250098d2ca114cd383a12e9eba56b5da42a16b64b10a853e1de97ce941694a9be1fb632cf077bf61561f394f22e7ccc8d9d7782ef8ce568d263f1afeb9de8764820abcea9c23a88a9f031ffb2b89b182d83f4718e6e68fb8776666e87520517ba28b4f0bab70dcf53dd2e7f68610b8f957b1ad58e2a55f3ddf16d4c39d508c8f010d9174d03f6713feb35a3825809c4eff15da07a4fef8b29cf1b511b6af3537fc2835408363fe6729f4b731328a44fa0ccdc113cd326ff8e93f415a3cbe744adf4a3aca27b46cf4f44881fef18967d427329c02916f7d270441be1198a2a6fe00d5cc0047f62b6c215e269572cd592da20a26b85bacd6faf5d96aed260a9a192b4a8c864f7731b22a809148f17e21b4aceb430875ae698ee213a7898df6a1497b6248c4ff3ec9a5e3f5b5e51a7b87747c4644538b6d76c987ef99511dd8358f00e060aedcad609317a3a7bc5c57875abee8a987ce72747449254b2f0919395e827a4fba83d3972562b65a2bb294b8c3eb253f6ba57ebbe303756071806dbdd985bcf12c70c8392aa237586860d941a85e7eac167d9e22fba7dbc8f607ca87d3d5ad1c97588553bdcec6735c4b6c24650aa1530079118b926674a5f3899a17b8196c87ad8060b0853f4c591e16bbf30498dabe036f828faa7c4ac0a44c10160cb6f8e5be79ee1b3f6da38f8d7bcd5aa095ddf71c9feb176a8a96bafe923db01491433a043f5aa5bee07f04605a7c7010c35e242a581cfc8d3b500488217ef00dcf3ce667d066b172c809e30444ea1b034e5ca2265d146b23cc697b0140a3271d0819db0e206ca4e0b9047d863268439c10ca0bfd534e6e460f1770382644b29866751bc0bf551d0d831b05d9f28dcc9dd9b027457b77bbbb4b2ab383ae8a614e0895a7513732034daef94f5085f02e174de2c4d4cb7445e14b58efc59c3b5cf638a9ee1607a8846ac7e374ffccea6306940b4ed212d507dd0fb6ef09f992423cdc54eecd0fc8f0a45a344f6bebc471edbbab8d766e20ca0b6ee48f46cd51fc769884e3dfc8a5f2c5d09e2c1fa1fa3f74d9476f6156e1798808122b6733d83112c78506151b3be7569757cd3c14ac345bc25f802fd7956c1d132f77da1f581328c6bb598d8c8da5024c83911c9c74ecb51f951c1b78f0705c28db3b9accd801b73810f94b04e5230d902171b398d2e076f6a4ed52db9a9730dd87da901459d4958dc4c75f16c5641437df886bb5bc1a579f4ddc1dd41287ebaffc0d5ee69229c5f451fcc81eef96dea09488511f91b78ffba4df05ead56c3f0d14138a30b4eaa9383fee2536b7898199ed62c569456f1a232dd9f658656ba03f81f778b649e12a465a2b926102f3b6f5706e40fac8db60dd5c203f80c970165592fe40b5f816c897c433c572908bc8dd9f0bbb7e140dd34b42690342a97b29ebc2af8442e3f4c808c4def884ac31c62db0394827741d19bb77c19241d45d0512dff3033d4387e80cc0d27bf7dbaa1fb4c8e2ba63fe62e2629dbdf1234e1031c8affa3f30b8c3d285096da28a2340c57a0ccf9e73c5763b3defe337204a413800b5e766e534d3ec07f92a4c542def35eebd74c460eb7d76989dd587672ac81fa0528f7835b9aae95c8f9cb575d7b273eda76199056f734f43e35d8b7b335fe379e8d7ad29c6908714e115d594ba5eb7737422708c08daf1049aeb8fc246054360fc7fc2088e27743ac62d9030e9b7f358edec5ac5b2f217236945f2ff2ab369b7cda32238b18bbe9cb3b81cd836ed500a760d3c26a6c2a71e18a7bc4eb6f48251b38f28367b4bc47dd698a44e01268b09a830a4bdcbd8d494bd8d7c2e196aab25e73f6e78a197b9a9c1a411a80ee5aa4a7365b0bc2b4c45c22433743c886589fc11120ccde97a84b0338567307ac4a10211c30f4e5fa800fa01384712539ccfcfd1cacdeabfc52ed86540a991223db9361e38231023348d0f2d39ba051ce0f387038a10986e2b0596809d453484b71993b69f6314b34c2f66ff1803e1eac9534dfbf86898164a8349c522ece650b83724c02c0868fb9711ebc9edd30f825937bfcc4956b8f1bbb9fdcef2b4b3c3f7dd50f9b9c7f511cbc6ccafae95b60d794fff024b8e04b5d9065fc4cffc4d9cd5c937aac34b02e2e4a1cc718b5c437372ab876c3333b97adf06ab2aae8d19deb6b82a95a9fe4dc1db814f19ec2970dd0567c3420ddbeb83cee5fed533563caee3535f7c42501ca7c58c6398e542b8ba455a07ec59d86aa02faf7b487432f076d68933120381f0384809cd166d4239c47b2bdc75634351312aa05b570de6f05bb2a0fa532ba1f2026f91c0ea4ba7b55d53d9b074297da841d679b458392c10c79ee14b9f0b39faaf83a08a2b5d83eeadf7fa7f3149f0994540d4413092db5f6519089e1877beb094dec522f0ab697fd489b398c06ba17868a8618a90b11fb254f6eece415bb818b228e80f3707ab615e550e821ef5984649e2d020a6fbbe028c39173c78d3adb35ca84233295d8dcbb72285fb2538a2d62203fd3d4f610211190f1c625d426d60686183ec73d8bbbde4cce02d46a3ab32269408516b49d386b3e300b7c559e3e72fc6d7a47e78893c1afe9fce94d339c470a54c6c8b1e978449f4932a01afdadbed01f2e9105b647b04dfda06c2f51face5e42cf798c6bc35a9ae9957c00e7ac35a745550532f111d92c729413961b8a7cc6a5975921029839d99fa9b223d82306449299f488a29320a4a3e8d23946635258f7ab8501afd0673b449cfce6bf5155577f0811abd192fe09588b85ed3ee46ac5a18fa1e900113487da80710992d85fc0c435c8469f35beef74f08e02b59c476f0657ba8ebfdf21416a60a173078a04191b4b6cdb79699d6d6869e344cf166604cab54b191a09ab60f2a27a8a3340f44f401473aabb4596909ce8d5b52c38b928fad6300dafcbcce6efa8987ee5d3bc65da672024ee7510cffba643d01fde22b5b6b050d0592878cec33420b23005b40503590e0f8f8457ebf2519212c439263ced9a32ed372562624a75638e24d1ecd63f0fe02c204750d1e4055cc6c01a64faa4954743f4aef02727d63d77de4d386e80dab6164598c682a189dd9485b09fe99461ae69294d82573d09de9308681330e2617bccf8c0a1ccb5a21c7e2a302531a174a28390d30fefbe918dd63af43c3ee2cb2dd519a7b371a10477506a7aec56b2572bd14940e32d1920bfc02804b193c7754d7211bc65b00d8fed22985eaeaa09f9a2b0b2d37928d3d9c4709e146cfd6fea8745b818431f74a2b6de2ba4f7763adeeae9e8bad6526420133276b110b8ba4bb3105f60cb86fb2c3368bafec7e304a7255877873a45b66072650e1f55d4381c89560fcff8bff1133aa84ca775c90e2f7664d79267750a5904c6a3f1760005a6db06beaa18e85c045aed6269832906bdc7b7fbcff0e69cf01c05c783478ff00af9db6c60fca4320d87a3d6f2ee28967018db1ac5804a84413cf3fa96c583268a3026e65a6a21034e48964f9f2fa6ff36340681087ab0ce6637e024c56435014bcd3f2717860dc3f095fe7b9d7a5e9ca9aff7de787a22db44a497068232173ea0ced87ef027cd0a637dea3f178cc5d642a74800b2792c37f4ef3796d241013fcd2da481837e48b000ffc9daaaf1f86043c91bfd1ba3dc344c64b99b566625ed5827c165d3ddadfd96c6f7932eb0056e78bc7cc67600ea424f7b4dd5bbd0ee1d9c68cf0a89ea7e521eef330f848e589af9626200b28c9e0ee4418c852f246d5dfed169f8733d8c9292c2804876f1da4106c2bec883d3f4e5a8afce945b6feae4b72dfd0fedad3b7d177edb2406d3022b7e20fc665c1e5cf8f6995fde370438ffbff63151b86dbd09c599e7b0b05119979ec4fe6d9b0ab540172416b625311b6e477fb1ec903c3f5e10f565afb03753845b1035c08f0e1dc5df9c5aa83951acb280aea3eed287ffc6294428359d8c65069ba076582f1195ec01fdcf0d6ecf94a139047a28686776164bdd98b521a0bc311a89946eb1eea7c32a5f3f5b908ccc8552197a70a179c3427d23c89e10f79e6380266293eb0eccad80b26fc0e77cdc8570aea69f161478458bc302574aa3b8fed67868653b11ea061ed62f7af3f9e887aa1a572d0329ce6e8ff3dac9ab8c1ff22c71d41e4edf963c53d51dad48501f53583ec6f6e5a06d4030950367c83bdfc23991273017ea8defd3bf8b2e8bcc25e358fad59f1bab9920155828ff5da8facee3aad7a103ce7986ba2e7104fcef2f88c228082b959e1e3a82faad8dc484b6850021b0d7a13be1a31ed9e941d16076ebb6ee030207199387c972d47b38b02f40a23253671b7dde89fcd9aeac71ceab50a7b20743015ce2e36afa4fc139e6baea015e6bee16e6c8069c26f5c70f2495aeb3f4f5a6267e6cd02489d1e595733087438e98f59117e180f2a0c049da7d426af34a965e45a5990531acb742bf0657c9caa980553aa5284a7676a119a3afb26ca9016e7916caba4f75e4219910c1c360487d618cc1abf0b66310188b76a7d750f7adc5c5b36d511f273ce7688f8b3a4648321d57ca63f32ce17d8a82a200399c908171b14912f524f9f86455d7eae242eddc2af6f473b97dc46ee5d599fa509f49348d4de3fe605662d738f179ec4d95794e1dc55d040cdfc76919f0ae12eb3569e4745b19a52a1b506a0c825df64cdee5c0eb56731da7fe79b306eeb3ed6f5c853e4fb14e2f645396a2f0da1452f7dcf34903badfbdf945356c36fcbd2d4c797e0300ad3c649ca55cfd7d36a835a01d798f498b5fc884c14d93135c6a53349cab608cdfb29085e90cdebcd065b42987de9efea82b6628e9a01c6a7a848c746c55b9c6295343cf53554dfb00195e7ff2dee4049d08695ce161a10efe7c0f341e03776d257ee55c4e9c42ce22c0cb43cad5480c5c4980e2a4aa3a9545d88742053a3efb05d4b4fa696b0d0492684f06f910bfebaffe02d3ac0559d2e77d08e76e80366bcc23d4557026686844d8c8255ee9eef97698d9d97fba3e88c63ca617996971ffb65901c667c2a07e356d29a5d6c5425ca61eceaad5e819c1bb5be318bb321371fcea4f4dcfdac692a72f54006b98bb03674cb9612cabecfac2ad13d4ea6a50174c4662737ac9324dd5e60791bb65c1d584d7cc66d806f26b94e0192d66423358620d2c0beb75a0d715f44cd820df58be8a75012031914b0f0c0c60dd3a4a947694ee0bd03f0112696c617e3f8331994213a6bf5ad0db76fb6572df8f80c97543d1378b1595f60927c48960a179acde39060cba8cb37cf6199273d20c9868ba1300677f4fca55d3e9405ae7b04522cad81be5aa2af18ed102318018c036c4d72cb34227cb8672ce5d9c0e0b50cc1cd178b08926d026e1afe28026d22746e7fb258c4b095ad39be1571cd3df1de30b73489c46a5fde6262bf8ac0b1b2a7eaa50dbad3b8f4b663ca9cb5620e3fdd8378a35958cc8e6831432619bb3809015e33c75ce1d4d8e16b745e543148d29144ab6dbe1615a3b012572afad07ee0d24ecca003cd1b944825947c42bac53039fc5f146017378811da1ead7022de4e30d669259493eba63534419f7e6b05a723846406f97db49ee144c324041ee7d770291b90d1d2d494f9fb5a15bd50c852fd43af481d9624a16b7bc5b9875716243c3ac4864783743527a3dffa0acca236ad28c40ac8c3e148942288814e5b8bf20acc391960c35202dfa0fb564261a2a12000bec0a017bbdb1529a4a8c0c2d614379a24a8903eccccc4bf456d5c323992e5395f9daca7cafb137a9960df66ad99c9423c3eca19a651d0b6ac3d3b66529f1e905ed8b976e8f2bb05e7f285e6b1f5521b19ce181511d2c2cba72dadb86ce551ca1ef28a19e43b9777a61f69653b47c5a2bed93996e823643583bbdcb243b100fb11e91bb1ac015e718ef3cb128ceafb7fde9e2808e92734426ddd47f4532abe1e81754bf1f598e5879ea540c61ebf3faf5e5cc14863aaa487780545eae9883ce7a47140f5d2fd980ad76e0b13409938580538d6e35444aeec748197231755aa0b7a5205a087551750e1d01d307d062b09aacd8ceec8eb33cdfeaa4923ebdba50f02b58dc9d65cc64c2df98faec490ee8757b317d48b66e46806b617b47a0e3c628def109fe0900d21b48789207efe18be215895828c6cf88b8496ca2fc4b6272c99b1a86f989893c3800343c2b6e9b9d62724cb3d23d8f71dd5113ee1225f2e44797b7573ccc2a9d391c3ee4cbe3036f73112a8735e94d1d9e67485ac1e785f616949e27f7002c99299b1d44c353364c21f04cb48c75681d7aabb427399e452e81c2ef6d2e1b5ec4d3c0f8557fc39c38e2dee6bd757a3503caa85dcc07f1f6d296a62e62883ee300cfdf2b1a79d428a3ccb70e6b7ef47119ecbe636c9c86d1d6c42bef7dfa9146bed88c26c2f4704ee81c371f90b37a00dea5608efa594bf217ac0e02f2733c2827f04ad123bce3522e3e525dabbdbdac52823c42dd91a771dab7a17718cc65edaefbffb5467a7a8a0c6e28184232632701f41d8e525c14e3b1670a969750ee2670c3d867e54ebb4406feeb768ce3c799d9e137020266a1d895dacf4023f4fffc7740f555c3c4e40448b9280c41bf9b8b0f743a78b41d849c0ff95ac57bb0942aa9045ebc83f161c3038d76396b8fa446539c26b60888b321fc4cee154f9bcdcf51b066f43f3201edf47cd1bf280a75d8682a2b91856153aed642e99414d18e9b9023dfd24e36a237423e37ea9952c2237d1d3214f03940adb6a53038d6ef8cbae9b5d5d9de2ddf1df724ff6f5311c0fd1e34048960e5a363e5aa5d797df109453b37ec1541cb5dda31810df5f86e3573d130176173564f4c8b06d842cf195621be10e30930c53461316f95f6fc8c2518914af190fe7f9340b9dace71503f73006784619bf29b4441fd359084ffddf2edb052d9439c9e2e6083ea7be6f2c444b83e72084831bff8cc992eea3f6d07e0d86a6964a29fb50f6e97fcfdd3c9119be85f224240b744c1e1e3e7e0ad98966ecffc6384395dce96c82ae5f4a9bd85aa939753a7987e31ddaf9ee09fb015d77972eba1684a79b26abfc25286973d73a0170539e4fe4bcfc387b08668de00c72824273f625810d7c783a165586fe7d599a7230524a1f962cd8d2d78d987b6770184e6e5b957c956f996081a015b97ab06e85aafb3e9ce58fc87fca637a6673e410b74c8afdcb369e3c482de7a8b3199e865e06d3a52d72d0f80eec7af96b48083a9636a0667dd1591d5c4179d24cfc0ae82b8974939b1698948a7c4d16fdda683d3700c819a7f13adead52b496d914d27f2afb842545fe0dcdc04ce9ed8ffaae134ff772fc623b9bf0e2b4d02cb24ca2422bba10f0896ee0ad17705663e0a822efea425cf172b814315427b9021551e41de92da702c227d900d3d5022275a1a192c5d5fe05a4897d02e4caf015eff39fdf91fb9dd5eea582df98a200d4be103acf31bf7124c16b9372b21311a03905cb8139e0a7cb6a2c3751c94c568bc1e40670ad3bd4c25223e88bc1a8bc2c3baa6487d847b424a445e85fa022b31fe3de133b3d89843e60a83ef333a9994120b3223fdbd5bb612041ead4827b020361201c093b3a748c854be6abf3be19b7421e90e09e8bae75d9d1dc669c324eeff1b5f0339d6f46c1d55483fe87e745e964b152717b6abaecc2ed9bcf0994d7393a20dfbce4e3c7b3b2fa64fcae668091a6b34e98e79e7b19732af7b731024479aeb358b393d26b0fbcd3e5770321f4e84778769e945d3ede495fb57674b9994c3a2a4172fa9a0c82b65edbfd0b439871e503468848f3c152965a75dfcfc1c68a5ab994777f96deb3d8b18f3d8a9f02ce86376e08ad7ed7bb06e1c859a423b0627a9df90859164434c9c7f516fd31b98d1473e05b4adf5d1a09f2d1f57464ae34c92824389a89b05364f0817fae1f092736e9508b9d1909f31ffe13b8c6367f32ee6539af0f0842fd7e2d7bdea6bf746b976470aa100a33df0f5adabd325f2571a788ef5f3fe0e8b21bd74686f36dacd8029954ffa981710c09a3dee29caf9b5ada5214fa8b570abeaea8d66c676cc28c81e27163aef75019e91eb12e981177c8de88b1b75c029233c69834cac47c62ed586080df719d2d6bf8543880011e9bec723ef36c77e6fca19101a903cbf25b8d95d1e4e00385f2c85e1b540f195c5b642ad279e15d06cc7c9e4d9a6d28aae9ae32db61bbde62c215fa70d88942a128279119d6c97668d80b2a24f4ba402ec868e1e1a1fea779d3367868619daf95d5acaeb40ff48da0319e3b3901858b741d3a81ea3c2822a7222820f899662735177d9777e96ab5650c0d53c636e47310901023b03cb2e05ec4a61eedbb050ed96b519e388efddb25a3d2a931948b5f52738c90f066c756e8ac4c17ba2282e17fb694e685bddcbe70b1d72e5181013122324f1fb22b439f59959326b44c72612e0e67b02d5680a2e637b5cdda66002d297d2bf78a2bd258fcc1e0282f259d26a9f9cfef0cdc114f38020daa6af9c1677f39f5f60d370ae720593f7c6582557d2c7d8dde34c58ddd43b64088bcb853ea05cc1cf6331b5fc6980a3e2a46e9b47675aa931f2f9c99a34211c04bd1f4a1739c4218c3c6c1757995213612171e8be5aa30bed183703008728a6ad1cfa8190da53e9c4bf202cc3a56811bf1676df66e93b63252ae0fb04a1e8f0b2af3a1281248e8d1590faed417e05d80f53bcd5edb0c4684115e12f521d35421a25bc01877a4e83191e36682016e146e5dbee5cd9df0696f5868c68d5a41c9e0b58ef2f878767ba129e83f10581d8b42329ed0e4b9b5a82f1a43611a0db0f709a447e85ee6b10c6d07a666fec49f1356bd2db888ffe890c2d61547e68edec56640006c5b64c0fd0c531655997dc2e4cac2fdaab675b5190869c1fa3f1d239adb2f3ab54fe052a6f5b73c1de295992a6288e79d16ae2ef57d2cd3b231d7ca597a9501848b722d74d7958d2a903620d525aa9af83d89668547f847d3c12719d0957957ccc0799a60ee92124b93f8643b6db4c7575438a11d3ad304ae78ebd11833a641b7eb31ec52b663da552c99fc0b89c50f06cf9d4b458d2d4ecf6a99464bb33071dc2ade786a6f01187956ad51db837b67ed5dedf1dcf78710fe976f6547ba864540b77a912e0d32764cc32116b0fb40ff6063cfec2524f6301e8bd73e790525c40cb7086ddbc87443b83a093d386bfc7bd94ab81a53c6a3281a6554f22bb8d2e749283d8dc7a073c5bb7964e82f6a160ecfafbca1bab4e6729dac6056264138e4891693d08829f47263eba969f6cd88393358755c7bb9a47c959f37497088f30a370a766beeaa6e7e6fb7bb2563c47b2c1f46da631100010f32fa46c3271b05500112569c1d40fbfdea23b79f5f8752baf0a6371dc231fe41776baf341d7533195f6dd82a6af2cdb6b86b63a97d76c99f6092d641cd69a1658ffaff248b03615703a0b4c85ca6474ff5b19de73a680a2c8e89c9844d1d9cb4c72af6167b5364ff4edcbe53e3e49c33c1de2085e051f399371aea68b6c19e536514fd3d27ccfe35f8b9a910dd48976a7388f4bc87b62cac253e95e67bf8498f17c40584896a2e79e6bb25c77699ba7f235f5972af3da51110609445691e3cf1b717f41a1c1e3d1d517d43d4ae604259ddf28cd5058bfa1f3daebba469a0b2f2ccb4fa9022fb230e4fb5976cd799aae029a105b10bc9d261cf717c7459b911e694f28aeaf089d4eaf8c167899878164035d99883cde3119334e5cbab13db3bf8a427bb6dff3f42382d9ea3c723f12fca59df1a59f1efc3f87115d2fe7fc2bc2305ab2c6b05e2a6de4aefb820d38d89a771ed2de4f88b4b892622dee2bf04f6289a339865d557be7f75525b27a29e9851eb74e890f8f15920872067a9c244874d4d1bfbb3efa1995292d543e40125c1c1343b1dfff6f4b96c90eb36198088c20b70a6fa1b6ad4843edcc519464fdfa58920b1b05b063a26b6c5e973850e22682885401fcd4176574350572d69cf8f194f384c99c33a569306eab11f9cc4554cb1d4f2927e0445ba3e2a7a50b5af44c210d91714986aab8d774f4a485bc7fa976f3dad46999683fbc64c85ad2e717386e8336e65fb9c87d3631ac317787640f0467b0ae2d75a793967c185642de33e32d9f11e8e0319055faffe417c8d89b0b3a7b3489e190d7f30006c56ab2bd2b7f7bb88b5dcb53c6e69084111d4b7dede6078836bb82c2aeed5912180b978c8b02bacae3f52e4e1ae9eb433b77b1a8874f6376799c42ac636aaf3fed3d0cdee90979d1e5821de31f3d9fd733705e9f28836c53aa6fd16e7e048b43f591b96e440472801aae6606402b7e893c946d2206e709d187f396608ac445a1fa04d8a2c6715757b72fbeee83b15ef33dcde7e2049c90ff5f211bb0ba607af11df2e7d2629fbe0fabcf750d3aa356787245ab8844496f15ec762324857ba210fa2f3da434a441be618df530be2aeb1b1e3335a2e2cbf8fdd9467134a0986d96e571fe2fd93e3610dc61e5cdbb23d45c38d4306f70735b57a5f754f43e6f8711aae7ff1621d2359483603f78cd79a0a0a887ed490bba11c0febe4fd578bf1089579c45973536dac81ab1775060fd773db625b50bd5401b4d0911913cfaddd837e618de276872a9bdb5e3cbea8f31b6f0e2d9cf829033306017bf5b869dab5ce2d3103b98024a361ca418caa68f186bf442173da1da8b65437a1a40aa09951cef89ed8035c6d49c93908cc95500cba763618444d00050e635d09bf8cee31f5b4fb2624bddf0d027ed4e752f4e79a75aa1eb8c0ddc170094019e3ba84429acd6ede1c660ab417ce62739230474bd39745c56754408fe35c8e93f0d7b2b08b99c365269f80583a5fcb8eaa16df7699dfdb990cd89954f9b486bc447348f3c3e399640f682938d9d51ba2dd3fec9103facdb254771f6df57d7d1848406a3610f7a5ba63fb7ed24c91593e1e582a42ad29a0e732e21cf0a812ccb03b29999b3378083666f13cb3cdccd0dd4cf7d8a1ee5943873b7a1863657aef735110fa9def6965a39bb9bf01e170c55015e6aed8eea45c3aa15b8748de7dc8ac88a6d343f6790630ee01de9035f2a7917e63286452416650c17ed30abc2c57c02c3ec6397b4475d7238c17815b502eb6cdeb347ef73ce14d652ad3ec34fb1e0306eaf117688a1aae59be41aa38f578304fa17059c032ae4146d4ac6fc248ee5d1d8f1e23667695ded6bedc45fab4dd911814f729262fb7efe9aa75d6cf1471307ba31e987918699a106f5b24851206b5683a881467484082e235be5580cc9ae804b55bc879eff9d2b99e4af814fcdb0aa79992965a255d4249f32e3b1cfcd0136d825c6f5e836cf5c44c1c761cb6f18c4aca333c7c5f74c7223e6cdfc6151623a0b3bb7f328075df1c941fad2e4dafb6466775bdba2645307e7d2f1a270c5c8a6dfc5c17e49d8e78106d03b6f6be99f95d6a75e0e73e99446dde3ee1cc502bd02f37b2a21a1d54f459b64a33fd2d0682d741179556af7541707f747f1b444ab5c7133f0d1685d20e247984bb8864496efcb67dcf6f3b88e21057ddc988e85534bfb14bb8d12a6bd6dcdffdd8f10774104a3b36e690ff83a33018d2d7da73dea92e864197934617e7084ffcfb9","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
