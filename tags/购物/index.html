<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"520535810b07800261601730ebe20ae366f8d4992b3b01ba8d70f9aabcd218fbaa918b3c768413163fcbabf067cb5e18987ae4b7e606b4abff21e4a56f4c49efa42d41c278d3ea9186c8bcbef451ffdb6cf758e6309777c54b710ff84c20653871ecfcbd0a17ec8378fbf88f04ca2cff1f21feacdd189dc3cc4d5ed49262d83903b9f2d5602588765bf7ff946ff1444fb08a92c9d6ac9e1f84ee9fae4007372818315e5c573809bb22a6e3fe717619ff3ae1a490c616534a3f3588bd58659c51adadfad56589470f04ec031a946828a8ffe472ccfd08822994809eeb82e776d3c58f624af3b7d61da62a51280878ab03d28c80a11418e361bfa002e9f51d30521b4e9df9e3f0b9faa8363f72a1eab816fb0fcfd61bc5394ff6d33b4d28444b654227118b4bf789523465cdab711e46f4fe0a82a8f86782c31dc82c803a3e2b1eeebd115d21f6270fd2efe9a30ab8ff6152f4dc1b33e110a02aad4961988e3958166831991bc9d8577a48157608081c24508d4328b1de6cd6ec6f48887e77851b19c06f90ab1485d9240fd145393e16158bb74c524eac9c78a28ebcb488af0437672114861232c2dad0556732d20850a468d3b7dff77077a7496aeaa88771f7acb62cd332a295a222b82efb7363cbff7d4345bb01235a004bb4ad6cf4679580482ec12dd111fbf0bdd01e62413c27dfcf28507933fa27b68146b78803b53e00ef694dea23dde1992dae56b8788467992ab2b9ccb6491ebe62b3528d5d866a2a66008c19896042ca6574977ddd125e8920b334481f10fe75ffcd7846cba9e88d442418aefaf39eb50c9ab97d5fee18abec3d3295cb7a5439fcbaff34ae60bd37b27405d133aa482a89e40f5cea930e0638fa350a1352133d34452cc95edc9853f0b4daff1c620df2c531a2c113928163152265341276d9e3dbe7d7f3f2996c5f718e7a98d01a43f2d183bc7854df745f5d8932a1ff92e64155bc1af5816b77a26d971821f3214540fc0b12b50cc6bfbc212dd7b75379ed5c09e6e8be0757bf76ca60fc1a74f291d14034448ae95f24fccd242f7d9d528c1a64dab208794966c81cbade8abe020982b203d571d816adc5f1fde57e53415f653ec6162099755211677fb552aae2b73130a25fb506433d0987778a7c67dba22657777759d891c81f8ea8617d7e909d6d702ba4b2fe47795883db2ec38623da6945b47f832980790bcf7d9246accf0fa118a163154e017e4f8c71399851e35e12fd3f90197b28b10967f372758b680e158c4dcd8cadc6cfdba5e32b69f15669b89395edd2dc293a874b6ddfc709071fd50bbb29f2ba05b80262a4e374b34f8422f96c828a19c5cb971558791f9d7de01cc13832ab8dcc6a9ff01ccc6120662f0300171b4522b7134eeea1d854523df8a9e4a65fabe6a3e5d39e0cee9daae190a5ce286158b8f61a325e4ff195c5c8ba69a526ba0fc9748eed22c48231da4e4e4cad03950713cf7b82f392d3b5f41e4aa8f6537aa3b9779069d3218cdc57c6b6f46c1cc41457535b8a167fa77576913f06966aae679efe72e513d55db3906959db089fa6fc417d00707d44c3d1936eaa4eb3955392bc70aade9a783fb1a3470a089c2ae708a9067c9e4a3d135e80e236b2786b660b6946010507c3faae3e458a7071db7d0abf89630d47109652066b0b8a012176538cc578a6efc49614aeb07359a447b618cd39a1467aff1815812153eb440cc5ebb3c1786fd69bd5b8d7e57e8d133ecc987ba5e73d6709d79de3ad724bdead13e16f990eb648fcc4413c2cc5c867c53a75012ada65dd2c8f1a39cadde8d34aec5c581b9d50194df0faf8fd0c1817ac35e0689c5412039eba38f6bedb656923b3c2f840fa8e3cddd199cce94c306ae57b1f831ebb6bf21da54368c00b68b170819346e5b1b9c63e0bf2b7fc6d776d9b5394f092367fc0b6f5763462a63c6f2f0b5aefabc1142cd2b79aa743c17990899c3b41a251408b89c651c13cad0c201da8a442a398548a467603495811b0cf1bcc1b5bf8ad3ceb997c6967da9bb9303da5c83294060d113945a01904adcebe0605bcaee448ded1648ae607e7ffd32610c81e411a85e94bae9e11781cb5df1d5539f19b481afd98f2080d2eef144b9172c7b5acfbde5ae7649a25dc96239a89fbd39e3d4ecb0e72bb9a5b7b5645f7597a6309f6da36af8aed06f90987c672dcda3e0c7691f2192db547646f1b9fe0c52bded954ddf35c20a3db317d1767ca5d59923e57c0fd3a72f624345c5997b20a62d2a7e46b44992e0a71fe11b9afe06cf22154f518ffa41b181cc28dc0edfaf32503747b9321dad96db85df4b5598a895017f10d8905925cd4b1c46f16b5149199fc7ecf5ae1df574d25460d214864a2fac0b81d796a8a3cf24b0aab9cf9af277b2153fe6f12eb6dc53ce361fe9535ebb7c4367ca07fcc8029f34d8bb854b3ba7cfa3d77730f9ce2d521798c4ed9ef9cd180e2445b54a65cccc9e58736188a5f99d1ebde05972148386c5e6bf1fe243f4d727b3ae453b31a1fdc18772da89afe869720fa591fc5cdf09974f47e7a8f4060d6945b5da47764a9bb3b636017c2e6328f086a020453523fa04aa8f8e5f1b8816e74d28d2966e7964eea1a96e02334e721fb45ee4afaf19177f878413d92b18c52ea7760e3bf128f731e97a30feb4d7983c8fa021225a7dc247557119f1b98518d97d1646cec5b7d26e3e28539f4d93b1060066077612942eb200eed520d578c8cfc42834fc4cf1b7450b69709521af5cbecb8e19c1183f158629a4f83a6cd22271ed75c5ab4455b24540d762c1bf07572f20f0b0e75d7c58e59728930b6f3d81db24884e8e980e4d7bf5ebe9f6d308494ffa46791af604229fdc8f1d2df363654863ae899d2126bc94644c601275dfc0caf0d1b7638eb82a864d1b6cf813fcbd483d058b6e8229c6aee66f84492a77dc363cecdbb7f7f16dc7a337147def064ffc6344cd3f013e5644735d7f3c956b8c99be4c54cf6cc06ef6c9200a864dd058019ba6ffe0d12bdceb48d829d5728e21e0849ed831632e0409fec80e463667e9afc00ac14e1d8a68e3b7b24723ef84a5252618db03ab02807e2d5d3c8339079cb438ea1143af8abef2e7d76e389ee175285cc75920f33c349d7df6d39a0e0507756f9f5908ffc0d8caa31b8d2b45c8d79b4862079a39e39dba4bdf369ed68566425229b1b82a9ed3e1286bbc71ce92e9cccb7c4d2f41307b2d71657443d7515e87231ccf2ad2547b2352b0d90a1c2e9d7d813c95e54fd9a2cd133a33492d72cb2e1f60fb947fb1d48814782f40cf0b26a82478fa2a848cd8499224cadad9f9f803193beec0f5855d7002de7f4210a40582d990dc22bfa544f262da919f1040c9cf7bc4709e40550fa3e238bf7eeaf46bac1873ea1213bb925bf32464b6808371e119a4f90bf0924c0e7503bae4daa3580f9a6b46c8c167b9cfdb9dffc984619f460b95be5a013aa80487bd6a27bbae60e31ded23ccfe610fde5b4ef6be09e856f35639520a536cda5a22c409d598e9b4dc5a34a33e149e20a35443952e5d6fe5e5a088216118ac78644502a4bfef9ea7bed0996c6525e3141c2e7f6c95dcbea4c115faed816bdeb87268b9353eceb17441398c41580e30bf39c8db829e8456dec4c0d2ffd9fbf086c13a6e150914f853098f288a63cf6ca615a739956eb44a4bdc4649a19c0f859fa7f36767907284158343e15730b3224a2cd5a3974a513519f1379db9f25dc89f3fcd0e725654a4900f00a1ea8ac09b4443e44a3705a7cfdf217c1f02b7dadf24827cf2e699f081112e0033edf034c083f46869db9b42eb248957f7d3b8916996a431eb27e228723de4bb70a0d29cbbba4a511685dcaf591370bc8005bf485d37e782926807a1148c915ab5a8b4cb439d09c065e52ad9a7d8ce66d036c377fa95ad6b11b305444a9c290a1aba23adb1b6b334718550e6b83b14511e24558fd831b932d6a997af84879b3fa68e2a844cdf95af04326fc58f33c9b84c61c8621a9b4840e233d1a4a4c1406789e0d28bc08c84aa09c803228ae242a28b8083922a143acc9383440024a4d1917277b49d31ede4595d0bfceaa097203409242dc959e4dba57755bae4a50a89fe249ab18158f8c7e8e91cbb040b921a003a94d76fca6efbc9c6432c6d7e9f36f21425c0bbc06d9af5c66682142cd5748cc203b54e3a2d7b2e4f0d38ce74b264a310f58825bb65929d6f71783d72e9e1925850a3a878ad910e3083fed0fdec7dd04a18810ff93fa563362d4e2ce52c2ef91d5658e53a6aba807c90ecbfbc52ef76a81f1ef6c350ddcd2e5a99b656a2a31160c590a5e2bf97ae905b4077764baecd4e1319c03438b6787d0f1e64d1f5c8b016ac9cc44a93daf9dbf83c5db394dc3860cc38ef5741c95a54c9fa7fc78e0ff099e2c05a8c2e57a864af4d94dcd1d4fae680d98a0634e02331c525ad20a7dba97b6a01a7f3fcd0d2517bd9f9c1630d2785949b60a415a5951c6bbe667f24f13151531d4b2ed758d1f248e202951bd79dd199b554ea698c5a93326cf261fec5b8685a2ddcf4af4bce61ccc2ae2c28516c8ced5577e41b3a826c2d45e513f4584f3c09666a8f9fe4287eb476485a689a8f7f7696052e257685831aebe6e4b78091344f0c84a185295f28686102ea27d0c0f921b34823a5e5c2a8a775dac31864eee1add86a1ad6b2bbc0e3f04c3628cfb727ecae6a0d27bfafd50556e971387a09fc5c57edcde6656eb3fad9fc6fcb62714e93bc110c142d02a2689a9a9a43d1be3d10ffade809193fc406ec3d485311acd44983b71c3ab249d8ed0525cc18b8b1efd36e9b97dab62bd4529dfbf4ee9d91e4ed825215663e13b8930b723fa075451dd8b35c97aeaf869d88d16fc2f6bffc585428004e7d7c40fe5a2659131aa63a4d6bc2c57db4977d45cea0f1058e0830bfd443496ffe54f7a6844470a1fb1f674b323392c045130688d8be082666f08656880b9f2de5d312591e3560a69571f853e678450056506abfddd75ed56f142be01be575ad60c01ed7adf797f1f86743f731df5dcc68e89ceafe67171d6af8083d54e67504a6c7b061da8cb54945749fe78aa258c4ec3a35d668323ce0f1ac9de5019e825caeb721e4c2498602f3bbfa3d5a215964fe21c85b8cd7f16671fd9269020d728846dc01e1ab6190d06804a5425f0032cfe509bc432256965a8303a89397a1cac9d81449745d6544bf3598d9c863ec3a56b9efb6991370b9f56316af67d70fed5bce50ac91466414176c3e64b150007bc7c41127c7da279c6e7db2b48781d0fd5a20ad891c45af3bfb593c5adb78862a90c50758b91177178043b4f9559f03c4e9d24ab7d54e7bb1ad03dd4eedb1f96414dc23bfb6cd2e0c3c2e6d65533664bfbf51dd4b586124f85e015b8b019084322a19ecfe475251351da3b68339e70572e3c3ca29df768de719f97fd68e13f1e293834123dde730953b1200bb275e08b699463b725901183ca3634452bd09cba2583f501740f9eb4b23a103dbcf2cd844f00e898d937efb7f50aedb051b9fc06b3dea4d5d345972a21f82744af4450a8723e5fb90f1ef99d9f7e3c4ea7a0e418cbc3a8c9b62f03494fe87edd88727a49e1d0fd785a182139b149db62ef638ce6399a6cef87aafabee24af4665dac9a21359a5f5d16a3d424bfc456e64f047d30fec601d9034b930210a764dde6714e7b5b03d876be247fda05403bf2e223059b68efa473f9d16be6198ed56a414adeff0ba5021763cbd18a7ed785f6519c64b6f76285d5e5c99fb7a8c9d8617b97984e45476d3ba201ac8b87cafa67e1580fbc34a1f6215bacd6735c403c42e8e293239781ea63db8f8bd64255759060b994a66271de8bd6a899576b8a4ad9862a82a813733263a22be5a9c72646cf4ce9b42d189e69397405fc787cc736be4bb4a91fd6d98e03a14ce52514a2bdd70f26e3fa6a43025ae54cc633117ef7de5888d219d9fb0d8e15e5858bc1962489fd4d2cfbaf44b4b9e540ffb6da1476f7453f490f64908d123bf3dfb9dd9fc5ebe73e599c75825515b51de7645c0dae5aef69010c96a0f017840424750788d4a05ed4ffab7886d7ed05a98d7cb78e528e97226eb782ef8ff64c144fd65ff120a6fff6efc35e8bd67da40d017cae3fea5c8b8683dc4bd691699827a88df357ed59787b45f3011f9ad2a38f0b95cfb85f4838c13ec250a14d8ca456118b8fdc7f94e6c98b61ab8f23eb8e0aff0a02a8b2cc882e0d465904aa49a4474e2b22e692e5163d6af644ed7669ab4ab857b608cc5fd693fa5205e76412aa8125b5293890745ec8e38193f868fc6e6433b82402cb8aa89c1a392e5f96a3d3d7442694e83511be7e121f927ce4e3dcc0beb6d69b02bd515d7c11c10654ffc0899d52f2bd0dc9b1f1bf44405686b87005333ca18cdf29996adb33c8d6cc309f9706626b44d8f830aa6a3742ac3b6d443df573f50df197e876f7241fc5834d4522e2adae27e31ed26687e856e045823254476e90c8c19b51e9ab508f36e6747f9eb490e8fef0977b648e0e0752bf9bed6ce234e86fc39e69c7bd2857db36ef26c3e09f79e05ec7a88890548721723f34f498166d2b4a8940e4f789c9d73e543a910dba242f2ed8f51891ceb520226295a56683c2650fefdee1efea46aaf9677805d90848e621b8d0831ddcd6ec2974f57534b38f10797dcfa542e4e4630e722f8d9091e1883e4aa6729ea88e43e545f97d9458c042ed4f857047bcb928d0e6c29159333b34d6825caa3b490b8a079ee887bd81c11e6ec4f96cb5d84c0662f98ea31c40cc3a0b98ab13df802c6b79ac7efe4f164f6a9096dc6d861e13ee0e758a1408de02ba2a59cae2d51780f48794c6a1bc689abaa55e14c2f8711be50ac24a9f708fb18d00b5b10ad20a62d8acafa04f74c916d51a71f5f26c14d3ad03d7cd08cd349a549d3212b925d2a05b4dcbc4eb4f93aaf8f4dd462164dd7ea35747127285c9d9d2cc20529fbd15e467437dd1aa88214bb41bfe0b7e94a643d2061a13a91511fa2201a22f94ea83604121aecbc53a6d354d13be9d5cb17e248d589401aedfe0cb9bac1fffc79da7ad07dfa3237bc8f1d26abf866c54d322a2164208a7b189e8c42488b09a7fc18a93378098fa68d521e6ec2e69c00436a47ce1295842ea6a878753f440d316b83826f4dec860bb8e49038552eebd2b9f62c3ad34a9f6e3585328f699daea4a790b37abe60f2ad8360b435a0912ac68b5ecb8b09f009b822ab2074f346f1007bbb2cc527067b151f159a6da6ed23da8c51dacab9abf9cc8b8ed3ca90d8ab9cdb7c89c36a9ad2c0b17c4c7687f345ee3082d98f1b30d3dd6e271eeaf31aafac946c87ecb99d76d0907e89c42a8cabc67e6cc35f794568a2a376f9c4341d8b6445607df1ac812e95c4685f5dbd01cc7986d3641b8fd0b140ff59ea30193c7d25433cc106bcec79248750d3a9f28a9791a238aee27c3575cef063c84b09534263f27e7a1707fb25c6b78452ab82b686273682205e6b4713c087ee6ff8326eb31fb7e7c04488b3355300563c67890dd8a0cd1eac4da5533400b6d29c48aee703a9beb1aee8e46385cbe51e125625cc3d2ef5236c15e708d8d4b1fabea1b99b7337d18f4961aa465a5064c58da653e72433306d34d33fae893f131277d70db0335f8854fb02e950c8b6bef4e0d2e964b41bca1e7dc9d52ba6cb04ba4d00881efef3089448e685b35d5fd097d8969e4f1bb76c3ef01518574e56da5fb967e63e5e783ff9b4c58469dea091edd8b567cd6f4ce4920adad45028f2f40e93ef036be5a8768ef176c9698aa922a836a64a9a1d7bb347d6a1b959ab7fc64d10e24bd6f91667e964ab9d8a390f2a82469a2e2c9fa1be86056ae092124f0413222ee03b68f3e8bb6181aa10bcb17792338dc800d509ee0955e1ef9d0d99920aa51cd33ae50c2df96e656a7ce468d4037aea82205402325e903f08ebd325ae5e7dac3dd8975b006f53ba333a91cd655a7eaa494d805f624d69957bc8465764581bb5cdd96378ef9b154059098eeb1de2e8ffe0c51c124d6fe5fa63f73714b7033ea64ec71228b1c602967b98b629f4949c0caf990fb9925ce1195aab3e29305a63e9e5602cd272a26ed08ae0d14d00d6e41bb380c8cc1a955c3d8c1c074b7bf349ed851526192ecdf007f93b590f385865f91e76ebefdce1306b032a4177b2b3afe02d92f6881a2ece2b19f1a32ede060b329b9f3631c08efd560f2c1ae8d5172be55297179c2226180a4dcd9d05eae70bf764e9d4e6c8fb376ed27c42a0823e0098aa7f71994211d415d09e9c0e49f6dea84a9bbc76380d9d9109b1b4213083c56cf77ea9cc182726a14777945f1b78550a7e4aae287ec1b0fc0825047967b53636dc4f29475fd0cfcec3c1753f40c95679eddef9174efc1d0bc80a551a8c7b0e6af2be6c27fe52d0f23e305c4a7c5c55480c1aca6c30745304ce51bbe0d1c2defbb03501b40bc81918c7a807bf1bc4516d8a3744f2e5c24bed60a53def37b6694efe71f6d06e9484bffa562636e1ec880a30d9d8a8ed4cb8259e2b7f9d35692fb7cd6b90e3712e5f1036772f4c37cd08b3427a177654e7e37175995ed886f290028bad41a7d87b75c4dd2c9eab871d925ee7762bb51f07411cdd64286dea0e157402fb06d1256e417d5d9739841508d1cc41a44402040a3ddcc2a6bd0740ca347a8e5aef149cfe1f81d8156b7394f1321ce4393a3a7710525018284e4bef929c3b026069a3ef9f9a1b769f66cea21aaa0264f5a10707882bea7b03c1c19aae00f6dde76c1e5669f5b8cc3e1f3ac301d18bee773f5ae61b2064bee4880e01152cb7aa427347c130f23de119d516e8c48a23c4e34d48ba902edb9001a1fd964fba60b81d78316b60a935107f6dee66ee012f155a51151f849f92964c0989635f4e5cb38b589b4a0a8d7d62eb79bff9146b0d32904bbf271101e070b5abecd8052e5067eda8102c214fcb7bf55c6cf1f0d55f8dacb190c6b4c40cb62c6e397b98a72b56382ed085ee6ec435629c450f54eab54a49ed022d463f3d3d75c9b5451f3f2ee80a22941c2760e0b48f5b84904a1b478d56b1a9fa551255810966c5c4f7e59910d17bd67dee17d1ef2cd7c53d3527ab20b58750ba121406f3135ac1a899114ab953e1470ad6d5df38784a8d8f09868546c47e1eaade5f9d5aafb9d7981685608728a79047a1f904e559e1a508d20c662b6c6eed851e9a1626e80f6fe91b85df8ee81c6685168c98b55e3c9ac99630b6750a8ebd9774f81368e095f6956b477faec590006a1c6e64ff35be6a39d59a0798edde12d2fc3d5d7205362717ac1cf8d33937cd0f6c147a2fe4f9a4f1275d0a743d950034a9b458a64a2fd732a713ab736e2f104eeaa747c532924024d110e32a437b84227bafa0ff8b5117eab89346b894fb33632cd45e4cf3931b7f3dbc401f86783f0a6cd1aa2c9f29906f5b93062c05693f024872001ea04c2b7459ad61ebe8098645ab64d2d61dce92535b36a2ed0c8dbcf72c440650ecc2cad5fde161b5f4fc61fbec653d6943fcebc2af053db1c119a17a33eacc622e9d1c73efbf9809e3d961398039cfdecc42515db56b40b47987833d067e08737ff2355de52310019bcd4ebc9a22d44289ceb68c1b95b2ed6c7feecb63565da569618968669a1604eb197bcdd2e81d7bd20fa9df6af9cace0fe3a929ab68ac8f6c5bb67fb1af883ffa275a82ea267d7f48ce53579cc57f91367ebc942f50c0a0f410aeace6724ea885d11c6e2d66b192897b0d1840ad2cd1369c3efd59f9e6d69e9e82325d395c8a80929426359ac7b2e5edb9f64978ccd3acfbb5c115d40a849ce3eaf790a1f5dbaa63c22187c2197d130df7648e4e6e2c1dbdc1ae643ae005d7310991a7ab416d9545bd25fdcd54a96b58d3d15b8e8e85a1e520b5d0f6c520a9d77ee26736d080a05285b684c729010cb5e293d7cc289002839cb8ee4933dba1e04c5cb4a8425946061abce8aeef2dbde48fdb0e1e711a758f2952d1d8cfaddc862ac847287aeba7e0116f535925e5a3fc300c0681f6de493a428ae48a5c089815798c5680d558faec2c9e135d4e0004a435715aff13a0ac7c47ebb57faa21bc5ebdaf8101f662d3d11759689ee9cb8620a5e59f7d080d137e592bd51bfb07e2846332b9ad3877a155ee4d31e6236b0a394b1012654c59795cee11d62d444a796d19e660d549c717043ac26b347b4eceead469c31a35a76d72fcedd25117d9c7eba46a27b847b6de676e527a4ab20022557fba2ffc8d3f9bab105c3700bd4e104bb6b399a55e74ab6c4b836c9d4073dbc6f93e3ffaa2865f94b1b4bfaec0b074222a333fa7b5f2991e1d7bf38b3d81f69e30d1ed43e322a6440563dc4dd9642f77455b73ec45c3a1c95507b2123d5bad25fb295de40613b2118011c86fc27d432e8bf80ee12be1d1d949901ac45f32d049fe4b3ac54217cb1a53b279ca37a3f9927886b6ab82a9de96ef22fcfa9263a5b343dae2ef43c363de4e40b7196ffaacd9c791800cc0fc8778253351c76362853883d8a5ab75cc23e14f6a4f65f2a36a8c717a40658dd8d963abc0cfd8eee4a86a76e1c7d09a27c747b3b5719252106b4b0460490bed2f68c849b3abc228593724cad136d012e0d45dd3ac0bb8a884bbdab4119834ea4e90363aa0686da4901b51322ab255bda9b58ba61436af0ad9dfdfe9515f3539341211506c6396d39f054f3c4a975fd50582a909c5db863d5097cc1c860237ed4709425a3994c5bf0fb7ba5f49efab25909bc83f41c563e79511e1813879ddb9c2cb1aef9b16ff098ff0d21552ea6b0f1dd3cf86acc4eb5cfbf1f9aec31b8665f353bd6b93ee8279fff553a0e9faf7b60839acb8a832bc18c964a03d77215bbe77a48adf90a85ab9f0bb0789b4dfcf636607d615e79feaadee9a1c5dea33024e88de5c629947881ab2660b23f91661de8a76dbb1bf42baa6d4596fe8102033455e293f8438a7686c75b041fe45327ce6850c7133d1867467c52688ba34fe72492d3c84e6ab59b41fba0677376f225aea545fb3bc2022f0086ca89ef1d5601c960813677b03ef219314668ce353c24473a0e9dd5a6650c79457301072978ef9473aad5c286fa5675384d8a004f71c64bbff1f44b75e64afeb56aab5f6547ac99362e263b2d1bdb59de0e338a6927ae42d055bf76c3c6c3e5bce365655b71bce26d10a5edfb2d19fd6d67a3b136ee48d0f3cc88529cb607cbfa5dd8f01897ea42a7a40f4511301e9466ac72acc521bad7780e3242ab2fac3c63d7dc61d5444df8237b8b83b67da9ac3799daba6d90b743f0690a6e37998f696bc21e31e44a6dee716884bc9ee5d131bd021fe115515779bd49f7528900809274bc3cedb96a3f2d24ff496d00f34e4f4923a9bec155c30534f1c512f71b1625077ccba5223fe8fd079ebb5bd1a67988e5e76dd5479b966d0c4312459d19e0b9074e801fbd849df1a04fcaa795ac71f1587bee9028142c4fc049d128e9d3788952dd55e512097abf1a431c7429aaa89299797f8a235c90aaeef2f94c209c24fc62000481050675e2243566e5f33666fbba5a92dbbcdff35b22f4063ab32680fd250918e6a2ad85d9d8c1b005c2d8e9c15d99121ed5fd364f0afc2e9686c90a7a6f9e3d8b95dac82584630cfee7423e9e3b5128f937f87960b32ac82c2c2ee58725d621f86c55bd8a00c49be6fd6f22f84e795063dd8919f7e059f10862401b0c476038ab756ffe9dae2c0e3408d9cd4995b8c959c1a77739290fa42ab5c484d23992f06574652d6e8a85ec1d806269d28f16ab801e58d4043e1ef274bb07dfe6ca73409c28022de2c282e155e2b3d033554cfe83673e4eb3e04eb6f9a66a00dfe3128e243e2d16ef8dfea754a7c0ff9837b0d586e2f5015bc8a5278fe1c61b2e8bcf0954e78cf08362dd8dfc3312b5de03ae4adc6491ae206960b457c8851e703e2908f950ab1ba2967e013ada55d9931a2ab02d8d47e800d28796f59361e447efe9cd7c6d32223c866be5499c6e4cb81fcc8da5888d5ebe8d5b87973b20bb29255549068971f5908895c276de4d7c3a9e2aaf2d30daeb1ae7a1a960c714da9b75454e19a1adae5c0d8f9575faf792b05774ffd5d40048ed5d858276ebea9001af8836a3121960a325a065d91fc216488bfdc27184d62863169f0544d662b261c1efe6390f6f97bc43f189a30c7dfe5dc3091f1cf8ea6efa06432afcefa48129a569c08a22f4561ff5a8c2dce0768a2dc307a77ec9af34efb1e63579fcfa69554dacb8d191596842a7d70cec601cb6c9f111879669b3891871d9770f1e96a0f46fcca1dd64473e42474267192d0519c6c01e4a9de96543e2408deef5306a1bebd728b98fd5800387591ad96f7b203b52ed7408a5fe7c7f0cb47b52e448c0eda8d5595871c2783319d36a226603b04ddd7dab1588a59f67612e94e3ae84e9bfdde20f96e731d63a04b76bb7241247669ca2bccb8c458081cad25eb22b2fdbb23864bdb7cdf4029a561a8c88cdb49c036415f4478f7ebd204d990d237af4c5b61673fdc33d33502d2e473b4e26b3d122cbd469aeccb1a90d7ae08738a9e9ae1800676a9aad0af8d27f33c4d020ef497eb0fa596dcbaac137f808101aa68cfdb2805bc52987405a47e8197f7389427fc8a63119f69d74cae038ee01408f0b9ce761d43e940f0f59720e5633ee60c7aac3685c817b9aa7013622f6ba7801fa8c60b66b44ccd9a82e586957ae01a037a068ac78716a205aa903260f7a65c63b1edd95bd9cd8e1d6da0a4a290bb1a498de162618075833d7deccd98eb26da11d7941ca56212be51f2ba631d6568c9174a61b431fadb7313a12899925c5d89acb0d07b672c299551026fe0d92854fe81a95f6c62066bd65a728c03b06a1bf14f09a48ab9e9471c6cce7ba3395a63b38c643df116bab6827417ef58d4ef7314afbc64766252c12cda596fe0a5306aecabe7f5831359c13f3ba8d1bfee78f5d0dc6907ddb6bc532051db904fc84a5fad60e55e80d2c72e79e16737905788ce5c5bdcaaa9f32e7bf9b9de3e3ba03e49af933996310df3edc44855600ba228fe6469901f4de5c1bebcf7cbbfa6ba03434c05994140a6c6af0068951ce496a3cb9afec9cd8b57de725f97baff8928a5f39a791a72c890058c2ef3e8ffde229a6748d1ba2260e0bc13d8a254e5c3ae6d53762a704621e0c53d54a49bdbd09b9c0d57ebd9d1ab0a391eef0edf36694269df2d4d8dbdb1c9ea2e1b748b24fd3f0de430a470b1aeb1b029e9532cdb05e3bc92fe1f03043f8b074676ccccbf24f85c0b160d38a58fcd0e2be3d35ccc213af26bdb9c182610af7cf2acddd47a959bf8796852e58d68ad0e3ff830d958aa0f62d3ea5f96edebb87f9989956e817756a6ed832acec2b5e609a6778afe1ab409d6304714934b34b90093324e07b3fa1c28ae2e091e6d319330cc6b53e9be6a67d3c039f0e0e4829ef0700100fa84a6742b69ef91f36344b54972f362a2328d0bad99c49dc334ffc54cc6374709894dbbd9629c848a3cf8511bbfe3c643826224d2ba598ac8a5f6c8e016b6c35085910f16c9fd8aa8099746df03da5729304db31a3c07198c32627d81d113bb6f9e46680a385da9c7a743f37145534a3f3de1dc074f350b9b41f3fb057ef7702a36ebd443f6b3f44af467e1dbf9975ae8985537e3207e7af93526cd53ce364f90bd2759dfcdc70598f9d94495e818f9264071f4d646eb596d4d654d057d7144d576261e55349b4aae5389b94473c9710a24e772efc5af0954037b05ca95b09401745f0aa3d8a9d3cdb352835a2014257eb24bdb654511c6f9fa45e6710896912f65ff1e8f0be5dfd2fc9f49292ec837d9c3e4b6a5a09f2b2f2e3108b460475ed77d71a7f6ddec6b39088920ddd21a439d0480bbe3fd522b8686a5f7c80eca289743159e19c078a17acc9dcc463babcf92ec2b360b4590461749affbd11c2d15d6fb6d06fa65ad262f457d01df2c4e7f885842d799c56961570dc8892817269fcdc14197648c0732c39ba04acf092155f7ec1936ce7bfd8585cc7bc792fd21a83fc8ee55d2eae15af0b2a9c43b57bc78f4d00018a3402f1e04fa2f614e4c99b703e9ba792edb50b826cf16158eab7163b1bd93409310755fc8d90851443dc6d15b50c218fecff4f5779f0606725de6d71e457f3e6bd6badf223a235245790b026f5610c52382ee51c5766dd81119acb04de91a3d6653499d5c88692348a9a49420c3856e0b8c7c2a407fa608a0974831b67fd5b3b8e3ccab16b98a43a63a8565e4298b5cef4446072086d69c03a03ca68a20c1918640428ba0bd42e4fc1c1e2b38c79c708633659dad02b211c6f11ce3c6118e9c9868d08b6191360d0abddb1787cbe01cf0501c7361b5cdf2e37778823b2b93efcf80b0e0a26c2c25879acc44157cab99c42ba8e8444987b2ccee995b3f84840432b300a3c7c51dc917842064a12b6a9227c9ff97ed1c80acac20a6ff0f0497406e20102717cb775afbb85ede6b32369b4b95358b2fd26ee5b79b70a8da8ffca8b275180f454b9e854739baf7f2a2988392af549487e114de576768546fbdead48205ab0a88ac8bb676e0c32fbbfdc1ce3e9c00cef12a843da7371d0ceb0ec02c8eafb61d58da494752252a2b65b0d4200307961a791a9b300271acef321150315ef6d9dc3f39ac772bc450259efb148a86cf669aa67eb12162f20a634a23732a4a50260d0e6d56b6c149e950271534c91e1ff1c969fcc077ffffa08b49c42f04177ee33fe6d027166733aa67eba66b45ef2ccd105e87f01c42f757adc4599aa29fca6aa64f23ebca758bf0eb29f6a1f544742a32355cb83aacd93ee141b01c05bd29be81736c3e48d560b22c93b4b67bb520066dde62f6d8ac64d468c309a52272e188b834acc5ff91a6d1ae4b5d6fda4ad6055d1186a77f7a1aac1aa9120e644692120d30c56299e204029194d100a6227121fd642e9ab427412c034bdb8fba628642edc979b37f8141e89e80579142f04cdb2be79393a27a4d2c0a02b1cb7390a133d08e910dd1ce2eef11cc01dc85694e841e1986b39b5ede0cd1ad1f12139741d3cb1b80125cad79b60b3e27ab66d360a259526b0cf54c6b90f1766a3fcec930343694ff45b07d203975a161307a10ceb98c6d1977fccb0aac5c08390c8b281e48124234589fe65f2dbb85a92cc84d09916d7cb044439e3c8b89ff57006a665f26472ef77cbe019f5eee9a0120d574529638ce42f9daed9364def4882da0dfc2c33a9c6cbde453ff48e76dea553a864f7785d100aae2918494c87183c794d62b65c67d1ac6f4b6cb508fb8f5c9a7453eb34f0a8c8d40418ff894887591f00224081578a88c6138b9c1c6126362270b55cc4d16eda43360685b37693648b92360b236de117b0b08385eee658b7e78cf0fd3a49c01b3709544a1537a41ae85b41e447e93ad0c345573f16e65668890037fb26c7a6a2ac70883c4324fd4eaa1e243d129f7b10c92a9c56ff38e3c38d034b4aae0b361af533341e3115a798ee0c65bcd7f40368ab8aecb3446d31ef0e0f09e486651cd155eddf0b273844f1ab0a36bb1d55c486d875c8dfdba045bbdbe27cb549c1d7b1ee78420fe386038cd535bcc6352c362bbae2e40bd1557c52af3aed58c14f321ecf5ed622ee384e73451cad257254effe1be0e023545bae7c197d37ec41289e76f95e5bb4f4d891ac60eeb59d3d2dad2dd04c70bb6560e11e025393d897286182beb6b050caa8649bfdfde05bf6a52989125a752bef2964a55ade1eb322149ee82aadda7065cd37eaf5fb50fdcd749378addccc827ab1730fde0ba2ad4e647c1828146a7f48b625bf3de1fbfa7b3502f22a62138157dce80cf82ac8bf57f1d26ec8fc1bb2e498050b282b4765e81c55511e2129f64aa18b245a02d2182cba71b006b208235a7debb52cd8384b539d4184d7522666ca95e8a16fdba159f3bc3e84ce18ac5b994f3a721992ea1ca6107562a8060563cae1e99ecbd4c3e845298c2005b9bf30af74c456b35e0cfc39c59fa1144477e95396daf1854979c26cbaf85490b49a42f5b4353ec6a4c6ef80761c069b8830acf772909e2c70752d6ea15004a1f4bd823848367b4f985623df8b0319465ca0b548fb573a3f3ca72b18399f4932ed6b482acb779f27cb33dae68e0ee00a2b9eef9474b3d4334ebbdefabc65ea36888fadbd67e19c2c08bf7c340041ff05e7d567dd74faf5efbbb790d859e524a006b3be994f854b3a1decbcd0e020ed0ff897f14a7d041c3dd207126733632d3a39dc83ff64a74c2cc4fc19bcff20f9001d65ac234aa75a1c44859fce1c2f6839eca05d3aac689ed7786a5bf3ea080dda8bf4dd7ac6b050834926277ad3a26a49b605fd971997602b7c5f3f86200730eab52d642f44da5b504b7b022abcd5d8a2efe9a2f87cc16b2b11db963a6a42387b63ba235c2411344f0942a0e4fcbb62380a66a12758788dd665fd0c4ef4771f800c91b41223026ea0c0c81077e7c92f967183064b054c196a013644403f82e5fe03835bc60debf66790da4e0bd8d6ea9715beb88dc43f3ead1553cd0cad680456a3b7c9290e5b1a9714eb7ad2bd2990a8ad8e76e98276ea68c3a8e2e8cc08ec4e03dde0c7a2d3b501750caf934aa3d4a8f062eb60eb6c417050f9a97a43fae2071a9fe153a8b5fc01739dd1788e4f8565facd9b9110a046644ecba41513b06a88e53c770b56dbe4ed3719be99bd231e46d43acce1897fe9b9e5027ae66499a4c3a10048b1bf249af2c6da4ea2b47cd60c3239d38675828f3975dd8bb7ab661f578eb0b27540de0f62834fe19bd834fb0028349c07e3a817d72e50bab6458d9b91525f6041cb09bafc1e9bfa47ebece62f","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
