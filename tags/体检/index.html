<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"c27376a67137d59031c12a887933c951a85540bdd3cf364013d7106b3d095f56c54fc9b38b7f71c8e6e11bb9979592ebcff9b4d00e5d3252badb57913d29243bea7599781ee294a1aecf919cdb24f46aab5b0e45b93daba8211501e5471f97c5a5af224cef400e330534594c7718554d26e11998ec20333be9b7f618f1b4d03d7871ba6261be857776a465f81f004b3458c6ce400ff0db3a0a27d3ffe9c8866b16ae083b5be8cc4979b3f6b7afc8873682c29b2eed7b0375da7886182e0fcb47d41e6c22deba127401f33d8d19a0d34f483e26454d0d9e4f471fd8b5484df57d076f96275ad0823a08d059ed34549e8e1164f28cc15d56696cbd4a5a232e1245a2f9571f1eb0647db32026080acc0f1eff25e458d013066e95c8d41b50c5509e004b5eb1144ef40e6815a8dff76664c2bd39f427c854b09c7dc39207b2a8049ca832f418d3ed5b901aba3e4bcfc95e3f83f415f367244d50169912a203bd6e329e1d95d8cb11633f0d5435a49aa8864916ec0d81761dc7f888ebddc4c5905b5f4a2e05b81c1c21ebf88898b360a10182c701c0371b17fecf6b4860e7430fc9bdd5826c440e3b065e62bdd108723786a82b0e44728b2086cc010c6de3770070406870aea0786199f570bef42cb55f930dcf8a80d33ba52cef8be469733ee7a81a1b41b494ca19ce0612ed7c8bc9e1d370bec462ce4b19fe482a3b7acbfcb958ebb82760374e51c2c29d3f845095fecbe644b45325d900f1f6153678442eacb259e8807706f56198015bf1ed6f2ff84b597b1af7f4d85a0bd36278f086ff1f41783bf8046640f8de2a8110b5f74baf5be13c2de0807698a2353f6ef66d356e0836ea7157781e311aad0fc15a3bf3bf01595b3c442fe00b3bc845c8f40be1dc28b4418f8686455d3e3db0b829f5c2668a6b81a64eb862f6aac5c70ed9658203e1364024facb78115f72fe9b731f4a7561fcdbf026ce62dae9feeeb1a5316afae9112422af0b4d7ae4a828d8a106fb57f7b53453a9f2802f689ad634daf1d5487a3f5922d7d60f3b8932deeaed8708e99968f9fe5d571129ae05d3357480c1cfec4aab1f93ecb507da7d64c46bbb3ae5c148aeea1e594fd687104b43b9617807b29f6f2fba8e2d45c964324e3d19736db0337f85f18831c4b0f777cd566c1372e3b34a4686f3f3fbe99c1d85ed3ae30e6e29f8279a8cd383c02668eb552a72e35bba8eba044bce66c95c72f786e5101a059d9c7e42f779e537898502f41de82fc3ff45e24dcc1206c8e91170892b44a4b9fbd35ba37905dffb8df6f010355b6331c3c4f796f596f8f164587ebcd93cc72d3100aa461ecc8a7c15374be9670e73965f77ea71dad3aa31c9eba1a2ee9a7118ba576a0df70cc1f6c3ab278d31eaa3b1eb6bdcf2eab1b12f29687675c4f25ee3cb79f1bf79910b5e8c82f9a03f00cc3978c4c73dd58b27ec60b231372f7a2236f610cd2790d454cbeb6d3acea73c51461c6b6d2fb4ef19a2a34cdd83eb2c2c095796a3dadb01976bd13c738a98cbe031480e3c7819e35a22f0d8f6e6f6c2ab4725e3ecd5b333a4bbc2d48e70fe0604694db20fba7d4698d6b920ab730d4c6f9ecbf769a6e26e1836501ca7335bda9c5d27928e0c426d04dc2be531b5c16fe14c37a5116352e319575d6380566e0aeaac19f17840b377263ec3449ede0289def4815598cccbf7b17d189e912cafb15056a683ad7c785a9b3c8d56456a61b6e72aef6fbb2fdb6e5e4db94747eb2dadb9443c5b8ee6292f24ea8fea9871a626ac1a61bcd58105e08c204a27096c9ebe6d2ca4d088013fd45c3b4c25ae385fe77bd01aeacbc60e9faf5279dd9b5f187683e55f9aa9451671527d429a2b3d1b646d3feeff90b586fc590d6cded62a8e8f2950e62b8111e2a1040fa831db5824d437f604f36237b50831a314cb6b47fe4e797f089b2b3c62107d1c76aa3a4b1115276256378faf2966201007be17d92596967aba7829bdf9d577a566e4ed0eca5fb6f786f6339b4c38d436fbe3adb5772b5b104e10f7054418630514d52a49162132d0d58d04d48794185ffa9d78ac7f2a0c7b2b8657592ecffd223da2f208bb5184dd36ba9f2d32715d59887ad4622697d9e84b7b0f28dd5f14b21640633746dbf81b0a1e184975b427452f5ae45ce103957de6914d44d0b80d809d000113b6628e3c4d29f2d869b43623e3d04cef46fcdc01622a107aedd53d5dac2f1a7c0bb165d4d886a1b37ca452489609593584bedc0b51ecb5cfb3192b58aa6a8a23a7cd7e95e240e46b93b64e27334b3c53aa462954fa982cf319acbe5c7e6360153617d9696827bcad1a82f6e9797e1ee24215f89e7160ec3417e2a6ecb619d029d22335102376ffd3ffc1220bd8e84eb4de9ecdf5ba33782e9282c0652c68843d51b7f2b3d797ef47eb00f888cd679e7011fedfecee4f88a454eed77ab7f3c8b690e5623e25ab6d8e80529bffedc85f4e5621a0853ce37cf7241948a05fa66f1bac61fa606643a70ecb74b87821ab21a2aaf94357257f1b70885aa6c9c577445fc75c9f58aa9b3556b4eda299178907889de3632efc8bdef86b461b3a32af642e9dd3254348833c36bd64279aa87ebaf6d32dc37b7abc182cb4b4fd600ae06af9549f2a6d81dae3669e5db8a7bd4394d7f5ce0110fdce0d8ac455d64c1fbc2e259881a71f1056dcbba01cacdcc69c980357e4b5ad81c2b2c8acab591aee4d9151854ab7e0eb5474dd98ed0ffffe4b03dd3b4f498c4355c59554dc5647052d78402c671bd49d712252d89bb08e44cbb5d8a78130287411c5559362e0bb5092755da4fa332fbd52ca4206d0e04da117cb9696c9f264bf2b75d93bbecfe4299161ca7c74f2e8e29f58d11636316af0b17d92ad067f98a47a9f8a04880bbdeffb657bef92c091781b48112f8e275e8f6d71a4b52c41e66e7923690d72db91a55199b45f8e575d2eaa10cabd24d508784845431451b58bbad3abf2ddd6ebce8649248143ac1350072c3dbe703775b3ed2990e9a8581d0f962ca7b290662bfec97426355c3c340e097eb67d0ad7a3422a673666bdd158778759b9c3b57c908fe66fcd4d16d9bb2f83aafbf4bcba72091f1ac20781187dabc1b1347a006dea135969a03e6a44e8a6b20fedc9f72ae616f47e5549d059ecf9e8ef3e44047c4a9fc8a96c9dd1742c6bedf3af2047492792020442cfba44b3b0406c6d793b5b1e803bd909badbdacd4a2f7e83ca4afb339a95e44744984e8a190f5cb0aa960b3f485d3069718943cd687e9eae20445d0545d2abe0cfa6ff7eacba0cbe2ee9fcc06161186f4373c372b1307bdb2e4998efa2f7d344027ef5ede9c379b6f873026abca656b301a13a0880beded25994816e901d4da0284aec31a560fa62813f30a6975056f253bd30aaff611422dbe7efcd5345ba8874b7e4ec28d6d819f720c276ceebac854f199b50fdbeea905094c0e39e1abd373d3d9fce751aa002528eb89780c8386a080677b1adb8f15e2571daea19d3c834231aaf2742b5d2c799eb9de188724da4603677db0a4dd6abb5a375c06c3d184e8eb41784b4b84d88be4a868b0f4d9b8ac0daec170034c118ba0dc77b8171d522ed52cf40892eaeda08db5b4b33b37d99ca4d98c172f69efadaa57391010ef1e1ec1207b5a098621ee5381109b3cac383e278fe24341cd881489292e1cd238bc4b03e4abbaa80ffac40d225dc2f2cf9d1253acd9a718a55a3e20c5359c938f813b9112bcea0b8ffa588a6bb9754efebe960abe6566536f65644826b22968e981837676d9406c43606d69ad6bdc5d11a673a70f3e43ccbf48ee047f9c1bc844f5ec3d0e115c5e50099a76b9c0d007a4c1330609f6427c96b7ebc599b627066ee3fbcffd01062f7c944dd8b89ca170aa5226e3b6e698b30b15b9c5f101f817d549aa818ed9d9036d9cf86a95d4d373208596690fcae3621a52a9758421cdc2a7fdd2a0bb7a290d90929c09e8c87d1be6af150357f9f827a8e6718df579c796083213b5ac510cd2f015d57b91a469511b9919a0fb7d038f6f6c6a50a17b2646ded2ccf2544542bb50e655dac898f29809c1f37ef5e2c40a1c7a7d27e093f55f102c450a692577ed898aef9b056d8e628ca8ab0f295f5966a80d22dbc500033bfc3c3431b32a6b9f7cae5e11e81c6bd9f4dbca1ff63c6d32d200b065eef93556d3fb58517e879243da638807faf19bf9a2de5ccc6592014b3335787f565a30549e873bb951e4990ecdeb640f97fda077db28ae25b38af5a1f0c4e8d32692a0afd91b8d070576b500b78af480b4de455c706e3bf38c5ee59b401039ad447c7208f5ced463534eb37860e3c19032146b9c6adb34af441596ccc7e3a6cb8953518f09c83ce4bcdb31600cdd82013c25c6800634a35ebd159615718e51e61044ef1032b406d8ecfff2c7c6326e0b96219fc1e02420630cdff74e3332335b86631d2eac3b906bf9194088d0983cb405f0c49a2de6b523f12cb481871fb18337901890a1366e0a0f7587c5822d3b6d597e683fde761c867eda0f898088ec30f339c7a1b5904c281442b3102467d4384c6587c8f659b3ff54355c7ae0003e780c4e8a8ea62b49f48ccbdf0743ac3a92d9e64c7aaf991db233d87264059db1dab730b2dce02fb829196c072623d9c4ccccf9b2d8fd58bdb9bf6594dc76067ddc27fdb4fd83ab2b1e2a32fddd4724cf5a5b64e23384dcc26afa44225eb333a8fb92730fd3bd6ab3e2e59331ce22d2fc41d68e543fc98f29878223ca0c0495c43b6ba7037fad86a2abc881916f8c0934b0cad60d8dae79e31b04bd70517fb57efa473456bfc217bf3f9e8be60d3bb59bff620db56b9c5c1a037fc15422e52260024616420eb2700885a65f234b4f2184bd2325fce92729aab7f07a3218d66450af2d37323dfcc812411f2abd3111d852aa04be1d69030e096f7db09fe9b26d3b6c672c1ab3f551b830bf7b3a2d1d574d908c68e9b6b1324e4d1b0107edd512bfc5c9593f84b2fe924fa0a09249cd3f653fa397b9a89511841b25f721cae0aa3550ef85a8154b710395014ed7395c6c389c1da4e0db9dbce8fa13184669560f80e15207fc15f56f91bdc4d73b2cffe69b08ccc74e8d481e9a35290d580ee300c7b803a70ab4c26f71549e5d0f590fdc651cf20a90c40358e3b0cd5830e5352dcf784be99cbff9c0331690b70593d27d1ae50e0fc16fb914125bc7f030a0f83c49c719d843d452c7eadef3d513236697257645010b1e9770c9561013f43362c30557428b3a0f2cd8b60dc9f4428485de23652429789e70b6ed2942922d215cc8f7e79c61b01e75cb3fa8b3abaf029c1cedd28ffc48dd11e9857b752695e2caa8e88c50615f20d51cc299a3ca9f8a1066856a2a53b24c7215a80c9ea51af379ebd649b5da6a3731e519bc5f447445c66de87de66e50d0de9f9504aed86ba97b614c9360793d325f48d7c781a07a54622fc52f585050bc8363c1bf42578b6ec3a9d5d7c344bdd28d2e06b219b8aacd59dc593b941c5b2266eda8b3ff742a21d02704065c66f1a8db8105e2b8bebffef3bf5ae7c5095e84d331ca7b2eebf0f9ad6fc5a04381056ef90ddc32e3a1079adc39ce7b3d488b5b734162b815da532c6b0472672aaaf5ff1d363b5a7008c55665857faaa9dca435d9329fb2183839af83831213f37f99692ca0a3ce44d3a200d2323888896c216cd93d70592a220c4fd6b411cd5c8d1ce3aedd00781b54caa308c6d1465e3c573fcaeae44e193b8959343cc51b461455ce174732d982a7a23780c80169c64a86240954a9c07806a65ce526ceda79ee62cc1424d9e9eb874c34a28e9d5433d32ce97856e527d0d4644211e11d81f4c935fae9b624b6fec178315f9e3adca1e7fbce926f1c15c944b10e93fdc6e71812b800c15bb83a8900f4d6212eea7e49b8ae50160c9f525c75dab0334f9ae4cb66d6d72facb65b6aa71bfeb612e8b2df21af8792d319cf4a9d57b04ecfdc9987a0bd392ce3d5c60d7b59db90da6727bd1238fcd12dba70360e81366ca0362f9e14c1183b4c3295c86ac8796effdc79676d5bcc0b93dda094d86ad0e747a0665a7d11e7f750e47460ab039373a1f3de6abb115785b8296250a60413a48e73852e0d3245ea9b518c41485ccd896d1eed8cf5cb243d454ee41e40d6a121c2a5e86a30c06176857b1db3eff94ed52e8c0151789ee689c0ab2a3475eb28ca1afb03cbce8e2cb9017da44fab65a4fba61f8b8d2b412ea9327e2b7821e6786a450163aa2018621b7e1bd75392beec66d7484ee01264a22995a6eeaae39ffd6559e7ad2ab43f074fbdde646f3d77a79c4f2ddb9821543ea6e5895c6c7fab22cde65699547540045eba6b8d0cb592f169787fe17e4464e3f6501f672510d6376c659d2bb9766a6b6a86f6f0a3db73d376c2a5659a7b6bb30dfa9eb45ccd806f7c9ea4870339005f54c1a074557dbe425de61ba0369617d0963fe391a9970fded0de40ff2ecb1b70845e58069473ce7433877fb305bec9e64d520efb1a53eebbc4c3f038042506f506c5d3ddbb1a065740cc9a2dc5012a9410fd4d355c48fcb1dddb1467ba5b7a0c1bedf5f966581b9a8bf21a045dd50444999fb4e4531328b87ea2f86a17c310d56acd357938ef0705eaff5cfbc1cef3dd0777b5db9f32dc40e146ea2dcabd091237091118d5acd99e6bbbf8c0def9a62a9a9fd9d24df65c5234c03b7f569000fde134661f281ef82957d24eccefb08ea63442404c2287c20219298099210b797a5798130d999935e7a3ba0ec7d171f8ba1e040a4aa78be8cb029b57a40ba2c63a12f6b2ba1d89d07af5e800de85b62144448a8830e24cb2ffb5fe941747662cb1e870ff98161fe433165ac0464b9a20dfdb24bdb0216e9677774609cd4e3a3e29c7a7fe00d5615acc7bd7679f2d92ba0224947c08625415dee6dd09b1d1b7dae470f68a0f9b42f36efe0c620fa59994b3afdab8f5a7e68a663c0959e7a7ce09226d97d48181af3aa385c15d07c17cd62ad57fa06387b7d59da56aa2698d278e3a86d51af3338ce1b15d1389d9798ef786991c4afeccccf24c0eb5f7cde9a61e970f841d9f7592752f0a14b9b7ca21db5d85111473125dad35e2072f90d1b19cd4af6576e8e2b66972b53e833d1eb448ff29224f712245d51eb5a2cb98731e20f2a98f1b2975210594a7875aa3256afb20f2800c803b90134aee0f0032550bfceaefa17fd827959275df9c52a8223f816c6279097b65e7b6ac576b51352f1174ed23ad07211d85a0ccea834a6adde42750e8cf23bb75bd0087cc0600a8ff2408381d30fc33487b438cb1c985274af58751aeb65229888f2b6bb11c8954926644804b9c5b57d287a25a5ddd814d0e66f87ea6daae9068e1093a0cd0b1a6d9b963f684ebee86ac1d0032719e85b2c588106d267a761680faf1646ec6f61e6970312ae36b78a3f38491f71c0e876b420231ee2015cccdf9c7aa07a8299a6e36b24c764fc84263290dec222502e47a0106f5d07954fa405e9ba4ede9cec4f340d3839e0a9dbe445b7badb03f09d8700f5b90ac7bc93b4a380aa9bb0d69a049865c9f072bcdf3ae40428f338cc65baeaaa3dec4de25a83f7df3bd7eabbebd910b53ace5597794864751bb249f370b71cdb10b19a1f30ee50e6339d247321dc0e595fa8f519d6a78e6e4d8b5ea699a4d63211f1194772cb682003c3f6f6c659e6221c37fe2229fccb8e4245616c9d9fc37965924dc9505a22edee6f75096b024b5fd107b6695c1cdfae2ab004ffcb62236a8490027bddb3430e610b444b73e47e01b804a99f0ea3b7afc65c6f429d1f5ebeb6857d8bf0e13b9f5b717ac94c86e7b3ae7bd23e0fac23bb22679993ea15fc427c2cfc0e1028ac0664678166665e6953c7efe60a0f31533d2e5e11dba48e7af737f93fd2814af58122efd6bfc9635828941a3534724aeedd660df50fe274acfed3ad7a3d1687ffafb886b4017519641e52e77d629bfc329553e27ab2b0cf3b862b8be951877043143bf3577a9165cc446a5711546769b4f4d9f0ba41a476894f257c9a0af206ffb0033428ee8968eb59b4dc05c2825abee53fcbf283914dccecc4c38304af1c64d73af3bc3ee1d17be01af29d368afcd2171b1db4b9efb33ebe3ee7938fc42868057ed4fcd12a7be683289054eb0de68a80cefb43853b3005205b22b7e024fd0a73a79ac8c90d02dc27751bbcabcada8faf13e97e0cae41fc3486f972ef0be295d207de1d143b1f9ba832b1c5d96205ed6208cc5f317b40b45b9719589ddc0135a48f3f1cd83e92012c54b3a1d0144ccc61bc1d804a76013fcb3cf0b6e17597c0d29c953d96aad4a36edb82ba1b39fcb66af871c0655b9088bb67de1bd339259de39b5ac2f1e4243b6c9a010bf0cc992305b3017b4b698b22a81f3cdfdbf1d19ec21f0a2fa633c685eec8784a272736cfd54f9e7e81c3bdaaebe13b065d7bf813226a1e1c78691f8793c024da8028407025b700f53c36da150f251a23efb23e47b13350a351d1202183672a207b9f802c64d36d37369b03c62b29457a433805ae73c06f0e1541cfe9407a71b14952300d80d0cac110c2925a08ace81555d6d86692cbf88be3799843831a8fb06e90e1b0f1dd951ccc4aa93b37e94f3b931d6a20ebe52ad8d75c842257e35d1f1cb77d67ff0d2ddd9c5bfc257c0666bf0500b483095f8fb97eee33c7fbbe2a8fb50f1bf585efd8ebc7fd0988cd6e318f39a658ad08917e500f611e9a10c25bdafffae78f511e23d8b316366dd2242aa673224be5b438edcb82406935583a8bd697ce68c7131985e333b59fed621fc2a0c8040a6344795516935a939405aaebf55ac6a6a4def96108cd03fa19eda78aa10da9e7970a14f6048d68d644ff5a24c17750024fe3df283682a8ca50511ce306f0727d453b6bd9f2b12f513fc309d3c174f4792c8b686b1078bac21fb3aede1526ab68efbdd672800fb4c971b9cae4888a7a973325321ce236c12162bf0cfcb953bc3d54f4d576582ea3dd06486e3d413e82152666ab3aa7d20b299d7978fb6ae9804431f749a86cbc755f69a1ec342cc7aedac942382b6cc70220b220c295fceee9d02a07f92ccb762db4fe3d395a593d49325dfa6866f90a1fd4754ef001e025341cb9b729de98205ebfb37d7769ccf42dad5b4f8625844fc08a2002e3fa48624b958f3aee98f86e4b936ca7f0e49403016e3adcc3c26b485d319e9df0c6e74b00109d18f57fe72d983cd24b8ff59109f271eccf619f5da223f09b8ee746c39e041da90f770521ac9daf7c06e191341efe7a5ad19f18a1239e225c43eddf0388970a25d3f0da1fcb3989638079d1f17e04ce320bb2af1bd2ae5e173aff164285e7f25061f9ffeff8e1e7372f0e780492971e60922d43304f1a6a1eb1e72dd0556fe06dcfcfacb98746fca4d319fc5debd0bffe6f66b4849993d762430a31002fa36045c7913503c29eca3551fc8fe0249e0633d183d668ac3de349575c0d0f2ec44f4be93354e5db3a4e0c0c24ac0f66da350ae50f277890307bdfbed97a5c9d79f72d110b9abe4ab9cebf95dac6da762534cfa4ea2ea209f81cf2d9aa846ad47dad68f956a87c4f239375fd0b84a7d79ea52214e71c8c3924bb4b1a8521dc4d33352d7b8ab5574c26aa99edab453a64d1c6dc4ebc3cd00a195b707615cef05fa053b551e9d67c6114b6607dfb535f04a43c6f317f40fd219b7911d2b282ce753fe6fe9f4dd9d6ef93770334af2cb32a25fac6154cb138173ebdac07fa98ea71d357d8805b640e4023da222c9b0f82e7eab0b7d00f6da61fcc37cea72a30a90fb00fa2e52314849235fc7d560cfdea654bec5202ab2eb87ecdae6ba9d582f83c29d292de0dcbe956fccafe11383e30a80d70452a2c4cf2163a02cb375852e643ff8eb974ee127df75101ace5e47819bfab944b82dd73ff8eac5c0f5213d496c36c33f85ad615ab34dcdb5141e44f10f1fd823fd9787fa4774471607cac29f04e0b6878dc480202e303f15fa40936a5aad32ad03ed39fde5915a496f4f43720a5d34ccfe8f53c43ecc9ce8e2828353714071f65a73819db0ce725497e6fa2e61d497397273104c76c81fa0fe772b6060814595f3098c657e80b70b221600ff6a860aa83f16d6a93113690fbe8acce27d79e5c31a5a68d7748922c7fa682ead342b724f3d62d8e54e106ba4414417be6d3993db45ddcdfdb8f38bc05e0efb26ec1999b0525c0ee51cd59335111a157ac001a71481cdaf8d7dbce06ff3192518e2bb61e36434480e70f814cd8a790714de830af1de40ef77d8ad27de82c8baea1e2c7180b50edd82e8880fa8c7c3e510298e46183ba9859311a19ed4d52408621322fdcb4e64910e4e4a8ed3fa327edc5085975c90994ee99d64bb054f65cffc5cacd1b38e7ee74f1b5d9b9a2050fb9386808237e94a2af94badd4fcf51fd0ad34e3ab15877f844456f197dfcbfe5b98d7a49c6edc21b83457a91e279c9f633010a6358e4d422548c180d828bd18b7112136cee5c80e34e8787ab31261572a35347ef8865808eb1a53cff0ac5c96e7b617c93a901bcf272262fb97d3b449cdbc5909c6cf158f2c43e929a475d7a236424c776ef323c7cd54d5e0612fe79d5b5cee34782fb133dd9c5d670114b99d31ced2dc3c82254dcc0ac1863a51c690e1c9c9990c99486ac73863d1948ed3befee321c5f5074429949f63619fe38b494b6f01979c49c6f9087cdd5babc8168898f4d7181f2f595183dcc76cbd738a50fcb2e777d4c2e074cc7bfde24beb2d63c4183eacc392d091d671e9443d657e7360d4b36cdc3c23bd7c21326c71293589934ae3d152ed5ad818756467b81ae3c1aec947be027df3b1ec57fed12f2989470c369cb8d2e536a67e04a68eb3813f23e91ae95ea06ff928688bf92625452231e19b1f600f1be054f4c67e5eee71478bd877fae06d3e51c2df5af8a878fbb13335a27c1a6aa2f43509fefbecafad35e4ced9ad6b88ee83af5b7913b6d93d0d96edebcf66b432b1f45cc4f095ac6c127be409eaa6b76ddc10a6406cd4fbef091af300fac849cf43ad5e34cac7d835c0fbb38d07d1ac234f3b1ca4bab150d80e917fda79c0fae695874300062de70ed05ffdb0d4798d08b312a12f29e5d978f9bf7a4881086de37fd6e66839747130c1cd026ca2dcac6fa2bda5d105d7cb33e496d2dca458f25562735b8a491ef24cbdbd6015555cdd33063b2e298d1aa2af71579edcff2e3af9656f61a84b0679ed2058ec7d61a63b30ca22ca103560a0a51f6e53f27a30cb8a0360af5c227e5d2c50d6e0521df4ff75e2c8418706937b63b9017d1a13c2494b4c04feb98ed4456b1f33b7e72f6dcaa8fd80e7d16ce0a3fd29acc11642869ff4f5ea4b7b7176d00620fa7924d87955b7fff5d04c93e7ada53728bbb522fc707a050961594b0147a1dd181b656357aa9b789f4dbad0bb8877beaa2f45170f705afcce07b272a7868e9c00ec57ca0eaf0f90819ab2979c4049aa96673748b6dee323d366cf22511d3ae25903ccb574aa13abf9f244de3000494648f5a9374767749a2181a41e4a3138258fbfbc71f8cceefc7c061e36a3bf772ba061cd53690e030c97160d18a38cd2011688947488ab7ede3b1dfe57391ecc4b12dd633ac7ec165f8175fde15c820645138fa58317d8cb5d42d190dbf395ddddb2eb342567bfc68007cb71c2638e1d4a983250734876d9bc94c2c7431732e315a0ad587ada5241efc15fd4515116d353a0d1aecaa98ef1d0b4c3b6fc379fc2bacbd2e6d0390c51d696a3e37a84582916a849a5a4f0edc745d8ca873abdd3114cad921822c302c393bff6d9291621e8206e907464d69ee81e2025b9c0dbb7e5f423e3600bbe35c8272d3907f61dae9815d2a935ee0a095faa968abc50fa3fb2a52f46639a0b0cb4839ed1fd67a09cc58c53d77d35dfcdfa5c88437282de15fd4f4a5091008c44940a51470c58654884032c8feb92e4b5e0e421eb174847717332c10478fe2101c3e1396bdc7c12941f20dcb2530f5c3357d55c3080e4a1a524cd0de19a9ff43741d6bd1ba6fbb4576f944763fa7d130d8f2d31954df0ae044193cba447f1b1004dcb94e5ab29168b8f098647840f0c3be9a0471b9d0db365e4a16a347d270237fc1674edb46540a56abda3ad2db0a1f1d5ce527b3e890986879b0cd104de72c28cc3cd4373010483b5dc8372393954d23a3cf87328f563c0154fd69bfb1b2f05ce1fa30f2a199f807ed9a0e0de67bfb4a23d09af36760f0bd7c1d3ececf46877f19ab47692be3f0f3decb1ea33fafac29193d30dca08c328bd333b90d45b2810c18c16f7df361f8bd8177d4750fe111bcb7a2a601529191dbc0e45a3a8109b57208239404e29adc117af5ffc279067d7219972014f67a49bccd1596237b7b7df0a513751df283a01aed23a6932924488dd7e0943a733c3778038a38e186872d9a81912f0076cf2b31cb80e10089afa3cd3e9286c379c4d723ae10b56f7b16ed37d9ede5732a22133a977bda5a235a3dd511058508c42023918cbf240c8cce906296043d2e7db2dead0e0e8635027d2b22c5a3579a9c11dbca5412b8c24bc90ca7e92131ce1ca29e9276a44801f4a86cc43c56c200b7c5803cecfda5572f6c308d83668fb0f6a78bdfdb77e078e28ca415f9528a1e4c6f101e0e2b13a6b1532a57587fecf0374ff678a9e92e571d298eb9b1fd623b21b785fa10f83e8c4a03ab6365c8b7803e434b47bf2997ac803622a9882be2bbe243441270db2156095f1217a72430ad4f9d17a2ccaac28a367e892356f27bf36701c932e8a03bdf4fc4ba381de522dd6616d3c024ad327a103d77f1d4644ca8c6480f14fe1e4ef96a3d0a316e08502822eec8bfedec0caff6ec8a2ec38d00891bdfa9b9c81fe7d2d16a66af3ebd9d8bf1806386d1f06e9102d9ed180a892cf07654414cddd140f1338c762115f82eac4de445935051d8e58b2beb90bcf5d9d667066c3e3e070f0c95f7df213a13918a427272110d7e4401eb6b9e234f6f883d50f8f0f99c9ea71083fc6c200234a14465bb0a77fef56607103e6171f74e76e682028152d0f5e47a51abdc4bef71ca518c768f48a8d0ce153ab207058fbd40cf1f02ac3c2b26271e47139812f1b6f4be6285cf4c62ca3dc7f5ffc2e063c9fdd3299b4cfbea896745270f65a79257de2f37242edf01fe5096974f1095e07b5853278f9485c993ae2fc12da9065cb1ea69f614dafe8c69b4a75cc00d89a0ccc1fa4088ad89b647812f0794c42a73c6844a7a90583b8faa53d61bfea9d080b89560d5c931da1539c9199bd70895cfc66887855b8106c969c4d9f18bd561d0afe7634ec6d1140da29a80b686d62ea3c0f154c3f91acc55b302fd9d8f506c8dc53edc3c240acbbc1e27231191fa3fba847522cae203b93f0cde462fc49d902438cb74f3310148eced46d4f20e5f9180943e6bae7c2d592357a6a3f37197b3807f3699f39ab69a42cc59c4a9e6a1619b959a5e09bf48627d232fdb7fa354e74a954256d18db8311240cf1b664233b39836283d363f548c95e420b79f02088d7503f36b81ccf35d120189a69fe420d9342ede3cdcaa2f34a22cc839a2d8d4e8a85722eb7445190f01f0ce06898cdd351580f7f7a079c650d4585ef5385e66ad1896b7b7ce946f41b7893dc6b2cfa21239b14a6e6c9f52fb930d9348dea14c70428af5300f42a6fabececaf569077a45fd30fbc035e0355f4ade61722a4cc0a7253e8dd587a5c2eb5ebba15d95b2372779a2800ebad24ce8572f411ab6988a5b2204940c34e5d9e31e36bb2928db2b06d3d75f8e444c1a5ca275f8465eaea3a73bd9ab5e1c3d0425a7bd7308eec58f710f041579086dd0c12ab8a8f01237ed45529a998149fad4b8d66f183a65aa6efe65d3f7fb30c107efec82cf9f801564e01c0c83f1c4ee0d186dc2e33993f308e72ddb3424366875867357e885f8e425992891ead8048cfff7970fe7a98dca3bc8ad3bd5460366887fcd9eea4e2cfebcc9255d166756e376e931585d3228df01d8d91edd2a3202d281eb55a80daf8a38e9f5d479aabc1ad40769155010fa5810912ca3568f2a6c6986bf20b8b67c527686cea3f268008deb8556216466decc1fe223680065fca3e51e40a11a1da05575bee704e8b9d0179caaac8137bc8c9f652ee7b0f12b5c1d99057d3d047bbcb61d0e0a9e85c4cddf2160aa31bb714996e309eb49ae70d516cc295708b9a7f62c9a658656ef14ecb678db97ddd7c896d79184a003acab25dbe66b6f578125b110167f357164ac4604bb7d16b391856197fc36e99927aa2640bb40969fdf00b6d5ba10b86701a07f0669ea3c59614fbc0952596e86db9f538d8b2fac67922f633e773b9404f8c8d300750f9e11d8ed445a21b68d4c5bfd0e2f04228b6a4a6efd6630e73d369434ad00c409ec5d948608ec6cb59ec1ed01527dfb5c021bbf6872723c8faf890aaefe62899875ab1940768cc36fdf524d64cbd7e6ec30a7be02a95dab0bed86e40793b3205955225a3e03bd085fce54edde9bde4850c810c6c41d13daf222abad401b793216c3430769fa94405f0d0a173e537ca8d585472018fe80ce89a7f46794216da67439d09ba720a7bbba9f248751e3f1c74eac572f0ef1290c643f0460f09dee846786cfbd9042ed9fc957eda7bbdf8ad28165f8d749e6bd6dbafbb64238b46a0176583d7e977d8538527d001ff3c87052330873013fbfe687b42fe51142b50f95de563885323ae182fd7c0d70c690410b6d503be4c66c5a471d71453aa29c9cc69ca8b44890a2af2c9770b768acb6c3706aa8a47266f44e7ac6af711fd7b91269118d9c7407b7f4e5e9518e845aa2ebd1caa20917b00327a2b99446ce1031efd4a291a66fb0e66c42220fb6764c1993d24a1367d2cc8badc54d16d2d14f2f09c9a6282b5badbf45e3fac2b50cc566d1b1778e502c580dfe6f087d47544681c68b76d07260ba9427bee6f3bd991c3e7a9122fd8dc6711b0a15a31ef13cbf8b46ff23b65929c9a277819438443d7c97b03b95c075da9a9cee114c468c4daaa27f5c83009c79b6bbce837ef46a9eff44e5c531ec5e30b4b9b6e5d9f28272c8d13ceb1f34d19ea8fdfce7d4bde071dcf3a051286e10852faa8b584ba47301f1ac8e7a7838996f0364a7b88bfd23a13b58769ddfa8e0b966e36a4479aa71a70a55cb96652d1842e4a09f84e56135a607d6ef32e330ccc7fddb13b2c38106e961e6a7f98c9fd02c7b14c00e39ae118b05c807181099f119032c403d56b88c0b450fe193c07c1cae0ee11f8a89a19abdb9fb699ac2455876720dbcd573f3e5061d31d1998c81a6454bc958a6f0909d14713242747dd6f68385b040653abe41d161a6da0d2d7c9ce1ca645ed29d9c2c4d1927eff065e15011f8e23a1d5f3ef3b4aa9bd0c55aa02943bc9eaec2d7fee6e5b94fcf7133382318159caf41fbc20999e32bd7c14d05d46a0d64cd56f35f1a774ea1128a53608de7a042de75ddea49dbfd294d6cbb54afdd6147d28eaff5dfd7c7792637f96d100a88fb98dca1dc72cbbd7077bdc02e50cda21941b574313dcbd88892fde936406d95019b25e6a2d15a35f35deaa6a458ff404402e5fc96168ce57085b3d249e1762651cf70023b82d7693bf2782434f7abcd85743607733e0b2426975abec9a86a348b0e6f61259711c49757b6fe97b7ca8c4b7396e6cc3b8dfbc8cf39cc63f67dc020276a719e13c8b444064b0f8bce4b698562bff622cb428ea352f985b7ed50ef71ee5ebf8cea9d77b26225cd0fa589599619586d0158674cf08f6429ba29e68dd99ff136f6cf73c6783091fedcc20628930b95a39a9d3a5042368410d52232032d0cf5bcb48e23b9fb9cc2dfada91b37fd3549d3cbc64067a5e726f8aaee55d19e7d82fbca5489efba0a9fc0c26105f3f04e67f0b89c7dfceac6eb236ca4af322784f614ecde57720f28c7b915239fb363cfc6ec0b8b1a3d1835e368c811faf8284b4f03d664b70ea504cfe71975d3cec9f209cffa30da58dde4667abba8844ae635e9675457b9b7430f40c094b122f10b6868907eafe4d42935a82a2614dd3ecce21805aa8efe9f4ef55859e24067c6f20de7adb321051c22864a339be6004c9334b1e7881f74b474b663ba04fa8c1d5178e11c1dfa9a5d5871437e44f4dbfa5ac97a072b8ccf0fa78cda3613a379194f11ff8de3495e6ce51419ef66e8eb1a5705e333d136067c7c865328ca7dc3b15f4ba98fb74a41d712ba8aa070289cabc82a51a647e63724865b519f7e166648588a235cdf5ad7cb250b7ad99cfb9210404974b7685fe5a427a6018c68a012f66a68bfb20d5ef4cb2aab05f15fe12d5948a0493a32dd7a018e9ffa9bb5361bbf9288da0917378fe64097ddf5447f351a5fef2c409c27fee365aa259e618deeb1a71cc4bef8f2a6be2189d84245037b7ba46a9f27dde6d98618d82b0bc851845dcbed9c6a2c8f28e6c5ed8d5367137fc94bb8ce1b911fde774650e4b29ac1f5a0079e5608773f3ef4badcf4f10cfbfde97b3d2d63710349cfa0a63549151fc46345f8a39e1f565e52942e95b5d4ed9061d8c17455521920df6bb572b3baa2ffddcfc60f468f3e675d366d1d491088bf90d8e20f8af7b5701180c8b232a624a64b8763d478f8f559f71981c867bff668631a319abe0b1a618a58ec92a9792a090ed18ede191c14ccfa0e3b82f978542d60a85eae5753a26fa484e222a0c66dd9f7760962ab065d1a3f9ca40055039c1980586ce5a3f85058c83c6a76a69afdee26105da2fe0659dfddb72bae81cab822f5dbb5076eb91d32ede5411fe0c2073a788f52adf526863f902c4905d55194a1f91ecd91b10db5441ade11c6dcb4492c46be93e2216efbfd6bd1","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
