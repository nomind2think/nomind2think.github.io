<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"2aa6b5efe13863477149547483883ef719c94218d11574bf454a7c1afc346f22638ae783992f0a29dd50f8f4bb45f06ebb0be22571eeaf9f92fed2cf14782d2de871dd778f6097619f56e93f766da93552e9878c04ae3dd8cb96fa39331dc53d8e3404a34bcec7d169fb737423b1758b529eaddd0087fbff18f930c1d1977c46cb04005c8b0808fd911dd238ef5b9464c9bf1f8b4abe5112442d6929d00b59a4fb6659fc0f5542416cd0320cbbf8dc9ffe38d87e8336f84da9bbec3ca3ce5d57a7e23675927698737dce1510bf705ab1e899d3cdbca1979ab615cdd4ad8e0c4f974b8884ab69989ac89b9d5b54d90f01d92af829a4a926be738832e1516c65c60e918d5528eafe90e83a735259f1a68ce9da64f112f256d5590f336cfdfd7b03516ae8b9d5f93653c9be8679a9ed5a1aea206402a37a0498e7dc6b8c74fe5b6de487b8b573cabcd53f2e7679a2aa236d9382fa35b5c7daadae35384a26d48e90d8ae86a1f739cefb7d5dc54bb6650420dfe2b7945838a79196c208848346b3d84a573c90b83f427a970fe6b7e6bd583cff5b7d63214cc305706f189e073167c5d6cf255fb192567cf9246d6c313142eee716b6be63003461894e2384a80a211e35ca09154f4b760ecf356d6a935d410c89da698a0ea77ae42899b5630528e8cfbf7062a4d525c17aa3a5eef524af641634f739233ec6b2fad2cf03f00c01e39b7cd35d2edc5bf7d8b286c33b992af36f6240abe551a61dd479d8684f35798cce587cda34e86e52c185684698566ee16c12b83d7b0135cb6b0e52bf8795cc7c52a35ef453a11ae425862308a8faddbdd967b10ab1773282cafca3ee93254eed866c9a9d25f5253ad55b074d27751f869a966c1fb4537753300d14ec046a5357062078cbb57154ee21c267675bf5fa089d164596bb224866e4d030b54aacac9d5f13f1493fdab9b03b0bf8bc71689b2b7a7b3955bdbbd67fb17963098d9e88bfc8052bcfcc35dfe0dce8c64faaa3f8c7c560a3cd2df39df6e8856fc73dc74ac4c90a3df60b9e34d378fe5e42516fa67fb83eec8d1f079a1dbebe6a95cdf5a505eb21eaf667f93b955fc0af7e7ca9a930bf3604e35abca4be23281609e11d8ee90a6f8a75eae79bf2466b801cf9af2999b675d8b32f4980ec7d4c5bf8f48da33e5830e00c1cabe91eca0f6d4a2ef69944939ba9855c78bcf56fa607b855bcdf6587dcb7e07fc69b14578dcc051f6089c9d9d186f0dfb18e4d8c938ee8816837f8b523a60b86d4d1c70f8fdfa1b40aabe6618c9cbfc5bec75e0570bddd319ca71f4ae52cee68f74f61a7a956521e8dfee53316be265fc47182f25668f80bc8b1d1a49fe96812497c7e377f85d273dfd59edeb869f638ec95b11d324354ffefc3924ccac92f9084e0492213579096fd311a1e92a254525515586e5d11ac05eeb28db9e07db46401bdfc7324acd583ef7da2e5846faae9e3a6d8380b2e26c1eb0f1f0bcc6046d850780bf19c09bdd4984b7714c2f049df1b745ea9023cd2ccdbbf7e83b241f32ab27cbdfc38bf8bc71962be87e465067c2cd46ea3a111a2796602de1b7ccfdc262423a83b47f9d339313424f3329e5e9813b18d350d6e1b1c3a435148eb827684ba733c0db729e6286e8e08d9a7f732cff177ef8c52ad5675887f10e50b60fa889a3f7b27a4cd9b6e96bfe5cc9deb452b3f750699e4319588561555d9599d28908ac6138dfc26afcc89e04e2c24120e5c581dde281173aef8cf36e050bd3e159ab6cf27d99f3711ee03811156bde564451930119f98cda9bc214574460e6b0e383fa0cb543faf0291cd466d67e224d55b97395794879fd0e433e3e74770b60eaaa0bebd1179fa616157152276eb802a9c905456868d7278f983f1dc38068f2005faff764e1f0b410bebcb7706450e266645cf2a178fd1449dc713d1943b331a8eecfe4b90dadd66444c7dd0159263e5592a72e5118301d74bb3ba3ccda7535b46c2cfea03f58bcae6c8ad885a538ed7e338cedb4d04c70c6f8f55588ce3fdcb6cf37ffd087fa64e519f65c0d14688452f2ed502e00948978bcbd216103b7ad6a7475d5070beefd260d23ed62db68c6c970b5627e7b13e5595ff27ab05e01ae2741e9758d048b85069a44ad95fb7c25e4468ae9b257f29565bbeffaceb60e6e69de9c2af0f1608b2195b5bf1f5ab731bed352a8f3cf9b58bb2a6d96457896583981e0de02df7256f180eca6a596749a58f2a52943052c01ae92cddf085358bbdbeff61594b0172c71bc102748e822a2a988531aec58df5cabe96d8e10860c2e21f00b65e959045e1932e79fceee097d08d59a77db7a1ca8b577a196a41263ffc1393f42607de01c31fa2d155824423c235e444bce09c659284841187ee114f7f915bbb965b5bf8036711994d8e101139c256f01f7344f9eb6bcd5a91adb3db202c234a8a50a9302d6ae5ddf5bad96ac195a04546c09abafaa56a70c9b72b7f6d512df3c32a6391da0e8a15fea3ce429033e9c032781eae6362f3b7b8ce45aa033f4a04c853f87088163107d906293572ab90f0411e3dc466f5cb89114aec37760ff44d32cd52eb90f1b38f13d1ce3c478f10031ef975d431563321c33ce234d1288fb59d30cb47a0c31cb29c2efd657b28ae826fda80a8f762a3618f8aab0b2c94bd7997a3ae94f30c6cfb0317a87dabc2ae4739e141092504065206349ea89210d7a357af5ad751831a14a7a7fd7f1168dd2944353b8db8b9a85fa623083f5c6b197c0d92e86e1cc7cd4b0f9b63583559db511b44026facf40aa363ccdff025b03938fbe7173d5136b29a743453e73e392c39145f0f3ac711eb556b6d65e73fbdf25b618b132a25f511100fca9df9026745f6a496c4e5a48a1c5a8df843630b6c7b7392ef400c1970233e0f1bef2fe0188b36c14803ed72af5cafce3f50ff4e2135a0e33a1a77aa5ad76010de230bd3fe1e3dc0a1155308c9628fe0b8c5b9ec3bd3205cc3d2587be13cc9f6a2186541ea1c16ebf4a7bdb527490f9c1bafce035362f4d2fa1c2f02254a027834c8b8101f6d97508877c31671b09fb62233da4480e9ec36a8903614f5a70af4548041e4979b30cb65bfa7ed01c08e25f3a14a06b572300cc3a6b2f42e1914f4be5897401ba10559d31ec9f8aecb597ca2f8e89c3d82d7416db53bcb906bd037ab2eb6805c25ed5766764fa58fd2cb4c1d2dd413fd7f51a8c4220fc186ed112fa7333e5791e6efcf74c317a6e5236407f329c203a5d3c11cc8863b094e4e25e9471faca1704fa6acbded25757fa99ef889ab82416a67a4ae15b243d54e4f0b402d0e7fb6a42d5e3125b1e538fa0246171ac9efba2cfa3b79394654056c50f4f32f0b3fc5560b5b681e53f9f5913e70989eaf04074e2b19b51663bf0c9739b05bc9a8c4c353fa8ae87ecd9b18b228ab069c119b1cba8c05d930c6b1d2dacd70cb3bdea60db133ff98634ddc41f103f7eee6be2caf9a31947dd013f04a856d0d7de63489167a6c68d51484877eb7bccc1609173cf072b64cc84f70e1f9c7d7da4932de1be41dc8fe82e155bf79d423381f0212fd53e6a5e087998536812c3e17124d110e3cadfa9a51bfdebadd01bdeb6f8c9f7f9f9ea72cd514db057882b36c21be4e3ba1d30a4c40d01a7afc58e8fd7215cb914308c4a75c644f0420c0e189903d8b724b7b27167094e3ffe855f667f683610eb12bfa558f7ae5aa31292ffcdf3d2a44b53aa28f38e99f692581d0d5f1c300a5da6f7dc908331b37e31cb00bb94b4b8fa2869b15f1a31e0cac98a4014a3d6c990aeaeb60f95e6ca1913c523a2d8858f429f5c36e1a7987a59647445f35e2542fbb7e97b1a0824077ef23135494014da09e9729322fec84fa76f5f4343336b53d5eee432d29a9ca73c777576a7f2b1dda1d9f59851b7aa7dd79c14e915b332bbcfa7525893788b88a38c140f8b180d4726000d543859ad78479f18a12fef6f16328173de8d1a38f73058aa864eb1878acb4e86c59f0fa352da2f0ded2bba385fe5b8d67bdb34561c91671cf864fbc08275bc626a8c19b276bc590d62843062c17611dc02a80b309647d731ffd773d1613d09aa0e70cbef8cf66094ae5942323c960d9459a9dc19ef4855f578307f9480d5a79846c7a1cdfe1a75b25f36f941144994e306fa4dbae5052ca404052f3db5f4fed24c7f8b2ee62099345581cf2a9cd19e42bd1a53127213fe35493750761cd987e137ba8e435d69ec598a586bfc417b7c510d83edd5a85be9680bfaddbaf3a3234dc59ea9d5a23ae86c1d2004dda31fab88df849930d819179ee0af6d585b734d08396204de126667c34f64bdf278f32487d3e202829c22c74ea718cab5f66de8560fd0b75981fd1e035aceb1cc5a7d080bf03202dc2659c369d85a3f9f6b3c33ba0c0d3990f9b86caa11eac355b00e43035691cfbefa245240e94b8ac69bc721b682df67e5831def3cc53ecd9ef86b34d4ba2c5992491a5f08bc10f19d35e786e066338eb5187376ffa8d07fb71d2aaf6dacbd252638408c08a324253192a983b8594dd0ddc0e5c793a0a84917a3b1e394f52d010af08faeb01a3889db26f7e7dd349d0849fd0f283bdc1a1ddd353bde225610c152f870760d90edd9ac1c7fdcef062ef3d2ffbdd913d64f73fa11e13822f2690c4765f5d589281a2edd4cc6add3fa15d9f89b837e631da5d27d135ee25ec41f6c34ff59aaf3c137c6588c00cd82d9253076f9730816b29242f60b343f9d7d332195eda249c1f4268b3f8e81b7f277c3d48d71177285d858a1c4c221babd986aed46e89fda694008f67a88701108df073a2353a229ba86cb0df983da317fef4ed06c818c29a8feb27926cde9e2865cad17a1da7186c5947a0db88ec1df199d6446822cb1b2675b5b582b37650e5299738dfc72715e8de96bdea32bd0d05ec65f11ae88650873dc8b9d5ac3ef85a179049ca31656c6cc2acc9e50993b5b70ea58c185d3bea69f1d7c4d5a0dd86d14ea60a91e8bf2eb52f9ee687946b008e327a682e028ed2b80adffcb0e910d60dcdfafd8ebc6a11636c052c9704d2c3a2295f334a32d11cabfc7fc437057ad7c842cfc944c41f220a226b36f2b2f0bfc6fe14655190c5159a57691e058302843ffac16c9b818d2cbe5adb481cd794ca8826c620c5c3aab8a1cbc47a1d87383efba802681f5178cb6d4cca6962bc017fdb02abe07abef2ef3c843a2499d7f54c7d96f6adb0e8c1fd6ba2dcadc0be09ce69fef6a30716d5a94c43ff31b5f8472a032d6fda3883a6a8a0af0b344126c8f3ca8fa71e42c4d8c3ec07b27880821a5246cd82fc107effb1312d98ecc76ba887c41be8689b1d1b2fe262aeea0f2e5e9f140a9085618295dc5303c216ea3aa70bbcb90d9996840c20d3c955800da4691426573b815ef5213c29bbb31a216df4050e80df69725d865fd9d228c05517ecea316ca2ac3321aee268d56f4c84bee2f28e1e6fb347094530a81aa677fa68016327fd8b226293dc87083da66e7ff4e6409b4773cf12de27162931b665ffe2bff92a65ada8a9d90d6d1577e3184282a83e3552dac0a3b5576f61440a47bc9e414d3f2408489f83861d7efa09d688f2e81ed3c087878544fe5a87bb0ca26c7efe9991e1f886f56052ceb09ba533644fca0389ad3e70cd95c52b20b6256bbc8124643a6938918d7bd25218772c3e02c03fcd80db89dbe2b6ae7ccd298974aaed9db953ffd209f7b38fad515c0ac6c3f1601d0edb2f247482bfca169cbc99ee50306b8feade5a71fef9c37bc0d9c0aa7e75cad57443a2b0ed4e496b55d9357fb62483863a87ad0feef247a32c8ad07108478baa872f176830d86648b527282bfe5ac456b40311d4ec616319f38e1c7d38b9964129fef775d6c40047e8c5fb4739622dbd4469a53e376f145227967d9bf2e1f00a91fcc28214f2f6e882ec377445ee51d47f29dc72345cccc972158274057f712e65b472a4b6a154175e50f2bce0492f11f466ad795b3c4b59821ece4511b40dd30d5a681ad2c74be5de41ebd9777dffcb525403bfa0bc9b7695071f01e6414ea5ac9adc9f32bb7e7ff8ebd93b3c68dd635d13aaa0b4209cf79e3f0d1a6635bf6687d1bdc8ade33ad3c9177662df38738f26f0f8aa0be466dca86e6f6df4e47430740aaa6c0d6a3a6d6c219e1c61b0f6101e09097c1c25fa2d775467430de5a62b1cf5913008c76a1d73b1a08a2a8a90181b68ae2733afb856f50dda6ef3c0079bf63907f4d17ef0ec1c05136d98e83314bb784fe664f588ee68f95ccaf866707f5d8cb5276baaa8d3accda35c485317093cd6b8420fef92747138b6cddd45fc7cd1d5cde6c8a5408649d76e29adca277a19b682c559b436e7475b349b5ed29c7d92d2b754da35886ce7978a0d68fb9e58228db3e67a9dc5ee419e49948991b8e73df1997ca53b576070333a2d2ded196372cfc8ef4b12e192aba9ac22010180fd3a0cf4879731b3c0872c3c4a5dddcda85eafdc75328cf011deba909a693362971059170eb005d713dcb860d0c2b9fb64c6868a20dc8a7b143053c5eec08f58101a42f2c950a4f6917862ddcd9e1d24fcfcab4c7a9c40bbd60cd228b0e4d02036ca9e7a735fbfafb7f9d40d35ac4a4aef288f03753999039e2cc21d84142c917125f4d03222b0bd23379d03eb50e2b047071cbfaa847026ff0429a05cdb33e17abcb3c4ae5b30622a3d9dca2dc7008654ae511f1bfde6aa4a8e53645664728d3a4d6c7fedb8346bc284fcb00e10991eb7edc57107cd097cae5c4d673c84ea8873414770ad60a4702e18a6df461f0c9cf5dc15783e584deb8a8eaa4f8bf6d9e613297207298c1c3029cb9f3624e7868a90e81e072ec1bd5c2df2184bbbdde3361e26ce6a2e268c4279964c0e789364c2a629bfeea38946890335f12985b8cf3e9c50afa7605b7df6e00f32a3fe66844b7ae0786ec94f18bc40929ccf70816f6fd52c414d1b5efcaca151cd1cf34b664c476e8c3bf0eb469fc924035e5643e90fb866014169a402bd3db1f0b9b1ebba10218e9b625cbe9f2e8342544a6773819681636ab2cc17d6ad1c1c7719f4c33eac966d11216148f9e49548a0194b26b04465c62fe252ab860aa7b2a37905912fc87a23d336e174502e024b2ad5f06abf77db35e171187ec5cb5a41f0dd7dc8dec3814c53efbcd441ca281b73952e3fed4f717ed152347f2f40e2db08d40d4d7afe29f7f14be0cf44f3b768473787def20ad5fdab1a581190967511c1a799cb10d980070dfb6bcf3594710ba4439a02c61e2f90f53709c10ef8e3ea2a0604a8a429f5196447317e23a8b93779fc0be542af194a801fa6a352653d60e3675bfc72d051faa4e6c4af8c44f78134f6b21e43339ca0667c1259e1889e46ef032d00b3d51de7d3d537042ceb27273b4cd2eb64baaf4d38e461d5cc82d2a3e7b00b580ecfff2ee4e31e0a50cbb6a51d0f4e38f707e7386b1fafee7047bb4be58df146799858518ddafd762485f8d1ad70203bae42ba91d8115cbc2ba18ffacde146ff31ccbe7e50ff98d7890a2e73eb01b103f94be13c97852e90cc68150b4ee6c8475c08652a025c81a34e4d0387ff1d937628b33eeabeaa71a2ec205988ed20f503f0e705e97bb9eeb1d4cff502aeec5bae4523fc3979c56cd325bf6801c343431031ecef9dc6a9cb5b9d2a4ef9cf8b8561aa066f1c3f7ce47156214580ee8bac55716dab670d66f9641cdf9d24926a58eb213212e320c3a47a84f73f76d317677689266fb1203d59604e2ee69151cb1984e2b31883a0d13726e4c2cacfa8bc2293ad7a21933e31e72f5edf16da187b4359b4ec84dfa11d3526f1c29bb696be75905c6219508672af20f3d8383ece36f02dc5ff9ff5ff1d2d8054bf8b2abc19f028f0ef1f3164c197a0da6b8233c703b06f10888cd6ecb2517042a9bb5d3836eb01f39498e71fbc0a58ef6d6743842b141c77ad345a0f7d3214658b84a16e08e2ee8fba6e25cdfe6ec8b1b1863312eb79627473b3b777cc722eb5413003a31e24c9da56a949eed557701de88f5e98215da03c327fc12d849f4d1bfb5bfe7232aefa956d81da6ded594abf5f6c4595317e907991177e3b29da72b9e391de9a819ff07d1f2050f3a87303d13f6a7c2114497badb95b5f8c19ae58b528fdd14a6b633d3263be6641e18b4bbb9abee662cff7906ada4ebeab289364dd1688029f04da81de548a1c39e684866d42df74eabeeae56a66bb0e994087ad7c6a17852b2c4449ba15aea63aba0a0a33acf58087414f1ff5ddd2f922382b8d69831f61c3d15fcc55eb3b6889592471260bd9439a2ba27bed9cad69b667e964a2afd732b67224ddf82eeabff1bc12da4156c99314397dcc7fe603335079cfec3a2ef499800d0991da5f965e93251732a3d3635df6e35e74e0e3498ff62114db0222732ea78c678bcbeaba628aaf89d3ea6547ac30ca91f85a24f9100c5322c1a8513435ae277604e71dfec48fe3a50d27bae7d2ffb71578aa21c60b14e636bb36ab2973b0c90bbab2c8102207001c5dc1cd40fecfb291be4a595f73a14d4b57fc2d2cd0fab003713bbdb747e2eaa9fe209aae716766f67f00f90b72c4c910506e5d699f4e969210d4c4585955ac7737b95d7df8ef86914dea336ff56687ec7ce0670d8ee32b9f58ee8cbdbb8d6abcd72ac814daaf1be5459e446ffb73101645db2337c86338cdec7218aea48f2ea881a2c5bcb7c3045e1ddf48920ff6c4e31a9d90865a7cb57f9c6ffa6f2b0510d728e91ade4dada7a2576db7dcdd28c9c9745d4aa375f06c665febf6df6e713209a7ec1e82ecd6bda7d32319872b9166dc64b0c281bb7fe7531879fa89bd626c57eb7ba93a38d7330f291a5ced13fc8ce7e32273a50afc33a5ea67fceac94e09526ef91794b741ee92c3d86608c5093496074ba7d8b3afc3388b34d5c18fd544f1e2d6e00631f49d92ed581ab7fe9491cb504e47faa33c1677e44b4d7b8d6c1022e444bdf9eedec5ee680c47c8e793aabdac531a1106de2e1e5668af83372a2a7d8e074d988b678664593e900c1a951c20b5ce9f80e88e9f6e3a52dde38b4e2d99124c44d8253297bff11c6574c3bafc227335fb215fac428b6387b5eefad3524e1f5113925c6b3d3a880ebae2f24ea1d6f2fc70da42948be8c21bc7135e87ba76f34c4a99c7b90884a5d0735cfca8ad1e1124c6607d59b18efef15c09aa5b0ece3bd3014d0c6f0fd44f9508470e2fed7854a694e44cf9e7fef91838714905831c7737ff6d194f084647775164129802dfc3a2b24e07bec71ab117817d1024f7acf80f02ac75822a528a20e75cdf7a77a11c3e3099b5d8643828cff870eccbeea727802f0a69f075575dbe9d035ff2111aecf0f3299c34ed57ce6acce46834996fd49d0b590902e754f0bee2d6bb252153830a198baf42a360d607cbb90785efaa437dc487bcdebaaff7e87f3f36055b7c7273c6b6e5ff27534ace867c66260d9167756db5d0e4a462831ae28dcfc7545d4035d0286475e96e3e8ea3739119f063feec06ef870093aa0f3f68d3b563db756db6d273218814e3d689d2b5e893bce686616899bdf9a31351d29e2ee4d0eb686b647b90581cb15dc074dee09ec86467d93520825dc36bcb974b4b4e3303fb410047607f0b143805cf9153ace3dbda09256f719ca2792df8afb6b01099bee5ecab53c2b5f904824e4cda355e3071afc45d50bfeea87c78d7bbb1817b6637d5d9845c3c0df349a0aa3dbe8ef7a8ab3745548e7d46d3b4f7728884f6eb31c3f5be8c5559915b458c185b433c2e87e55cd29158d87bbdfa1fe899dfd7b48a8671b0b3c3644136eca481353cf9647b1d400621d26d28c992744df99e9e7b7eb9765fa87e2ce1418d06f9de445c03a05e3c71adb860e9bbff4363c820a1e4f52e0e041e8fe1efa231279f888e319e5d0b8776cb78e0194a501518f2c98a21b857150171823e9790b737fb367bafecd32b9cbb05f8eb0f0a81e8e82255c9a66ba452c707bfbe2c2435c941cb8cf3865130000bd6f443c19fa898ddc36efc61c016c26ca48338ba2f1368385d1a118ee07e01ea4efd3979890704fde2e679cfb8ee20d75160263bdc000dc87af53232b378f97d9bf14f0af875959fb111176908a3c150d2e67ffde9b67266816d6f2b286e87c27318f354da3398715f528f7aa297179c25c4f3275421cc8f7a522f5a1ccdae54f14c4d2184b6d97de6bd55389a15a14c322c8f90515891899761e1bfae76415ba8bcb1858ac0ad75a69d2510c56333cdb7f97341be4f348679746bb4f36b79e9c5ab04a4dddb6516a39bf67fbf2f61bc57b0201c1b18adcd4e7afe19f5823b9cbb4bfe22f5b8e8fc8a5b37f05b5779b7fb33a140c8fd7bafeac659deb3ad18df6772965cf4863086f4d18babb4de6bedbd98e534e11cb64457a49f58f4e3a86e99273746f5b975f412a21523e6e5803989176bba93de10f044ae8840af022055e4fa4c69061cca7892cf48d53260e03c0a8b2682b9d17cca673e0d47c88333b0da46dc161f1643a0287375676315649720ce2e79cc19ce40c5f15b5edd2dae38e4bf9a98101a693e3ba9ff2c40696b72a4114b9a5158fb79f5e8ece371806d0a285de1b8694dc30c16b3bf14391c06ec0ebfb57404f6ec45bba1c91c53335c45847ecdc52703e5f7c64c435fff56320ce23550052f92167ec43fdec98797c76be8a305dbb853544f26dff0482f36d14a2ac1e9da75873355e1dd5ea04c3db0f7546119713476b924d68117c4cd908127f9166946d69bc795e5c8a37ff16b5555cdb60c9a0819afef958b6f732a1a79201488c21fec28cc74462cb34fa0c9e89d88c5b3da0e0638cd1c4aefbf066e22f4ddc6e648f1a7abf0bf8c2d47930d086d384aa51c89873abe6da06c1d27e787c4671c9b90ca07faa60a2ca89a61e416f9c3fb45566b8d125c93d3017e7caaf2ccac865bf24ea2d73208d98144e6c1b822657e3149d8e5217790f97adfa15cab2c706bdf652dfb7d686186f717cac65f77aec607eed37459bb017cee0b4c6fde0a3638e130c72bb5ae20f7fb9a7b17bc724706aa30e97b9573055b366eb56ea4ee3366f62eacd6a0d715285d5e4eff726822b5615b5749a020dc6b4859a104f4dd737a47eac64f290083730e4f0ca00193ad617a4146554b2f32d8d10dec6fb0afa54f7b115fb1be362c1145c28860ce331e97f796ed90932fa3abd589f1c8d38d38c6f81d5d39c99ee180f6e78dc6839a5ca448471075dd874083a5e3940ffda25165a4a26caff598edde5884dc0b2609d3ec07a97e7caf20697e77d8b466305ebc0c2a5ed0489506d781f217bba10bf25d62d2ed67644df9b2683ba54fbc5bd1748099715417bf46d555096caa3ecd905f89b40fee789c789d42b6c78ec6acbcd6bde9a6d9895097c4d0adf68263709de449b9467c9fd8ec2632181680fd3f66b79b5146220a16ae52f09c90d92c5ea8b78095834634d7d9c46cebbc9f0a98d7e78a8615cc1418904af853b2158bd6f38ac20a2553fe1dc8520a54f5f9f6a5e37d85fa65d39d1aeccf824be78c14c1e60f30f23b785333b39be14897f203bd8d2b6b3b0a3dce3b464b3b2da8f3e9ca7e66e67c6abe6963e47206f188bf717c26ffd601250b2f77d5f51b97d0642006510f3bef4f3a0d8348890e791a7c983f56ecaa06c73f304d60c80bbbc11dd8dce9b117fd31d7d9dce08b69b7abcea58e2588919bb2e69c29bdf0e047bd0257e73f143fc6b22904b90e85517ecad8245024a07b67b0318f18c0869f6b4f460f0470cfea407be9a98a5a8f5e9edbc7d99489b957c852cace81a07c512da36fde01c852432043b6df3b0872509ada54ee19c49b2f4d4b460a0742fac5116fbcc1354a5b690f44a413a233114b0fc7c500440ab6a0aeb72e9021c577bf5c13b3762c80c1145a4a85aed4fea4699b8b6cded95fc1641e08f3a1e560c6844e289750f9e9a5d7390bb4d0fb81ab7ad361d19841401c74ff0596888a8d114e12b461243501fa025796d36c510708caeb189daf5500a417c1cc338f2f5944c0d568b06f98d6e6b094e2d47e019bebdf51a61975489d6d0e285f98ffb161c4d4d9f9933936cca0834df277bb66354ba04f736da3fe25e268c52b26777b64d3d3dbed98b326cb0470f39f59f6dffd3ccb3a8ecac2509fe176b3c80f98897cf90a7141ce0fb899ba8b2090766760d3aeba63cf61f724cadebba78484df670052a9a25fa5378dcc215186035a441b4bdb55b80bc6908a4ced6da379294f27f309d553370426c37222b8cf512a75d2fa7422235139fab4ed1563b22d8b6b00113d3247a2a5677f5028f090c623435e650308e4daddafe6c292c5298e897d8a948d3b7a8132d48a1b781b3408d582666f05522f462d66f57074883bd89faba04f5078bbcd8af28c9f80df70f1fac746c8fd712db02e150f11984252cf273613c87e4d4905e78ff4e755643d04de2a55bf111cc83e3f8ce33bbe1c03a759f7ac893a6e24b296c55799176f998f6a98b09a343ce01f663bb203b537971bf636884926535814eb04c0067fe8773164283c95bdc3b73279da5381754d9e3b63b0e6a96384b89157d1db30213620ac1488882666401e82118c641f0a15306031d1b6cf648257826593723b54d92a4bffa7aced74ee8cf038cee937bda40dacece43680fc6bbb654bd2244f71176879a3eab9e025dae801f7729eaca8d3d290c56f5f5c01c64b28180fb327171cbfb380361cc8a347abf876aa6678af9a6f972ae5503b2629d533571eaf5b641574eea1e507883b1fc66d223591681215da5a50e6b7c8ee2065cc4b28bd719b47ada284f9968e77ca6ca9d58c4b7d3ec1f0af183baef282ec02817384e27a9b86dce908aab8e6f090442e7e2793b6035fbcb6b239dbbe7612da2714ddff876315e9cc2d3730a2c3f4e51a5f653d1a13100303b345e129b743d84b341e9432ef030d70d846a72fc016c0aa9f30b2040f10ffff61971d838cd7527b69f21151472441be99048e57aa0485698520c45a547f49174691a383241e51fc569353da7250316c18c5a152f2735a719e12ac9bbb5f6f779a86872004546b3c6f6f45d1509f9d1d96610419704fd0504a980d8c6f09a99087dbe0ba0f6c632b5c4b9841be1846fcabf398d80eb9fdf20c7106c14e76be01e2c3461ee421c51576deb1206791502a5ef4155f4ee49ee70c153ec4716654cd00f4b83652fb3b4816344c6e24b807680788a4d265f38d73d361019e676d17d539d4bbc7151c6691e4ed2cec5ceef6489ed48c345ea446840f1d315cb0c4d184f8027093c4fd203bc190390d47b2a02f15cd7de6edce7cee141c13a6a262d470162b0c53b116f6d8e3e710492f407985300c5fe164cbc601113063fcc149b2aec1628ad5a9d48fd6c1cd00d1386b9ef970a272346fa0a42a5e463ed3f0cf91bbff18f08d79f96d158fa0a640da79afee7df1911d5e0d5c934009d862bd971955d002a33917897d7baf09962d678ab1fb13f4e95fc04e48fe4a01559f214579b5fd4d6feb9438a9beed95c314b01d8dbbce34e9e8f8785ef62a1954d1aad423b32c77f44b3ad77314f7812fac53709e8f1dffcbfccd82fb4b9f00a9d96513f21f59a215363c1710340d84402088b0162ffb88b0bf6aa2863ef0595858ddcb8b2a2b11efdac7b2ac74d416784bae0ad179e03eb89de06def62b2ffb986038ffcec18ae87e070830cf8f686adf54c922a14725c4045e7266986f63e37bee7c8a7b38baf27732a0cc1fb4ce460a3fcb7db8ed2079f179fc5c51aa4edb5f1fdbdbadaaef064e7e3d8449826c291a16508367d450bc4c346bdbaf5a3b5b36343b80e5e9a01e5fd32c375b7dbf0e5aa41558ecdd41038caa5633dba0a5961109b463dba39725e1c9487c60a923703b02b5e4b55cce6723e33780b6cceea3412b9fd9f7cf137f64c49efe654a8169db0aea3de6fd4dab8b98f011ca75d2b9037285da0b4b55edf2870f9ca479d36b0cba142dc3dbccb9ef01be3184980abae372b8e325d26f1bf3f533a1e07e909ae6f743a9d8ab3cea5d5333417ef65cf22b9f372ecf0febc53d6ac22eb19a51119d7c093671fdfdd36713b541415ed2615f90b851e4d05e270b9a142c1756d1e24dc07c2145cfa2568f2eebec2007e94c26f22359f7cf98c0fa3b635c0da4c989d930e8816dfd163de2eca49d6de604948001b847e2d9c6b695e3f3200dfb2632d8c38cec5aa93191cd53501d16ed57418429769cfb9d1129095a75701736de8a448927ea3492fe8a04247b83435e8fd0c34a31a30876aee11ab3cf86e82fbec4b382192ed77ae172b91f1d251dd05c3756bc7d8bb93a953838d82f25a2a18913da6c38e400ab105f8c8afeb271efe8f30e1073933014b676e23eab714ca6d9f3304aed5803dba883d2a62d9b8cee04cb9197eda47108c7902766d7cc2bea1c29fc37df86a9f2fd7dd52247dd0ce5adb4cf0d32edd280469fbc97db78e317ab90f40ad759d8181328c355c607adfb968208f068aeb2ab96ee52fc468ef9a06ae0c1876d1b87032f8d6a5233406753dbc1f113593fa678eabbffa74636bceff7deb7df7ab11578c8ce6eda6d420cec9f41ba079932d7153e75f5b95e6644518069997227229fa693768b350b09963a710e37e53c1b21be008de5278923dfdff1cf69792469295608795fd3f2b95ccbd64e97748519922b78cc3c4337b01a0250906ac6532a3ac254d64c4392d0178184a804182e528f4659c4387c0fc9e583797e492a74be476583f22c3f019654b865312d8044c4352f61a2c81a39410a6e34fc874fe041f72ebc21d8ca991ea2e3574d270b35122dbb066760e92489e2934432d86da8b193b955ab622cc500ce423bd30e8d224f072fe3e19a7639b9d30d6f821b9c7438e2aa1e0f6dacc5ab04464477d4d21ac2b78f8e12257ab6d9d4917046f0276b5e7894b78bfe978cd03397ab2a50ce09615ade07f41c73258e56abc8dcb959582ef1d42f20964c683a199e241ebc6cbaa4a4429f0f3731d525888445b01ad8e613f88693acd70fa5fc81aae1768f378f3cb720e34fc593b9ec98755fb6996620ba598691e0cb1c779758435bbea0bc54c6370cb26e8957411bd1508673e7288a993c2520e5263910d17b9c8f19f56a3c4bde709d4ea7c76b6b8bf922c4eb6d8b1c865319525dab19511a77a4adbacd404502656e4ab63abcba0dec78fa4434144bf1e8383c174bfeb24f6e41492d8f549400ab82505be5dffed566c272bc8f596ee6347d7db36ac3758a84e082e91f2d2edaaaa15e02f6e13d6c8f7fada32501996b6ab88b644c83a12e5e68a662fd44e3de438e10952b45d8a1af7d634738c1464ab0973db2ea95402684f6862e6d3e57df99065e0df3329d7c1e5855acf1f6669cdef4f20d0d1d360b8f3533b2d8441804178bf9a289298b74d0d273fccafaf1af53290d9bf487c4bc96f4b144b6592428317af8d44f5076ed51727476c2728011a25647b6f2eb3c596b7c3b136d9f83268acc345510af50c1f044b9df107b5e641b90a92cd076359caea255878604fd461f8e7a81dd8fc86db26be5ec21b8d670d16fdfeb48fd206dc791551588b3c0395cb712de191d629697fa74881f06f0527030f49a1ddfec4d087c58d4acd89706287453e4b4b50e4d8a2edee024894ff4bf6edef0a692cf1bac61db6b70441480c029f4b5825de2ba467c6bf14cb82897a172a09a636ba845559dd1de5b25b08ce03baedac1801659e3b2c833ce998496df2fac68b1cb1bd04769565e0764bcc478a27d8a5913a732933b17a04dcaf0698ac294797e7ec3c2f17fc142ac8ad6be41ebac36eb3c87b57702e21fa7c231603de50ec5f19f7c9e2a323cdf428da4180325d4b736748d680905f3f145160201b5fe80143e6a0c3c3631b409b4d29621af5bcc851eaa0e96109b22086c3675ae65e985a6a20763497db6bf6d7de102d82b1fb2ee3fccdf07a52f8869c7b9a8d3cb50c3c95199bdf89d5514f1e28a91d7644f861288314154f18cf21ae512ef16a126de10602f2a70eb6f69afdef7bfb5409f2803db45a3ec2ad1acc82692a1756b0565a1d85fe15df7f5c169c206cb8c6ee3dd956bb7d04476dc86d87509d22d004d7a7d01f6702104823f146037a3da710c484a278ee53203d7ed584147e9d15a4e6570a1b84e66ddd2812ad2412bccf07530b7c8132f9d318cd33b94fe890fc81696d98315502015e54792c97812c61da3145afd92f2cfd2fb753be613605c7b777b8989103ea6951a32bacd5183140b9762e9367b3978df59b52bc836c3f3c09fdccddf3666703088a0fc088e9d80150f12dce7c284176dbf3b731fcdf3afb7ee0f54b6613775921aba700b50c075529dc26930d5328689e4d4e1abe5154c32698df8712d20e11fbb565b1797ca49db6c6b7469b5bc8d94b14bfae18e3faace5e93ce5a2d72a3d5ff1931641d511cb35e0c9453b466c8ba14c2b74794046c833d7c39318e183809013931b6463fb2f384d6222e7a92164ba56f30b6e598b0742377a5a64b6e8440c84a8fd0c624ed69d75010bac7de4a290be58d502e82ce1b74603e1e5583c4c8369f3ee149dbfa190914446905d20bd404f48415fac56e2bab8f15b5de2e3915fe029154fd49a401903baea15f5609ec68cd0ea30a29b2e7b83f9b94b2c5d0ab53d43f4d226b9f27d56d645bc3e33769b0995574c20419dcacc1a8126f735df28115e19df4113f8b1a11b41f673d5edce87d7a785eefb83e4ff751f26b776a7f8d84c2487b7cbd5b682ab18cf63d8c12bb41ff07f97a2847f4fcd1964514a8d020f7119945031278226d34ec4cc73ada7134828355c954a6d49f8ff64cf81947a243bc99d147ebe185d650cf45c2d19a998284fd40b4f14d0d970d97a920e713d4e73b7776149d15af9034aed12097d016856fb34053b4d482ff180be8e86a3d458b0bc4adbcf8c242b3b2812a8b59a91bf310cedc15db45575b99dbb4647f177726f4c1eb1647ff8ad9794fe4c1e2a8bc55c1fa4907f5352798cb83183b0c04d4309e803b16937d11c76787ee94980cd724a250956b406523442ed92e1161c0ecfc24072c544d4f85dd2aedce3170e19e2461e8214f44ca763a093d3d8963fefd590e047acd9a32552397cc2d405ad1240b98e11de2c4341ee8738cc39a7ed849851af130e3e09666f47700e5a3ae1921d980c1c06a38b251806b8f051855e1b698e655e4d555b9dda120d43fe4eb7e2bc17b8b1865221a45767270f398cf29fcedd9f09d4e57c9c95278768000532b4a7cdb774080a6ac35620bb5d7aaf48d0743ebaa0dc9731caa9e3f190d1e2f1c3459035d254360c410d0424753cc78925916e79f01eb27d2cd49cec75a5701015b5741ad5409ef362514205c49dba3d1bb4dba7b664f324252af5438d4a089b227434c4514734e017f1b827097d5c59f0d0bc2d9fb377b594ae642edb85fa87cadd9bc0cd92520a6ba6488d59714bd501ad78a66d0eefc0371feba187cd949a3add0ae6db6e0aca2098e22e0c8ce91776d2f2cd69feaff48e4a2b20de5b0162e020e856a4cd6f199e6c11520129c5dbfbe3276bc695093625f6abf8ffaf52a0a4c0aabd05bb34a638ccf47108fb9676dab22e2b44e97a765a484353b5db5068d4bdb3eac0287b1db087aae27d0292bff2c6b76358287d71e56c36af46b8ecc452214f7970b6c2d526e5da5632716d79463d3c21fad39a01210a50887cddaf8b833fdcb92cd5f817eb62b2f3f15205367f2f753168b1cfcbb27f3d19691bfb2ff5bda1bc534993a7d0d392401595fd0e14ff2863c0aadb70bc2f8f46fc18d2eaea1f066507f2051b22f82508b606c7dadfd0e70ef2961fe03aef365ecda0a37eaed4c0b873e029479ff1f3d732f15fec7deeca90e1cfe1f5cd79acc7b4afda89753388d28160d12d53e1aaa8c28e35f5c28946df6060e6a80ea11427f7a0f151bd0aaa4c0576f8661888cf36da27f2834b2827b16b8808eefa9673946b4eaa9649d761d4ce2aee6ad802264598a3a455816917432ea9f7ca8ff6b0e771958c1bd5b173bc05cbd61977c989244b31b80101ee9fb8b60baf76a9f43829d3df3f6967cf6412d26db3f8000f063c840e8f746c128ab109481c964b56ca97e953bdcc3a77fa75a1ab430f3cdc2c022d1e5c48521c7fd24a08ba7bba7656351aec5a6ed3047f3bd454d2438585002d95d010fa6e3afc071c4f891b450f529fae924d040714739fe8b6f57497b206fbfd3c3818f9c332e19453f031e7199cb92ffa47510b784334525ce9dd6333a398d18181726cde51b645a38bcb721ad8010b8542453868eff89f7c88fb28c2b1bca75ebb589b9b58fb30a5f65f9b817f309e69d0986c0867bbf184b9f1f0941ea1b0d6be713150283a2662f7346f177e2ee3e01449663cbf234c413be1e890a707fa94214cc13df1367c36e22752950dacb525828390513f0cded40cd85cbca04379d29a9a65a662a432fdc1b67096fa69c7a55499bd516362a557f00f37cb577f4353330f732e68a2631a145d934230a2f57ad33e2d9fb806f5b6b30eb61ac1219115cfc16441dea5d2543b8d163cf5e1d577457e0d7146f117bc9d591c9d1980c0c137f70fb13f186650a203e8a07e97051ad446556398f1d35aa2dcd3a7e69412a15077cca55aca5032476b31264a597f2b63bcfaae9d12fd9549c9f70c2ff7061664546a82d68cbc557292363d45c9a2bd28fbebf6415757dba3e3beb630df458dd743722418821078153e827dfec54973145e4d600d1dab696a712f5caf1565786809bdaf67bed7fa451f2f545fca0ac947dff8760d5a2330ddb9045830cc026d1a25c89564c59d842146954a4795e79bea86c6ae6466e907468856f8b7a3b885ff1147ff0fa45274581a058af5307cc3cd975eb74081adde2a521b1aec7161b35901226d2b370cba3f76f5ed72903c366e52cf08c34a6005555737bbda5b19e55b28e9fe93ae16cac16f8c3d6cfc604bfdec3ae25cd38a7642596fe152ab19237daae0930da154ee2056673d2ae6f62f151f701d3025b49f2a67a10f9842b5421d77dfb7a1a877375a58c3fc2c213b3cb9e0bbdb7f709d23b2bd5eb1bb83f259fec2a0c7febe31ff8616005221ca037ea951cb0805d316bd1bdb72efc3a5b3ee878e8b358d353111f703cc6d7d08b1ac6b2f126123a24572b9a3d90e67be9f0bf063aa3e0b6695b2e7d41d375cb97d00c15e1a471f0d30aca85f732471b13c4cca4c28e3a60514e39d0bcb31523fdb159fcf4b1bd7c2093bea6506d9d3795b43b4e428682b32596ac09059c39143c57a14115bbbaff10ec179586ee1941053d933febd639a577dc9dabfcd935b9aa3bcd3c6dcbf8740a4a0811655a543759e8426f795e172e78ee783d2ecb87005b6bf3750ae7bcaead5a92d92f24a5b8ff9b48802ce580a321b97347ecc59f7a6d5553cfe996972d570ce96bf5485afaa9daaf487b1800a9db0853c672bf6a3f3e5b9cefd1a15810a4e7a1c8a41b6867ef9917778e1dccfaf49b7db9a0c7dbfbc13a1e557c81ba3266ba8b8b06a9cb84491578955f033b037c4b714f0eb84b17b1b382143641cab2845f8ef19990caefc7cb71469c84e4ba9bc2c4a17110c8414b739133718e910f9ee6540cf480b7c40f517cfe29c8caff9985e3e31bbb7fc4dca3cddcfceb9906a7f9dfac010a793a79498ae287a192c8f6c1b45878876e187ddd3a209b6cbda212ef710e9bafb320e08a9cf8c45d711cf956a3913c3f0025777ab32daed6ec6bbed9a4d1fd5661683430ede370f097ae554225ce6fdff2005526d6f703af721fc5f10da9507675caadbbf03287ff66b375fd93f73da3ea76c5c49f89b9cdeca0eefd4e15990ecb91294d800f2f224998c2804a3d413b7396d9f49073651e1550b952232c170046f6ed2cf4478ee61a8e36d9c0a966b2349266975c23edfac5c0c81bf788a1e41b422126074a2308b623edbfd584ca3711c0a3b528e207340ca07c027d3164e766595835829016a85e496d4a6335254bba54d99e2dec3735b2d7107c386b545d280913a0d2ac3ec14c483d91dabcccaf0a208927e298a67ed9f0ce1a246629261a15681ce8fa78636e9957602003a79030487438c55b6ceadb766024d5d9c6cb300bdca3d2f52964a05cc0d64e6e30af83b6b67d19d7f2ec9fead243b569261e50a937af46df9fbf21ce2c0714e1c78708af3","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
