<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>请输入密码</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">请输入密码</p>
                        <p>此内容已加密，请输入密码访问</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="密码"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="解锁" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"f555c41e5bf0ed7face5fffa2a748c761393dac04d9196d49d113081086124aa29ab26cf1a078d6b316bf344d342024e1b979e869a730b250b50c0ff4663863b0ce92b68528b9064e45bd63b76fdf5b196c5b2e2f2a69ca8e28908eda1dfb206659f43404e72292a1463b879f5fe1480c90785c10c0b1aa25fd28e17d6b6d4e76d07945d8e06af70c202ee8ce3b7615973179605f29a1ca4ff5aa895e242205bf929ed77b918a53e4bd26656dd34371eca9352a8b02f1f25f06bb81d17f601fec215810a9e7e981d76b03883d308cb9b15e81773b3a8c9936659d3586d2a057eb95063198027c1ed8f7b1ec9584191a6768accb40a9ba7ec967d1e0104f4b89d5a53af7828eae3ad4b9159f974f5801ab3e3a4b4339170ecc51cb087f07c93fad3c6d3423b15eb5e174b34adfccb929282c28e1756ab660806ffb1f9cca50839a1aae5d8dc3ddcca012d9c31f42feb17d9e5c04a46ab95f5edb65cf7ac7e4af08d9d83357996975e65faf0f0e2d1928fbe138dd7acd43c0386a3a1bac3131f0f106897950605ce2b253bb87ffb4ba0d02832e5479ea027b94b6771b83442ad82c4aeee448310f99e823b606660134fe2dcca1bbea0434a432c5e97b10a8563156997b91505e74b0b126bd6041b3e62fa508886746dd1b6ec344cf1094262aaacd72839ed2ff409d685072a3f6671c158bd5ccb6e642b2ebb7e42838736c6c6d6ea249f033a52ec84b65298f2f5305527130f5550e89d84370ba6d4c7b3f02286986898bafa5eb7aa082ed12fb193fe83d32e01b83fa8b32bcb74b598db6faae8b4150c2c445fb6e9d82da6c236ce33f61b3c3092d9909144b1f128fb32ce5eb7a7e6b83eebe89c04a4fbd09cbfc5c4453485a78f261dbef387f0deacf146294e82e7bea5c801670ba5f38955946963191459cc3fa38004c7264078c029cbe31dd160777b28cb379f41961edf391777b100b46fee23fda9f76d4c64807f9c3a1bd992d090240ae112e06506a0e15a18b4f66047c8ebabf4f24f81faf2da89016be2ad1b3888731aa00785757e4016d9c8d894ba148661d9077b348aad9f894f51f1bb3b4c6b07b26fe5b067bb4799f74e622ae53df4a4633eae2071053357a3fd0e885594c2c6166935e3f73800f4eace36d6320a2320bd676f726d357472d6e2f7877cc5f3dee9facffb9555be3fe9e552d6669eb9d1686060902a850602dd36ec29a68a4280c912d258c724bd1c28c5176d00709486ca9e39bcaf78e4fee4e4fbdfc056d5a1679031739286fcf1c4d632d3b830cfc93e56ac80743cc5e4cdda0303ccf91ef492a473668a2dd8d9cd327c14f84c86d9d17eba66bc9473b243b9286b879200362cdadee1fada71a14358921a2691d8061c8940694f027e3660b6db8e14cb64a2a4c4387fdd686c83d25b8371edef2cad00b465a40dd281258633bfdddedcee389919d93065e46016d43d379de3fff1381002659879d71671814e24eb15a7bb3133309e2105cd622e1b09a52ec5894d2bebb36c6d2adb2270073b7453055a860d290e5d5426be10d36c860299c668ba4a577c5d7f85f20c415a44a8130a52972bf1c69d707cc333822c2a5f3d49f51101904138a24d0202e97615089b1101b9a66cb522ad7cf15c38a751f01a5a64f5d65123f0b977ff7c2406c3978acb77b0f1ebdd43dd121e2e2aceb342dd880e016bd1f4b61ac0a7f14c7ecaa5f15deb4f1694955a0d3b5fd9ddf2e6cd32c4bbde4507451fad0ce5ce28efaf2e2df5ef7584f40526af36bfdab998b6e269466329488c0c0c6710f247d420e06985387a13e0b7e9bdc1b06cc1e2ab47d62c079cb2ca2693c0204b3d8ea1e61d7f7cf6bd3ce6ee1c829124fdb7ef71062dda6a6e547a8b32b647664df94e591f1617ba7b3457581d5d64e63b91b9e3570f2a567a652a2a438ecc1e2d491f68031ea5d2dccee50789c4d16bbe9d737ba1caa50d6d3fefde572954655fa2ec56e63e2f4ff1a94066176b89e6e024b47d4a699f3bdeaa0ee6b292371312784f21dce9e30be68131c85213d379e8624d994dbcba60b08b55aa11bdca45da73cf6f96a0ad057ac04bafe5394efee8070b360a24cff86b8e3d9c24dae592c7567d69a552a643b9ad62b7dbcb65ca028ebb6b355b5ffd74966f2c3f363679d8d22adca1376b62ceb40df85fe29aba39b4ce5f8bdf8cb1df76f747bbb6da491265de411bb7fab298dd677ba713e0e19897debf1de259a2adf61a347eb3fdc87bb9212c585c98d65e063edf45afb5b5ade27d744b145fc3785237488b981f21b93bc21537d3efde6952680cbe712fcd6cf33613ace8277c37f9b52e9b35e5bf6e405c42e03f5ac60f68ec851072322d073a97efa51da93def6d31a63e2c01cce49e3690b21b3364a95c2ec866a295c3a20ab0c4fa369e881879d42447caccc8fdb94eb7a40f27dd6be11cb117821c87ea191e194209f02f62670ba22f2ba9bf3345f20aaf5e16fa04f57eb2ded8349e40229c8d08bc228e8f1741371751d0d81b254f7409be86c7643932e916ce3bd8ce075b2b0b5148e8e057b97eb857293b36a23ea0d977f6a86703eb50b9f7280248c180c77f34235fe5629fd5365846426d82bab8d447ff168f3c73a74505a52a9dc78738242cb1f97d105e0482ef6c320c4fdbdbf349aab9f89cf7954e8e025a9b3ee43ceb5bf2870cb60f1661558a68f5eaa68b2e90a516758bb3faef876c006fe0633ebb7a548e6a34804f879bae1b417ceb764398779a5e5abc61a5ce008335487f5471675876e128c92d8edd5b278ce1b7d9f05e29ec008aefcaa440c21562c7c7bdfebd2335ab7c9894e03b368fd145be91618051de7a79424860235d8be57602381f7103331768e5d141fda6447a807ff2da109ccc5a5ca83988f8e37bfbe099985efe41eb772313428be2c6a469312fd325d7643efceed5b0a2529677331b3c27dc647a92fed87ac842359de3b1273277f2614c17bf72918a5398685c15e902d209b946d6ff58a2d994fcc5d2494cde32e294902b28d3ceed580564a47ae477226e385d46450d8ec5881ef04925f11c08a644464819dcf5cdc197466144ae6b5a05192ef786a5faf141b99c99276492741e7c5f78c68dd2cfd5bbb53a8cbc70e6dbdb4b5a83fbae4580c6a7e58a4084eea89bbdc39ae19fcd20a4a7cc4cb6f32ff568b2870099dbd55ee383ec412c7cd91e27fdf1e0e07838d9b86b375f0c24ada85e0166774d4c06cd7612e54a2eb086be892806de732ff18d99b0273155a2c9438a7c46435beeaca94e39e2f82a98afc10dc5e3699eedc137bc827df3c350f7faa38e962bfbaf6dbd5dd2c89679ac9b3833b67d00e2e55d701e47b2be318b119f862718ab55b9ea5505ee9f78b88e8e82a804fb70ebde235efd50a32beaa47a6340c0acefb67b099d95178fd9273f613b8f45ef17fa18da2a82926aa0678a672acd9e7972d6b2b0cab928c24c3453a839248b80f26e0aec1900a84c900cd75b6f685877072d4d0dc369bf471baba01579be21468403079ddf69ec5c01259d0adb5a8a3a283c68117cd4c9112c153c8c5e0530f197d4e1f0ce0d46263046efd044c3765bcc3f12f51955324baa5c234c9c4a6d2daa383449fd21891c4fceb8ea25a37e42c3122c9b80a8c024c694bcd06da252cd888fdc89d43c471cee9ac1a177482fe627c1215d89d6fa413f3e5ac9300d69beefb74dc098a950bda6adca524470cbd85327cf49932a317d9edb306708e4f46de92b636e7ab3f830a6b70d130dadd95cbc527a8c4ab306edff997742e458e1e081f97c3f2c276766e9975734ca3290ade2840f4d757c99bee6ec8a50e4e60c57507131d08f13fe0eda0cf2c26bd972370075767495106b2c42e70647409cfa3c3540fb9071a3937d1beac031383e6500c4fb62108432dfdb609a152f65207d4620937b4ded79ed85b8a9b9823234ddc2292118aaa3a679dacc871950cec0bba3aa3733a9c0a856173b93850eab27147dde31afddd0d0e3318514c836fb0017906cc4f644ff0d3680755c9d02d63ff1587356ea1e9d7d8110cabeab4af36f50e3fcbb35f40024cc59e46d0530e90b850fc3fc64572f876f1267d0c971b0da11ed3515e865d1e7e2508d56bd0053d634e6e2cac21d4c37725973baf4e05a725e57d0fecddac189fe85cb1f0c3b29a276a40c2f43049b058ab134dddfe3dd784cf6eb005f1c04bed8f9237f0a6a645c3deb9cd335c60053ad11fe1edc4dd4d0f8fa31432b791f1b79218635ef7395c7f5085620d8b3fc214c91a08a9941de28ca98788ca1570d3050b6cbe31f18794be271ef498d73eff4d3afe9c4e992ef16d585fb73e2d6c95a7574aeaae3b149f4dc4d981c25af6c240119be0433579df71e71c7cdcc9e90f50a328861e65e7674049338bd1b920a1dd85f71d4888be9d56bcb680b7dc37d31620fc41351adcaa4bca62b05877b3b3e21d7d153839317c7d9ad4ce250f9d033d1cb605c7a1b4abfa625c2b3fa83b58b6a6f7205b73193a867494489f29ddba18684295bd2f1165672161fcfee2c9c27b333000253d0958a861fd9d475b7d65e9e5c77b935440785e606a62e144f8db120b3371ea516185c55572ec5a628de00953740d98502f4201e01ab3cf6920383f4a3f187e50faa8b878d37772a8ae71f3ed25cf967bbfc5673913200090568201458771f0067baa2a3f28ead0ab42ee29ec03ff52b86a7517b3ee0acaf8d420a17a92f443939ff8048c93a2fbd59f68d5005065a8074abed69d90775fe8fa8679def9a5ddd74a1fddd72825ecbe3fafced5171ff9740de0cea3f9126b5455bf3428be85e82ff89c8569d2e0675558ddea3fef47ca188a07a308587d31fc3ce34a96ac9c04efb3f5df0111c758711319227f290479ab65343c9b2654207e34be2033d1192a9b4c2a27392d06053577ce9cd6a178d92097ba6f93b406b8f344b4891971c66a7f3591b57911e4b1ed9f3d1cbefce4dd3a9ff878ef6c0d22fb16eb9fe14423491513af9dbaa0be3c9fd990704f73a7ab0610743d6efe449b2257bced6ca46277fd853389d541a754bfbe405b10e682e131e27e3d9dee97cf9114d84fa8dfcd438e18cab5ffeb3ac1e3444d0443ac3b5f258842d302a34f502dfc5e4df3968a3ab15f0832ee9863048c36152c0eb98d5da8c8c5f5e22e48eb550f580d8f210de6b2e5a9001b03388b2e747699c703f18443be8d350660abb11198c8529c99182bab8ff3e23e451da26f135e95ad5fcd72a0e371a3090f232090b327e7a87acf15493cee2259b867c60343dddb328a8d0ef716716d9d099db6d442a452f52abc145d90c83281028d816a0dc52fe42ad374379bce0175c56ba7852c49929f3d598028b2f5c98ce1d93ee96fd94a83feef6de5afd816e7a57d87e300325a303a6a3b720404330527cfcb7bfb42a2f5b31033a178a3d6bc4e84f11e47670b8f022967e30d5906f1b9457370829ffbb6e58224a94a480bdb98ac34ce2499985c0de802c83ad9b8f8d8757c453ccbbf5733238d497e64b08065673892bd4b6fb7f3dc6c1fd152bc98f8f03a6fe9ac0ebc1c3c5bfbaff0c6702f630813f48df38cba3149725d1b96cf1872d361743ac90b75eb4e1ad83d8057f101f4c3d6e227deac22e6713cd64c8269547376ccfdd0ad85387ff57b52be66981eedacce57ffb85b5ea69d6d778b29298a80492905b8c4ac89ab8e8a0d65134bc057ab9b0752048c1bc433e2a22a3ec2353c92665be9a7aa5001848563356e9a9c7be5afc690430c8bd4f55499d1b19b8838a687c159827e67f5c97af2a7148bf04d655ad72fc4277d23b2e6e9d4cef4806db2f713e2c75a176e3545e1878178c9bc38dbd801a6ad329901c6b22fcf621a33d64010ff1d2cedbbfb083af7e71681b1602ef18a9b34f69a90f344d9619848bbb03b677f5c75a749a2d68f23b06acee3d0b104d970ac11451392202345f666260a395183f0421cb2d0b73b129b1e44d8301b36e644483651a3f277ace6ae6ed330cac7c765f025e204ba1b419acb60909d8cbe9b2c584d12c5129a6c618c4f81e87355994cd5a2c5ff6c4e56a7a3b79840a5d9f53155de16826b4204e3f0efed36b05e12e0b54b99cee2c5a349f253e4a4adec227ffabe9deae806f291988812c7277a6b554ebd272c76309a63a864c2e180afa190e62d68e62a2a8228570c6c6d509a870334c0cd64c5523e18d561ee20d21d1bcac6ebe8ff56e0e59daaea731e83736b4f9c1a3aefe25a28612b08c228fd3d90047d526e496ab745c276bcee6c96e3a64d3f8acf03ddd6cbcfb93a8ef5cb73200db05cc614e0b28ac2ea1be77477c72ebb39c0c5feac4f12750b268a314fa1bac05415bcb52cc2dfc9a1997eaa8ce24d49ec97af34b5f3aaad5af49a29c7b1d964837e457314bee5db674daf4044030cdd9192e4f88015d7c6b2cab6c0270d8a2c32921764287d0fa235a32815f049e2065413dc30e7eb1e07f4e19c1063b89f0aaf8eb804333bfb91c0d8f393bb45524115a82a7f28a72523308e9bd4af6e299d9ae337299813302edd0b5500e06dbfe81c61d524b89275e682154d7b1e390b335d9469a73437cd15d49d3a5e3798f2a4716f3e28f62ba20ea42291b2a5f15db0a985b7022df9081464bc6bc0467270df90579df1d7d674c549e38ab5b412f18f71dcc9d46b27cfbbba92fb2fde7c3e452d58dc2521c51a238ebdba7915824be49cedbc0ad538cc916efc57abfc5c60bbd8c3ccfd6c63236aa904a60c32ed931c8ee4cf0a82300975c4552d498630370e754691cf3d1adf9c7a34d12f7819cb3e45404c5b277f2ec8bd07871f655161542cb64c10ca1ee25560890be5dfee7014f1cb53aa168b348946bf1c0ccd992fd43a618ca1a034c1df78b574846866520977779df09263ed039d7237ac357af51d1e5f3e332b2fd32383745b8c0fd9a7473302838626de14b6f05d17aae4f1284d51c9cfb28c1447063a2b28da28eeda562ad0cf7bf346d1176511cc3d679bdae17f9f47da1fba3e49a1d4f216cb8ae32298653edc41ff044444a2a905d2416fa2a26d0769555a98d3cb8ceb56c8cf6e710567e67d799e929a445540634dae40919aeb6899fac018b5f39fe994cf5b7dbd2f50f2190d80614b36bae943098cf5b2b8197b187caeeb99f18120a691aef7ecf5b8c738e8dcda5c239118a4289464d32b7fd7a419e2f7e695398278d0e90e1cd1c7906e5507700adcd07679ba46b60050453580d786ba5fbe104c43941b4cc35728530aa2c1211cf369fd6aeee6e61bf3a7cb3b16467e642a8b4a50e7c01f9b4ec1da42b47866bc07ecdb07905ca4115b82592b6e96c87c94f1d5de788ea980df1a019342dcdfdc3fe8b7cbf5b15f0338649f074651a5aaa510aa19a4bc8ac7458a496c89a601e61caa1f16e8bd61e3ebc42271e71be1f6ab83d717e4379d8f685a744eedc029be9db0be2bbb44236cdae3d614d36835923f1beeb56679fb5fa88dc31b8835795ef670f8fbf71fd725427776c5bef40606b2bc509a863a9b6ba8b0f3220b0e5dd8beccd84b6648e0d517f0e1bd8636bbbaf72197dc1417c2b07bccb9ff53ccd5599ccecaf199749f78c09d3a8888bdd8e789a4fd249388816383a649460bdd1198bfd032ee8c029b88f83404ab774a002e242ede72d9662f2ec512d70bdcf2a75d26b10a430bdb0a51646f6f2fa4216c4172db221ffd0bf0f406ecde2514bbc439927843335ac08a79cfc302c0cc1ec7edefa009bd9c2581b104634047c1484dc5e5acf796b6e8912d899ccc1809d344ff615b79f5b57153474062a4af3d7e13ebf410e5f37df379aa282b756c796033057fcc513e7e05891135cfad67f008324390313ce96ea121e90af5f350b2b2cea3bf495210f354289a1fd32176f2d302c48783769cb931dfd64eac1868af5ba79efc7673d6bd365f1a671ae20b1e3ac618dd190fef10d15bfb12828746cdf0e2e0668076a30f692968fc1657c004940dcf08953409dfc9aee1184bd2652ec34d5ae07ff493c174871d88028ca50dd1bf1bd58a289adb648fa2dde8cd9fd5be36725cacc54b05f4afacbf0d9a7b9fc5e1e44268e40b1f349f347e989156ebd2c7c60438a5fd7b1b14a117382b1cc318ff52ee5c5fe8528da5d091ddf4f22636f8aaa9398a8e522f2c46fe414a3a5b6ae9f65d64b3e5af5117d2ed6f6c25552312ae36be15f40f27c070176e39833d733d580cd01fb5628432915e7f6f931cf04b957d8be284e5ab4e63dcffc821ca4c7b7ebeccc8c0f34fd2e9464f95d927f99ad78e59b35d46c447f761efc0a12e0cb9aa72f16a249b7e8b7833a1de7a10b6489fa5e233a081489ede313757033060c1f9aeaf763c8bad86dd57f3ccac1c0f433d76c579587c23b48c031e8c31b455d3ca587c70d75cb77f9648d51533b92488c7622ae370a49693a7c64eb215ab7a62b3eb2db7900d9c0d8ef448de0e6419d76077fae2d74b790edc023899209c75bd5d1a9eebf82bcb70b20921ed8625d2a1689f7d20fe8cc04b0c071b2a294b748b97cddfcde7da307e15178674783bf8b36e961fb7a2ad487220ca1e65fc6cd1ed2d82d0e38a6c6b6fa521765626110a261b007b458c1948dcfad64f65c35c84da1cc8c97f9774323b594d89bf5453f9e6b84004f02c9b444256cd1e207c36427e85cc8b0a278db1f34a49a822dc4128a43fc36e4996d1cc64c449ba8aad8e7a3d116db17527ccf3476eb644a9aeac320e898b8e5d6266496e038788963c7ff69364845c4fc7bfc2ecdb455d3a01b117a5f3684cb178a27207962917a8c6f2f703dade30140354db9c6680c72a64567c6b9889fc662b45619a2e7e3e30e8bf43a9677e3f4df8984d8d0634f2e0f1fbff5cad6c67fbde4c5b0df3e9f0fff2e525664e1358b0800e19051acb75bde1ddc02be4ce717971ff5db892980cd216a4cb37bd19f4e6d9b4707bd6e7d2b181c99fe3a47c799ae03de0c954161458ef6ca27336f742dedc1354ee863176a432b054cacb96496c86f3b165c74c418855dc26b3b7a99503daf929a92682aae1131079c12f202c8a7d379bd4c4cce2cb5f1065bbe5b124d30baf77f020fe7619f337e4684ca0d6e4c7fd67d6b77c0e3c6a3663dca0dbd69802157d06a128c30a63428faf3737e78dd901b501a1018445647155d71f7bc81e1a645a661baef40c8a5a7e1b082d8de68e2471b0a64e597d05fc9b3ebda9f79930667567bc79f4dd8fb0b6d4a091baec0b32f10604f15c8fd184116c4abf21d252e26d6ffb489076a2b4d8e16cd0d5b3eaaa9d3c170a33ed2d855ad021a34e32525fb43f29f828de5d3f5c6fa753ab60ca82fdadd69d211471adc8dea6a18bfae38a62d0cf168f07df914a26304c75729ac9b697f6d3afea67bccb209f60d9b68183d6f2299c26f5ed77a9d1cc9d4ca5e9e12aa64731256f76ba2ef65d7838c15460c43de95d5b68a67d045f148830a9c5ecc4f53b84db0941f6a72633ce29ff65999989b4bd95022577df6737e40ebda00f745acf36b959713c9f4e4ebb1e4820503829fd80cd75b081fe9411cb2c8637b7f6ec405cbaac15594437980c1bff9c3c7f243daff61a67a5940502bc9e199aa83ee3b5cae894967853010e9c4e017fe695af3a3b69bebb4077272607fb709c9051d72ab6ebdbda5c5c969c87148686f497627a0a7c044713e74ddedac2cbb8af0241ded079356b71c5b521aaf4ec548b90ff6e4afbabe7cfe93cbd6cddaeecf6a5eca04ac2976c1569978fcd59a466c5be671d0b8c8e666000138b2cde9d8f80680c00e73d890f84e72eaa0a43b6bb391e3360167cf5eff908c74b3cb49c6f2fa8035f1210835dfd8d306b4a2235165f568c5a382cc6636c392dc6def23d6274bfbd90fe7d5c1615c1cbaa0e0a59ff005760376937be1070097a33c1000223e3fe036708876fd06214de6d5c66801d3eb78be90b0e460f8c97ffa928c77b4e2d35403c5bcc2802fed9fa9728cc79d22d74bd9528b712de856798391f4791532f8db2fccfdeb3ef0f1bcee951b6b194e78dc67d42a8793fdff5aba0629136588bd3feb933f6e3d564766aed1417fd7e1205b4b3c4eade2f34612f3c594e3bc88ae2c66523d47c613eeae43cdb5bf307a2ed2310695012c675be954972f2318d67843a6344f0317aff3c938812980a8ac116c82f4ea49b21f486947f2f3936df8673814435bcb6d16a600f7b8fa901f95beb8d56b7f59b15c62e6d15ef8460ff52763cb49f03b8456bca8e8fe8e6bb6e73adfcca388d8a360f53c2dc74b8af10b47947599c5aea5e9f806b8fb6ed754f5b5af706d3bab3af080ff443af1515384d623d577a9e9b3303fa2f8d03885095a5f5412d29835a5008abf30cfa7d78ae82d7e65fb9ab9fde4153894eebcd5afebb1acc75f51a21a13d9396c78ecdced93b83fdac7cf4e6334027987f3117f28c641aa609f4c64246470a60d3fdfe00857e2f44b639e192c43d6c01918cb926789beb9870a26fe7352aea84d35bfa2a272bc6fc8adcf2bbbf6fb86b768a37c96932de442785f0b49e3140c2ea5a53b87c9521c19eb810d3eb16afeed0f2233e3ffeef9a8361d5d3027e323ab488c8831b769fc94debd0e5a4349bba2cffe7a25ce7d99312701dce48b3731dcfa68f5ad9f2c618aa6c6ca675ac371c84a77c714880d3350702d4757bda9d5b37ee54c68259372aee01660f361c06f5ae3690a11013ff7f9af8525199848954079248e2f5ca5e2c6e298b558df10b367e8b92a74d47180c7edec738ddc1bf8a6704e7b2fae1e58058cda190ae9fe000c32ef8312388a639a0651f39891c83dc7cf13f9c046ac982afb04c255f8259df4585f726abcaca03d34713fc72aa01cb684ee655ab5cf26000f06de2296dd72160100c1dd71ef62f0bfd3e9e139c4234951ab2692620ab6bf0afd5f4255b09d6bf6e1f86575924623860eec6a8bacadb4493fb6a17a8fcf7088a932614a5be9e47a0bf616004a2e88545dcd38860d903139cb887605a0d320e703f0d26cc2cde2d12ac36abe349d02511718d02a1d9439d66366e4306d0e380206f86c6c4cde2cbbe5b9ccf0782f8a2916d2930820951199b130ce052f5980ce8d72c5b03214fa633d8e4ef694acd22abc73174ce99e8917e8060b59c129515595402759fc5045456d8e20072b9ff091e92fc5f26f608f274a4d4c9b3b24409cf2c49d24adb460d9d08652733bd1a9593d298ed4444fd4e90f56977d755623365ed1c4d0b5d4f5e0f9b98727648e94165f1a129d3b4a672ef405abc1572b7414b9ec7f7a8537df331024b4d996f7ce2962f901393d543f8893fd3ef64cbc1a1721407c366534bd2cfb638dfa48333c936b31ab0c0e1d9e78fbd9318e73797988f1d3aacd775c49885d684de54efdeec2603c850e86883c36ebd854f21fd0527a4dcce692f620f68a55936f6b50a7a910ff25290e52cbd3ec7db0f7c0434bbbf6bcd94aa15738ff927d9162f05c7e4d3576ba54d02afd74267aee910381fd60e269cd66d8d06cd6bae537576913def94532a78da0c5ceaf412af46cd062f2198dac0340301dec6dc7482f07cb1653fa8e975b8a869d6965537bb18c0da60e917683db6efdf0d70023a1807a6571fda68c1270653866bd128ec39ef26c55d029e5500c17f1421851f91e7dd5067dda1a1eedf25e5dd46518f240a561a98a1596d06a067b2522b5e7ca5b6b5a81f2b9b8deba5287de5543b8ab81fa62750982028c37901ce7853133bafd7b00534fbd52b055fcc8e368fc1da1767be985246df29cc3e680f739ad34d3582ee3ca4ebb3d7d0a39df46d09ffe06e846c16a529d65e9090fca245b266427db8964ff8bb35339bd92b8aa7f1f23ec28935da0f6e0d403f65bf16046a7780bdb817635357ff6bd0115c2b51861b4bde7401529108ec5231726abb241a8c8ecd143dc5d8f53fa8993488809fc7b0902f0064829cff90fbd68022ae004750e5d2f7d09c6b2d69c7ca9b6715fb4586cc9e7834f680ee91882f62da40a1d7555e989b88e7f6c4f0a3c2ebdb5d546232252ad4beb88c00c31823bac2bfb48c902c9498f30ae7d88e9526d1886a16a07d629caad745ae4945f570eb806dc52742a1b650300fb8f9b37890f5c615d8f4d9200af9a0815b2e3022a5536cc54bf3b068c17a97092947baa70c7b027f7f76b0b6a2e1698bc7082d23d9ed09f06a52d67787b9f2d76c5c8a046f7f132e7539be48d6efc106fd113e24c23ca7e419fcfa10cf5ef9d0b0fb3b13dfa0ea3efc48159678e1dfe8f4ab5e4aa5e4da24dc342371d43d739370bf239b481d9a276bbc29852d6ec94a7d63e2dc9c0f178983388b9da4325e62bde4c7dfbd9a1b348201948c1e215c1d7a04b4eca4253539e643bf229d9d91792c64cc4e58f0008e6313de16a09d384837b7837d1559566deaf7d996dfdfbcf266d0aa095e7f73a31e79127de305933d7a6a3c5c293c448723c11a3bd77910acb23d75df2ca84fd5278d245a92d0b8ecd07178d40c4e6ea4508d421a1541d42e097de58ed42c98a89ab22dc3f2d39c9332545f4f416f15018df82c85c572263c85b034fd52d9a5d2607015e58339900986968bdf4927b90a5ccd4b5f52b280fc17b45b6c25ab293940e9e1f14721d2c9d5fa175a0b6914821a73180c0842b7f4defcaf8b253024623322c8164f92fe17f3fa6d7d2eed49ba750981495f96a2f0a240d79dd69281106282a5744fcf72f3b295db191fcf437e4d1a7140ad1046b8a43d199693c495e0d2c0915c1b78a28ea8a05a42470f70a1f90ccf39aa753684e1295fb1b13664db1efb3fbe5a2abfad7cc117c9f4a397318d2aa83da1f8c3974e90844076e182cb89d76ba6a4934758118c3d9f23c194c615211c7785de2f93a42e41018e865e0e105471c2b082fb5190563e1bfddbc48ab08227074827eaeb794c059b0bafeb7ef03abad43cc5a33864bbfae5c057d2f8e0db580c8d8bb34503c6a3c51f3f4aa66169ed0dc2365efcf038bba49dccb272ce536ffd6a3251f9fdfc07b4475737f5d22a0083896c0e79df075f782b41958ce5b3c14dc93fe7f0b7df46db7da9d9389d9d0e0c62ed2d2b0c3900216ccc0511e27057d237399b56c105caf7c225ca79b7299a6fc35aeb2b51c26334751684a5f51dc19f233b46e5e4abe13856b3f9e05f9c590c74e1f10c8a3a137323d54b589a7b65deff2c679a04c2cabf1099d11b9b58e2df8b28a48ed2a6bf57754afdf5194e828114817fdf3e3499132176d625bf0e2b1bf57165bf0aa279d148ed329a3909b5a94fb48416d85ee01a8ff054eb1be5f85ac5ec697d11611b71021b651fffd60080f637df2e17799a597beee452c26008863e5638c0a1a9cd047ac5dcd7178e7d02f6579f4527f15d812c2dd5ac33da6e26d1fff07f39b4e9be1a6363a7ce53527998ac560c505bd64d3330d870b5402ad0b5852e94d9d69f6427f02e3571162c5f3a9d325826846f22a1cf56d0732e9a104ec426172a3271e516d3120cdeca875854bd64e8aeb4fd0b0dfdff08a49a678ed470c25fa1debc6bcc81c852d95b755e12867c725ef03d8adfd00228dd3646c58cc627b53af721904e852da23cdcfbd73f34d979d2af680bfb1dacf0e721e9d6ac4fb2062fddd6b878bd0a9bb0eb06e14070ec9087ecaf6d541d08acf3c65e9b9a1ca92ea67881b37d616ecad2220c804824b2649e8d1dadbce0f55f2069efa8f3b9a1dc198a11b5af737cab2c13f143116ed0f8adb7d2936987c14ab3054cf0e3f2b13fff52dda12572e3db3e84dd80f15f4299bbff992e0973292e6c626406971e14fb7fe5a287b765db4778ca258d04a20e643a62f4b1ffd5c3d3f86a42da6e586ea41506026b731e9c7b615b0f42641c0046a8537e0b3a156809c0711c059a4f084c40248fa5de6696487a2e886b0c13e589a4d055072c43b85a5d315881b044431eb00b8fdde5611d3b6efad9821ce048557a5df136b4df85926522d0efc2e817835994c1763cdc4353776f785aeacd5bcd8e83fd3b3b6011751804cf9febe510cf8da218c8b8370053dc35c0d7c449314dcc7b3614771851a9253099d452d5cba1413605ed736ce49ffbfcab4c8c7c3900b35cbbe8887a1a6a491b64eab0ee8147abeac612e9ca9775a9a00919f8673d8fef5ca2c3d4c7ed3ca9fafcd5c1fc6eab4c186c4419538283c305dffa81e2badbe8ee1caa6f8f7537e42db29ea50e7f4dd1097fcc17d539b5f89e2f0185bee8b456fb60d1de2bbbab35462cc594fb4439b0eb871f4515fbba02404db806f17cd31a93f1f5ee84fb222ac4353cf1a6c25daf15d50eba1a1daa1c1fb5ee4f1bdd0148408fe608a5b3a83f2cd1a1c9b17cc35a92cf2dbb9406e0aebab58f703d4fc567eeb6e0fc8622943f182d730ab36d2937afbba58a8ecd085060b07e8356421a9334c444f3cb1fe178d45c2af820cab6593c8b1da7ec941558311737416415386628dbff290fe1a19c3db25a26567a8c4c71c851d4775e7a4722be7ff9677a61b3e38f45850ae006050cd751226e6cc8097b235d8339a1da86559e1c4a54be0fbdfff92ee56b9aa424abf5118a19b34a71d9fb5e88c522e5baf35082a6d5781c49564a3fe01f9c6fc6e9975cd2f8fa92e84b998142cc5ed4bbb4e508023591da6909aa6b3974ff096abb0b704f718154712f4804e3924449655e1946c2ba8df6f463ac5202f787f63e367aa213dcc9cc30bc81248d7be593e8594f0ae5ebb5f5982da27571cdfd0d096b025ba0c656bc3b10a0d3b6eb5e2d479bc580e9bb413b09826183c6d746b1f9f85440040be2df0a703654c6217f26a7258a02bdc948451012a81d9aa63000230f1b085ae1d925dfa13b62a561f873288b9a8cf622c17dcf53750235730a82812358f8c44fe3e5188e23cb0e0819cb19127e7c2b4feced186259bce70277da308fa521201b66d8a8a1e5456c6d092843f017e1b2abaa9790a9116cb204b207e39220d50e602883d944d8e24207457070feef6f772e5edb8ac892de24a05f63554d90dbfba4acac1b5df469e075adb13d01acee411dde38dfb480db5b38a3c24c8d921bf204faa63321b8deaece59fd50d858abe796d0494d7ec79857a1901c4e3a3885e7c15274bb6eb8475c125e3814f2e29e178e08d5f85d7c260a4ccd8db278fe01513b617ccc09721dcf09c6439934c2e282d55871d14d68698b2390d1ac0a3a137b2026cb3d803aaf5b6d1cc9193bb4b765c455a3fa333511111ce03fc9d6ed2cc50611dcb04f61c6223faf5e1865a6a48ea9d78116b0a9615fcf3f276d11d977da7b31c1a5d17f363df52eb9d499bf48423077c7650f25853404d355fabcec05186a4d33bf18894106fd83291a1813263a15cce1454452f5894b046c87b2824cfe3155ae7e7db23ff22e56ffa1c19417d470f36ae521ada4a0c96571ff952fcdcaaed7df8e085a2f069b3bcbce7a01cf4883e4f7b306e4847c89b60216cec4591412cf52f641637c6c7e4646966c3f9e51cfeea5e12a1f562f53d77369ad101a97328e7799b4a9a06a80c3a3fb4d3504a33c66eb49b848add0fadaade2ef5a1dd01d885a2f72d1c21142c5355934f266eb3c0dd06af92c8cabe51640f08d52f2b3b4b18f920f68e53903b76a8de778b676cada4305bea21b344f2690efc09223c4dbff5e63c999e43cd874e3e0414a6611eb98558f4638eddadff9d0384487483a2bac06c98100173812b29ac495d75c6332ba7475bd80e570f5ef8e78541a6a1659f567a4510a3c1b543d4fefa04cd536c9dd2c475e08e8031829342b59bd30d15aaa9c1285aa4ef8456daa5f70827f71aea6cb5ad4ec9712deeeaa1cc22bc57e9d4c7915f20b8e97e3fbbbb0ea2da1ed031c1ec36696c0133dfc540ae344e8a86c371025af2f1c61e4cd91e53f490a8759a04ebcd6e2a2eb745a2ef171bfeb93aa1847298f926de298b4ef084fd8ef0e3ec0ee12fd0955c21d52b4add3a4b7196e0c2873198e520c5a07be6ef8b2e5a79b4590b1fb7147c3c77a03c0f2ea3080aef77923d1c1ee491bf71848f892451877721d5f56b9cfa40fd0719719af822cfe86e14ea72cb9523a7056392bf4aae0682b056d9b10e78336394329c40d7822343f424cb81a68534f1ce5622b8c4f4e8281d0fd1a5ba9a9df340d4e13cb8ddf269d137937ee95e2113ee39213355a1dfc26baff675d2342364cdae50e95e0e0a3285a7aae8aac1be200044180fd6ae9b6c7765c1aba23f10b86a24cdb83d34fea655d116ddcb72f0b200fcc0257256fa2b3d65277203735471ffc4c1611b9b517279d5dbd48e1eae303e94375278d4283f213f87a9f388aea7b61bb97299c1abca81d5113f435f1796fd8259fc64450dcc7894d170c83d70e1458233244e3de7ea82f9f2472d2a33e689bc23c803a9e0e7bdf9d3a8bde8b0ecf8acbd9dc67d3332692bb53c9b19756c8cc6b2aaf528d77453a67a3f43eb89ca8d59bda4253214bd7213acaca101a11129336e6aefe91781965961a69ff7591a26b516f79b48071cbcb03e9ced084bd6fc195e705525d025d69efb6747428b75ff7ef1d296c5b3b8c924324c9ed2678689b68f50520d0deb3c63199c5daca890a0fe4f061258ce765c4a564f714d47613bc977b72426548821cefb9f930123a718fc00","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
