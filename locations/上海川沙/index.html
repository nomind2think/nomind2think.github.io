<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>请输入密码</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">请输入密码</p>
                        <p>此内容已加密，请输入密码访问</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="密码"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="解锁" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"639b5ba496522dd4677064cfc61253f2424a2f9a6bc01b7e4b08dd933aa3bfaaa8595f49232a236cab154181ec94a6048bef7b52ecba6f63115347fc51eba18d712590b1022eafae11eeaa5cd5c86c3f881a9a66406a0de6122dba4fef8c5a22410ac65ed47229ac006d340dc412df3601832af071fea4a3867017e52ad4c630be3908a9505dfbcc335c43dc921fffd1a94f6aefde7bcf3341291ee91afc024dd0d143d834f070c6c9ecd2852fcbb4fd9daff8e72e34f8491924873f1650cd33b556f8344ca35c42691ed63d21d71fb0e6847baf7e5d09bb649d401084551c87210b7e07d011c5fd9fd76e36ed8a30699ad1a669fb3ec9c94eda29a896de4fd905d770b30805e1a1be6f451c6883d16cf6728f34403928c0df2f15c38ec03316b8490433afde79c7fd7a0afdbc0c9b938649348e0ff1dfaffad28ef61032b94d738c07a6a532120662c1727b41a16a18e2a318d77f847a594e1583d868c9877c02f4e723fa3e095789141cbced079630dd66566b591b28933f31d633aba7e60e477501b983dab69537a61440e955d5e43f789744c725c7d62cf88308c9ed55575c7d990de703b4182c6b268cb18b6e1dd0dcde8e740bf0d7111b4e61fb6c423685f2a2148b5f92621676c44802a8cfc4a27828e51f33cc04fcf87c1c5f9c7b0f50cad85b4283febd8c8744550ddfd91eb855c4f2ccb628b518c5c87ffe1e68ce4d692ce03139802918958194ccdf06cb633aac84913329df8a10df013fe3c7d697aea12014441e9fa240b4feeccc27c72ed3a6f0b5a66390d8e98df15619985e296e21588b6b78d16d0af4c768b363b3c484e5633e86032928080bd3bbca78c3f1e8151999db539683074774541f171597cc27b0ab2fce6c8cd77c9ba3cdd08499d24eaa9138f0a6471b5389cc93d842041ac044cc019d01c2237402b2d749500dd8525418f5719ab844d36791ed4e7f77942a61b2488b87f92815e4ec9886cdcb8945e451ea2f9a34880f2cc7bef4a7699ae4f0388d265e1d203c34ba11a8bd4d09f1d6026119c7889a3b18cc0fc9c422cd395ed9756d0fba94762bdf5c23a953f4903ca2801b3d16c4232067068ff2ef302be02027403c2f0e08023bc1b9ad05d2c231f04a6e6923e636b76befe341dca86c0de86ff981f95ea0184a91f8955c337d21f09b6d2c1a508a925d7e093ce276092615fce0fdc9d8b680c435bbce0823aa253be2bd8b1e6fdf065354436fc6f117226035828ee4274b8fa6a4ec905e95f131822bb4a961cec8f7a8096693e684083fbe33dc76d798a2ee280178ba41780c6273842fe326eab24897ff06b94d253dc3f8531ea322624394bb7ad5a38c407b925ed0dc0580ff4db5b00886e72f7ef0d2486c44ed71bedc26c7a33a09533a9c092431a7896d59fb0f62ee6a2e8444dcc0b5e96b0ec5997a06d249363ab7a6aebb20ab3d6712ff5bd4d654e3bd51ab7a5a07386b7555057ce86ec43ee6f04a8bc28c37981fa3de0ddde9a15d52660a5ed636802188530e77acc64c66d8fb3c3bfde2ef04e3e2a3ed2b245208b4927263ef81452147ad3fd2355def5f1a51594912327af8614d9773c797a8858ac4d23e7bdc4f7160fb665ef2a00f4d82ae53ae4f7d2267791452f7c99f5e74440dfa44c9a3e3e3f9410920ad339f5a943252a4749ddfa5dd5816b953a6ed3ce489ec66a7d0f1ccf1b0f2910734ec09e755655f2b548e26a5c28e3b9a2cdad74c15fda4d48a204433cd0088611b81503ec9a5076917cd7227beae682e92e031ee8a5a787c0cfa2d50fce302d76a6dfdb38cc5e285c50bfb938454cd9a1ebb716f02b2fd921fb55eb8f7320ac42d8d1f5a47a8f08606479508742bd6458169cb23c6f527f7848c3d21aafcfb3640e7fdecfd2044d28ca43ef8dca67a466797d9a1827c030929ccd2ebfc5397a400935cb4a69cb09bb73cd55a9943f2c66a14d13f767018f74af2e8675e62edf458dc02c8b32520d7f8453b9843ea422b62d2608f1c469d05cd3cc144e4ffa051f944a8fdcaf592f150ff2ece81bf6e199388e1ec0fbf03811d0322fc4505bb0d241656c73bceb5cd7d1eee9714a2846bf7439565e05de2d0bd10a4306b1d7d4bd6cc5ed655816b29c815c2c6be71411132bcb9011b9d9ee25a67802e4a1bbdda8c6fbc55e63c118a697689a3ce475c188b40b70c2522b2f4a6c618653952a46f315e79f34c500d0c5f655591b39a67589d1484bf37f164acdf52d5255e527fbb48482f081ca3a8a46e3c72cf8c18a3ca8c85a4fb76de8144bcc822aa0cb2a052b3d4a36b5c883b89678b76000d4c229f390e34defc726ea45d6dd83450a06c1ab653ebaaa2ae64b74a9436f6e8c75c99d227038a73f16c96136b7b24c019fc903780fb3a91da9b8786b6d49a4bb5e0c283274a49d707488c0ab84a19b0646751dbd78813f586f94789eb7c225b21e0f290d2008b0836b694fc72ea1734c220992e69373184247db92e170ce5b9393defd223e33c8003a9f8acad7c41cf87111f4c31889d8619b55fb91e669b581e2853c71ce2d034533ba2b4507b9db9872ce980c0fa5bce84a4c706de74d2445c6139d25fd652b67044ff2ce876db963a91810c799d91b0c8111e196edbdf6b5c0923afd1e04800da477febffd50d0b20c07183698d6636257f64fb2a6efe03886578602144bc737b90b5201c261fc565fc71e93d0dca2fac87a8ed1795416b44db9410f65910d3e6eab17e0bad7e351bc54a1d69604b07b1172ea12de52e00c3c560868f246542768a978e43bdc436afd0969333472e0854d96ad6d74dbfc4e4b85baa5f97dca644613fa8d2c17f0cac9cd8c2efa625865cb1a5bcb5fc84f939077b3afff47ef2aca88027241c471b3ecb8a5cc4967d8ba6916237e825bcd7f1dbf8eba3883df51c58e5a35dc94417a89d585b6c34d2b64c61acca0bc4a507e4951b033c89d6a69469efb8cc11ad07946f0fe22144497b5379f5d4b49b6fbec3740c89dd7284e394a3f35e1b4e1d3dddec50d0e6747405d6ba93bc40494e456006baf9c2656d50675e423b156583beb6765784d68ecc63c3a7a004aa5804ec883ac94949082789d6c162e7ded0f744ae106175f412c91ad24cbaae5fe3eddd869e70dfb53e5951b8bde7a1da4acb7780da521e515c461e6712f00dc776940f07093407604de63aef40d7af192b485eddee562d714e9ae3c5401eef2a278dd2a1ef1e7c605e1b1b200d3b78d7249bdd517bdc07e99cf54508337b7e0eb12b6619b4408e298d170010ea3090b6bfae739ad0f97da2f728bdbaad4c5098842d861f2d5ebd52a709ce62fb521dfb3c569a1e9b672a4ce2366a449f39b91cf3b6867e29f9416565069aca08472024a5b8669c5e3332c15be740fc97b66af7e6ba697ee2dd241423bb99deb439b3325274722b75dfbd04c35b44cb8ca5d89bfd507da17d72768fbf9d6643a62b0403895e97dc49599c032adcaa0e9e8dbcb67892306c9ee624850326637c525acefdb0f553379781de26c2c1e3efc0bc6f0f0f36d5fd205d03bf272175ebc5a1000ba03ec3d88891a0a710b6033061fb15dcb6b6a8ddde2e4862d6a824a099128cf17efd4127b9eabd206a4e52a0e4a5e6e279274a4f2778f72016993d79a7a8f13e1bc6ddd39b41607d7a622fe5eb09f23b13458715a5e0a99b6e012b20f2c31a2e9a5dc522575ec4e2255fd902f919c319fb116ea46d25b447b873280c597582f7df81f396d22543c3fdb203f93d4137fca052430c4da4961a29e77dde286004128ec1200e161a2f65779654ddf257ead82135480acca98e7fc00f0d55ac8f9eea995b1132f71ef824ee9e38f2f988456f687857c2792fe2980d943615ffb2d49c4adf64f9e5c17eeeb1cb4163593a6d8d0c98d793a5820d55a2252925d133c828c94f8e541e14e13e5ef7fb5630355138366fac5a626d1a494b899de33523c5441a3e03431f3f3570dfc947e0e0d98508f7e80616ef1a0a6e0182dfecab2d324042be86b8e45bce6a5f2b451a048f9a5a10324bd3342f8746a9898c5ebf3fd2ebe7cfd2a6eb60d6dc99bc6fffd0a9570e9f1767237464555d47f970c56d9e8eae26f05afb783cd5dde4c498e5b7eccf37b984b776e385385e15fde5d8e637c04ed00d76c7ec561b12991b96c1fd15fb38773d4af346ccd765fff504522a7836d79eeb287c1c1556c37d615f0ea8ab5cd56d5918e6d9ddea3287ba411a42876216fe5556a53b462fd32d243ebae8ed76ced5ced1674dcf385149fff11998499bf9c10d2ba2e7dbc2e88c083c727cc271d1eac776b959fe548de8bd00c7bd090354ccc463857ee374eb23776e400250b97889a1d5c6142f969d583e060103584da4e8f2cde6fc50a26776083a142b4f8ffdc75cd588a35f7cf9c7402243e201b7c09fd9f98aaf7e3e6709ed00e5bf803e373fb584286a5826871e9378890967872618b14c920d57a10a5b9b2d9296157156287558229345a07c0ae58fca96c58da02327a84771eca2b556f3f9b8a67aac6c4e998fef3b7b2b0866758f364e260686297ab844dd7cdcda6856182780013219fe53c1addc6d730633a7846c40625e437d4d934810ccfc1ecc93434fc4de71743d97ff6a1a32d07f586c17769ed743ed6a0787f8ee3bb5f3d5084dc8dd42c5c32e75ac738e2f27e274df2cbdd3dfb2d598ba61124a2946859048183b59944b65fd0087a4f1e23704dad13e037f393b409b48e534ed1f4bb1dc71ee9f7077289cfc76e6f89d1c6bac611ca0fcb80e9e61c52fc0b9d11a333013ac4dd6ca98cbc812dfe69031e8df42c082931419f4497c88c6059e5230c9470ac0d497b9ed7c42d0072661ebd21fc9b0e3594b0267eaadfede69ecd57f2ad8581857ab06058457c0020dbe7cd6984301da0b282e7f2f62edd66426261f5d13ed632a5f5917b8c4b4f79fe651ea25e716ac3214f32319b6b856a37de3105d66ec23bfd05351a3ec2e922b6e2c937b0da9ed526ac087860888d28928d840bfd41f40e603f4ed97a3ade5bb2e0501caeea924b395313e511cb7190e109896dd292a02e2095c10fa6ae2e8e7f95049f446992b21995162f9a4e2e82ca54ee2a856a64455d9e9706d636df19f9c1e286c6c2db5d260dcf464a5cd121cbee2406496ae148984bf4aeb651d7e39239714fe1187cc83892a29d9ddbc81af0c86011605490b8e63eb45c9a84a1c4f3dd27fdba32b834c081e0c86d2e4ebcb447b05d8b7d89df1fec17390d4865fbfbd4fe2bff8d9f8db064d51971d3ed6c8559358bbad173acd354af3516527d09d12b452625eac5eaf1e10dfedb0738c4416fbd721a2214d2ba89f2a409edce9c34a708873f70ae23ccf11153cb8fe2958a18c7d04d25a987609270f888aef1c0a1dda958926142f148cc6b600f2fb44be29939b57d1f2d1d18569af03b6be2d8ef44bf6469a7893bfd29463c780e3ba7ae892664d36180017ff866ccf11f07aee742587f873114573c0ab8cbeccc06cc5eff6ec15c20717358d818c2c4239e439f63efd7a33c64e3494556067dceca87cd906f21924421e59f8bb4ad4fb8a9c387b19ef529339d06d25ed020e66182c3e7c9b92cf78a4ceed85549231031c92a3ff6dfea8504cf2d2e2667ce2e3eedb022433f6199453bee5ce5f86a8a647f0f9697220714f4195dbc4beac3657bb45bee4b446ab6634ec0130e0e2ffb4235bf5ed3260a735539896e1575012d425dc480480cdb772208bd46d24cf906dafa35b041d48858dfdad1ae3a12ff286919c5cbd067577b46872f46a40d28a0194d3d191a7032bcc61060df6d8f714ef0518cdd5791f06106e39b0599ff1cbd50a570474daf185966e4c838e51ad134b5e1fae775be0fc68ab4c27932f1e96d831756bd441d60e63ee04dbe4962c95c730b16db02588d920991d385a21640eb95bc8b20e94d8c8fd2a4dd61578e361558fbb1d9858f0a895acc437e548776d34c6cf33355c97309994f610dbcd953c3f018bfd480d3d3c5d27b9398914719ae0dba274e175813959a367bb268e2a1fe6d3de44600648b049c61a2bf9ecd732e803c9b1a6ee448551fd0a53e8cb41bedab3e076e5a9f7071f1888d602712778cefa336cbe7d9e7cc76e71283e75db6ff5f1f347ea9d809b3986310c7c7f92a86f5c0ce10e58a3c7afd23f5a06dad160b3c43305783fbf1f347b318beac0d090efad353338e62d3b88037460f9f2f79509ea36997c807b2ddaf0a5a73f842f123e042a8976612e9daa4dec0d611d14483821fd71d78bf8f7dec71ee6fa749316a83e81ed137dff46b5d5fe2afe54b82a8f9c9c7d9961b94182705b4932a5749cd5cda0f60260f3cf1508362f9bcc49a99d7904b5b962e0efba844d4aaf08eeb9cd9ca75110ebb78289bfa94550bfbd601ab75c8bd5a5764dbc2eeac04a2b6f1dcdf544475bbc0424e61c1f0c0545134b091803cc117a3ff7502388405b5583559078dc44b3e4f0b7267375d5cb1960c65b31d6d339d5e02b3befa30e43854ae438752ba4500b818b9b0d5b85555b660e3d4a0dc20859e9ca73be2c241b9eb5aafa217d57f0f7bf1ac81ed9138560e88a7be47f7a99b6bf346bcccad27c35c5c7ad87e949a8e3e071a5e8c5773b55aadb2011bb5925bd99904775d2700c0e590266a661fdb75f68ad4730cbeadd9890e130c9d7ef26fe0c1a1bcfc67191fa3a4c539ee1c69ceb9308fa52fd3e44961d050b417e5ce59b5141d6cf7fc3852f6082c682be17076af1f0185966982c2314544fd6e7ae5c1780db7e049f4fb69aa16102cd59ca6ef8a3769c861ecf9a4c4b1817933f2f53ab1677c0a53c235ce7c8270f93c0d07a328705a6c092e8536d1084332a3cea665687a2ce92ebe521dd760731a7bb0584adf56141bdadef69d004ea2c734ac035022eaa4453a6e007f35b52d0dc820a0183807a22f9efa648b4c736e721ba03ee6a20753021a42db7c02f10cf3d75b508949881f91795b411a428049d128d883f57094580196c2a3453b2dd36902348eb30ad3a246872726aa40fb947718ef55004ed9e089bc7382274c387205a473a54a9619976aada07750fcc7232b58aee72dbde2fa2152bacc1b13afe5fa120696586c56e604941b7ca99f9934ad789b8174c9628e528ec2365b92e3f4d8d188952b114ccbb8e92342f99bb38b0c3b26c90327b1a07bc671f84d5bd1198c8e1126c9b3124c658b09cc85e4a79f9b925c808f3529844834ffebd373b1892e4cbeec49197511ba75cc9bb9aacd129a41ec8f76d183586db805489b255cec1fb59098dc530e5dcf0720c34bc5a07f51f8ceb1891e42355f4a693802307f2665645cef8a497d36986106f21708f66464bdc6231b8fbcff008ceda2d5408045bea3c73495af796d4b7b4eb98ffe39b6d23892ba95a31ae05fb54fa78738de7860a272f2026c60a4d98eca355e24119956e727f4c5c4d6c73770e3676cc11f801ca95a9b28c58e924e5970f9f24cc8b9b52ac65b44101b11c00f3e47e1550b094d3b5a2661b0829706da89e61721ccf9a5c2b59200ac688a53013ee3f17e3f0294e422803d08674211b692db776562e0a578e112403823e22a91b82d83916eb2f6f9fd1c84298fd62942eefed94a536394136405db97a31d28518bb2df3566c6dc8f85b0f1d885d12022c6cd1243df5d23c32f767ca4c98d064005946bff3cfee14dc7d0ab78d1634182724019d846e59814fd952f922b849001cc4e54450defd83ad54f09decf5c32044d3d4d4f372f414b8d0f59f204906b0eed0a9a3300587ccb69a521a5a4be9ac496d4d8209b1f3da7a931b77c193697113732d758b09bb20d7954e6422a245274cc75efb5bbbd8a92188f9aa96a5514976908c4346633ed9ecb7f6502042ad432d868ef4a2a2f2909c7dae27a0a0813fa64880037e7b1391049d8737a9c4a252f5ab2476dcf93df0ad6e78cf7791e97c58d5a3ca48cc63b7f200a3ad8271cd7b3a4f5735851369c28ed1d6ffe7dcd63c779cc96b0a3b5773578d2e768059edba39af87e8e6af58fb163257fcad1d0b20fd51185e1c6cdaa91122a694f0d444f8c1c118516f19cee5d4c8822607f9aaf96a104d114232047f1218a40c194345724553fd00c16497e40e5c139a01f47abaf2429803b0198e0a3092f7af4408a868ceadb7d128dc708ba1cacf5ecd85207e54bb7e3cea004754e5a3c0e6900441f8315d50353bfc5f1fbbded4179fbb1386d9e949717815c0520d16a4de66c21c717a2732668d6f8b6512cb3845d9dc87222265f67af396be69b66b1cf1e6ec03271c759b0cd9c8dc9a2adfb6d21e129cef7b9ce906202f90cc77e35ae45c8df6bae48c99de8337d8826c7ab47918bd7c637ce1f03390924124f1f55d407246f489d790f9a8cb4d5aaec41ebfc9c0a1693bb1a01efefbfd92da00a069435beb73a93cea92d9ccaa32f8d64af080650da6a2dc5db4d344350de70a7a98db3a658b1d4ea678ec510080c401e35105ca4251acf55203d8cef35ba84c00f4fd21b4298f24ea7a747cfd8d9b3e3a84d251e3c8343b853c96b3fa5311682885a0409e832b64d4199fc3cef7ee29eb469c493acedd19b7cc6a40d75401a4e7a356ccfa4f63de3976212277e159712825e4817a54ad55f42f22acf0d056653e8d7bcde06579917b5203a135470efafa55955ddadf399de35243d8c520dcb8b1dab4995f2f480b9c3691cfa6b796480f3a3ece41bc0c445a9786d49bc431f099994027a546a2db0321c924f55e7a4850c8f9698b7d6362f6732f2dadb8a182e43c34722c2477c7536b1f47826694881938221bd6a01eb2ea548a9b53af9e52b48622e69c10f53beb8675d280773111bc20f968ca57fce506b65171240dee7993e436a6cc2e6d758d73614f1e5c4bf9fc20d748046a3c7b0a4fb3dc2a0832f1071fccfdc5e1bc200dad400d7bc0c4e99c104c192a1eb093f101409c4f7e4f00bd50cd67bbb6e9243cb7233bd80d72155270283616d6edfbc64fde36d3fac89d404530bbd9022057c809bebc57b97536310d4471a60034bbd660a6d8305f0012244fb85f9d36af821ab1456a8b71570bb3a1420d1e14335d7e2dab8741418d8da069b75e33ff8e4ffe0e4fad7bbba68f38b8f1b0df7ce83aacda5581ec1b23da0b5c67dea14a578bf0181529aefdf2e94d2e419cfc99319d0fd1115c84aa4a3834e49c4fc8fb028746d1f79457c642282330776f66d39096ef2ef58e66d65b7d093f7731a2b45275565556dadcb4b22618a9798eea416accb76aa814581dc1185e8f129960dedca6098e7f724bcf903102ee8bf406d6bbc60a83bbde9b10ab051db3b0796caa2fab7d8c6317b74383a805319f741c8d37a56e4a81eed49006acb856a031fe0c2c98ce06ac0a300c15b84db1a7132ad04a306b2d65fc7925987fe40aedd87a052e09bbbe6a133350c1d63efd69012dc204ac9b3121239fc559b2524a32f755b5f0e9cdfb4a4611ce0436c313e11e2bb1194506ffb3e42ad8001b0d067f27d39d809054e0ecd032c597596c3c8692165f7020ec0f942281d1deb2179cd12143da44831c99f8d53406a0be8f10d026dab454fb7dec2b34b9f66d98d18f51a6539c587e4ec2e48eeea197f29925db6b9341e7af583ad02279a593f37d60fdbbb4d682b8a311986f620b90b9bfde9ce4d5dfa7ff7cb75fc38526b16ba4b622fbb15dee972f809f0b906bed2e953885d2fd7f26e1f074bca7ae8b50f1cbf83bb9235d202b120b7ba0834225a2779dfce047719245568290ce321d22ea5985d25975083f0256d4d7b3bfceef19ca6175fe0d6d4edeef2cf1cebfce804a57a259c1effcabf478540d59e05eac585c9eb0aa5b1596667c2c596c3a0b565dc938d4cba2e691ee866857857b76c5f98f6854a1a173e2dde68ac7d9858d28da049c3a78fc314108477fdec53a64e797aea7bab6b6af3db54763d756d95de54429cb3b053585042f4f2f243d101e56f05d8f4c5f154c3d11ee0d65c5a9d204ab625e7c094cfac1a446ef826bd1f7a33e032a92138f6346358ddd8de563af7ced7fa59e31b23438948a44e3ba11e1b54beb7d96973da580de77abf2375048484930ca9657d14faf6a1892a8201385b0589dbd621d79c8f61b8e9abc96c4b28391d582b5e475fdd6c5d43afe3d17a01e6ccfa35fa132b9504bd12f51cf35a7b24aa4916dff3581660eec01a904b428c5875a0486f09e21ea9c46ec8d1f672a11785beee558b0a3f2ccf9b63d9a703c0388a41dba7be9ed0f5839ea829d4a8ad6021e4e0b0df20d04b5c5a6bcfbcf660afe386de3fa740038c1f503b9f227da8149fb4c43da3213fea4dd27795a9fe1e71f86c3c337f2854d8ca4a51505c0663a861ecb947d4212c1aeeb5cd6e78d7d4e8b5393484b4602a2af05ea576c97203137164d64bd7207825211ab4b91532c57e43bd90e69579a0b13fb05bcb14c11e9ba657689f2d75c7fe3dbbb1451a5b5ec6ca4e1241ce579f40f6caa24a489a2df8f138807044deaaa8171b2bc4831cca28f2f1ddac67a83706d882e5a67fb0af7100e01b2aa96c37b346cbd283cc15f234a0dd64fe02fafee538fd9ade570509683cc9b724099b56eb5d06a6a27a3e13d8c538dd4b1c1f438b4e8901e71f1990c130e0a3fd552a8754915e0628b82984b86cfe52d220085e7077e10cbb7f6b6304b883e156d010afe4da20e6b624a0ec76005c6682bb94aca57636f1586a911024fa37718e23b88f81d8768c6b8ece9a8159546a460a08e3a06a09ad5b3e61d28d3346209134fd4e4985433fd721f4787e91d6675791bf3197d02d6cb9724147f24a84903fcdd375ae52533e142b7a6c1e7e8b261ef255483790b268018e7c5eecca685a59ebb34e0c118c95539c5467df2bab74eeaaceea0444e02138b0bd313d5b150ca2f9a0a45608c4694c9222bd46e9ceb54bfcde4caa0850b187a7d062810f21848ee4f2c1edbd5563ea437f0455653a4088f409c8877657fedaace200c7b700452b00a27afdc205c56857259ccd11180911b18d9ceba34c7aa819e16292c6558aa8f743e2df8cf2b7581235fa6cf1d4f5c07049788608099e15c7479763c6e7e3e8b76f4ab5d9c8cadfefd428c9013fda015ef16cf699c4bff6ead87342f8a81db7ccac1232bc31e7649bbd28eef4c25d8cd78c36dd11b5d478bda08437645e5671efc24019065ab365ca50d0fd972b1ab13a2d9976a81eb2dd6c4664b682a41528b29a5a68923af1d9effeccf095c4142236912fb8fe81c15976971aba46e292bd904d6c50986a98777199e56b68a25badde2777b91d3f1b1ab0d5c27f5c85a53c0c48adaab5f7f52794b68bf0eb086964457b82023419c597ed4af5e8cc3762f97ac9bbc60e441bd42f3f83a7f6810cb7c70765732f4ce015748fba05b369730d80da9fd81e8f8ccefc00cfb740909e023720700bb55adef710d575ac3d737a4ce06610c55c7e6914e9454e2be40dbfc3f2d8615575d368884d7a9fb76c966c397415cd418aea059aa90c00bcc9c061cdf374e031fa4a99bd93aad304e33232342418dc51883c0f7a1e15aa2a32b5c2d6e8662408848c9eaa2eebd13202b42c1919bbfd9c083822a9ebe946afc3f3b13faf902417df79a62908a8b23f1907273ec2e8f9b5b81c37cc2a34376e98ffcf17c595373653cef764b335fa990f8d37358acba828ecf9d8a01b0194d99803da3ef6d77e4794c8bcba80be848b40887f4ea7ebc8820be78e37ebca55ffe2b2ae1296557b44a35f9fca6f7a935b91ef88b83d89445ce0f50d6b0494bd4607ce6ebcfd5416e1009e4b895e1de22843076e237b7a85952b863e624fb0be4fc8865523d10bf86b25b4de19bdf76ba09b24a18ed633fcf223404623eeb5d956183c7db28fb4637ff9f141459eac87682fa890cd56141ca0a387c9edecea359a5ab6846ce9607c255b2c01a3fb3e6ab86dbe84a1b539d200f26a156b47ca7b8fdb85eb5c75155db4abf894d6df87f03fe02c20ce18cb9e2f381ca7266e487d00586ae7ebfd94b4e74963578c8307240429a24f5c8111ebe6d8ab16bba022d06b94ffdc2b22a288cb7fbfb0226a667d01ec67c9a403826a17913f86d93b6188756d4b291bb763c2c7a556814fd3ed96d4e1ac9b9bf59289260896f5eda3cf272ad9bd4fa6eb4fe590bff93366a57abfa892d744f5578cc858e37f2875f57d0cbeea3f40c0031f2898e1252d6513f48b012e45ec7e1db7f6cc8fadabd101ad793793b00ee00893cb48dbd090611581a0e79dafb88489bf97ef16e44dbf0ada6c70b9cebaf5899a02d03d878eae8b1037f4b307f9a536b3e27f088dd38ccf34e235e27eb20229c2a61eaa10bc6908dbdbee49270b66ea84c4c09ac7a8683755df06578361e4b96d0b9acda83e6cfa165d579147a0d18e53b7f82f8a7398e2c019f0392ff9632e6ac961010735aeefd12bfe9bbcd42661677ae9fba11d20b258fe0d9bf79aaff02760ca88fa542a8614944fd5318feb645665749970c74f5a55536058d9949480741d3e27856742af9cd8825273eee37afdd4e7ae4bf838684866c4a33992484b37386315a9bc9e569a76c814cb1ce9c98d71b6ea4bc34c80efcb1fc8d86d8d610b1ce66140324a042bd2a5f51fa5ad939e607955b0950f21738151fb43d039024d1eb403bb9b7d8aa0e20efa2623454558f98fc3950b1d07d97589888fd30bfef89a89a563a55d0a5335044b5d16d2aa0cf9d24c918191a56567d41c980de8036c8b6da9b7946c6318d81caaa066f778ded451ca0446a5257c85875320cd06edf93f065cd6c0430e76f493c4c106476e7bb909e1bc07ce30bf80e93d6261a9b61cf0ae2561512ce70a013129079c794dee8f9c32bf252dd47042d40d845cb450fd850c5d199e98efe2a7394bc5c36d9180b85dec8b587a4f67c7685a647470a01c91b37646bda38ec117a0e5a6e6dd66f1335a246069d861baf4927336db07e78b62d25bf038d64cb915e57d4f647dafab6d2f9a74bcef33d9e0d0d7b0b8bf8e13042374e2ecf48fde39df228c7dd5a658722af7de1cafa51d0cbbc620e76652215ff78276ceda69d168cfa121b29551306ba585c3b1e76c61987659bee18595a9419915c66585f149d6530f707149558dd56eb2dbfb8bac3c40fa4fbf0eb53538ae95a03d56be333f29daf9f0059de2feaa08c88c57d469ab2198ba83923168d84ec4fb0681c08b859514e55a610913dfd1cdc3c683973434842ffc88906641a02006be83ed8dd86552b5f4f5ae9b24b8a25f9221640f001044f3d5abb3937e58656526dfd1cd42e79bb3db24211a2b75678dbe8e13c4ab091b918f05fcb7f7aa5eb996f47f5c3b470da291f31ec7edb1ff59f6bbd17878f187c29cdf49746765aade7eb77efcb008cccb9538847b51cd6d7ac371eae6c25cf03d93c35df6c9b5e99b6010f1143aaef9a27b08f9e80f87ce8021aae2a2d3daae1fc8f0dee54567286b3964ec927ea3baa5c9212cfcd514b877a05383973ea1c415f10eef51adae714b5cc27682b1f17d94c61ed984e08c29e8aff7389e2c0f471fec94a0814a5afb5eecd3bb94ac903db58b50a920dd80944f18c9a7dbbe387cd6dc0e6651be855afffff4e1fc17d5942ffb7e0d84879db7c7284c127d580b322e312b1254145faad23dee516ce5ab46ca32a8930ffa4d24ce01df33a5b57dc3e454192c20a69e2dcfe73cd6927f5f1ff324493ee6fddcde81d81921c93e815bf0ebcb187e72129adc16ce7ff3a7325d3cd6cfc219102657d3c3d49c4ef93a6f7e7ff721a61d530a20c0fd454f0cfeede4994bfa71dc0a8ac6c29f9a62a6ff061baf6519845c7be9b7eaa585a75d2afef7b09c925430e2eb002867bac9cb3e95a48e89091a0f7dba6013de8a16e4c3f39efc46e105ea37b2ecc24786fbb61aed31f03bf17d4501e26264a471e6ae0997ee760c2dba05afd66d8a8889dc02dcc1a7a284efa0619e7426a0889a9b2a95ea9a85c99b59cddc2c6da7a016c8ab6cb4e56839100cecd2342ac65c4819848d9075ff92c1504245f209721b6d0191b0518e7627f3272759597cfbbce8dd9e5658236027254f87fc35dc05940780d28862e6978e66876d3aeb48958a6b9b91a381ea9eb8f60a726a923c12750b59922d949ec50b6c17c48deacea0a39ee8ae8d7a31b8177ecd62086d80bd5c1ff722fbbc410a85f7cf7cb85b7fbea92245a9027e1111ea39cfd2b41eaf07367a2c63c75428bccbe9a4509274911d2f76ffed07f4f7d8268aed1fe8786f013a035717731fe1023868e3d152bab70411e0a0a4147f29232f02a83933114d4b5f630bc24b51754e5827c64afc886e62d84e1a6238cc48cf04374ddfba479d504983dda11b07054c1dc76792e04213cc5ad026b05bc98814d9417773f500d8c530cf391f06f458e8f1b3d96723f195a4711ee08f31fdd69374d344dab5f3add3688e2c01cb79dbb527edb76300eb733e6298d1315dd19b723195fb15a2c55cf841f7373b5063eb75d275bcb57d691aa202abd6ad581340d9dd17263c897dc85791d1789982544bee3e335b2c50f57e25aa5e14f32bc124786b7bf596d05b2060e33a7d366f35f3e75d32fea28710e17ae3c00876bfce2bbf4b8dd6ec7d10533f512328c43ad33677fb1f8c10fa0740322c7ef99af2df64a52f853ef2d80b46d2670fcce1f164b88cb533950053951ca36156b798701281a85034f97a7f73a1e3fb2243bba58709cd53ada3659e9d9ef18df8de12e5b40286556d01503c96f86b2cdc293c8f07f5a7f985ab4a88e4d4dde7b3700f4167e6d89c4795fb8bc314ed46ec9a92c4368fa532858ac1241743883f0254ff45c605a03dd628a82400183ab1d77be3a2f45125004185a733b0dd169de99efe1e400d50dd70225d989002962b8aef7feac3bcc30b95c75f61c9f9403407c61c240947718f9200857861e92d58e9fd89407d2a8d4f6a2f326c5fb15015f499f7775157f0fc28900a3e38a8c42c9e8bec2bf6162da5030ecada87d8b6557bd4301185843bc4e654ff3606455d62dce75b2a3fa2208ec768ac8d6a967fa77ba9d74632b9294dc62e0d61aa806e5f6d5dcf50f5164261277c1e42bb73c755212f441b7661924661e4c5a42eeca77227f60e5a23fb9bbbac9080b8cef8385eea081e1e2d9ca997ade50c526540f0e66d32371b50fbd269e10668d0f785dbe11ea93fac206700ddbcf51af29f969cd1931a892329ae09710c0bb684f8b67d717c8f8277a4fdf9c7c8a6c78282005888ebfecd3d59e69740158df4d706fa2d68328630be7881bd97c3a09709d14061c53744d93a8990d40f886a0a7d8e5b9d504f9bc495ee6075afdd362699a9d4893c4798e0867634e0f1e0bac51c866758c04d5671cc89bb92e8645c579115e8715e0bec5145a045ed36da44d254df885a2198188f0f688b0fb4ab30d177017bb0c6032d128641dbe1956443b8a177bf949de838b9a9ff0bce9d1fa79eb2c299609846b2f6d4eb1ed5cb0d4eafba4f32668bc3714b6adb9800217d7991086c717ae5f9780757573dd87869103cf1c141c430f09efd679ad1758a465c545589cace87eb9b42201075eecc7574833c7f4b4c03803a966b6cd3ffb69f9681f368a9e759f2c8cfb7a63ec4b9c949bc66b1338eeedc4b5a919fdfa3a0452ee1c5a8d75af599b74a3809e919e269c462c54bff0e9daa1a8f7070eb64afcbcd7a7ee02b1711f4de2eda13f16d68242a071501368a9639095e1e7e9a2379ff0fbbdecefcb3d4f16dff73e9efe4c2732b5a3b74e619e8ed082e388c662e292d9dba7b73a3033a84247e8f435c47659c7e74b435f58cf7c4bedcacaa90c780e7759b9fa9ec0e98c707a348de67d789462e7c58ec81b3caa4e70cb8a519773eee126554c0fbe096326f57775acba4a05c94430a3c6bbb6af84823b5707eb6f5d787b59961d764f531858d180c8264358e7961c461fbcbd523fa1dad731136183101adc232bd9020a70ae62b0748504cce525573a79f7226ec133899b23cb640b80edd332aca427900d61f2cd6a614712ea4fa301406fdce08c6b539df64bfb94aa7304cf2aba08727f56f5d404b6d537d21b7015f2b3f9327974e2485cca464e12757b883659e905dadd02b7e9e11bfda4971055e7501aaee5a3e53cf5894f34ed8390148a5a18296e54ec82c467b1f0df4148162bef2e5015dae62db0ebb9462b0935f21690da07fc03646c69352c3d4a67c1029d5861b38404e7b1292c13d24d2b67148ce63dd4e2dcc5e7870093d043192923c47f0ba6dba5d7df7ee543260ee24153c5551a2666f71257ed1f538fa1d1ee16e66b9edc1aa82df84609b1acbcfa333aa7b8eeac82543e9f94d71b6f4036a4ca54c7fdb9130adee579177d346a6df21c3d5d5f078349705160e995d8a3f699b55f0d73580cfd08760b9ba8f13a65ed622d1a7ba20ae905db63ca82a2c2e35c3af81e29a14b7c99919480b05b13fbd5c73671ffe238d3026ce994304ef75555c391365bcfc8545dd825a2a288d11ba739604be6dea1c82e167e54a32712d2c3c1b563923d9dd47eab0bd555c75996902b9f5a517b5a26cf1e4fd00560eea064d22c67266e8abe9525727362a3bd3128f962420c6b89af807659afa3f8766cbd30ce86311212479165db0ecad04c3a41952bed6ec225c3303026c85d8cdc9a59bc924f5d8cbf3fd04a4219c3625bbff568720d93e4119b5dfbc7843a797698b5a31009225f6f833d822252acec49d58ca02d897d354f2b04229ac52dc05114f534d56a119248e22d4790441b13f666e0d7d38210f9a62ac5cb03e1789df10c5130b99c6eed6cd01ec709d0aa0046195be636f1057a41b7ca3fbf6ce18bee338748fb2a0df9ae09e222c47e58361d65b53253280187b948cc2b30b421a7aa478323dd758690930a3a84ebcfe038992124425089802efd8b9ec51d026aea8f204d8fbc76ead4aa1ff10e9675a446cc970f9b2a886337c4d0b41f6d7be99977b22d3d1285c743f0196dfe294cc1fb624b551fb746d6313ef3aa0364e6ddade5553386c4c8f2b4e522765a69571a6006084d12c47cd623b4ec6b2a769994c0112a7dfc1c10f8e713a0bd4fb7b8ea6f51c35919c62b327f510d26da2ab4c8c4e7b40a3838e46cb848592dc1d0d875de307fee7634db889a0db8991444e3f234d84034f1fa65611edb3936041bdeab67504a840fef7b","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
