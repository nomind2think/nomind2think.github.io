<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"a10047839a61f31c95639d6839f7da653afd204d020335b8b055f2b155c31246273588a5c493d3f77d116886e1faf2e52fe3413326ebe5b00e9423b7e14c95f031fe1b780b4cf4bb7f496f9772292fa488247ed63698d004089be993b0afb5ce7d32200ca9c253e5f6b260340fd14e5690c45fd0d38a1be24b515752f2bbbbca9be4a16fd861c1f84be94ffa6a58b4950743354c20ab2981a19688755e78acf3fef1e2ec09ba079fc3d74611627226306c76b8ad36c49bbc110b40c4fe1c74526dcdcde66f1fadb1176b0199d4cd7ea75a2bc975eea30e7916257c42e94189f721113e1f5dc82e0caf8d14a8a646dca23ad522d771e0c624f752b25b2d56a7c80bb424cf844b7212c6785e8b4bf372e28c2ac3c186e9232aa46d319aaa348ef0dc6783f94830633948555db202c95e39de7d75a7c91b3b66c065fa65982db9536044c7624ed1b467679f0893d937485f6eb929b2450ab6ae722d8acbad5be7a9aab5cc67153a146ce1f8d4344725ebc163f78f6da792cf7e6682510e3b597e252434a45c031687bfcd5dc8ce8130ed0def7f9513b209a2573d48789b081015816061c9a22dd102751571f19e2878478632010b929c97cd3fa2b22a13d51e7cebb4f7128fa8f95dec0c35e1b712e0f0f5bbf30caa57f71ecd2f98cecf6348030d71773a3077ef0168787c3cd0120c858de7428ddb3b1393a6fb1cff090c676b4bad7324eab8c9c7145ad66395d3b2656873f3ff588e990377d85c08e884e4c18d726e6d9e3ff1a6014b8d4fcd1be7a15601ce43e5096353d8b3c50fdd0be28c945546d4538fe5e59a0928a86f6eea425203d0ddc984edeefbe20cf248ce9e65ef3806b126eb4c5f05fdc5c8129cda52f60e31c218a2fabcd4c99cbbbba207c16926bc82697ee4936de42e877b8087b4ae0ad9645c4a33a0d6a398a6f7f071f25e17da8991ec7446296cc4cd62a345e5e224dca83ee9974c51f629664b6e2a008eff25e50546b31a32dbba280545795dd40d02969169d444feac619f27344ec25c37479475cdd5bd3cbe06ab0ab24afddd82b801ada0e1eb640c3901267dc2c27a338bd318db9d28d9bf4b58255dec5314c15e3297f642a60ab1bced82f24b280aef339d2457d6548acd8d6b67734c4c616341e56b702088a6ea6da7b144e149b02132905ae0162404b353c325bad80463200a675de1262adb0067395e7455ff440b98b922e2afd547e04cc726a125a0e323d8636df9c490c28e77817ec056bfd0c35d78a7da15b3715e128d6a6df39946bf53b9a90880ccf59f58268838c30814c27cb9dea90ed885cf22bb4014a7ffc82043aecc71e8369839a29e171dcfb88936d5b2165f14ab4422d9c9c5c2e0af7cfb5101efad445e931d8107b0a93b53e7cd79b7edb73b5e41cc8c76cf4e3c01958f1899965e74a5d8081dafc283d6b5cb2e7f12432b180830ac69b4b0151ea3ee23ccf01b9c2537f5e6a6635f6da963a09beb83f3478b04d613d5719b7065642474f22b096458c19a9b2c65eda6101a0f023ec6f13e5514a34d6a5e5b4598b986e7c62b194a6d561414e8c0e82b973192b8199aed4bdad4a69d5ba0aa8514ee61160b88db4f9b3aa4b35f7be29135f291b893e4a1d9b86e07bb70336ea9a3aca3a2b8c9facd56daaec28a03e92beed37fc87b392383dfa087a08a941130bd8cc5a408e06d9153994914c597d760a1e96825895baef3a3d9d283bd1e29409b4530b383504e991e189cf3c120e1472a92f9d42a3113d5c3ef80a081a3ac5a2230c6015bda04079bcdd600bd8933656fff6a05e0dad06cd7229cbe222a27b814c7bbee993cc73e5d60d2fbf2e6759ff83a9ff596745849acece5aa65420c882b37bd33a6b1fc8453930c9d70471df7d5cec11fc941360539c8f37d051ee4d1dbd6b29fa054c1227424d20a300d3d49819735683766b9fbc5393e96a4e5b41d3693a2c5fdf9f34b0eb3da02ab6d8c140062bb05981ab6c56207a6f977d4ce77be4bfd4d24d9ff8eb7569190ade3a2f1c2165566374e8274e04ed25fd85b50096c8a4d366c2c662e9b774fd9fe8f48ddab9381d7b5b4e83b885f3db9c1e58dd853c0e03a10b2fa1bd182ed9d7c4616f080ff4df933c68b8d1880cc931b9a29042fc9ec3dd0fd0170cfb97a702e111f93a1836762c4fc07455940e200e00feaca8f7e314bfa5a200025b55988e885cb160ea9dc93d4d591da623cb6ae2019786d21e3edfac3901b1d612cf66b9458bc0a0d500fe176527028e40bbdc033ccffe97c1f7afb4cc69c0735f2dad39fbcc66dc784fe564540f4b45fa594d307ae1394b541d8216db0d15484c489d87f9686b821ef444d4fb64008ae9d42b142cdcc512b37b89b74c91e998e1fc26b84ea6b41746894970e489b4f6913ad0e728411c4d1b91e7550ffefab61454fd6bf1f0d29571ef6a98840abfb50449c1e3abb399687182542680334ef8dec838906d35b3bdc58784971092346a79fba8754e54eafb2b8219d9dddb88c39814bea319b742b303ef39907680a7b8cff4f0691209d66da644c2d063f3a3e8bed21fb5f7f71cf6e742618e3f79f0906895db9bddeb7dda15a731ff2148c62484a10f8a4b91ad5c9bc7fe39e2adebcb1f7b9ee3f941def8124f8ffac303f24c36ec145119de63c3e4c7df9a415e14a041c77ffc3bc584db9c82af4f0ee69df7a64a1a7a1f4153637108b93c4f683245b2ef0190168b1a9b5911db0c71c260c4b731f5d7606314a46f80cc856d1cc0221b170da625d08389c3902f5e2a11fb5619933db6e8ce25b61620759f7de981131f3fe097904791bb5021d860403a41b83b083acec8d5c2f64249ccf1cbd70f1a52ab08470046f60e42be0607094905d4e884d0f36d6cd35589fb85f4d6dc9d6c3dd6522dfd1aff01b26e0e81579194707004d5cfb5cd56db76005016bf60a396bc2abc79d8d95135dbbe49f6d29735fa93fe5c32ec0416dbf0bb1e8bd62d361b8996a7b7971460c545d5ee99c502c1cb5ef95c5efa454e847e394e1202c22b57cd6c1a2d31643a57de9fc05c1eec95cbfe16d20d3841145ba7b36fec7e994a677c8da31655cdb3eb36cb8957cd6698592f88bc2f60736b576202fa724d28f6e141aee70ea46e1a9d44182dca6345a9b0712c90ba7bb4a9cb7dfe8dadb9dff1b8dcf9ee39b747e6e0bf715e9c8b630ffd0d18c15583011652dcc6c83ac10569e09a26a84e9b37eb7dd7f063d84d7eb5c65a4fd6c63513ec27a3ee0024cb653cad6707c082e1d8d070acab68ed81249fabfde98b09f7079b45d5fbc7c523bf1af114c0419164dc8074fd0bb4703eb199400d1056a941639ccc556648cd0c5494f18964a3d9ef69601976e6d2d3eb4dbfac506e1e17c687630c47021a0bbf59485b25ff344d2c726ea55f489589005e2d6e7e16f936a68f38ee79b8b83a2c993b03e81dad03155c36afcfbd00e3b76fac7f22c671cdd97446126705149adc20ea5fdcb96ba4c535868a7be719ea0b4dab6534bc4dbaa4e96b370e3be6097311ecb73ba6181fa03f192262c21c7b6ee79220502419ae62821f2f72ba1fce7425af6aaa749d13f8eb0aabfaf9ba04c7316c4ee86d78cd98cec655d29edb41a83c14523853fcd615a7c362639cedc61f6b604d9ae1b9a41814ba95b6e715bd06882130d775a7e3b2d3ef3bc38c4dc8d6b87cdde2e312f2853fa93b0da03a7916d646a0635f3ca9f905e73930b9565e025bd7f2f76b39ea87a87433d46d7b5f9b62c53571ceaeb3a6329ca6c91aadddf453344b5834ebe250535552660bb9ef3e06a496c90b92685986e23038e7dad05c366c05381628f83b324f483fb5771ce149e02ef50afe085ebe5bb58bf54cdb5adabe7b768dfec7992a6bafc810b1ba4717e53ec5ec4a07f2e057014dff7501739e03f9fc44796025257e6ef397d820e68cd3ecea947b0e08a5fbebb22b40a023452f380a67f54e50e3fd594b628c1e9391a02263a21994e4aeba17dc3e00dcc8283ffd3d4e9a74be7b4f5f2282275f91b324471a048b6b4fc292d240eaa1d79f8adb17d8eca1ee7098aaaf4cd241452257926941fe98b1428250607fa9acef033caa93faa35ceb0c62cd8d08aec14c56ae8eea5245e8dc154b9b1dc0431e718d09ab8c5d2327ccdf5d2a5c8563432c57f05c9396d234b2399243ce9c611ad75ac4e7515326e8ec630aab36ad827b10830ce013bb7eb50779013e951240c4092f751689714f974da5b01b65b154367c5d72c00501e734476db3737c7846f631a219fa773088e3182f9c4a9425e5bb651a78e156cb0bf0069aac252c8278680611a7f49daca1020d58d67b8ced63409a641e7872de74d7a1ff3d5cc08cefae0ec8ea0dad4c820cbc6243e545151d82e1aafd43b95f5b769376e6aaf90d865d39c30ebdb1b2a2883c3f7f5f277d8565483ae9b8d642693b58aee6911499c8b4e840002b8530d505e8f5fdc765581006fd24c88bd993ef8f504c69cbe7b62d06d8eaf105c6944a9fd83b667442a458bfffabcebf4714a7bc6e4cb42c29101a914655de5ddb8230c91861852afe7b93d39dce4ed581ba37fd4b113583d64f09e14ec7d35be678222dfc1504541af52f073882d4752a6f72122e485ca1172447b93469d0d39972905099a1b211ec049e70dcb0028661ded1069956c92539f3c9d302eaa1908a44a9b356643e708b67915a1cc7f583b2155fdeeb7e0bee2873253b84d9dd468b8971bf86b8e35202e847c6e56070bb1e92bfe06e5926605dd5ef130010b6f485cc3f8e7672d6bb8687a6915d9729862b8f186f11c08b1687ee0844952f9663ab29df5dec3fc28d453b6bba4ccbfd79aee16f3d7a625ea760aa8641ace505541f6c7c554484b4e6861aed6aef947c961f4c573e341262d8c91f92107fce04437371aaaec86cc1b321bc4cf063b42f9568782980637066ab01bff33ca6387d9de701eff1e5f4639ebdaac49e241aaa65685ce0a29179856c1615c6fb7e16b4b05098f6c3be55c77ab88e98fc03347afb7472e92543031659deb5dbb2d3d9a7461102b46f43968f2d7d3af3da0085aa7984ecaa28d2bd083a2d58c500b2d0e53213a779a3ee8a844da5afa52cfb80598c0c4ed5300ca1a109f06b9d993ccb90d7b340de13ab8c9e96dddffd4ab36a3655c0122f298a1b8ee6ec83473d43620b5b456364d79b60a1c7ee93cf86a146be352da0fcb3f4e1aabdcb244d78fcac695cea26a549b4db4b855b9fc9a26faa77879b70832ee94a5eeaff2d33e1ee6f96c27d1faf5112de833ec97e6a3bfeb96bb924736bd447671306221e06cda6fb1e54771cfbc3e32ec884dc1b96c1f167debf65b28762e785da219342b63ab496dfddff2cd06d0e2ed2111e143c8c61ecc5024a4e01fda2e350a58f74192d976d86c678dec6663a7b5be4b3137110eaab70df26666aaf57d533db8cb594a2f60d8445743d07e5df214c69c4709e254522be0b33f1bea0183d4bdf943d7da86dcfcc1aa0df83404482c28e1f35826274b39eb4b25cce7df738dcd08e8995b6a85320a8fb6fcae2f539a15f49b045b8859cd0511e3ba12028c0a566d3007eab2bd8ce1c19928b4c9137b4c2f548ef4e3808055e48cef0e48edec188c8edac48b61a53a5236e62876aae500af9ef6041da7af2837d53bb2508d2f4017f605f40624e5ca92610173013c7e31e10087447ecfe9822ca94d56114e13f300ed0e2ac214093ea22e8cb3b25877ee12d889f8097c163ace40196a4628d819f5d139e01e76a4f180cebf7d5f7cf0623f53fdad88a0f927554d91b303f4c1835748a028e83a899a5ac8944906fd02e1fdd7ce847d00f6ea65b032db3a429a567a0f430eff44898f2ecc5ba82a483ca87c4df89bfe92384f0927c74c9f876164750c917cf190f51fdacaca0ab1b6fde55685ca0e534e1cf337453a23ab2ee0d6fe4872b3cf3117a7ea38b89840742a7c433efb4fd58ff4b0f2a28e17e1e36692006d11bb2b041904250d20eeaebd8479732a256c34f2a1ff4442c3f0b488f5e9e034d40d12918aff4da406c85c5d6d9712e2e613de462058b800973aea6ffa6fe8bc46c2f04b1c5a5bbf9e04e62f1ce4c47360d844cd9d618c71eeaa3873b03076a86ff70acfb23ce8ffbfbda68c10566b0a42123b4dde6509e8a8293fa6bb285ff86255092fb38b42afe050f19269fc80631092e6f541fd84c014e16c6a367cd038122f5d73e15e6fe4e45ca46ab5af903539b91c3b8e476bee55ff193bbd2bfe0e59572ad0e0b043258e547e400d981068c50081cb1bc1ddb5d6878a4f29cb5b103f9cd14067e9aedc58e78b65f918e1074a14ddbf48036b12833c277fa526666566869e931852d62e3ea5b79d7a34d036110d53b5cd4d8e7c7c20314931d519706ccfaa6a0b89f040a94b24dc66737033b7eacf21d628dcd63f1f5897635ea91029aba901c6763804e2186dac042c689e3776400efeb195f09b72f62cae6e97cd193c8cf7ceb3d768062ffe501ed7ff8b5db33b02e23d20352ef2512aa7fd3d426df7786bc7c388ec4e98948e153b158097a14863d5f6510514d00d7350fce6f9cde8b2487d4f71701592b0ef53c6436497cbe5d68d97f27c6dd55435135bcac3e75aecef33f9e66bbb5c48b635be7abf683ccd52fd4a5723c62d11d8870a1595599eb04e761640527d85829c6d8386919a84dbe19a539294c4521dc918d512526fd1e7144d5e7e865bcfc1de2244d8d3591a14552f9f31a8ab53c799df5d20f530c04b56f42be75894e829f52320a27dabfcfe177499a627e4a512a0bd2d2833ae47c5e5bdf85941dca56e2c94f0eff7a8e909abda93a7e40a01389d79946adef069cc9c0e322f909deb43179c86c44e5a8bf12ef03685de918392497b06502e51d86b97c70fc5e2c3c43641103eb76fe51fd57cd8436ad187c51b90fd8ce586b74308a45954b81b65caae7eb3d2f3cf45f29cbb165dc7e80df0611479b93ede04fa7aeff29d8af6afe027857ba25069987d7385cc4c8a1924191e878062ed9303e29d98f3bd03aa0a4ea32249bbcffc831af3ae6bc5e9b4b7a7bacad01b4ffd3b9689bd11f28e57b083684e18493650206d2fa207e1f18bf2c1c351587d96a87183aa7a123639f58f97f64b49a24244901d1e10f910956a7335041a7252b2805dbcc7e9c53089356de175c7e9fd8f75b7f93f4f9e80a2281596a39e86c901ac8a687735a18b85e342e800a283a978c77b25aafc17795edde10317c641feb8909572cccf67630fe6c6d6a099811937b01e03fdd094be9617d0ad42e6359629db2b782f35ff429fab4ee5429725cc531d94217bef0130181c7cf982e2d84f22bd7f240b9a94b3575c7473dcc89d4c7c505a075b8ece53d56b11a85f087ae3f16f7ba7682b69ed3981880038f53fca8c0bdfe3c5d30784d7950f5a6c8bc5852e111238bf2878fc1b8d18276a439126ae2e493db8316ead5ae696f56bdf85b5c5ba33d3ea6b29ec1aaf36487603deb5ef65ca313075e6c59c583cb6ddf1669f1a8d3346d59ad5c549125863e187c4a0efa2c67a6490212cd61dbb54e1d909108c464fc344f86ea19dc3faa4b6426a57e4eb3a3680d7e4280031e980dfc914b8f7f7c6f07953c46cb1ca27c41af5f6326b10c0d15c32ff847c211bccf2de1ed5643faee63da6b07f6d8dec4626c53b47f6efad5ff4014bc5b3bd318d51364f2858939840f650180c3a138a429b9d403a7f739128071d78099d05a76166b5b04efc62fb40fc89cd6c102786e30dead4176a5cd4bd4614a136c5d0a01642c1420620e0565fed19e1a6fa4c7b41653042efe755d7efac15a9642877eca8ca1ba1c4205ada2132b4dd08dc2a2edb4558909b42f48ce5609658c98e5e042a88461e3894b3404a7d5373e15c4b0a28a2d22c864f9f641683e48d74772daedc4e58aa0992785dcb3c62e8bc26da7aa5c6fb5a5becd7cb56d39d29401eb15b4c7f8efa083884a28313e85d47358a12321f84211f2011ebc95b7244c27dd1f64cfb463d26dcbc5a54b739179122ce928cb125e5cda8b01237ebb827b911ab9ee128da1e92aeb613384ab3338f9de154de4284058452f99c2869890a5a447c96332512b4e695737e463a51f89a1a244713f4cd77bb753d853d3e89bdfd9239b0d05f110b185f8a270770f580d6f7f79b3d98b9d523335e5b7dcb83f91d3ef11efb0dac04e6d5c3923c574d7d64c32d80eab54c300ef956c808a46f913a0531f1ffd0eacf5f25f212c4f47e8879516a2c693a38b4bd039ba97868e2a94ac9849cc9bf2d90605672b0c86e12268bf9e0bb2f18accb2d45aeefeeb92e98be87e5fb68e64a6028f54356c44b1ccddadc24b542f7be4fa0b92a497c44628d4e4d397b28bdaab8c5350da10f2c7e8e47366c94fdfb2610163b4fe094bb2a181bec4aa432be37748fbc99088c35c185379517dbb55a965f6f63125a6729e97204cf392b1d031e37b96bb1f05fcaa7fd105bc6dcd77de1ff5ec0c994d2b6b49b57ef5d47c02f3050459c7fa44fc5d1e8f17889d138d8f078b7b125b0980d807b29fdc9f957ef240ab27aecb51fe8d5d83e234622731a0c829be6c702e908e7c0dd6fc22c668d3fe39c691344a0ce75a0800f6822374bd51a4d79934c226b66fbf36ba54676af452d716143784466df5ec03472e7d63fb6887b649bd9c8f6712ceb76bc46e6c63b378d8df8b79bdc2554e3296da2d74740cbb248bbccf51d9d588d0a1689d720935369bb76ae0692d0f7114b66a5e496a968142f7c10011b6935057fec0b62a648a85bf8d06a5d60ff45736836f63a095a3823950fadc9db5c08ce2dc760121a1f66dd26c10a72fdbc9c4f53e4cb20497f7099840d0468b6ed9843a24671f156b2931d3a92753f3cc242317205dc562509852249492475c340820a97047b2171c6de109b6685d5dc66b263cf98e06a396208d97b0c52c53a4f850fd471842e03996bc72cf2205ebadaaa3c283c997c53a29c07fc0fc24fe8628f439647c6175ee9f52c144c4b39a1cd11c438889dcb608013fb30d92905b295cbe51039e573326d7b89d35b8f21c5bc1d4345e84a5da06c04e4e438c2364636e8de4cf146c2b2ee4034b3e13606410825516aa9ba7415268e4d11e7d7ba235e103368b7ffeddc8192095904ae30a911180fa4f6e4bc59c108a73e91f4f9ca60bce8004b89ff113e29d5a5dea5b8571786b36cccbe67424d4a8683bf8532f5df43e4714b15b1a122b43e401555f2a2158e03c57b81509a3b88010f003c6534ee6d859f0fe49148f053ad713f2c7c2b64fd12f12c303755da147766d1cbc53edfa4fc3f8ae36a7d85504ae1a06835d3326235e3cb84f145c051de8a106d907598b0865471239c7d954bb6325342f72ae7b547c77ead426d496af9b5d150b55a0f1a5b420395105600d796de988ca552597e5ba947fc76f4402009eb223b588388f45251952572e0dea35d0cbe6b1a0a4663faad93e04a24a5a4b4bc12d3f36048e4582081def4d0d795fe972ab88014e1f996f7fe03fd6a0beff6de01d9587058ab944c6814f160e0b869d19ad6d1baa20bbf44390633ce83f9dd6e7d26683d78fadd99763055ac48b8fff3495352ae008175d05ba7ea7f81330ab7c64f08a9cf60758fd0b6a289350680fff1326f6232a6068975318123c239fa0fa5ffd7df6a5fa088254bb809473f86f7f90bfa8cb731dea7886c55df82da17789af4990c66566b8d3d3cf46df2dad313a096009ec37b557c38fc80a6c398a6dc1fb69d35a563f7161d299e97fdb3db97d540b560877c4ce47431a7b388e23746d0f17765256a9080072646b306e7c8f7046d9178409788a76daec538ec553337a945d8679c7f79d4e21c01cffe0a153b8f0843994a4e41bba3b3d13a54e3002336fd34816ae7fd2a45865c35ad4d287c591cbcd04179effa9c1f1a6e4cff3c875e37f1f14fdd65cdd3680774472b1af15344b8431d6dcb2355ca3ac0cd525457396d46859a2f4ad29dd8c0262b5a6fa1fead5b66f40ac59d9f0ceb078dad09b621fecd22ddecacf5cdf367db0a6f026c28e9c8769abadcacd2ee553806211e306732c6927f5379071ad28f9086c040434692ce14cb0e526e472d785c54173e12af540c3af9a3437b8da66905b1a49ce1b6fa5aa1ae9a51d0aa4fade9056e99003a3d8483a8d25ab91a6446f12c73c7d03d66ebcbfa670695b38947c8a1c65cf9e0ed6dedb81f9611374c4fdae6c505bf6edf837c0a758dce07d78d2ef9867dd895fd38e5c999e56d5c8dc6fdd5c1b520acda6a4cb0493ca34def39753ebcd88afa559c3b97c6374838af4b3937f8289541c246077e4548fe725261033f901ce4f9695290ace5812a5b53a4c5c80bd982133b737f475026edc7c3e26e5baffe29991b263f2974c7c7695e45672b185137ece231cdee7c02d8891075eb9dd4e8b0a40076eb63a0549eab94c5c8cae50927313eb21b8ad0309bac4bf1be7a3e3ade6b025fe5f4aeb74f35f0f631df89d9a756d647ae2cec22b226bbbb586361dc8a1fb47fafb4c1ae3c5c2c45f723200b43bf79efc5f68028397d28ecc77e26d1bd4dce8a286c6824d09e4bdcb20a77179040c16b04afdb960eb2b0fc458ce96e06b7b05b49c9933c4631fde46eabdc2886382a480fbce04db87374037a64fc7734d36d3814cd090f382a6aead84a687fc2878cb968d60157f8606e447c09c62628d10b188e7ef3f7428db6c8fbcc35e18594b32959be91e16e37b7e60d5f77a06730033471069bd1a67142ed97ccb936e5e983282dad5a07fc7452d752bb2eeaba4bb01047a1e246e3338ced36614a84568631af717dd7639558b76372dbc73c90dcead234e36ab7ba061b08a9a21b0ca09826f1fac6fb575e21216a5c1d173eca65753b1596932bd1430d6e824b1c6085724d73fa8eff80cba60b9c3da913830c1b661767d5f10c1608761c541c49ebdf4eba140b1ace3eba5819982be57233b46304cad6e2a3c20dacdb88b5c70bcd63fe0f5a2fd47595bc8bc83b1a6eec171732066286f3fb121cc65fbaf9b3afea43763c94989d39f0aa747d334ac53a2e6f0954a8563422b40e5e9a7855e42a339ced4f898d261d60ef6ba4f634d318cb6cbbe39efd95d13ba09b2885cd56c34185d38a5ea8c3a8a41fc3d01fb08ad6d2998cf55c38c2e5ff078248550f596e1d85df17da3a95c4f539bbd20cb4f4c7cbd513732c24179bb7d2a2190d43ebe3a4d159f8c2d7fa10fc5b4006bbfaaaae6e6e018a8ed4c95895f5f8171e12e8c7c863bca3cfde4e4471858a7d9e80c1618a0429e62ed4b53f3b7eaa5ef0ee9a2aca46686aedb7152dcfd315f16a114c7de029f4b2e38f2147d312794f93595393b32bc3ce5d682dc862445b044f8c07a4726e39548daa2042131bec95c5da17af720b429a59113f3a6f7ea85eff5c5a720e1b2d2e0240a9936440b47df55709facc4b928d193c19ef6823960e669e6f7e39f9b667b28ce9467fe44fb64ef88c2410f116f88d52e3615ee63b658f20373656c2f270ed3cf52922ddb2c5cb350c6d9442c527bb1d32ea47c9bb4045898e9f5eb297d2f7e01fc7550aea83b6c7e62826b515545214f43928463c856a17b6bed07a3dd611947358c3bece63274b984a6d19e512a0015c8b7cb4f8e38eb32b82c836fed34a7f2a532f4809244589cb82e1173ac8b01854d806d86822f99dee59dd993bce607c6c7086e154c96d198918b568811cf8a93ae75ab62a004e278bbe876bf7c77c9e44e5888e898f8ae2c8465be93ef423a4a3c64a14f082df9fbc3183e5ebda67fc9ec6dc61d636e408ec74373dc64cb1d8696a2ff5d7aa3b1252b53f0799460ad99060ddd86c21c9919693ae6f7f51c42ed01b4e251627093deb50aa5dcaa3f02cd6c05a752e868e6602edac62861c853aee7c5406834f9b6d4bfc47d37b8b761140a82c23f4875d086982737684352670c49670aefaddca28eaa79540b043ec81c296498862f31e51a986ed3be2dc3e407e63087302a431f32adfd4bb551e1840971f17c7a250a7a15aef2a903df66e6b9cebcfef74cfda2756d310668605f4189b98a8a5bee9635957967328d352ca900a37fc5d888dab7b0706c3f83eeccfae59ef9dc641e30e7dc1c3a2f6c6cb75265c52541469b6619e54280fd8e5e510e759944dcd807362876fa7488e2e1740be3ba0763f83da44252d3e70698548644fb7acc4d651fb8e22c2006a4c87701b7f57bc768885c615790ccad726564f131b8b68c3ea7ed6e4326425cc3e8db4872bc9d96ca2ce7cc87e4bd9c5b95c66d5d8b305abe8dd196f4332978fb6abbd55f851018c8260ad9a5fde40e538a4978259bd0e150367777f21a6a276e8459a0fb5c433b01a115da5de22d7dd1706785b0d4a3dfce8bc760040dc6e2c3d21d3f7ec4fa42ba1f7250a03c5e58417ca6a23eda955f11ed97847c1818cf1b12fe3d234545d619a7de57ac30702664be669296bdc71537e3b516bb37a245f45f64b5bc2ce384eef0bb96c4bba1487e5198ac8f0dfd9e15c16caf6541d4542eef0833115194b9c450f53a67a2532981162aed2187d74a195502089af9678669199a45b1a3fa9eca8d3f1a64bf3324db606b03d02492ac87fcf57e2074461717fe77de76586bdfe71168b8446efd4a85b315dbf65b03e469de4860dcff084d77f97a3c8a6cf9d199ef02bd31c582dac9eaeb52b6df167d0e327ff52ce53052f327d68457fbbbad856c093b3559d9885924d634d90d9a3d6e7b754d06ed4f429b791792ca903371dcb1b06c7cc48c267f483ee2adede9d771f85888aac9adb5e611085aa36eaefa92f85c986a2c909893ee428126083051c9c4ab00fd3a2b7b14d66b199b2bcbca8dc4dfa17441409a2b06cc640b62c58c81833715c3ae7ae088721eafc339adad7d080a40ee660d169186ce478198e269b00acfdf9344c9dd86c8e349eeb96fe4636eb82d489e8b8c499726fb7722916c69279c16ee320984ae9993be017cff45bd627dba36980196c1e35304930d09de3a92885200607da6a99644ab743979828823971b13951d52b5b9d01826f6763fe76a46d522e0d8d5af57805b44d22795692b929447f8b18493e17cb2f55a1f37671318da864d4a0bddcfe2423e9120abbc580e9c6e91907a595c079b041806413e6e3655cbbcad3e7f3bf6259925854b26c436de19c190bfa1a078d1806f4a6c5f607b21a19aa1bd7f7d02b149f3d785af005ed35b745a89fdedd640af3513a1bf7c1ef6c7093f85d75e338f446462791b584edb1eb19682dc8300759421ccde4ee96a063a8dc7f13de50c1c95ae6f7c27aeb7aca879ebbf833d2ac6025e2554cfd0cf6019a2ed150c26551fc630c44b66541b0f465df8918a20c95dfbb9e765f346075fe4f1fe9111e008d1e009463ce13da08bd745143667bf14af6716a795bf9cd6c8799f2265856a11f94dfb848766eda41128b42664ec2dacc0747652303930291adce60f96095158aa5535d1d5766ddb64807ed4a0b73d85a10e0417cb3bb6ae8cdd2dbc003b4462050fb766743f4ec020f7e658422b640622cbb1a91f3a9ae9d88a3ad0b6a1950cbb457b8380202f9dac2a590e5a4b8636af4444164af97e7a0da37496461ba00fdfe388082ec366eae941b29f5ea035b331d564b225cc4213197d693a89a3832998e9c14c31fc4b09218ff5c3939f0725781d9a8e562b52fe2b9b0250f6ffe4145fe50478a922aaa614cfff906dd79fb6ae473a9b7886bf40f85684c1b54d1589b5dbc4fa91b997d92f83578639e9b7d2db4434081de9869c29bd94490e3ccf4cb6f50d9fe66935fb3b3348cab2927224830df0693840e6d0d3e6ec56015d19bed618c405977bb5773f04838d16d0c9af9e95c27d0591c76668a5cb0115e9ff601a4323b05f1d355b82d05c4160a52fe832b9abc810c0ce5ff69fb96de0950f7d6d9ffe00e0ef145dc98c49d8338cf90555597fb0180833c18fb31e272f6d64dbec2214ebcf660dbf6e4f8af44563645ce4664ca191ac2eafe5d6ddc32589444165582510129a8ac4d75365aad3a5c7c3e933add1686c5c3a3453f17af8d7a985aa50763947264e9f2935489861fe9a9057ae1e0ad2625ba6a1ebb649f71c3d349deac6f305bed8fca486acfbc277a99aaacfb20bd3236a3cadda12e1c0ea58fb54595e1f9af69f907cba32ae521016e4bda94bb73ee6d454268dac322bd931f169b8e245810a62de2c2267d494437539550cc5de6b80bcf3f9ab4d8e3f7ee7da25318a39eaad9cb0fabf5563f45da18bd9d212c288e615ece5646809f31ec1decaa57e91d8b25c461b11ce12a7b99d1fc611d0b24edc7f2d97bf63967aa6b3e6608b801304d6750b062dca65cac526f1a541cedadd3cec07f5cd29f6538aa57c68ec837012f106f15b9a512eff81bc2e39e07ad24866ecd0f0e96ab48774fbaabebf1cfbcbf0b1888e8ddabd60fa10ae5103509ddbce4f131e1311c6639fceefd5ab6378edcd9cb2256c76efcbe5c36a42b42d1994489efabd4c03869d31f49d62bf1e514c7fc4df313508b5183a8fef1b4d0eb104c4efe1ebf04aed769e36ee954f94e715bbe8bbb2b857db15d31421ab9c49d5c9266c76a0ed79ff30d0ded03218eb4db434da8bded830b4092112a71acacd8e9d81ee9591de68b3b68ea6c5b1e8bfd6fd9f0f8601411ebc789b530c6e8a819ae5495409173badc3a3418b25b947d243646961e6059104b764af97a7dfcb65315cd8701f1714b435d1ea0d1c3e45afb7c67fb981d6590ea078d130eac09c62e95e0169a8ecc3a0e3870d43b143f17ba26e1521f166dd2c507bc7d7b7d68898923d33f7478fec5ba65847297c05a9703e3524b3462571cc9181672a3bb68e4c655268624166c0f783196460286b9343300133e00017b09ca3410cdfdd25b468957c3ea949e17dabdc7fc1b54312f7b5cb343f574fa0fa9fd2a774cbb4245637469d0c51a22c49e0a29d4722fc3e812e6d3b4fcbc21e62c68ad42bc09a08d5d4c24104998f594de36ca95d65dba93e5a8d4530d3c6d49c0fcf12281f233779fe3f843f11199c302752c91c65a4a534fc011df438b9a77bf5856b3d80f09b820e21f19809d3dfd246382992a7ad2d970bef7b1f7cbf89ce89e101d00006d9e548fb6b757f7701b9a386b41c1deee3ce6339bd7100758582a05681815798b41ea4bbb8bedce60ccd96dd65b5fb0770828b3ff9153ea246875f45f172ba1474080493586daa7b242329408960143f9277bab424cb10a72096d6a1dc82d21ac3d51679ae11c2b9507987df460e788b77e2eb3c08406b291047ef2b6c8a95240be14ef35949e981951aa92f314ed0bf6560ad09d010353e7aa37cae4b8b5b205c108bcc9b2fd15d6d3a05be8fe709778fb65d03cf0d23c3da13edbd4a879d42fe82a4581715d0e72f45c64cd51ec8808f8a3c433decde69f6ed426819a5403553abb319118f6fa47c787a75092acb8bbba9835185b9546b5c0d0ecdc352567c7e1a421a81911c4c3dafc27ff1bd4d7db870777e26f3596e9668ba9ca2812f8a7d667c276d5f58d8c5971d87b0cedd1acb8e050dfd42ad2a5fa58e8b399649e61385bfc34e8a0f35b940bc39e5a1ed428020b163b612dae2caed4e9f73a3ad464f5f7dffee0fb7fd565662ae9ae968b4c40012b85ea01eed18cbc034426bc9343ecd47628e80545f261821a41378a1819e7ea3b9e119e1becf9199fd282be19342cda639bdc22056ea4f7c1de22d4f734213eec5ff68e27808199ad95e237e4804f4860b97e7f701f9266c719c9801033fe5e1d38996fc89172b1845c0971c1fe86c6621a0ac1ffd62fb0d9116313de0291dd31904dc3da313dde16e1d02264da21e4e03e26bf87397d3e23ab972683be5676ca39ef2e516bab79dfdc5146c23ff0c54e1186555ced3d2225ae02ba8a7070865ecc164204af174f86a1abb9d27b4ac200a0f474d7f54218250c94673b88cadbd063a2fa1cefc72aed8c17c7e3fe164f1766110288beded4c61c5c9d4dc01264312397c7e3c7c246033f0cf280af52faea8bba70a16c2d0ecb690179c70cbce1a21ebd9bb973d802cac72ccaa0429655ced93a0f57d3c7f456fe88fd1fd396b707782ff25407b61ad13fb794c89c39d79072cc0f3d1a1d5f8c737b751451efbb25961f594f641330d122f3c09781da16df8ba85b46c63de2d7c11317af023208b4e6a871b7533ba90ee8cffe1e350c241fdccdd2f1465decedc605b9f31ad174dfa83407d48df3a0e505ae4df998f8d565254583a7afa0699e366223eff304fa583e61e19e72a0bc6489811ce8cf818e30382378c436996e00d7ea1c9b743b598ff8cab21b360806fdeb716cbfaee3e535047a18fd8e554fe6e4c250f6684f67c9c548a1214ccee4599077317ef0268373467cde5baa967ed09e52831714d7bf694acfc93ea23ef3faa41fca116555ab607e82e66e678d5debc95e651035ad824affa510ba2dad71d192de76b6e2774d21438058c0616067806481116b857ab414d550198d89d7e77f844ab0d4f436fb4570043ae0d5d13ea31ae0b3b052be90e005883120e020fb9073e80a940909fedeff8bf01b83cb22d358de068d312621038365a98c759dbc396f26e824cdf79f507eeadb091c794dabb4382f838c5363e69e95e0361efedf4558cc863093601f2be1cc9f31446e8780428f504a9530eee2385d41e22d3d87da3b265ff175c37f4aad1edb117db18b2556f186502e46dc8a339f79662e9ed8f9df19c83ed6ad8c1d2591659627e03a39f518d8c815a3b9c913911c72f5cc3b86c41c814f4b4ff78381e1bd73fee505a7e355470c3246b67eb28d6b094d5d249e3b007c8e86d4ca81e91005616075253556818576fbd7f37970d022c57815a0c4d3f316df8df2087de8b112e41e01856835ab0fb46256c25d276a2d1405bd145f2de1596a0529874548b378f3b03b8c4cef9a45bb3352492ee9feb91a310d35c97c0eced7bfbca7537c5c2da3052e859fe25c8e24c056bffdba44f60934dbeea59fbae945a4d00327c68e965325420c7a8dbbc566b60e81eb175e629d76d1d6ef4701d6f167dba25416c66eb04ece75dcc103452b3d3fc8e32dcfb1a783c5789bd119b06952635814321768526c5a98dbb75e5d63eb759e273dd7de37e37e6008280789b036c8457c1adff731040ed9a54a04ee0bbf3f5987270c99d2ca28677411bfca249d6b37484d609108be1538165f5904560e5d018d5dbdb697554a756b149346a338ceb4b7c39039be696f312ceb8e4e6861d8352f14c7bc6140413f6277304eb2cc6ad260753f184db41a7cecb6a979d1c267e33fa66a190406cd00b6fd85d70df24786c4a9a7a939afd4bc5b7147c37a15ed6c278f55d7ae81b2ce8be222d42d1ddba9bc7de4d56137613ec19afc4215ee18906c91ea205c9b07a802880278c40fb3135c6c91daacd63be8744a9541e606d8e1c54e059e5334450e1ed9aab11c38f5dc7691a0d373d82c919fb185b7b65b30c3d2f773b4db6aae316896c64d916331a5e16f688dd4122945ada5fa62290ee6a17fd32d9ca90f9a0acff5df33a7ff9335af34b99963ea6d69c5eb20e805303d11dc55b3cb74432abfb218c860bf43deb69cb585620274b21505dcf8452633fb41d692723a9a7f8b5127b5057efee3e159351e8eea3ca5e420c843860e3f7f1be7fc80ece68bd11f3739752824123b3486f1ab129d3de12262722d28a4d0a019c5eb5a7fb1586044de8a7b85ee953baec3c47a23a10ed044f32ab2eb87616fa5f11b117d3be2fd82ac4d36e7cf5348e7b004472669b36b941f61615aa013c834d6829870bf6b45a99ec43f05c3f0f0e475573e95c785156b2cc17a8e858f55e69bd07bc605c71d2ee43912347f29f9c0a1dc4bb9cab56fdb07ffa58d89fd29aa224bc33b84d849fbb2f37e0722d85f9aa0503d5fbf2ff2e032c4e1e84a5de0480dcaba210a1660a2525f61ec9106fbdf480c2102688cf8b61004b163f012b89434eb5db3ed159d0122ffae20ae24b94d48d6480728c34dbd96ab5788aad913b69f54bc9e157cabfe675ca77af8575cdf2c0405747dbacbd4c219dc769d8c3f319188fdf0c95747bf4366fc5fdd05ebbd8343ebe0c51eaa0855d566e12272846d6eb79df2bfc92df5edd5d9a761922855381c24194d9c29c36df922e198383d5ea596af443179fd62700af65be56f1356a505d45949c815c6a39b4bfa72750eb1a4d1ff4e8946639ff76a77c6b393066af7951acd5d7d57855c884a2e218b28a820dac0c4926409e36b6ee2b8fb030d5100f12014be762560c778daf7871692428ea45f8ca32eff66381a3bd2536be5beb849196125bff9d203ee510e16648a6cb5404981d4b84a5f246f949bb74df6b40fc087a154cf297dd961d2df72afd1f2d0278c5a429bc9dbef6adf5a46d49b881b36f13c473a4bed05e4fbe78bc0920bf8f0e8276b1a530ee153f170edd104b4efd2765ba64bd4eae41cda62b3b0769e1a079b9d09f585425a8b7543917913a9fc64e186616b362ac073b4cd6c33cd157f18819ca605e30f7e7ab503bedbe754221bace83b0489834d0affb25e61cf2473e1965b155b3b75a568b10ff681a5d00c7e699638dd8b3ff65aa49ef49bbced634f6884bd35335b61c6532d563707cbbc08623f96d744fc24571f276073330a530bdf03463fe4a9d45bbebf25de43559fa42fa7e7ff753fc3f9033ac3398e449a2a70fdc2d126ec1e1d79254e3a8363a4bd2f9bc80f1bba1a41b9dacd8f688f6fd135696f5f002763c90ebac2db6b43de3b5c57c886029cec7c123f011c31cb9afb39467ce1a530c5145573b0501795e2aaadf7bd2f7ae89ab5d0bf9294f2efbb27eb6bbca51272ba1d3311c890a1fbe674719c65f12a5cb05bd24c878dcdd30e3ec3d9f2103914ab75f432face77d100371afb412426946fac65068f65737a5e74916e1aa33668a4f4eccd4c02d46f3e5f11c65e06c1a950e7f51ef99f651537e97749960e60b892907af12e621e85e13defbeb289ff2b02776371e6ede1cd1d4d65397f5e1f3bf9ebc4bf186785e7f0a1fa020e87c34fe9a3bd7c13e2f89ac089cb437b2462cac57e60be88484979557ea13fc3a588c5137258643f17056344196551496f88f2c461ad92e18e0fd5953db69f3743f4e56f20425e8c64b798b5d124a3bb6fcb448f53ae54af9c2cd3b844cb4c5551407448506c3ad458dfdcdfa365ce050803d9dfc289d1b7cdcff19e60f85356d35cdd818a73a1bc259749f8eb780c23b413db0d683695da2540f8d9ac1417a1ee297840218c661633fbb9e395cde0a6fa3c3b69d8ef0d715f80fbc69f8427dbdc3ad8b73aa9b782fb1182d3ec9b2c28680edb017eadd87289f093ef0df120a361095adac326c72c954aa99428b1418718171fe3c24210298e248ad43f653430cff5614ddbff147d419c8b00849b74aa8965a2b5ee724f665c8332228b5e6d0eb8422b38c911be101bdbabb52de2fa9cee8bcd46c70eba7d0a14564137210f9323afbf8a42fe6dac22c08594b855902688bdc90f8213263aa4e0446e3d4192dd1e005f9e10615ab1c952aa923ec0d714f629fd700cbe50aa0d82fd3721e40872ea3d2e5aece14928a84562b9b836e8cfed29e19e3ae8a589d38ea66018de0011f02c8d6a08e12a0f9f354a0518dcc1d92c88cd3d0df487352f88c728bf0b85931d5e8b89beca9c0b465f0e4285d2b659b1337e748618101d1088c58e860f8d9efbf67d77b9209a18884b67f22ededbd07f3a45effb62d38b1c96a2d1e13044d3f478adac5cfc91f333a4b3590e9765d1c252ae6c7cc0b0fc9681cb068e555f7beafbadac6584bc4a0c884ccaa0d875d8299d7b872b39f4221e378e49f9e04a26d1574a608e4047a629a3baef4913de9afb2111955321c63ac03386a7d17fe3de06c97bbd989de10fb5974a3a7e30adbb571e6a9eb57ba6b734445fb6b926eb15711878eeff8ddd06a5c1e0b09e9607cd1bb1958ded5f2ed8bc94bcc55566c770987219cb82ad378e605b9191ace6f663f58e3ac06735c90cb13874943370b270754d523394f46d7f65ee46a1e1e517737ba5c646ae2a65f74c2f80cc7c5f06bea3091cf3eabd19d24b5062a36d090afb84044b1355b29f5db5c5c7d223242be649794d6dc35b2111548eb900f25117a1d7a3c060c3428a2e479b0253e231633cf421905b8eafe3707c3e5a921ce1290350a86fe1e0e3ce4b63ee31933944e9661274d492bf4895abbe3f77","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
