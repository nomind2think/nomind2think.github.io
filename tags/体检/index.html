<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"121d9091b1d7f4034970f08bbd98a633695c160eec2232fb9c8c22a3af2e09c2a4534ca870c682c177381ef415629ee35264d24abffbda46b1619f6ae95d99ab323277d4fd17a6553cbdc3c67034d75e58a3dca832bc6a3fb10776b1276e63fba170412da1761b9db56b149fe8130cab50f19669512bd298ad9a4a075d8c4a3ec391ce1cfaaa93bb6929c9097e22d5f5de38d03eba8bd1446b0d978dd9d6c09e657a144cdf15e9aa2a358319f5f8d114aa5ff0a521898c4db177d321c8a6e56b95c2270931126fbb3bc8ef2f3d19f710a3a611f72c5f02561505c752fc2de922666ecc8f65db04974099c8de0272dd79aa9fa71a4da3b8019eda5c6b0170b48b2ceaf3e873e24a9f6430132ad914d38ce7f740b81d338e9c9edb2d1f35b9fb4b59f5ecca121dde3df07ab15b74d30bcd0060f18937f00bc3a6ad90d7ec8a0ed173946e8b12f724c519a6d6ed38397d5f4c712a977715b4249581f36b8c0f03027add01ccb3e1a0bff59ca417b02934c7fd253f5b9b1fe843b95cadcdbbb1345f52ad2f810b7379ed3100bff9c59de03d8b78f5ebaa4e3d754dd67e13aeca7bbee4f7946723c138759a2df9063396fcd4bdbdce49404effc6efabbf13c83d4fdba0d4cef16ecc57143ebd451421612831ff6785c8d2ed713ebe8053d058e8370fbc1f0cf06eeae028461bb473caed10a7ddc886f8e01e91c010c6d4424427f965f23c9abee3cb5cbc447e4893d886782ec1c6a29d9310c22743b1d7e2fa24957fb9f0149ee5a7506bd5236b66a2bd8d11f7bbd872c34fdd817d4ef4ac52a0024acaefb89bb7464fd054fdf4455ff496e86cb8734b70bb13a96fc4a552ce4684907ab893423a2bebb77036ec10596713e6d996345c1c5f1042a172a07bfaa2abe4f829849b55ce4258c3bc43c1569088e292d162a2cf3c6d6b90b52bcdbf08c8e65c0d4c44cd0592e22763c91edf9351bacca9f6709fe58f59bf7cc99f9639431285a90a38511d6a137735ae94ef7f7b0ecddf9fe0227331686be0718f8a4ca3743b9856e12c424459a4cd9998ab828f6393b818f8b82e83825c64b80d7221b682285a5bbfcc5a3bbd5641ffbf0089be2aaaba77ef87b1c5d1a715ac2d8c9d8343dcbe664a49e1d0e50d80dd6933a2af94ed0bea7f8de277ccd6d4e14fe6f9f9d6abdc3fef479bd0757958d2febc6a1ec7956155691ced37c66cd07ad1111688268d80824c7d4ced023a8fd2bd928d4db3ebb7f357dd07a9b4c81be96dcfe90d76dc7e6f84989196778cde361428e75e65c095d67693883c64ffa38b5d3d0ccf3db227580eb2df142656e387ba5329a0cf05ae0f8a5855e5103b51497183305a79f1d35a29c80ec1a8eb46fb8c4285b525a58d81daa8a751a8919f201e5ef3982791e980780ffc0105c1e8689e6e76b5833a4b063f0934d1c608217faa4be84af0006a136cc2a1829e53529ba1667dad9b5d1af461668874c69900c2f1858cc3f5f286ad4167e0ce74f4315e462ae3b49d0cd0da05bab3312cb07fda47d67bbe360b5e61eaaba882aee621b38953eb3f30becf6fc27946b9c64497ef9498b197de3759c961e179990b64646d83ccf207721cbce2d10c1867467f3d7928427836486838cd9c9d5541edd1ca5da571d535eae06b32469e310d6ec45b8871ccff7294fe637cbfe42d426e7affc3a43eb83477677188786d69e652ced20a8d7b44e54cf03b458cc92a23a6c4ff6c3c347364512de131de45ea69b31859e2c76d1d3051d5fdcbd6c17fc9f3e94ac4955be8f684ba3178a80d24b8841c0e13d54a974176aac2c3a826e537ca39912dc94b4b9ed32715cbf9aa421b06c8e3728af69f1d20cc419116c5f8168775f9db83b383c7707245292e2b7b17f64e0fb5bf3fce554f015b15ffba827bd9dcec2a8358ab397a85a88a3952d011a48451dc4fb252ab23ad335dda7f1788fbe14ec712efdf6b705379fc13aa8beb37dd1fe760f4110e03cd5f8056033163c9b5cf76e6a75f5af03db3d0a955c1bfdec94283ff9161d09a1dc9623d45e58c2f6b98751cae20bf3da5a7fd46991275833aedb44b2f208d9a34a70b930f5b889789583378589f1f9545ce35f3b34728e959bb7ff0877c94639a3f4d41fe3a9c6ed80b9f427e78907c834a56eff4e0b6d693fbcd6c96eb0f33fa0506960b100ac80da72496d97ec97546f9a9b36f99316c1c61d83d4a38d96b6d217209b536a89b90bf2f1a06982ee4a2a52a54c0e4ed4bd467b8a1a7a7ef2b21089d26d465a501c56703f2a630c11fa07d577550968498b385f5879ff274965b4c424d403bdd12b6945751a948e7df7c1a5f1e9427f0a5751496a395ff6228a703c06ffbf6affb784b16e25a881ccf82b557226ca7a93ddf7bc52e24e3f82925440bf52a8d194718bd9bef76f11ccdc48da9cb07ee230c290b0736a9fbc78879e34cac1a07bc08c7968fa9e268f151e2537ce9f28efcf8c3869e425ea4fc94b9c41c4ac09603f1de8a120707b3d51997cbdd5df770df6cbb0f7f7db1bfeaaa5d215e6545ce2967e431f8e2479d8b99e7bc02b31198adebb16459a8bd5506dc2985f284ea199140a1eac9b898312c789ec705837a73346e1476e745f0704bab02cb2e59529b46b9bad65553322ba8678cdc5bd14c89a0e59a3a6307ca813413dec33d8c703e59748cfd4ca8d4f50577ed3e5fccdebca4d20fd02f9128119a54b3a5a92d2e7049175d577df354a066eb92adf14b608e99449878ae9bd316e16cc674f27641af8771940f60ee7d5c8bbc3517e876fd978d331749ca33be9ddad2e3ae956dcbe341b10a16674234a2499aa6e86a1ac5c7adf7a4957b98d20cc3b87960369a6aa5dce91081a28ced3315e28e6182a9a01457ab6e10776339d3ffab394407703833b8f79161cd6745a38feddad8ad308641b6d2025a48758806eee375bdf2601668536b39930d1514fc784d7dd8668e0a4d46e8c4146696082731a9ba1eee596bba2ca5cde80a3a324d493caf7013c0a9d8b50fb486a405552013d143378503f754a391ebc1f6bf5be6135ed14468de0a7cadc6f81d3629be772d1d5ffc092f050b3484458e4f21429413161382bab4bf8fe4ae7fe80838c55e36e36093d575a9e5381d9e1dc43d7453241446ca260dd6064989f70076fa8496550022457fa22d56314ca672e6359dedb3559ae8f6ee4f7bb75f98d1748af1044e42d4f08d9e942182e98025441b169a2e093b281f2a40220e74adc9130a423dcbe08804abb3f294a93a6eab411166e86927f6dddb65f1842561b648a6db1e92fcd6562d6fa0176b0016d683fb3851935b355e74b59d3b382f89071c50d345597676735fd9234315d19c4fd3b4d97dead8a2e66a14491423c1aed52f644b1cd7825602a2b7858cc433a6e69990654e3c1ee1349aa1d96f05a2e1bfead8602ee2efd76b712e3cbca8a8e7adbbc9abd4361681175d229fa180634121849172839aad60f73b860b74155367c29d0229d976c76c8d1c94e495a7c10d01b22ae380c7d3c6c54d8d3e1585fd9efa4afc405851e077145cdcca5ebf312b45635f47eca3bd752086e90ad179b18fb78504127d8b9dbe2c242219b1216b044d90b822bea802679b44b33574fdd8586e81381dd349eae72a0307e450dd38e59c737565b667c29725771d97a073ffed9e0d9a89307640d31e3dcd8011ec2278eeb4c0f9b6c8cfdc1993aa793dd78c25101a3a65da5761c1978c30c745aa040dcadedd93cec1e483a9ae0c53a4150a544526d5bf8de75fa9de3a492a158b1b4eb78a099e3b0e01ce8bf8b03d381c8b00230460392d5d49e6d76c66ad3fc11abb41d2ffae837f18b494d564eb91b89eaa9d3c93e87deabe849cbf13e4f346fb6ff94c6441420723fac252651dc0721ad488abf7f686e7a8b07602595d8c41babfe566db9ed1c39ab95adfd4bf1683171e4f9c54c76cf424052958544591b0a6f0e968cb0fd58b4a9cb94d19ee2237753e97083fe808a2f38cd50003f1ab17499c069452b23dc192dce004eeb5d0223355cac2e05ed2bff31b348d534274bf32209e17b82f20ce5fb44de7f749dcbe35a6a2d012f4dffcf8a4c79378dde1475d3dd890529e497b5bf23f47e1a594df9cc1cd0b810b5647a2b9ddbb6d26dd494f40ad65fdc2444aaa9fdd7abf6c7d67eccc57bed06b60b11415aee1da2a647013341ffe100f0acf2e5dd74d7f3b9a12a7eba5bce4ecd8afb90c949809e0114d1aaada2777a257826040ab6feb145eefe1adc6b0d9f1524b683d0369ec997df3931c157df8dd74da2fc77a32841a0a3d78cb2734dac3adf7ae0bc0af63ff96c47d62f82fa7caba74785871b51f01e0290aa53677dbeb4f0e5a18381b062a745b675c2e3caa65051f42df1dbcd6e81027fb61931adb26b9c16224241e53a8a68faf876d977ab693e0ca8235f858cd7d3ab90aad6ce08ac1be6cefb83f76959c2c230ada6e63a794770befb84f1937cdb7c7321cfa9265abcf14e6792a2779bb06652d6e2ccd3b50ed1b75b244b7b0c42ae622ee5ba1b4506fdffdb43f9a326d7589d2d523c7add8e24ae3d6d79b1716d20a61dfc016d0514113255d543d4336ee04d3319c13d7e4fa2c3e922ae6e71d38e79aa6ba9c517f987d8338d5ff875a71b545ba4609e990a09c4ca51a3c09eaf9d28af7a83a6ed4b37a33375a0e28b11647dfd85393dd4cbbaff92c646c8871cf9e699d70dda3cd8bc7732ae5e5843fad63426bc8d75026817254d4eeac338c70ad22c9f26dbdaa97d9d0cb934707dc5f3a34a3990e4c282852f4fb8999c429edf827ee9616cfc45341e6b8259b7efb317ed59cf1428026d24296a5263bb37b22e003db1b1288a78396f68a853b09d84ed877029aeb01333efde534e9028867db3ac62f904f67211bfa3e3ec248b830ec95ace8616f634324241000dfe4ad1f6c71249cc246ee9c524addb63e929f6e5efc472aebce8bad162eb3d8c508329a451b3060ce148b2a38b61a711fd9646ef0549674be74936d2527f692f0559a1ba0f4a8ceaaca63603f1dcb116e444f83bd5978b406886c4208515f21228abcb9db8ac15cd7896317234ad06560ec13d2c0f574b56dd1dc59d487851d221a2d469f0cbbc9734982ea9d8098657f502a3fa0d1b82090d2d8ad78e30cca94926db0d1b64d4e30f8f844433d08564d69c7e328db22e8039910691f15408af9afc544fa67ca097c72649517e4627b20ee4a4678a2648d7e6915ebe0c49d529c2f5212e3c82f60fbfd288a6cafe448122746ef89b1e7a8821e80866f636cebe752c4b9968908fb3200a27db7221646f87a3e8dec4a4b07675e100523e5b5525a80212a821f9a1490b2cb09a15ef5f8dfe0c0cc702702f6b4ee1ebb27e27391837bbd86c482a1d5f6b0ec1ba33df33fac09c882c914ca5571e261762f65c90b299a115fd0da2d841e4c5c18b57ac665a2062a242192e8ef9a8b1d29ac026425d9d388d17a946bc85ee99b67a4da35d434e310cf4b6b467ee0ea069aa308c9db1676f8fc3aa194612c91d54b5bbabf3a1ca862a30d7cfacc1e5b4f93faf0191dd4f4ca1ec60f9d0b0dc1602316802db76f03602f0a76630d13f3e6ffd32c54827d81c1140886362305346425efaea547f1df3f19ebf9b1d7af8432ad44633a258e7ab8ed6f225a48b705c081278c9b813cc206e6ef88e26399867c9b01e22b4e4f6873f149b74627a4d4b3245bd7c5597370e120a9d56b4d5705b2b17a1541bf518d9309206577f3bd993e985148435a09bd3fa688b562aa74a8e7121f1ec27c1ce32404c1301438de4874eb4f4aef2df12c30719bdc0257b9d4eff90692687e559cd22518bfc5b4899eac34617f6ab8547efc54849cb1d166204857a2bfc372ebec915c700ede97973d81f33b0bcfae919da6a6bf49c05c5d8a6352d53a6eeb1cd6c5e25df34ed72e4b7b737bf22f721450b7e4bb0dca2a93725d21a4a6c4b25ca4dd1fd9d63a3f377f52ce2945c219914c3aeb69c60cc3c6d881e0e6544d564339350bd2e2432fe5c301d6d848c97aec704f05721d3fc569992974a46b44ac2654cdb0595472c1f8d473aafd2fe99ae5e0ff252420bd66ab044ab76578d90748b86a7a31f52a6b613eb0e6d07f11d44c632ea51285494412067110963459131c9a3dc9f23ef01c79c29c01eb39b2491164bb29c7b98d238fb58c78bb2cef5ef4f85fbdf0c8932efe1156b5862e719a099a697827347ed52b2709cabada9749362df8e2fffb18ad8f45276a63e4e1845d39e7d3898bf91c5c42de43d384f9d6879f7c6d40e969d1b8c75b95a6c443c1fdadd578f94c1782109c03c34d4d1a5363a0db17c22080d8c3b643738de9b7ca12782883452ce5970268b38fa96b44150514587356de145f46bfe55895e78ff69e57a5a7c5b5e4842c8e3c15ce27df8de86452ba01974e59ec68809353e211fad268cb1b8add0e4b0af52687d08c9274847085befbedefa393d39d934c3e1bbd3971f9951a4a011341475a8375424f28cded639292dd829ee82be291fb8a56027aa5f51930b3748993ed04cb99532605a0ec645467bd4f4a08bab40ec7ac5ba38508d95029895cdc09750fc37f9141bfbfd192226a61ebb2ef6b283c1a9810de918ab243aa815737570977f7046018077e463078fbb85c0c5631df1ca3851b25f2f97751e1ef9d94da42656f9395e6b050527a0e2053e8b964102da597145c153a87a95493f54d6bb6805be1b039b0b65344b3709acbd22afe49847aa2ff2510d0a04c675ad8b26583b1bc336b1ea8e0b973713ea3474bf3fae2f3ce8156be4fbe8dd54d7ee8d0bd0e41d20e3bc2813c60226b4da0b4bd1a6d84e898ca85c5a1f1d6cabef5958c7c8a8bacfc825cc663ade17607835fa153c9eed0631cb75e2da8f210cb1a483c860834fff68b94845e3dff70e3504efe0c04c98edd654adf21627c0a576a46b9fd646b3865a00f74dc9429f9d7090b45152a88e517c0ab7e193105a03d5743c20438dcd78a5be02abf315f7aece50602f8012d61e82ff3faad1ccaa29fe8701b523e109c022abd4df773adc522bf44a0272e8081d9354473cdba903b900c8754d35d4e63c846f47ae59571bb2eac3a4ee9f5c066c58dc19e9f40a3500343658695b13839d02a331748700a5cd2d837ca8febcfa846051579fab5251a044b610d5ac3a29daf29b2df0bb4a7ffc358c3ec296d4b2a48bc702619f46e70dfcd29b3bee61d8f403d7934fe532b21800cf42a0cb70146c67d25c7c8034aef72eb902784147dcecc5925cd2f0d6ad160faa252d2bc56abcce8e21ca86c4c92e4419189700d6995602fa72dafdfed1c36689435f5c06ae32e92c80a3cb311324fe502a01c7b4b54be5ba00bf8641bd5f25abee5b85a748404395751d7f501cf5084308f3a8a9285d618ac27a4bec54b8905291f9099a4159003c6d805ffb39e35aea6fc40656cf68ddaefb31ee176aa5b8956ec8ceee7f2068cac86e924fa4ee70c64e51c5bc361fdb39662edf3d70be89b0086e6ddf7a7ea387043ec10c28614956b40ea073690dc26882146d24f0e5c64b424021616b0cd45cb7a7f2b6887f4781b5f30fd392da6e9a1001cde7ad48650e03c491bf8046fa728ad82fd782302a3565b2b8fba970258a9875b0dc10a6ba2e32b599455cde3dd9d69b214d9ab34573e13834926b798ae38cc093d865d536998547bc4c9164fa75219af5beb187906c442b0794b5ff4c0994bb88a9c744ce980cc5581204e4c7aca14dd4a484d18316141bca7aef00bcbc0fb04a6a7df2f217c54eba60c58beae6e6b5937fb1681992ddc63a6459ded6aeea097e89c0cfafa73d4b21322054624ae951cc4c6ef67530ca469dbddad752883085bedbfa7c9bc9b36d8ca4fe75ddbb1ede9e3a32e007bebfaef6986a3787642bb3389f3c9b6b5edb875ef86716e68f63cc367b55a7f86b7ca21cc90c3c5bde7e85a84fcc14daf3de353dfccc8cfceb0411422ac1883290fb892ca2dfd43b2bf9848b3a9ce1355b75ace599f4f4fd78c04b1f88f90888b01484e470e7c8bce64852f9dbb8a12d874919df767259676a2c0b5320470e159a3561d80c1547547fdb8d64160c9b34023bc6c87cefb960250dade4b67b4c5c1e3234ea6db8a8c1d8b874e14784bc64594750e71254d39dd2f6c8ceb595b428b1ada1a3a3181d7e29c1161ab011dd7941a69c571f29347a89c39f4d6f57548f28edf56479dcec73f91e8bdbd952ac7582c5e322b9090bb6bff8f1620c2cbfa8019d9e2cc6005d35e8e921d2ecbfe60e0237a74263ce34ca4a234461b87c307a6a11643d501941dce3ae2fd78d13e2ee5ac7b7910762c80672ce4d0dd0ed33d9d12f9dc4386d96da10cec8829b529d256a6c2a96d206350cb64ebf86c4ece8bfc82943833f61852ad5136b31acb60827af096c3f1f7490ecb7070bd51c1168882943bef76cfc01d1eaf72be52adb2a8ec938883347ca72873ff7ad258d48a9dd831a810590ed94623522a00a7e051e62b9c9078d81a969f93ee2d22c544e017a31a677c9e4c4c9451cdad05922af6e7a31330f99ae4e98d59d37196e20de9ddbd79e2c2b60f830b4ec82f34d9505befd8ef56b5bc0f5e026b7749e62d2b1bc6bb856045c57068e12118e40dcd48292472cc8d0786d3bbb363acdab37c9d924b463bf4048930d2153c8ee23ff4496dacf8f55c83f78fc6178f1281ef267d6792160ac92190ad9d8267b97bbf622ab3b5bd8b1366f568cfa10f768d40ca69d92b846bf7b2226bb3b166ae86c219a6557972f64bab314ce146f50beebe5be1c660338c100914f295bbf51ecfbe10d532a570b63530b8dbdcc804b45484496e0c9eaa4453713d4d06955d1d57cd920ced588caa017db22d7bec5652906bb55c12587937c4e92ac95952be4929387f09a6863a55bad22815028aad457ab91e5f37c8dab3127488b2c393193bee91543b52023c590e91c924706186c2d0ffb75e41a9c97da23fa1a46bce9a8ce4ec33741a41d216e8d094c674a1c32ad3d4b7904259811e1474583f6cd85333630d1d615fed15aa89d7e07409a88e9698301ac0200b2d9c846cf74835869917ab925634c9ef9715f438dfd5d25541dcb50538e1b042af2f3888c6919022a056fbb907ff5a14fe1cab2bab849af7e0673181b77e11dbd6d48f2bd51f86153a9354e9169654b56fc7f3433d0c68ce62b427928d48ea9bf9cb34d864075824f99a5655b993f080e07721e675c669f07e87072619d5ae54f9890fadc3b2221151fa6da02d64d9bbf0daf700e78b2b286312cbfc5253139960fe4355aa557fe77a7eed3bde805f32097c781866bfa8e6b56a229562215d2d2d68a4d4c1f6474969d810aa75e445286067dd1c6bfa744617262c5f723ffb5958ae9deab4816e70d791d7e22cf9af162be07ef8eeb48bbff2a9470f441160bd629d6ece731be048674dd82fbec1bc958f5aebc21577ccae4f8ae88642c82ba8ea75ec04a287174841b85f4f17c02476e53ae57ff7becaca6b2b63be7f0c158a4f456f2eedc260fed0288f2895571a27554240171ffcacac5115958fcdb271cb0b16bb1b19a30eba0aa76a16503c334189316bd8afcd366a9c7eef22966b08833f5902eba2688b25abaa318bfc8c230be17a48ca31d9b17ca85084e15c019036aa959a37e1864ef14078b6a74f6614a4191fdea15558cc1703e191429093494e5e227bea87561261e9a2d97a39f8886da054a69d11fa6d36d94451632d258834b7b61bb9d9043e61d7174efe4bfadd6bf0f699f0e712c52ca545d7c88486ebd1e83ba5eb32478c7bbeb56201013e51142cb953381be7b300e6d7406cc689ade1b504be725d6428fb272cd93e517960a5f8b04dd474968f64db21e082a334e6cbb4cb176ba91c88153ae62f93b9b743e258b45d9e2e2e08c86dc9dbfad0e69c1295bc19fd83dbe6ad591807362e88500dc5b114ee2e4dd7a5c8446412342da3871362f06ed34c7ab373c6465cf529ba64f75c6eaade1c007edc7b72bbc880f305e1d1006ed1c32d3badbd0c0ea6bd49ce1d7395635cd616075d04ed6df1977ed83ac59db57e1e9c1b3969d30bb4657314aba81188a909297615385f45fd8203aafb3e362f0bbc2642aa162b7ca8c5503073730774686249da603820d7829977e836747fe75f3cc7d529850a31389832e1597c91dfb927ce1d7fdc7f200bc6baf579ea746ae334330f3fe17c6fda08b55449107673a1b82dab4a53d7c93b977c5f113acc178b4eb3a3056bc7dccc7f0968dcf0f15d223d600b167cc8c7b11c7010dea58ac3e6784c4f285b820076323353b3fed24e335787d6bd0e11ad1589d7fbd71784e607e06c8865d98fe5ddc678b97dab4c304fe2f366412c39ed194dc03c3fa905e873025478407ce62be4d2091d65d442d8c05efa74d7c8854b156938626a0b689d82b56faa2350a82ba5c0c7671d1f0c3aa64db578e3e240c8e1bfbe1dd3a37319c1e513b5f679e22baddef6c5fef2b025d8c252c871548b45f793b50b1885646800b4b30dd0e990715bc4160e3a6d7926b00c5eac09ab3abae8d1519373a2222dd4a79142d16db4d9e59ebbefefb4f704b1007bba4430f0057581e42a954a1dcace28d1c92cb1c6cfd8f872a9006705351e9d9ba75788a907c3bae837537bd94e4232474fec0407314fbe1fff83ef6936a4b30794dddbd5b839b23513c4e1d1a088c8fbd1cb38552b73b08103219ff3502a0c1e4e0cc8ad8c2a1f3aa28ca232f83d4c9817824ba761ed41d2423ecf186d9b11b24d5ebd1678faddca7ef14593c5874cfb3d639b7b02bf951503df352187a06a0a5520d272a15f37fbbbb3ed86a60d2b07278206c7eaedaa1d456c3daee414b8470e291a650458640b3f8b9d1596495e77f4aea3b621147e3cc8e67f36c0339af18abe0fde4346498251cf15fcc33e1208499bcac5c0e1fe16647bd43461df52ed89f25d9e7506912b737dedc158106b2f686b2fefc621a5325f45c89d3bae7a3ea571e1e1a401fdb22232e36e7e461eb1f1c13533658bc8a5c6786f8ba69c03021aaca02619242666af0468f9622dddba468ff9680fa1219e7648ef6a4e856758a111552bf7f583f7f9129f940c8204e8c96f64f189f4ded422ca62c8719870004ed515348f46dcaf0b93f36f60f65f95fe9a50ff706ddbdc7c653accd9ef94cc4e3f451129e6bb0db4a21591523336b96e1a96f2a07b79160573e493b6069709066e8e5f02a2954e136271c9b860b9dd6f6eb93d9fed99b8eb598a74b4b5a7eedbbf20f36626604c2da3fe00a818a42003ad60ccbf9e6ac1c795cf74ac2cd42376a0512ede235dd0c42ab08f59c92358fbe407322a698f18d98b8879e45af7f3febe191e975bcdc17ae9f10ef61145c681586179d4624da1b2da2acbd98b7f0d46b72317e533631cdd3687c43efd5dece3092903ba6f657bb46d231bf52e1160bed31f7f3bf771ed04183fff4459d5ebafe614fe85ab9f7230e4652b7b797d850cf7ce9c2e76ee2a48ea15654a8f381076f6c66ecdae36b2a2d4ce1b8c4cc80379d32a1d81aa5f22be0758833b397a80332318f8a5cd475293b55b45cfa2a30bd4b483b8bea63578b46b7a4cb236a96e63735e3bf52a727261db7943d0d75c0b4385f3f93544e2f4fb74194fe6b0c49344b86a021302cfbaf1db06d330fd558fa94f879d970c69556cda5bf7b1486bceb634d2efba11f84b7532aa10046d34558cbdcfc0baa4970a4fac1cccb73272c3d66fc4419dd3c30af732ec3a94957466617bb7e87b98f9dfb174a817f3dab939fcc4d9a50998412896bccd980410c0edb429517832b6b187d9dc668b511ddc302f044a812f41d42937862dba7461b1ce63c5365a1b70e60d1b40082151adfca5a206c6d86ac27e4af17f8a1612a3e0dccd4b534d818acbcc50a55232b000c9237a6af442814f55235add1236bb3b21a9a6868af4cc137d6ff803c276425deaac472837f92bfa664b1394af244b422a69438077593953db9264df080b368b36e2d61235480e2ce7c99072a64efe066708b5154892df40b5baf1482f781379fc00760f0da6670213defc3947c9961e4d92444c1d088b50e29e77271f789524b14a289857add0c62238fe88fbd394efe52267dd9c0ef0b98bf384684b5aab503a166153fc19642db945016160ea331a97f241bb3d1d1ed850ff0dc269cfb050e1d7ed1301816b5ee3d989530a206b7a14bd2bbbd670aec84b8001049d9ee210632ea89b785ca8881ce0508315fea278ff00a517c4d531bf882205b090711dd44aff1088546e16234119b7a5cca8ed780801dc9907a910d8b1eecd89ad54a75b2a1c0e259783ba9c46b591724b3925d7f65815d2cd18ecfdb616a0421cbe51a4d8453448a9e6a4232a4d8a425dba6ff66b4d9c6fbe79589c2335e3075aa1791b4a2734f5b9421290186ef13fa3b7a14b6c82cf73410ca2fb2ac2997b9f788cc1b48bfbc8515bd24437ef56f4e50cb622bd1bff4538635f9f06abcaee626e1a2dd9a929a16926f5e30bca69239c637fba16b0751c6f74a0868835f2f4086462f693f2653c05a6d8a6b4d341cc6f18fab7a0518fd501f9c4ab99641c650cc932ae16f0f3dddb2cf281cf9c16208f4f2badfd21773a074903eb91f495e58c41ce29cbfb9954942eb6bb12c629c1c8d7a4f65c1828f02eb480e55f96ff06e17abc3dc1211cc7599319a7854d8e29df7438ce88eb0df6591188889df308031fed7d53f643ee4c01acb885818aa51d0d1f5bb279e823d4752c43d035ec077d3b6471619b4dcabdf17de5ad2a06717bc0ee42c3471f1166128b73753c93e0604c9d4542299563a11a5d4c8103a5431a25ed5c43e8349ae71de8a82367b6aa762dfaeb1cfa075536bbfaf0878c772323bc7106615a8d9a0d993ea380dc8b17a11ad35b227076e9cc7b8ef0f945c1da814115ec8fd464dd952587ca6f6ef7762319afa0e9818cbfc69bd81198d146f00c1605028d064be99650e874411cd2bf3393329f5e3273f516f5a658b7549d63e4fc40e41779cf73ef44fdadefbc808a789a2a1abcb7b42e3b4eed7161aaa34d470ebd73baee850d2802363b4391c12ea10abd0177a39fdd9e59b2ce026e8a7ea9bb23b913314ab9329145dc01e001c842641cd1b9a80ba8d8b0bbce0cc32019b62d29930f0debc7dc1de3e599d2379c5124c87b8c8c86a83cfadc9f74989200d0fbe97a0ce922964da8cc71f0d372fdbc7b9b2ea4fb36eb58edf708bfe10f1483267058e20cac4455d54afd23371712ea19c7ecc3809722ea875dfcb31e46f1733d2fda039f6f76320ec3ad87d7d5c2f46dbcc1ba3fa76fb328165f3cbf30e97c46dc7cfa44a70a56cc59a31f1fb1bcab25c8c9899193128eb9923ce62de28162054a7d4f06056ad1f57f7ba7ba390db6a61bcf5b71a87ee99efdfdb75c51ef6d1553e8b211bec58dc5630a52c73a90fb661f21d8b4b203eec824e7d9a7f4946a06f529c51011af47d85f48472372dccab6c743f1b07b09e7aa25ab960a06d340a279ce86f45e68d1ddc23b2eb64576bc98117e0ea6518fc0ae58fda9df7260a318665ccd4cfb90b3a37ca84a6649202f8b34150550a403900a4809257ac464c867f86d02178244384b42dbbcf849679045a8aab790933857026616bf89e9a9989417bbb93eec120d465f3233574eb00e4f4525cafb28359dc26ee59ff94a7b3bc34c0f19b24c1f790ea949c44f5d0f54bba72e89cb80fe085bbdf7a3b4ae4f98b14a964bc4c95c39a2d324726ad46e045ff770fc23b2ca590ed83d12db48ee748d7e5f0bfed78f20bba27752fad02a84c5b026298b6b7ddecd3c06f41417e72eebf13be2c650bee22890ba426857487e4f13925fefed172a1bf873a0f16b28e11b5f17c57a5d8a1a1f560ef9dbe1afbc00c848aec94df004111d2ab7e00d2d67c24a34f8a3954f838af4fbaed06e1b87bfef3526c3480ba15e7ab6d442129c633663404908f12fe902a9625e8707a7c8ed3aa964e47dd98bbd642ba6848cf02decc436dde42879ff7ec53721b2f9d81a70136c600434ee3cfa8155709093e0642d040fc9d6b9ebff2564ab34507f6f7a77668fd382a29ae1996134f07bda12f28c83e9485e3d9e2b91e9550974879121c9458812c2d53797d8ff083f862c3dfbe00af96ead369fe94f136a6e0ccd078ecad3293b2f42158864d4869c216e404a15f548532076e4897d2a9dd3d90af52baaac6f447de73c3d26952f0174413d3d7c37a0c82b69c20b8ce52dbbb64cf66c553d73aae4ee5f6b7b13a23323e7ed34bded43e6c4dad66c04701ab36451ea63c454c34135f54fd4e84618b19d1066c56ea89bc591825d619a4a16a11d0515bcee19e6e6b912560c630b80e0a764708898cb43d422307bac02407a4b097942fc5d217b3c145eddbd214f0e381bd07362194b81e2c5a18bb1011bd07443bfb5fb5c99d202cc6f5f973ecf01582c2c8bbea083f8b3b5b052b8ffe8abfc0dbc40b4696a5f6e438c8b39585d1609940308a4e7eba5f6419312b974513523231f7084a6fdc71dd0b58079e78a0ce8c09eb41f1b814be1b792c3cac02821ac11487faf54c0111bd390910592dccbf12a6493c7c18aa7df786294d429bbd74c2c8217873a8518075a380575ba4a8d1118360bf966b3bd8954452b99f42377179cfd442954b83b34e6e69fe579c9c57a75eddc445b3ff217e54ca84bd63909ca286c58fa071e7683bfdaa670f7bcfd57cbb6440591566effd6849ef53d30e176f4dc5c213a1a2c7bc4c3c67e8b235e5392204c91520193895c5c3a8d5e5be90f9468f5282e66386d891fb12a5e72c7ef3f2abd2e632ef399250dae89a211fa96a0f8b84b32b6f5565b8345e34b2dbde0ada4ab7a393b41a609419acface63ff268b9eb2635290edd2b19a1a360f09cb97c9b2a378f13936303442610ba4e23cddbf2662ad74394522f53ec412db7b1df00a2fe555a8b978c31d745d0b7a3efeee92e69aad7a1d10d0328456987afadd50f1773dc893765a9bf463564a55d746b58591633847afac95b447370e1859c384721dac665bb304daa1cdf34bcc449b60dcfcf47d315ff2cf7686fedb3ce4791073e210f9b009ac5a9b424690e47d390d26219b1bd0c34e68f943f81f407e1e1a311a6cdb065565fe0e124505cd5b8a1ce0adf4cadfd2c252b2d228a1cd1fe0b4da1532b39102553e5a2d6dde651e0b678687ceb01ec5f5c6ea79f8b64a265f1fe157d449b70d730b9e4977b18b0e6c976e1a2a45cfcbf43fd6d5e4618ba3cdf1cc3754a0af79e1d50bc66f5657f1432e6590a08d328503bfbc543bea289b850721fcc4fffbc22e4f23fe220f03ff22815373c3113a64aaf48c08c767461ff53fbfe37746ad96741ca267ea630e5cc8b8c22833f9e33d234d8ef7131c6f65e93b514bb286920a0a6a3d484c9e754aa703ff7a3dc7c4900138c4bb71926025580d51c1f15b22e3b4fbdfab02d3084d0f6b7620b671c8c1907f3de2a5621e5a373a8dfa1eb15e711bf9188501be211a362929171a59d33f104d4b5270f8ab45b412dfb8319fca456444bb968ecad45ce3a1d6bd8e390b898617f5fcb7fce4929e34dc1c9808bc36babe426a1ca7e1292a91cfd75f56a9374e536b8408c4626be4a71718963f67f8bb0ee6927faca6aeb57a9d903264f41f05c3213bcb7aaeda2f1ec0ea299e480d2e06ff16690f06cd18296b5002f4c1369fe8bf2bb1553e8daa75fc1fd6e56f63486de83c226c156ad02feccc6c8ba622b7894656d5afd131b5643f37e9a54dad277779050db06b862233f9490006594e2d303239f02f0abaf384714f64c1261ff688a082e14febf993e11a38ab7435475182da7064fc5b4940d17a05ab451258614b22ceb70383f3c8cf5b122c16bb075f5baffba94444f8ab1e1eee9d2424fe8addbbd9c879ca05d362d568d24cfd4af509f9028e92b6bf280fa349ae276f71cde77de8a1c8055e5be90394d519fb543afd74be65d10c4d7f10a417fdf34de00296e0e1aa4756076f9e99162d02a641076de8701b7a131536dd9a5010dbfe8e0cd7e0c17105a028681a1c24bd7a1a96da563863a74cb57ee7e62ce0639129ca59fc66fbee9d8f5cd2570a03218efa7b4f9a93fd9d8b9d9233ebf2b4279931c8a2b2ffd3fc78a3a6b71c23559aeec9b37c491bc164a344f37d248ae9acecdf1db8d0b01fc983f47370fef215956860557b12f14a031f07523d339d91b9d5d44f50d4c155afd997178e032bfedde3a5e81aedef3207d4db1ecc6f586e4e37b2fcc23717d7d72ba077a6249aa4817baaa97e59ee132a25bb5a8b8add6fb5ff0f7e4cb26dc32d07fe0c9528a66e8d422175df982a0371bd29de7b5ae55a403acc5a8f4f03eda18dd357127ce9240494c30981d7234a1e0b131bbfdde6a23b15b600aafa211646aec2e7b73afa2eb949476d1daea6093a17c22ecae52c458fb1d0388d69146372e35718fb96005a6091bd51c8113ff7c17b56a4c477ebc04068db41cfde31b0a4c5ce5f009bb621e2e85acfb4e8101c5727c1b8e813c9570bd91ae80d8589a9d196117fc242f17ff82e505ca64f73c1069d751e053aafd354c2eb8434c3b2424aca4a370fb09c1aa8eeb281801f606611a06d35c63fc5d1407c0e0def09a2efc96263b4e699650c2c9d101abb2b44e1ea191bd279feab5c476756d72d6d141c128bf7045b93bca6fdbdb058fc070227f23f3ad6f8b3e00d2966bf1e133ab07844d0bbaf9314fe3b9faaed86faf8956463f8d7bb0004e0e34a893a4dfd003bd3043e5c4271da2ca85f4f06fae874225d61ac2c811b5a3b27c547b1cb4aea48a9e52b569bbd83be6a354d6eec958661eefcfcab04a68cf67a2b5acc11fa747349ef1a60e3d26d05da3cd88150a9b26719e3b6219","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
