<!DOCTYPE html>
<html class="staticrypt-html">
    <head>
        <meta charset="utf-8" />
        <title>请输入密码</title>
        <meta name="viewport" content="width=device-width, initial-scale=1" />

        <!-- do not cache this page -->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />

        <style>
            .staticrypt-hr {
                margin-top: 20px;
                margin-bottom: 20px;
                border: 0;
                border-top: 1px solid #eee;
            }

            .staticrypt-page {
                width: 360px;
                padding: 8% 0 0;
                margin: auto;
                box-sizing: border-box;
            }

            .staticrypt-form {
                position: relative;
                z-index: 1;
                background: #ffffff;
                max-width: 360px;
                margin: 0 auto 100px;
                padding: 45px;
                text-align: center;
                box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
            }

            .staticrypt-form input[type="password"],
            input[type="text"] {
                background: inherit;
                border: 0;
                box-sizing: border-box; /* This ensures padding is included in the total width */
                font-size: 14px;
                outline: 0;
                padding: 15px 30px 15px 15px; /* Adjust the padding to ensure there is space for the icon */
                width: 100%;
            }

            .staticrypt-password-container {
                position: relative;
                outline: 0;
                background: #f2f2f2;
                width: 100%;
                border: 0;
                margin: 0 0 15px;
                box-sizing: border-box;
            }

            .staticrypt-toggle-password-visibility {
                cursor: pointer;
                height: 20px;
                opacity: 60%;
                padding: 13px;
                position: absolute;
                right: 0;
                top: 50%;
                transform: translateY(-50%);
                width: 20px;
            }

            .staticrypt-form .staticrypt-decrypt-button {
                text-transform: uppercase;
                outline: 0;
                background: #4CAF50;
                width: 100%;
                border: 0;
                padding: 15px;
                color: #ffffff;
                font-size: 14px;
                cursor: pointer;
            }

            .staticrypt-form .staticrypt-decrypt-button:hover,
            .staticrypt-form .staticrypt-decrypt-button:active,
            .staticrypt-form .staticrypt-decrypt-button:focus {
                background: #4CAF50;
                filter: brightness(92%);
            }

            .staticrypt-html {
                height: 100%;
            }

            .staticrypt-body {
                height: 100%;
                margin: 0;
            }

            .staticrypt-content {
                height: 100%;
                margin-bottom: 1em;
                background: #76B852;
                font-family: "Arial", sans-serif;
                -webkit-font-smoothing: antialiased;
                -moz-osx-font-smoothing: grayscale;
            }

            .staticrypt-instructions {
                margin-top: -1em;
                margin-bottom: 1em;
            }

            .staticrypt-title {
                font-size: 1.5em;
            }

            label.staticrypt-remember {
                display: flex;
                align-items: center;
                margin-bottom: 1em;
            }

            .staticrypt-remember input[type="checkbox"] {
                transform: scale(1.5);
                margin-right: 1em;
            }

            .hidden {
                display: none !important;
            }

            .staticrypt-spinner-container {
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
            }

            .staticrypt-spinner {
                display: inline-block;
                width: 2rem;
                height: 2rem;
                vertical-align: text-bottom;
                border: 0.25em solid gray;
                border-right-color: transparent;
                border-radius: 50%;
                -webkit-animation: spinner-border 0.75s linear infinite;
                animation: spinner-border 0.75s linear infinite;
                animation-duration: 0.75s;
                animation-timing-function: linear;
                animation-delay: 0s;
                animation-iteration-count: infinite;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: spinner-border;
            }

            @keyframes spinner-border {
                100% {
                    transform: rotate(360deg);
                }
            }

            @media screen and (-webkit-min-device-pixel-ratio: 0) {
                .staticrypt-form input[type="password"],
                input[type="text"] {
                    font-size: 16px;
                }
            }
        </style>
    </head>

    <body class="staticrypt-body">
        <div id="staticrypt_loading" class="staticrypt-spinner-container">
            <div class="staticrypt-spinner"></div>
        </div>

        <div id="staticrypt_content" class="staticrypt-content hidden">
            <div class="staticrypt-page">
                <div class="staticrypt-form">
                    <div class="staticrypt-instructions">
                        <p class="staticrypt-title">请输入密码</p>
                        <p>此内容已加密，请输入密码访问</p>
                    </div>

                    <hr class="staticrypt-hr" />

                    <form id="staticrypt-form" action="#" method="post">
                        <div class="staticrypt-password-container">
                            <input
                                id="staticrypt-password"
                                type="password"
                                name="password"
                                placeholder="密码"
                                autofocus
                            />

                            <img
                                class="staticrypt-toggle-password-visibility"
                                alt="Show password"
                                title="Show password"
                                src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg=="
                            />
                        </div>

                        <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                            <input id="staticrypt-remember" type="checkbox" name="remember" />
                            Remember me
                        </label>

                        <input type="submit" class="staticrypt-decrypt-button" value="解锁" />
                    </form>
                </div>
            </div>
        </div>

        <script>
            // these variables will be filled when generating the file - the template format is 'variable_name'
            const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
            const templateError = "Bad password!",
                templateToggleAltShow = "Show password",
                templateToggleAltHide = "Hide password",
                isRememberEnabled = true,
                staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"61e126141e85d009b20dfbb6d2bb76acea220cf4ac1578e5ce9fd5f10ff1633a98542807ee14eabc423a3213a024a644d8a3857b1b74a692a3a32aa2a96e81b8437adfde1510487c54710500c7a385494e4d3c608cae4157aa3d8e2607a19810283acc3b205dafebc40a8445890712717354cf3321000a2934ba98aa568b6fd60215f314a951e5780cc5da6b7c4562fae6a6433552e2df909262bd003d6cf984825a628f349cda5b04a158c669dce38d82261de02f984c303e44531c2a06682aab432c082271266af6f20ab245e4f722d96b358e22d0b2991bc89387c1064aff5d5fd8ad5def3319561793b1997c7960c57176be6b364582ee6f8ae2c00000d84e9df395bf36e54ca229ebc9e39c5283c7b1314523bebaff9ca74d4dc295b437501d91d1c885ad737e63ac915022399544a6bee4f788dc473317263e321a2c006eff9abc7c761f560dbbf2a998c4ca5bd768aea27fffdd0c28c4604133f051d193d5de7d6370cebde92b25e18abc4e99303b720d52809e89a28a2f18779277c081f69367f06083313b3a785d5ac812ba17fc10a1febd0e3cb62cd3b1cfbdc2bb1d94ae44d292c5a8fe7b8dc1c0806a7ff15926d44eaffb6a714027db4ab220f30dbe296c7ba9d31b37b6add5c1d9f1757f8d9850737ffcb02d53e8be84c88118b9539116a53134f7a9c3b5cf802254bc1a2a10d85e173dba5b9f2c5e1c2ac472ed1f671663e281bba1480006996d9f79faedddfeceb0856196315df766f1c2d854f6240d25f9e6e3cece287d8d9353fa1b462d27becaa3b0fa404d393a5197d152b380d19482587527c1d69dd02845e9cd59bb534e3ba7fd9f2d625294e939c65eb204b07586d9a43eb9d0799db3d99b4fcf09afb97454009d90b3d1b252907a08d0f69ed0d5a73d944e50424d7760af10ac1e06167639e6dd25d986bb99835d2f71321c0f3706dc57cb2540e1df67e4b8a9104bb4fa29a764b72a1529fde0fee2f11401bcec0dba6bfdfb00e48cc448534c8cd4a654f296a314420bd8319c52098c772351679c5a5af96591112ec94ff9057f18386bfc6e7ab02ec2f70bed75c3039c5fcf2e87daa1732452a09a2b82566dadae8dba07ff83aea1a0dd462fc51499206bc3195f73f904ec4dd26dc43019db0749c8787c3eda57ca1953084cdf33a7cab49cec62fad839b8abd9a665d9adeafbe9d315020403e30fd3a93aa190cdf7aeb6cc4333551bc20a76a70ee946edffe61f3678fe4ff1c8b112fd8eae8291b752da2db5956d1dea0cccc907aa37f307d550594abe7e0e6abd711159902cca6a2047382e5903b9cabf6c12fd03a0e9842a9b28f90e1e2a42711d80ebc88f501a728e073aa12bbea780c1601fc475838b715e129baca34a3a523f88edad0c0e73c4a7ddf59624b1e2e5514166403baa4f2ec7e59fa6792e3c067dc0e6d223b8294e1c4dbb46ccff88b9665f4d4f22f921f35fd741fe8d82126d3d761cfb31f46e44b245d008325348fab32d90fa77811a98756ff3825e38ecfad9c9c08e208951bdc7149e698d926c949451e9d1d53646dacf50e109fe4a6cf663db339d7800f96908c5943963515f1ac60c61fbd74e1e44c3d207bd2c36fa5b6ccb8fc404cc2439d8e11aa535d87c573033d91d1242a7772a0c6ad155d17e12a2e29be2bfdd084ede55c49ebe3317290b52bd59e9e97634e7b84bd39ee96471479bd01a8e17a59b4bdc6cc78a478f4aa457e0f2aabde1601d920c3f3a4e89d7865d6bb7052e4553951a10b4dd2810dde1864239e66caeba3ebddeaa19a5f12a16140c0f3f3544595f1169964710ad879f4e0deaf5c911d85875e5dae6e488b449f1997490f0b169b5142734c15cad1b2c5560f0f0cdfa92cd9b357ec84e4cdb60e82c7e2604fcfaf1aac2ae804e363a837e53e3d0a90dd4e8426d1a0de726dc7e911ceff56d922d0942304eb23c3bdd7e74d5f21d3a591444c04c0bcfce414e9f7f92e0a506469870e14ee4911709e09edece561665a8301e0230e1d5e34a310013a78348941a375852b41f4e0d0478091f0e32e816c58e3b54655068c4630e5966bc0499cc9092dcf09eb451a3d9329431193b63508dc920178a193e1fba7aff93ad3d1372a749cfe98dfab07cf9d8c5f5eca96e2931a67b296985ecce2eb24f3153e6ab4010cabea6c1f1e86b755b182fc437f6e8d23fe68c1b1d2ecf672f97206bbf6fc9280fcf88423033b0eeaf958c024bb51f01569e571d435a09c03a0d5a515b22b0416c8723618d292eecbc6fd5bc001177bee9dc392e80c793093b349fc9c97ebc339559a2f63a6f0e8e9a0cbdc51052880a872315d32ec06c8714d1a9cf26a78251177a94f61c2450ad7de0adf752921c11eaf3e521fa9ef8dd03d24f1819169b771e204596ed2e4919eadf6757e230b3df35c8c5f1f19fa6a4d4a3d3720c6f841a106be8e7092efd30cdaf0139f343371ddb7c477d6b1bb34dfe1fb368f428139c0264fffee8e5d78916073de64a81f55c2734a5820819a1f3ff1c86d1fe367b94d2099ba9a88a2e8442c8bd4c9a262f6de4f0226a6109a962aa3804b46b0a0fc8cf9ca99c34f8458b8e2dfad92a6b74fd7f69e4b90f48864cf952ff97544ba4ce8bb30872a71b9c7cc9d8b631e5d4a132b2e586f19e04f45c98fe05c8b57bc6bc37613a9ac2c1f129d0648539fc9ba97df30775fac97dfe73c1e7cd8fd54da9f209f3246f6a9dd6ad5bd504e5ca07667689e95164d5761b98afe1ac31efc7c311d95cdabc3d2b2df68efa2011b0378aa9a6504e9af63a76c1f1ace2e4fbd18dddcb9f6ff2614526096248242b3200bcd3a46eec3246d98c02cb27ad5bbae7bcc403208a81d0db340f6c8223a52047470c32a79c6208854a537612d73382729d107888962d68314932fa006fbfb23beb3cd5a64107f0d5ba4ade6202ed0109d9f59b35e48c304fde836f983b5b36f00910e470b3d5fe013fb11e5db88b3d905524248946f255636a10e47f5d3b038bb0861266a06769c00601a551c86744c5711a1f3e36b5ebf6e3001002d27ac8a002b7a6c799f4a20fb4319c2f24f345b57c2749466624a7ba56be1ee6baef6a906051b732cd60f70ea130b5f0184d5def372c0ac5b3e02d626ab1aa167c8c32f3a316bae4577f75c426d5de19e179a2e2058be11e3f019f41b4110d09a8545477212decb91f61cc7ae30c9412ac38dd02d3876d724251b92a9ed64087119b5ad75fa8b3cfa7bec336565462ed05c8e552995c557a3678f306a3432db83e60f928bd28b70252ee5fec7fa6b4df00bc5803cefc1daaa681b94d0224a2a0994bf938bcd4d908d9e0f6438096dfbd4929dbfff97375b198adf7c4a0231852b9a21f7e3b35511eb631b69d4c20648819675a963aec473ea1e66de9b8abc95f7600f993312f5a1a6a4de56086659833392c17d7a0a5578100e4d996576a4107d2eeefbf22edf2bc1ecc82f2cef27587be630f26a691d70bd11673fe8aeb4693cba252f3a25dde9ef4e97c068df0ed9186a50ba7f077e2dd8579162a54cb40c03355a316029200a11663e187dba2342b3ce04d27aeba846f1117317d981c41303d9bd7fdb2cc15b7d8f6ff244c451b1342ced1191dfcd49a7101f5f661f89be19afec8f3ff2457fdef6a6bd031392a010992e8df02fea1841518abe4ead222fc8375a0fe151ef33bfecfa9760b4bcba38f586caf1f722adc781da4d616f9a0680ac7c67369bbb3df350f9ae9a805c705cb09dc5f7a85ef297cf6569061705ebb22fcaab7c251d5f73affa3ddb5214a0c2aecbfeed2491d5ec0966c0007225274b9bc331f6ea770804eaaed99b2b556c5702208b6d3a6383be9c155451aa93efd7e226cb9aaa15b8fa966e2f7836116aa8440247937f1b1e412f15b67c5f9a02c39391ed639ec21fea3fd2ef5d0c131dcbb5276ccd673c4e6d82ec823c4a430449159f074dff6aecb15dc7c08c65170b8c4627d1a078e7d089dd849f0de138e3b809e7ddecddf2e8c173b85f156af9bb79ce31260ec5d57ff2a765b48a154fd4746a0b113eb7055e33b3825da18641530a5121b62bdc371642d49def67053049ea349c66399758f7654dafe03f5f44be9d702da82155747ed339487bda456fec99c5aef0b0fe05dc1533f7774591dd3e720fb4382d25e29b541f19925e407f3377a6358d6ab43ee2ace2034189191409bef56f9dc9f78bc56d47d81253d4dfac816e28444d1585697db55217574e3f7794ddedcb06be766a1dd673dbd098c6861018425e7739d3203018cdebf92bdc997a7f480b3a96de674ecc9bfe41ece2e127e3381d7e0bd0e56b2d2eb9bcd3142c99aec1534f7afcdb8019c05d454fc059f8774ae8f513ffe5913d0f6cdc756f877aa3ba255271b6b5aac7dae2ca19c38795dfd091876d4dc24c62027eedf8a0fc5e4a129c82f448b1c53e935cc6a2b569167df89fc9cbad1cbba2dd54f80d12b046409b77f0154e1b7d2854e6b40a368f2b6cbcc826f05c447275c9fafd54957b14c72873a0dba9cbd160b230fbafc7b68b4f5971c78b4cfe3e6bff831a573cbedf11c0ca199ce2a8e3ae1951c6f84574536f8ca45b716a6fb8f1f46f164e382d4f50c705b52c14c13417a755d65f64ca6e6bf372dba137bc71d4d6f24d56471d0c71c3262261ae7e37f30003a73b55d985d68c91a4afd7a0622437076d76e11df7f8a309ab428f07faa5e5de72256d6bfa6a2dbba0752dbb652f98888ab80f4a6e52eca3be3490655b4f0b6ce07ca028830dbf67f9f50dc91722de906d6240c8776ee81a3dc0231e8491d4b59dc9c45fe3d4369940c6f9f1a8cf2790adb4567e38b52d044a3c748d00c933730039c9c895cbc6b9e5267f3b69652d50aebbd28a7330522f9e30cc8080dd2b83d23ac40fddf40ac81be979e679cd129013996c80364ebdec670a067244165edc7f732470d0218f5dd4621d12e3ffa2812552d3fd2aa029907b9488a6c45439cdd1fc2aade4e0182dbcfe8b91ed274e526d22f7bbc9187f528f89917dbb0e6902576368c1b5f2b8d6f3376524dd3820770b245a9d9478d9456a8792d09bbf3fda3aea1b1cf1aa801be2945d386e529fefebb6b3c3bd7e6728460f6ca17b69a4ff694caee956855a8813feb5490190b7091f2bc1c19c9be8732be662254447d885570d5eba3b3a491471d20e4fae8680a7039bfaea2586a8974185adee324f11d7984e73e95b15b0e9a15d47ca4a2bc2a32f7f1a97f8b55d5b6d8aa4d1e3e16d29fbae9e5de8c5e75028c1ac0eedf2c8c12216e3f5d9381405530b04385962d7aee5dc17b8603db3c6d93675998175b61645696f6ef7880e8e4318602b6d3c4e8974f65d03f5bbc74cb3ab8ed1167bb6ede6c984b38a0b549de4207047ba5a317773a97b20be060fd542c29dd57c1b046f2e80b788208dfb257a8ede5600fc45378a58b71618698a94896a8537b1085c01e2d1349801be60ffca7506c475d7648807a1790e130b3c0dd253794e1973ccd5bc381722d9fcd347df3f385dc5fa51cd2dfba83cecfe08e0994e454992dc72e165074f3c44472f011cd3c3a84f3550dd179c925954b7fb1558c34d5749c1979d4a2d9da2002c8b9f91ae280f8a8ae0c7b6e8d11ec4d554eacda026254a6a01c5d07e0d7acc0bdd0b91e977eb290740760fdb753683ba945d3ee9111b109e12af27f542c0436ba18596633572e495bed398b1c696c8ed00d132f2db0e9fe8def3aef8a021eee99efb6f84c9ae4da521f8b913b0ae1ec689863db482568d3f0a3efb70b14ebc3081f2f589e49de5cbcd2d817fbad3385d6d10d4c37bb043157e5758ac9cf30aac158f152bea7f20cbecfe8b752da7cbccc3f58cefbaafe8c34a836c9aea044aca4be9a66e88678c463d29e3d81fbc319a7303ee1e8a04fb9d10e8e56d1fe9c49e16a241c66000dd7814781c375a76c66822a400559177b73e9f248c10465a2ae97b2889467f38c53f89ac6f2afb76d5fceaaad549e43748558ed93d1dbc1ba5d0acc4104066023191f6fb9431d61c42ea384be409e36a6a35b98df2f0edc7956519afa0a6e050b36263c40cef1af73106713f9bf6f04996439cbecb38201b21be174ba69436cea2abfe39e8eaad9d8ac77e632265ab142ae4708b15e17d76029736bc9dfe143b065286525f0645836e900c6a433f98b634a7f501c79b05080c6e73cfb3abbff974baccdc28853930cb1979b6d8ebee3d48664432ca04580ca013d71bef9872f16677c8d8e3289366e048f8be483895f8f659f0d87533aa23eb3f624f6c1841985207097ccd9de8de8560e7bcfe968ad22875182fd511510ed8543c38a6f4287e57edd3a073eb030d1a6e0eda763f908e9a09965449b0784a5abbcd2831ff1fd7f656f452af75c7991d147345ed499b79b3c6851fe822abbdb4b2283a9c48c22f8dc11b76ebddee3836652edaa1dfc54d2a138c8bcc25cf30f7e2bee29e3443c9352c48026d64c5274ec9cec85cf5b13987cb3e925cd46bc0f4a67f7094699603d3aa120d30b19047a1834c01c571e804656bfb01d6f8bd0794dd16db2e663a5d1b8143bfbcbe46212ad1ac82bc39744316a4ab4533a4101d6e9dd441acab65efd4b70db0ce5c7c7a2611dc242a03c087d06a3641b2dc7c32fdf6a7fa65c20d060a2c2e681ce4f6fd248951467b60c66be100d054eb5ecd8322a8d12e10c169aba03083543051aa62de0d7b6f06e2117edcda485514a8075f4ec3a951c1d4f55220456c8a00e41362816d20f74498b733460e619712a20d350f5859f32c433006d869563cec0b4210d850208d3e3e12e5c3e01c032cfe517b23640a8ff03f9aec53b24cc83535b797df1cb26c9c1cab75f8ca97076e41a01ce0ad90fdad12db8e5341a0dfb2d98cb3b221f25dd2c0b3e24071fbab719964d73c251d8a3ace8fc7f73c9487148d13e943fc9a7a4b2ba3e826dc3c2ad5da1a34f9e68eeae889f12e4b5c59155715a31ac4fb2e8ec788379ba46ae2255571fcd192fe4a09a323128988f1a44318feb01600df0d1eb1cfd8505c416cdca4436d4995c0a3643e3e55599948c86258058c1f683a446f607cfba6c4a9f308f887e1dc257a619582245876238ad0e03ad0afe74dd5e8823101f4b60eb99f3251a2eb3a380f8176167115758184b07645de7c45da2ac0834f9d70176ddd8b124145fe30622ff5f62edd5f9577741cfe8e9f49a708fdb245b04141055d98e01f78a012ae11fccacf4e5762b4746e478b817c06859cc83ec79f24d35d30e0d62a3f93d8044f92635c0458a43174d408bad0cc9e5e2fc261b24cb3e2a04c69e24f9694db2ebe8b7b673748b3caaad6ee962edead89cf7a9a4c6ed482915163357ff3c57796db5adcade22bba19bd9929e49e341f915ab0c5e04ba64e7f80f7dcc45794d7298a4422979bdb450bc55985abed4ca60fe99939522f3b0641bb8207b8160bc71f1cdf43390a7f07bf1982f4d4380a43fb2057da388426769a9095fea10721a13c71e1e526b43068230248271e8dc98699e786f277509ac5dbbd9cf5834dd1d4d613b988a047c632f68c6bde40ed7953bf341ff651de020794e7ad9702c009896aff3337b20bc488c7a21ad0d3d321f450337344d8ac62f481110328caa13eef413d7fa4ea9f9001fb559119b96ddc80fbf82964c3dbf9557aa3a61f7c019a008d49d8becc3623be59e19326e28fb56cd24033f7ff54f3fb7709c688552d6ac65ee30495163030e0fd51c7784a3931767a608b7660a058998b780da994b02db81e42ee46fc8926b21f8d15fbaff161ae5299659a255048436ef94abfbfb8c7d5a19a4b73846c34cc0a5a079c467d765eaab65a029feafedc2cb3f2135981a02857c1120bf14009f3fe65840c6f6b6cc6e25751f622c07fbb69ecffbdd8f5a6520f33b212cb144949aff7881bc95fb87efda0123e4d613041d0c1b715df063a365a640b8f54b1fcb6d98937065435198efe2168c893b913333ec5fa5df1d31540ca915badb1a0d2731de5e55ca78fcdd4e5a61249c052e04bb3a5715995e37f8d3784defc7031421092aa5d51dd02aa95e253a66c99b2b1699459ea551c9a6d736db9f442d4475215cbf9a82f6bd97901c23bedfd5f9c0bffcaf5a6402b39833f25ea1a2187dfdf52d501c0b5276243c9cb54bf8f4c4f28f69aba4f79c2b43fed6b17293833e4f8c1b8eda2cf8d766fe9d1333b4c0f46d8122cbd25d0311c516a08cdac47cdb70adcb3565580de7614d97713f8252c88ecc0733eae1b9969923b040b88202ad7bd09131eaf7d07e3f9fb9c54d794581ff1a8697f17dd2ef1939144085718952445b0bec57119be7575288a7eca3673b052e37a54cc04242ae539caedaa4aedd0332bbb06e5774a04a87e38db1225af7d27b023cb5e9cb5db0bcb1d582603ad934e01a72c8e9fdee994e5ca3056b64d33ed601dae0a942d57173d8e606c923038096406c73859fcdaed4074637edd347a339ef21e69fdcdd46df6897be137515f71fcc8a915c6b8e82361da459a8970f8dcc93a59698e8c7e347296120b74d722a97eba139910780b6a757665ffe38b7b64bab7ab00ade36f60c4e0730e23fb7bddae79a182a97a71146323b659d5cb0a4fbb09da62364c8784ad31c7fee43fc7daff410610cc0841201746831fe34449dcf3abb3245e77d7090f17af103cde65a5b09dade9ad4288dd08466cee448b373fe5f35e6a5807f5cd3cfa8cb73d3585c3d728a0d14bb3cd2c7b46e8040ba17285edc9d5ba9bc4962ac5d161065b0e478907532446b97dabd1bbeca3670af394ba8d8de0d3ce778dba2586225f1ed272212b51e02b42c32f1dda3e8b0075aa48dfa95d883f4900463cc4526e0f342a35622fd197cd7729b72903ead97a6a28a2a855e6ce37d5de6e60152b86761ef8c002dc94cb8684bab5728f2567dfd7ebea1558e05589ae47b8a3e5601191506d28faa29ec2177ef54567c48e5a98ed22e43414a8560e9ece7a82f7b15bc83e53c9eb632127dc06bd173c5bed2bdb2a32c18a01848193d9fb69e1e7c6bf9fe2e2170a64393a50b1445280b04517d394919f3a17b286d00f68166dfb8f2fd964c956217b006b52a6031cea89500b364fe2d65fba7f2b70ebc08e83742c47c066810fcb971d8ead5723ea468d2f1c2f472901bc78917636e5a5cf46294a3aaeee8f161dd6dc881de9164b338879565d79df01d6b018d7adbce0306f6fa572436f93990e52803df64843715dbabf0c1533518e345dd422ad34b5fcca4a3cf8e1a9a33616d4fe9ceaedb75a3fe097c8d07d2f1691d8b9d14644dfaa3d7d8b41735f15711f420dd21657766f4b7071b86cbfe577f9aadbf904c1e144e2d02f90118deea4d7331504611e70d34628362d27b5874a6d6734f6e116a769fc92131d51531fa4e1616bb691a240664c140cabde2d6ca7e70be5855c7eea91b5508bad4d82cb060021533e1412dfc98bd54be6096a7a0045571458da15300f7c941b866d710785847b9ff64aa4032d1fffdff168078a2f169d1215653d27c85122e89dbcee81bf93a192d98cf0ff98e9c953baf8765c742d451a0f1068db3f23363344f4c8077e66b86e4aa36070212a7ca585028d0f8de0c60b514bb21443307a07f1718f24874a3df64b4ad63fa1faf1d69ca51d1b713d86a2fe96dd454dddf49a3db985ef93d3bd4652e4a410f151e4be9533f5af4d2dae3c504120314b43599424fd7db42bc77809c8a1c2ebdb1eae4a5ba3dba4a55239cfd1b9231a04a77f69e6455dc4bbf2aa8e34fbc74ce83d076404d571ea5a9bb84b69c309cd11cf3216ed6f631d27dadde425c94e84eef7cd64bc856fd35a659404adc9ed13f3fbc4ebbc757b9855f13ef3866c1acab83b4f88437b4a0e4315e347b5075fbb6fffcec0fc712efb9133f06184d2757c347127c91f8b7433fa2d691e32d745f2a7852b19b8674d3c51488b89e9da596e35c74919bcb5e1b9ed74e47e62948ab8eb6b9d3378665905e7db2aeff13b639fbd16178c7169fa23ea5c3bd40612d0fd3a69afbcd1fb341e6dbb5254d469776c4626c30ff793c53c5469ec501ce7b8909a7bc8d0a82da276faa1316d16c7f650187475b31f7060b09dcbe0550f010601af677254856a4c1890b0855b65d51ba2d4c2fa85116365fd5e95ee22cdc7cd57eab30165b4f71f28dcc3cb78baf3dc3c58ab858e11c070131cfc486ebc62d4f27f0bbd01d626f2f20683b2bc4d30e337ef410c6afa3a38645650965572ebc0b0d571acd4b292a19c277bc58ca305fbffa3b2715e4d08e9757ccb0e62e4ba269481935b9f1d09b732ebd1c184cd091baa61c6ef2703ba9969bd1a031b20837fb2d395b9721e7f54080e5b02016e64352bfc417ce9e88ae1f969a1cc99ff85613e88e771ad383be310d9bdf7504d90717f2d6f6020429681014d1eeb41db570f7f8ff4da40c764f0583600c1d96cae683b30083c720d02ca42c06d16e0ed68ff3e80dbed317f7e5b52472127689a02f7ac0d31018765909afe5267f4b3559f961d1101f3adab45c7bc7077c3bed2187973d4f05884e34ed07db0894511349b6686c3c402df75b28ef0ce935c9f0f1b05ccbb042718c932e798bcefdb1dcbd9331e40754ed294925039f3330c0cf84abaf67576a5ac5f9248b2b5d0cfdceae845f2f114a92aebef33e2c4977ca47b98f2580bf13f0e47fb0dcb32ae9f044125d79911aa0e7914fdc782204f732f438351c0e517a7b147b9cca0ca319326e8a6e657a9c9a2df24836906451a58e478bfb8251ce4ba924ea070332cada74e05dbbaf2b97194d1f79926672d1239ca729aaddc5fae463d95a6bf03139147492c55a39f0d5e7add164a167294a14694c1c285c116533e904ab9376f79ebca2596e281f568c2eb508312211ef8eaa11ff895ac1cc71347ca826d5089664979ec6e85fdef73e4fc26cdb1430b151643916f5bbf8ef31f299d91a017e0648aa45a61f479e424a3514a6b076221e2a06fd0e34acf01664c00e8b85dfce8bb10202f8930931f27363f6feed0ededb06f0a76f50ccf9487d3adaffb6822396a2c52d3c26679bc9d7ab0fa543bbe83cc8722254fa7b5e87a774009ea0ee0f15d0a8f2754d7d01ff32b758bf3c27e250c489d960380e595fba79734408717ba2be77ef37691707d0fd97d5d596c6af5c204f5d6b6cf8b2de86dc3995b0c776eb02f01fe761d58940c929bec3f33c1eceb9b837648fe843b8fc9e313846f8af98ae687f817553c4431e4903cf60b5698f6c8e0036ea250a45b515e731765bae5dcb21cb3a0ecdff3e8b0bfeb318e0c5adf23178228a37e3fc2be8ddfa62ed53e7c390c0dd612cac7cc3dcd9869a70287e153a0b66c8901d70c3bb338e8420da2fe7c39f77a0a7c6ed3636132daac0c0856fab9107d8c17bc5c73e25024888af847ff933cf86af0b2d4d7efa7014773204b353394787338adec82606cf444d884da30e769132fce58474cb092917431ca0a28820b292186a7422702c1ceb136815cc7f56183e809f344a42229058bf7da0ec979596f5e133090fc25a6f2e4cce6c85415dd86a8b75793c1c1657ec1775ce488b1a0bb7683fb188b5a67538a93fbf901209d946b6633e93686bc2c6a6b8c8f5b24c70587a8c4d52568a4936ff13a9b0d0f82866dfd5cdd87d0c5e4815ef883bf29a20dc855d2fa7ad0d3cd5a089e705141fb495ccdf5235b287e6e05a40bbd56963a6bf707856ebd70fdcbcaf3442a12ed4fc62b1b2c4456b912488b7f150470e5b5947c2ab7a9df76db9f286f9cbf347813e0f70d3ed690edac8e301fdd4463b4704d4ca65b90354679930b056f9d8394bcf30016b1ed949cd72013874141216c74b14f3af6447e78a505314d08c6d21d489ae820bdb01d0f7ea18d4b53e07260ef578e879db726c7344afed147562819d6b4a436e5382b3c79af70bbbd62b5c0d433dd935a2ef2a8166680c28af23e265f5947b9f38eb8f51dd438f633cc875c3a8e7eef756e8b85ea7f071e1214fadc9bdfe6f5b59f85e0b942101a66ce3c2f0f36161bffcec8703e75838b14b1ef780a889ed5f62c5670600866e0156d61bdc7cc55137f3c825236b86ac98364b25ac770fa83c9a201a028580ab9e69c232bbe9b6eba5c0d3e1891dbb57559db3f3f97398966fefc540d4136bc0ba8dded4423b927c45a5144a9d8cb4e690ca555a8ac7c840260d00f67d943e8113a2841e37ed75b676bd9d14226123d62a3374f8d656909d35aca196010afa86f39f020260596de8e9cc3611e20d5c032f2a7a024198912672065285a1b997ea02ad4939696a0258ba22ebfa40b0b635977835dcadcec56b905d4ef7a30940c9516a026cb8cb3836a5df0372ee0ebba8302e4d4ce101640ffb2d28ef1e50cb0fce2381262ed5983e71488987b11f59f4f412499853564ae3c0f391e04d3604eb34997f3f92f03995ad68ea945bc5c34e1ebc41cf28a25e271015fa15a4d23db4ec4067fac19f16850bc9baf4fbae583b78a0144050659fa2e835497434f17690b8db35b8012ddca27832e7f6de49955b8dffd8b39605e791defb568b3851800cb3ade019aecc9f852c50b8df6528b48aa940aefbed0e66b59d3cd910e85e47c88e3d3d6c0f86d41a6eafe610826b8cce44c6ae4f89c8179484b4f341502f283435593f7a0a451e9ad33a92bc0260154a2487e45066fa49e04aa2a022557024ce0aac4d7523bd790bdd6ad6243949cfc69d0ffd1deeb6ac1b27bd19b1d6b63ab352275ddd2e1079d26a9453f0a32dc3fa5b027b778f15ed998573ec49b3303179b39b2d0a45da5843dd7395e9189def44a4a418478a7aeb396b94ae25e2d24df77d5768affd87ae147816ce976413507a39b167903d6ba2adc0afffc8256f4b43d90ef4257437e8b4f827124af9ea684e75bfce7fe8fd8c3c317539ca061155c1d903a5fe04b8364cc9f0e6eed08b74ba3e88a20a96c19115b7e5758076cab9824d528b9a580876edf13b7f0a05a914680eee949e95e62bc88f98a679b64c33e4a50512aeee21edfe318b8c33319cb36e25ad8cd3e45b34f684b2eb5329e4be7ae29ca9f45023e495a2ee564690ae1942d704e8e36e3d9295e6df22fb161d22c1256e0fc69cd807eb472e695593568de349f7d8e1e772a4d0bde16edf9dd5f0a6c994f6caecd19ee2b86d9e6626f5479ba42d7a6e0ffe77fd52a1e25a7f1fe82bfd4352f0a0208c41e7ea955bfbc12467def6bd8176ae65fba07266ffef5efe92ed875f9895e2af7b909fd28723d497d9b5de184175b346397f224517ab688fa764e2b5e79a0b4f5e564f51740a8400b0a592bb74146c77d563b3f35c22c1e1cb0575f3888f484505e8153f2b9be30ba09f8e0f48a4e3d63ed7c43f0013b9fa15da75303e08cfa7ed489edf41c6291c8802792fe3cc3a58ce041334de9b5240cea1c94f9c7b7fde42ed3fae10de237fbeda8f561b4a076f11ee1d460720ca8d1160977190348321c5346304d278ebfd2e4747db8dc46872fe1b71770aa4dc26c36f9be969dc82bcd27f08132492953766cd069f10cd4ca132814c0c3fc2d740c8309251a237a471a48bfe459ecb969685fa7c42c08cd6ece5b99b06fd3611b53c50f3d37a6a4c378207c72d8e676aaa87c9f21cb865d4c47f361562953ed5914c703f2bbd3c8815681aae536a98997cab1e53697857b4b79f3a372fe5d2c3101b38bd122e9ea1e8edacc164cb0c7489f5af29da924f521c2268831862978e0f0dbe75c666a208cee0f96c81acea299d227a27de31ee1ab63730a169444e541b218c320b0f341a5361e359eaf70286e4cf94213b87c4cc87b8e1290b47d56775506f7e03bfeb932436a27c6ac62ba134ffb5917267fdf31bd455717f7332bfef2e1aaed13adc3c9950be6e267c44174a95a84d541f43f8bfc2e5f83c27f9c7bf6a9e7a065dce50ec6321ff39490f0fd9fb8719782079250582e27ded9add1c46206f4319e27cb234946f8700c4bd232ad081ffed03b91c4c1b660cb4b29085d79f02566a9e0d1c68febfa654ba60c7463258e14ec102df29933bd1904af04ea0776b6e1379fd086a016474e28207ded1304b6a09bd902175ddbee6f34ab93f3950a353fb23f4812c8bb1465a692b0160b5b9075fc206d2e80f09bbbd3a9aa534873cc0c5e702fec619f0f1e22e15e7278e86044c9f2071b632f7ddc44cf91820b17f0848ad1a36f1398ec1217858f7def39e5aacb83a9e0dcf4777c7f0bb0ea5e1eb5bad31d73833f81f0f9001ec0ab624996908babe52d3cf4b33c19aa9c8855d70d0c27a7f9bc5bea4fa4b3e0a73ace38b08d9ec76a20d0a38bd39b49501f76da7c3d5dbc2dd56d546d83348ddc0e2868b20725611febb27e2070bd348794272b84687a1d894a734650aa627ad54836f351470a158984fa2b1954bd36ad869b035c215ff7897c23500169cd1af7a3ccafe3c01f171b252c63f78e06253ce6509c765a3d91b6ad0eb34bb4b92e5136b8dc5e3391754c67006918c4ba981e52e5135f725fed577b5de1f6b6f5679fdc9d39e3600e593518fe793881fed05bd8f3352e5f208bc297aa6d2df232c194cacd1fe2887ba4c893128d69b904cfd0b8a5dbc718657ad91ce275ed954fe8bb526612684d27f526cbe0ad4c3dcaed0d2b124a9d9fc30dad53f96a18497a5889af272508e9605af15744a64acdb9522465060f0bbf572eb5d74c3b9518e5336ae43c4d63f4c6885e48cf7dce8d1eb41005b504128cf9f341ef87709dfd9e4bfb15fafb493b9b77719e46035ec1d18e7726c1d5cfb515643a71891a8e23c7218bf20d70131bf9508779a65ed7aa96befc1bb07fddb04d5539e1f011a78b584fa2fde346ddfc50f0a7f0c544fad87cb75dc53ac361b6466d691781159294688e23aeb8baf85e4ef1c748bdc42b041d57bcad1f39f9f9599f623c0a2942639d0a18e1e88bc28cae3735e47968b771df978830521622c806eb9398d97d5ba2914aae8cc3709db3c6ab761063d506a9a79dea030fe24f9b286f9f473f1c0d3f91c57e01e66e6419a6ee02c894b6f6dcd70e608144b143f35bea83d8d852b2483a45d7f1d4c7813c617caf34068a5b10b8d8bbc9d61626157de6cd3e560f8e554db414ec91a0a30763cc5820386f241177f56a4632013b7899b789149efefed2d96c49917701b8c1ba9c98eed3a847d37e1629f1c56956299d42ec824ece39c55274b7309870cea963146b5461a9e46f71939c63bdd66bdbf8e8c4199ae18e3cef1793d45b0c7014dedd79d19c7f888a6cc4b65b80228dec7a0bcb00d7adb8ef280ad847b818fcc403f9494a146cea8089a0d81374c20d7c2f8abbf083da3d7ceff181afa0417f9f03b30d1f6eb1c370c152f0fd39a65eb88fbae4d5e0e420ee4036478ccc83ca37333d7dd23f5015af69c7c3ff94e052d1228d75c74e58ce4bb5ca499beaf5d38e4774de4e99debea5cfe1dd5722bf2cfc9bd4fa44d012e99fe33146f5778813e4ab24fa64650c6ad59e434e86e75411970976d0ea80e46c62019d139bd4d202653ab8a3e5aa7efa3ecf14e6b976968f280800714b0a7583c870ca46e0588406b00d4610549f2a3603f100056bb02dde61a38e6a2380016d5cb27bc0e5f978e7be8fda034adebfe62fcb91e0bf5a96f0ebcf82f2c460f6e6ed62a5e7a0d472fcbbc2338f68c6f97d577b25b06ceb65571ecdaa5c0bef5ff82869f333c03ea3721be2662169ce5b0e43970612c2ad2901a53a8e382638c3e3f0a1ff05c2d77f25e89e8b492c8f72c49f989081b4776f0ffed9bba19b78aaae2080fb55d12ae06acd8a85fb4535ccdcf657aeec761122e79c7d3aa49159dd8624b6fe6f8f1cf0c6589282f175d2d69bdefe2db0ecfa15107f066ee986c4174abf4929c048fbbfa3be1eef22ffe4d813d664aa236d54282233d1cde39c489b98a801bf6b0845231d7b7e28d07c8af2d4cdc56ed8f5fc477e2b8a2639ce36aa502d8709e6ee71e04781aa6e042dfd2645c2e82c35bcd39ce9d4bbd7d20d574f26037162000f86b2c8d19cfe72e55026d1a6a9091ae54f01a7df933532c17470490606af60853de5375cf2e33d80176eaccaa0191b1d7c24dd48d284127da033a31c0c90b025254dd833e56a049cb0683783b405921d3f2ec162c57a3e7bd75d3e42bc82f3a75db63f4834b4a4d4548742901eaeb13ded015719708fa85087fad0dd49f6c08786bb06daa40bcc83989f78d64200079b47bc9e0dd86979833cf74816d48ec0347435284eeb2cd2ce4abd2a35f527a7eb40710741fe267ea0de2da3992e6689c0bbbe6825f48e5cf72806f48defde9ef46fd0d8b57d8d1695f9da633585c31e822bc7260d6680d444ffd0c0e1ef82cf352bb8118e03c9c675777bc66cf128ed506c976fefb3b5e6aefd34b316d94697a8363a9a69e68ec31797b47870b075473e857403afa36ced1228c0e180b784112c8680c96f9f5b27024b2697f90810a3aab7338d7ec5a5378f2c2ed252e94226a325d991fa200d44455f486bba3e95b91a54093c608d4476600a6db03762c89d8b70c4f7f207cc2cca0e3a44fc6e09ab8e8bc61fb10c272cbda73b06981cb48e3c714b36c312388e8fef647bc5a2eb610ac564bb8f69752dbda3420716c8ade070879411cb6acb1a46240ccfae75d3472661eee1301596641d6e481b9ecd46a94f6ff98b2ae4fd3bbc71496c7a3762df68601055a106a70fc97fd539b912114a88d30f557d8767e6c3a27651e8d3433c9734505bea86a5a79476c195fde9eb00097216f9d1ba79caf1950d5c800e7169e5e8556398d4b40a174c50e7062d2463d6c2aa50ecb2faba809e322d342bd7dcd9ade7b5a81142fb926785c969fa9086b7e441f2022ad1b37a6af134e57297806db5292898a1601f57c98f9bb17e995a7bbf24666","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

            // you can edit these values to customize some of the behavior of StatiCrypt
            const templateConfig = {
                rememberExpirationKey: "staticrypt_expiration",
                rememberPassphraseKey: "staticrypt_passphrase",
                replaceHtmlCallback: null,
                clearLocalStorageCallback: null,
            };

            // init the staticrypt engine
            const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

            // try to automatically decrypt on load if there is a saved password
            window.onload = async function () {
                const { isSuccessful } = await staticrypt.handleDecryptOnLoad();

                // if we didn't decrypt anything on load, show the password prompt. Otherwise the content has already been
                // replaced, no need to do anything
                if (!isSuccessful) {
                    // hide loading screen
                    document.getElementById("staticrypt_loading").classList.add("hidden");
                    document.getElementById("staticrypt_content").classList.remove("hidden");
                    document.getElementById("staticrypt-password").focus();

                    // show the remember me checkbox
                    if (isRememberEnabled) {
                        document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                    }
                }
            };

            // toggle password visibility
            const toggleIcon = document.querySelector(".staticrypt-toggle-password-visibility");
            // these two icons are coming from FontAwesome
            const imgSrcEyeClosed =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA2NDAgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTM4LjggNS4xQzI4LjQtMy4xIDEzLjMtMS4yIDUuMSA5LjJTLTEuMiAzNC43IDkuMiA0Mi45bDU5MiA0NjRjMTAuNCA4LjIgMjUuNSA2LjMgMzMuNy00LjFzNi4zLTI1LjUtNC4xLTMzLjdMNTI1LjYgMzg2LjdjMzkuNi00MC42IDY2LjQtODYuMSA3OS45LTExOC40YzMuMy03LjkgMy4zLTE2LjcgMC0yNC42Yy0xNC45LTM1LjctNDYuMi04Ny43LTkzLTEzMS4xQzQ2NS41IDY4LjggNDAwLjggMzIgMzIwIDMyYy02OC4yIDAtMTI1IDI2LjMtMTY5LjMgNjAuOEwzOC44IDUuMXpNMjIzLjEgMTQ5LjVDMjQ4LjYgMTI2LjIgMjgyLjcgMTEyIDMyMCAxMTJjNzkuNSAwIDE0NCA2NC41IDE0NCAxNDRjMCAyNC45LTYuMyA0OC4zLTE3LjQgNjguN0w0MDggMjk0LjVjOC40LTE5LjMgMTAuNi00MS40IDQuOC02My4zYy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM2MwIDEwLjItMi40IDE5LjgtNi42IDI4LjNsLTkwLjMtNzAuOHpNMzczIDM4OS45Yy0xNi40IDYuNS0zNC4zIDEwLjEtNTMgMTAuMWMtNzkuNSAwLTE0NC02NC41LTE0NC0xNDRjMC02LjkgLjUtMTMuNiAxLjQtMjAuMkw4My4xIDE2MS41QzYwLjMgMTkxLjIgNDQgMjIwLjggMzQuNSAyNDMuN2MtMy4zIDcuOS0zLjMgMTYuNyAwIDI0LjZjMTQuOSAzNS43IDQ2LjIgODcuNyA5MyAxMzEuMUMxNzQuNSA0NDMuMiAyMzkuMiA0ODAgMzIwIDQ4MGM0Ny44IDAgODkuOS0xMi45IDEyNi4yLTMyLjVMMzczIDM4OS45eiIvPjwvc3ZnPg==";
            const imgSrcEyeOpened =
                "data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1NzYgNTEyIj48IS0tIUZvbnQgQXdlc29tZSBGcmVlIDYuNS4yIGJ5IEBmb250YXdlc29tZSAtIGh0dHBzOi8vZm9udGF3ZXNvbWUuY29tIExpY2Vuc2UgLSBodHRwczovL2ZvbnRhd2Vzb21lLmNvbS9saWNlbnNlL2ZyZWUgQ29weXJpZ2h0IDIwMjQgRm9udGljb25zLCBJbmMuLS0+PHBhdGggZD0iTTI4OCAzMmMtODAuOCAwLTE0NS41IDM2LjgtMTkyLjYgODAuNkM0OC42IDE1NiAxNy4zIDIwOCAyLjUgMjQzLjdjLTMuMyA3LjktMy4zIDE2LjcgMCAyNC42QzE3LjMgMzA0IDQ4LjYgMzU2IDk1LjQgMzk5LjRDMTQyLjUgNDQzLjIgMjA3LjIgNDgwIDI4OCA0ODBzMTQ1LjUtMzYuOCAxOTIuNi04MC42YzQ2LjgtNDMuNSA3OC4xLTk1LjQgOTMtMTMxLjFjMy4zLTcuOSAzLjMtMTYuNyAwLTI0LjZjLTE0LjktMzUuNy00Ni4yLTg3LjctOTMtMTMxLjFDNDMzLjUgNjguOCAzNjguOCAzMiAyODggMzJ6TTE0NCAyNTZhMTQ0IDE0NCAwIDEgMSAyODggMCAxNDQgMTQ0IDAgMSAxIC0yODggMHptMTQ0LTY0YzAgMzUuMy0yOC43IDY0LTY0IDY0Yy03LjEgMC0xMy45LTEuMi0yMC4zLTMuM2MtNS41LTEuOC0xMS45IDEuNi0xMS43IDcuNGMuMyA2LjkgMS4zIDEzLjggMy4yIDIwLjdjMTMuNyA1MS4yIDY2LjQgODEuNiAxMTcuNiA2Ny45czgxLjYtNjYuNCA2Ny45LTExNy42Yy0xMS4xLTQxLjUtNDcuOC02OS40LTg4LjYtNzEuMWMtNS44LS4yLTkuMiA2LjEtNy40IDExLjdjMi4xIDYuNCAzLjMgMTMuMiAzLjMgMjAuM3oiLz48L3N2Zz4=";
            toggleIcon.addEventListener("click", function () {
                const passwordInput = document.getElementById("staticrypt-password");
                if (passwordInput.type === "password") {
                    passwordInput.type = "text";
                    toggleIcon.src = imgSrcEyeOpened;
                    toggleIcon.alt = templateToggleAltHide;
                    toggleIcon.title = templateToggleAltHide;
                } else {
                    passwordInput.type = "password";
                    toggleIcon.src = imgSrcEyeClosed;
                    toggleIcon.alt = templateToggleAltShow;
                    toggleIcon.title = templateToggleAltShow;
                }
            });

            // handle password form submission
            document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
                e.preventDefault();

                const password = document.getElementById("staticrypt-password").value,
                    isRememberChecked = document.getElementById("staticrypt-remember").checked;

                const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);

                if (!isSuccessful) {
                    alert(templateError);
                }
            });
        </script>
    </body>
</html>
