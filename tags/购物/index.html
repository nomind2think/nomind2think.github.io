<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"0d9e0e569ae6b04798f83e91edd0bd9012523db23371fe998ceaf57f5d872643b083a2c971ab361b4addd40157fefb72e9acc800ccbea5114a036370bcb6b409c952c5fde3bc86337004e530d8bad15228e405ecaaa1b5d0e8bb5dd7bd0e868162e8e704e28935e826d1b3cebda9d2fe68e84f97090d36bc7c33ca31a417d3f4c7568e455867db9d6a943b61d521f36c0e7bd2488f5875d98ea2d8309ae1e04aa4ebde982a39956122668faf2960c6f8a8ce63a4af832a620b5aad23547e85d53ac1935668cb329a744e2ee442df0eb357a9b33736173310e7b26cebbd2b0d5e10e544a657570eb2c2ed0a1268c031572a3e665973832d450d5911a44457372b38872d944ee571bb19e2cef466bc38d40a552fd40c749a3f3a1cdc559a7d8ed4db55559d1b0d571800b10a968df4f8ae4d6fab8d1c1323c258c559b628c85dce93d6486d59d891637b3b75b7451c76a34497bd6dd1a197efc8957f24f948988f72c41103588ece0124fc161dbe4d135920533a1b2fbb41099ff40fbe29761cb7aa45cd368e5fa1604d39c1610b9dd7bc4e9d13fa96c86134d2bc063b1e236cb2813adc5975d9bd982e65ca53eb837eac45a49cc90c301dbfdf2d695f83ede0ddca3931e40bb04e3daed1444c515a04acd43e41e218ba8f64cb7efd784f3149485a97d3c4cf5fb1f3f19753a698a02d6d0b1bf0a918572ebfa370c512d38413cf3ecc278cfa9fa0017b6b74ff83f4ecb56782747a7099665014198fce986497f608b059542325dbe6f9f38121a7a831db7a80e1a3c38cd02a925492855c05a0eab922dd99f858c688fe67ddb428347b5addf391260b3a5c2317f83e143c805dcd2555492a52e726ab12a94891b6151fefac59025a9d9859960f8b287cd9505c518ce60bd6cd776030fe11e19992caaf31284fe94f8c6f405f6ba36773241d8a706cf448101ddf85bb4c877a826ec7064c9a9c374c81895d4179006b198c639ce7a7b367ec0585900d345bf3fb2a4a22ac6e8cbba2a492c28067988f19378f6cf9617e220526cdfd36b8143bf33e2b48a7a541b917745ed3a20abaae007a09863066da10b833226fc3b09da9e8ee749053da7dd8d1fa85529f8cac1458df12c240eb1d3bc90d78fdd9482a32e0e084708c5cce0b5360ed5f60fffcf85bf5e2be6b3563cf627d4a50d66d95f36cfb9d032fbcabe44a69f685851ee7e739344a1fc8bcbec6331a25f066596daf104c9ff67a62c03aaff7a8e03155ee5f5fcf2ca4d0e499c3ccca5b797fb2c7f981c0d6303b43552abd7de2df9f301bf5c771ea3d6056a9e016d292de289d7ca7d13e3c90263318c9009f0cefa58b3633f9b0ca986870d39ab84101db3b5803386f80baed19fbf1941c32ba78da953aafa6b72942ece3d1fe4ffc68254833640135685e272dad96e4b4d8d0af657c632d35497b17009873723a7ae5b3b56605e924ba84c64b30b3768a72d04c487495a41e337b0a080a4c38e5112adeebded33e77a594ffd9b738c3fab3f14cad876caaae4d1293d48410f8994c0e77cb01b5c7d9018a5e1e4d558613ef89ad9cfca38d9b6da6bc3f1531dd729020c88abc2ad899248917090c2303c487c077a140ddc8d1e80de4c17556505be0649e6038d03bc63a4cad18eadabe3e3314a5583eeddf73b2328abe61376463825c0ee91cc165c6e9cad6c1c039420da22372a5df04f0c05f8db2e6763f3ddb6f7db59a97f3c16d8aa537dc37179f8dd07d3bdc6308db286a9d140c984ebea7b785586af3f1d504d162a9c089b07832b606788909c18114585a7efa2e0b4ea0a56183610fe9f7bf92e6bb4202e51b5cc63f373c0f303e14ea0940730d82cd5eded50c67dbbeac33b9c165732282873267d1a203bf0e7090b9a44cf1a1598dbd4f574c5aa3a08d4a1720d58c2c4870f1a5a9172d4098230af0e73054f8e73f690b4d5edbbdec240049a85c9dc93355d374dcc5198c99fa2663d6e07997f2b7abec5be46ee0f317080a498ab173cc5d4d085c95e99e2180c20d59895bbbb4495efff4a76eb9bb296141818568094c0fa02e39ac9495fb169afcee06f926b5cd9a72d41010cd23d2eb72b13d8192f371a898a05c40e2183aeafe2d9bfbc8691204cd200f2ce2d047541057487b0ff0f8d31eecec2f161ba8b474cbfa4283d3d7efd330a502d8a8b5aa23016ca39e217449fa0034cfbd2e50c1ced5ca7951c93bfdce9887d4f921c24e5322c4fc8caab88e61bc42ea78b626e1eae5b9b2d25500c8799d0e122427ce3f2c81f638bc0f0129c1b142c4c3d7701678d2a7250e7ba9396f6a559a1a252c09d2d28ecf27d6e69a6ad7bed7d1c7c98f1274d832a9084593dc69e99b8da6cde2a3d6d7fa2abdcd086b05bf84586190e013b433f1583177d8827a623a7f74c11d1dcc8a9360a391ee8d009f765ce0ee29cc034415d490e89c671446cae789f844eddbcda3d2950b4b87bb78577533b8ac8e7465ec00bf42627c50e417c8aad3dd819b47e493310c4e75040d002cfc53e1a71374df708c4f2f39712c31304dd6803d8b0a99eefc76b26f56cfa542e4e0b9c569c0f74436bb2be175fd816314444d0ab859a5db997c3775ca470ede6e3777da928178f23a4f61a8b30ff26ceddb6612f35028a7e49296576ba16d86a8b724bfd9357710716cbeed17492155382f8bf5ca5bcb91f2e6dd4ec3169d8c28b3c0fcdc3a16d28734fa611976ea4c38496185429d996d9db95d0d8d4ecb0657b4c781e2b718c3e826776d779bba78c478224b9627c7845a4d644999ea606c6e27b7ecef3c557330e8afe9bf4aaf9e73d5d69e9e3b59282607493c5a55ff41a5405afba4ed369b63a6c07476f3e48201c3ea0d07d2e8e99449d75f9642090f6079febb1f90c158170412279724d67793e4b697ed3731f1f68b432620620dc3aa9d15a0e02fd6069e2d51232f929389a446f79a7d292e49cdc919d14f8ad5450ced187e07708715d20eff97cba4f9cc4393e54fd32ee935fed91a9b2943866e36be0ea3c6d53c4e7b53beb15a0c49cea0bba260c8be468ab32bb337f6a91bd9b6c5d03cc9a4c4a4f1fe812ec4eb9781342053df44dd0d23eecf018cc75c481e023f6740f97241106d58807b72bdce335d21307af2c438201fb4fb6937fa03b0ee940608a4404aa87ad38eff0d0247a7428505f3bff105729a38b2f956b77072effc2c261affa29b709e805d3bfc80dfab54cec2221dd82ee167a0290129c55331849e71d291af34731567d158b0ab0835f64a6f94e000c329bb89893da2e732777c386f7155e1335fc46cdaba7cf621b18ab9aa4e5e719ae1bb8a90813cb0989955e39da2d61687caae1a733291cb2540f2732b2ce9356a1e61abf519ffc808a9de54c91bde925df4fb7c847c1c5902e359a7f97a20e250713c6decff9b60e007717b245a99e90a5bcda84a7e35fe13571cd1c24f21a847405abe558c84e0a0b0d10dc5029856b95b6739471d5c19a00d07d254dc9534ab781f350d20aa69985d478b731dbba93387fe5405c21ea780fc74576cae441ed54a562de63ef7d407a35f8226c88a9cb04eaa0a27172d3d72e6cd24956b55399866c0670b3330f6053e30aaaa501afb9de00407d118938e5090c92fb3e9f9fd052ed4a0235122b5e26248d3bbc7130453a752468e0daf7cb74d69d4a96d6e8592455584d25c860b9caf5adab4c9eb55e3ec9b35d9a8205bc25ec0d1c797bd9ba70a8ad7a2d529ad24e93aa206a3822e7f2c78476c5a1546dcb0ac84b24680944d3662ed76ec646c8f2fdd5dc45afc920ba40cf10aed24ef8316dc766704373d84c0c706e905ca23268ca212ccc64b70379bc392f04226e2aae8549fd89210aa7f8d08bed9f30fde48f02ff32a183e417c550fa993f13cec37a7cc373079875259f12c72816c6f6740153136bb09b5723ac92ce2775e933cf2e95bd60b9aac162cadbbc89d90d87170d0591749f0fe7e6bb8b97cf1d5a68cde67e4662eefdd6c28e59e0b1e4ee2f929c0be4f31c44e1f8a387375ebd19fcb9967cfe5ce69e04e545e3d6e25a279ed6e5d8c6d50e2477a0613e0f9e572b9faae06cfe6d14f3d5b6253de1443ef635a3a6e392fa48adcae35dbe43074961af9d955898767d0b672867f430fafb895e9e94e963e4321d7120257f5db193986df8ab47298f9865dd1ce7169c2a3fbce0bd2e19b9d392393c27b35c78d3258bbd0aef876eb60c92e3551e843836272621652ffe03807108a6b0100525d9cd013f962ea7eaf51c890bdcc615893d30993067b366f09a25b7f59090fc7799524ec841ee441cfa6a2deaed8915ff44d5eb9792590e781be55079a4e5111a64631c33458fce3b8823d1cf0118fb29fd4762c57991693350903ef11e094720a6d39ffc0a14a6d747d6e16578811e1cf97db56b4771dfab645d59c70e305a2a8cd286a6a62ee8c9e2a39815e30dd5ef513af5d73613809152034e05e0de31ad991c433f2dca5724d643b28f63fc2d5f674b7537c5df78b45279addd558b58c4588129e82821d4fd4c541a7a348ddc544427d95dacfb12976692c2fcb55268ee89bc3bfc8e9fa70668ee348f171a68b4fb6b450f7482f04db16d6ab171be8f28bdec7eeecedc0ce1022458d48addb70f9a69b8ec6e72222824e95866240d356a4a0cfe6036694a8c69dfab3484ddf7749baba43575cf4a31fbcf8aea3e3efb1e67a5da4f006bf52989219dd925b9df7a39a77a7dcc9e0bf22a6aa45d65ff9d41be3a334ec95f92d892883c4cc280b5febafea6e373cf2f76b19100b44058eec0ab13e4e569b16217c32e8b727321e88a32b2dec4464d19d78c0278338d75fdc33fe77efbd3c93a8196da01c1c67499fa588a26c080abf988b0628312fd9cc7477a1f5e1500c92ab15526eb4a95e14957addb693cc9109666315859e0113f93632f9185a3d48d707aef1725c71e1538eddb846c3c8fd26ce374d85d2fd13eb2789b18747d64fc1f62a6eecf0aec6869c077727e8dde8479261ca9858bc588abbfe42e2a79a6fefec7b85e21184e38d4fcdf5233fbac4cccc04abd1db214560836eaee7ef0ab142a34527781f61bcc8633030bc81aa5af0ec298f7e24e54ad331fe8e475a1466f541713c06dfd5f27b52c16e4312d9a7b7906f7a73b5482674236b588696be0e62254a6ba1e51806f404a39a996a7a4e58e6686be1c5c0e0de328aca0a72befdc679832dc0ae0c2e2d028c70f0aa2bc192d3d942af94fd456b9f7498286001d242fd4374718779797f99e5f835f8d771af57542cf96c54473d6a67301dcd76022bf425e95181203428394134518c73ecf558dd83a1d0f0ac67114b18189f26e589795f95dff070ed09ed6e4b379de2cff5d804c3c8867e98c9b9a766a65099388946df73cfa70827e91a0e63fd2f21706322d8efa771e3e3407faa3ba25f3860ad4811bbf5b2da98bd6f6a4bd68383f695309257c7b2e287eb256d4d5f190eb0186091c326f6a82787212bea84535f661af6235b6e34fe32ccf955d307881037bc16ce336416cc2a0e722d0b00f04bc037c87cbc69e4f65203dda49c8ad0893271ab95e6a3a2c360a18ab11c65a5d2651fa59d1ccd522612d1d3f8792f9b7f6a562c55990fd1c94da70aefd652ea07b1f59fd9b20cd11a6b3c787c4504c705c5edfa2a359f3f6ebe6768d3d351ed7475d2de3d91a038a09a8c115f71106eb38e5b999cef2a35c314ecb9a7512606f5b09db9f4c44d51f87f911073ff96cf7012453f0d549beb972077d9fedb808d2f38f1c1dabc69b318093f9085ba6ea555d3a29ab4b8841fc513b400b14c4c44348d89111c3efc9e26dda77fc8eaf5ea6f8c811e31066bb64fdee6ee012d31973f42de9de476ec863a2d20066af8502edb290ee56b6f43b44dd58238a767402324e29f8921a6cdd0e28132e146cf171d2c8fc43b131fb53b86fcfd36b052853e69ed9ec78bb17dc89d9be83a7358a48a69ec949efd5af1cefd5822d81d3ecae0e5f7cb3b54db41cf05839e1f883a37f19d4c2433ded24151e0fefaa351e63f968f05663d4897fdbd3e3ddef58f6c50bc9c602b2922f19b4420a417f456d04b8f3aa8a5dec3eeb30add50cb806be53b4c71efceaa3bb4ee12475a1ff1ebc3d89e79a74a397827cbf2692da2795f095508241d58028ac9be13be58bc9537835b3c085c84160681fcb728156dd0f3feb61f52dc460da4fd10874d28ee663e63cbea17d4f46fc2f0b9f57b15ba0557695f5621b46f34e7907e9f16ff9076fdb519a151171b85c5602b86b8f73abc5bdbb8df8cdc04bf00512137318c008d99282b318dbb3f31eb5740da8cc77e364ac4b2eba8889a5bdb3cfb497eb6dece58d96b2b290e709310d12e72bb3b7481e576b6ef7bd8af45984c43486e2c68ee9259dc01b5305fe499dd9bb26cdb2b6f254c235a35f61379a0347f9157965f7d67cc766009f0fd2272b8017b67932fbaf1c225ea4cd3c02f0362e71a26f28408dea65141f8826b80833f80b921d98c778af801846ec016a418266ded66324382e967c325e8a4f000dfabf8ed41ea274845f401984a18e1265e0563c116f39cdab6b59caec5a265371ed303edb08b30fec400ea62923e3b1d57a66fff5112c56cc339afd1a0697fcb39b35ed0eea3acceeabe24c06dc1f41fb39a8f5336ecbb1edd82fac9eb6459adb171f8da8ec1c5cd50f040676fa60b56d350f9f7f58de6a2c3f1f1d915082d247a9bff929d7bb532ebd12bbe93f25b90dacd2d1625a64a00c409d2de0764439a496c230189694b4858140a00d414df3a52f214ef4c2de6adb26a69efaa0bdcf8995c5154e22d6b19af41b520164b4665bee39db3abcdaa1a42c91fb1b7dc17f6028781c030374631fe25993ed17b61e267d8a14e9a5ba5ab030432e009cf66244458567ad4bfd57ecbfea7521d4300e90fca18028a9e8cc6f36052b621debd523c6dbbf00404ae038f1e35ab64554a3b04e0cfea65204d87e9c2bedc43e9488ad5e4d75c05c1f821771afeac7efcd6220a1e81b79b6aa5fb6ea66eadd709b8b8d35aa32de45e561016a571ea47b7e98a413806c79452fac255d04dec58d4eeb58c18b7e84a23b534fffda377793d8108069433014b6e67d91e521c727b46b8d8f887791925d135fac2e753719c5b6555b58238251598e2283c6405b1b257f53271a86c82b86a65a397c1b81288a1194d8e799c3bfec4a0be388bd0d5c581aef5732722516bc6c229ef822c4f0b96127e2ad03555a53ccc3cc2b27b57f50c6857c69bf20975cf3bd3e6943837bf6b0a48a77ceb1d966dfb72ff2d8d8d21494cbaaa646a683749d1bd47f81d03ca2832811a3f98c3661b6bb1dccd2365559bdbde52458a451c5619051ac7d849cb71b43ed71eacfdc1b528c60dba6163a650d04b9cd49dc88a62525eb4c119ebbd4f23e50739feb12f1c1758e03300745d981b9b0e1b20a2601de49cd55ef7517f25efaa26504fc4f4ee2a4e22bb5cd525d25cb57038bae53632395026955810ba2e7680e28be0326d888bba257b2b7d2a60ed0410ae213c6986102964991964b68c32c74ee2eba5d41e0d38a40268fe0911713334e47897161dcf681ade3d1a51020b88026a27ae200535e033adde2f85e6ba15b8ce66413e8389b92a94ff495501c0d32f2775cb8a6fbc78c4c0cba218c6bd2ccb93ce5c20984405f40c17a56138274e20e40d5e15d26acf9196b382673574b65d6593b536847723da50c5fd88c96140cf93780f7a27577a7f4711a98ea88044777fe6ea237a6ebb13db3e89436a284a6ed79723562219689e4ce36d1d68af1f09d2b8e95dd5032ad845338f124b9ac26b9da22f011e7c2d129d6e8a8e715a38ce108bae2bd2aafe22d30c786b08a8b55f7e35c463ffb5ccb7a25d049dc1cc7c0c7870051154276bd1f88ecda7ff55305b49f60344955254ebadbf5c9ff060c5e6a93c876e6ef564b05f199304e9b9d69743fda9e5b2b9ba8cee80bb2029df0719dcc21fb23540d4b0ee9f7b5080015e7516fb8a1429d364449d3cda4c17614ee7b464d63a3764efacdcf1ccb54386fd6466202acf0106d5898a38d6f278c312b30ca6f1cf706a5bf39f74c08cb4f0bcd81d664a125641e8d64a6882572b3678080eab205959f6b20e9eb29f7ec47b0617775c405bbd8bfd33b92f9a85c61147069308ea6c17befd006783186c632aff4b7a631e1026a50426882696b91a261f1dc084adce7bdb09a214bc90fd4c4db9debea0c480fc56f1ba746145ba251e4e2bbf46e4c7f84923b2f700c1d31f1e631b625c52943816ad14318c33d51dbc3719eb905abda40b80de9d1bf36460e5c6943940dd18015c7c97c2ac7869bcc69664a1cbd033a5ae93aad36908811a56065c165d4fc6801e4aee34e7762aebf3a0f67ce4e82912ffe0e25c71e933a82506547bff6f0f55adebd9ae072da5593b8ab9dfe36beadd853c38e74aa39c7abb0e28beba3e47f36bb623b6b9eb75557937b6e101a7387a4ce0e266d4a56eedf2fb93757c07f49e21b1ef29c0995ea22c0340d6c1dcba2baa76786ee3eebb72617c0a335536e1cd19a6f338d464f4e3d13e3562a2c1ebe025c09e4d0249f865fdab3d9c488531f2a96285feed4f95ada2f4813e72bf55c48cc1247ef5baf0b5d223861341e0df0173b6ea5a85bdbe4c89f065402fe9f5c250c0f211c32473885e841cc0141c5ac0160969121e10623d429616a48cb7395cc1399e677b4cc648fa28c943b572275edb717c9198369c2f589ca75d8856468830abad57c228575592109a36ab3658c9863a01237e628c9b6ee84c4528d9171161ff1342b30103ec4c28e3ed43afc425aa3ff89f780658070e51a82814685e1a72bfc6ad4cfea37a94c10e98d811d1b1ada63e745ecf9977ed478d9412b497738dc8ee2b04f073288758ba18e5732bd077358b38c2cf204c1be883645c6fba3172d2e01498b151dbbc93ad1aff543d6ce7280bb1a54c9c2825aee677a6a940ab25bedcc765783b93ee8d42e802e115eb1e9d7f201ed9039de328ad9aa28b7e6594501b70e2dac0150eba386aa0502af4a355a79d037cf95adce9ee1ba06587f07086ed83984c2ba2ead1502ee3c5ae6588a94e6adf66f2ece66e2b25fc1d84489d50451c159023963bf99ae12b0e4585c8eb34b4a8f0609f76ad48378210c146369e72ca8a4cf62f2fbd49e4bd0b9479a6a0e878cb4c035e8922fd87308b29ea6d470fffc0323c190ea110ef03ff3e61071c818fded04ba43b8e1537586880ab137c6fd0c5e58e5d8c2b95d90d1c549191ce727a29a74f32163d2f0b35b8581a51d2d9c66a8ad6175f826e5e72151e134ebf83ec04a907d615f9d6fc2f81427a3e821f9ea074b50a59752373f6b11240c9999ec516997719c450aa91246120478c8629da9a9dc3569440b0b0ada9f4c96950d8c09a550cd151e724f5a893351d7be1e82b5869e18f83ef7c4f885bc7ef2ae6e86646226b28a0adfe7fa64cda92516a5603bd3df404a9717242580a85e15acec9df175e47456ff1aa053f6658400e69442d3f0138b44b44b200b32218c9430ef2d3f109c1adf579836caae5d81d2f0198047832f40f5759dfa32044472d6eae706f64102235ae5fad89f667cd2592bd156f600f2d079bdaa9f408db453e0e17402b7efd78c2b32ae26aecca32213c3c706a439b1c1e1f2573f3dc5ed45e20270e09eb448c5b135e6ea454a1053bdcfd9dac69beb3c2031dee79e50b374159b6388254bf090b2d0593af401e012d57dbf32032c5fe62b59c244b503750e4da0caae18f1665fadd661c31188c9d3888c497c8fc6427276b3ed21463f15dc2cf4c58a111b5124da2b6e34cdd62ccbdb302f44d520497d7767a935060ea2bcef5f70e0d2c7fed257542f1c13e3c42f54a6def894746c86dcb35e65523e45ad454d4ba804455d627e4a9e4fde8c8bb43c0476aa568c53358ca9580e2a47f6dfca6c96997fe25794cd0d31145023ca9940df84bd493b9a2418009416ec065b4561df7bd283ff196251c1f4fd93d91a34d321d52bf42878be7a7f7cabe581cc505c3a232a8ac0f1f0a4f5de87738ebcd40fa3ca674a5cc6f4e6f84f3fd36c6c1e1ff2443738f5bb4df2aeb4cf64962514d440ac48dc01d4bae545a83fb9b5c1389fc96c686c83130d03724034f67fd25961d3a77025c2b530dd80feff7d8f8545aa1c6da5064c89a4c82adf808e2fd24110a9c77f9c221c205664d76c1348f953ba2f51a36c19a04c7aa77c1b754ad2b1be9e44c9e800086e33ac70d7da274e3452afed90ecac8f6decb7f25f780a7f446adaefc938188d9f40f3b834a8d6352788e2b65fc4d0bdca5121be480f1e2950fe95efb955ddbc2629490bed0e7f4cd9bf92a13a49ccb1a1a85f5526b6517ae52eac9e2b630a2d40fa462ff4405d45c5fbef12aa254c466d3c5a3b9ede424d53d6efbdd9f1d74244014f891c012c2bf0b7c80722fb7f91a4ece76e09a6e26d5e809ed0d988eef8f23fa25908f523c45058c58e96af9da393618e1692f2df2c4768c80a9cee164d098d5d48107300797d9f0cd2e1089ca00a6b6b959e37a9fd422991e015b294050bf19552a1149f15286f5bcc5b0f9f62f9bbd2f189536fce5a8e7de2d525449287c786feb528d674ed05d8eaf5595104095cdf5125fed76740aed0eb4d913065d5a11a1ed4d5f3f72e0fff78e4c1f0bdcbf6a15e308ed3ea3f1c90fdff561762027c6de4745ea2b4127a950018d39ab4616b3e370f576b62bf20b127318cd7abd4c22f862139f7ea9410d9df35de06dc87e423383c884ff049f7755ee7089e77d0954107fddfe08fe5469315fb5f705323600104c061da9050195fdd1cfde52d6dfa4c69fce491ebd3f1254672b046bc84a231ead7685e7558e69591164ddd7a1e6f1470c9d5bf4b283cc8bbd66f0b12be87ffb9fe6ff8295621a922f91d06b25d3d5953424457c661e334f0c980abc1a85901674be2734464bd087da947eaca2c9977c529edada1a2fc3c42a8a6c431167106fe490874dc0f7df21895125403280c7b64ae23edef2b7c9b4bf0a9b07f87c5ebb507f30c3105ad887cec3e4f044155e42f634bd104c322854e7cc5eef739b6c165c3d38a1548898a04abb4e8b863315ccbb6d53c520ab23f4cac28910a109478c19e74ef30c39ccd152a0b90c3f6d1e4e9ccc34b3911b45acfe2850e2b5e7e1364ab87c997dfb798e049b37f20cac6b963a23a52da33ba82bc997ce24d400faa91258da977d99529fc05356418430ceed3ae0a9634a69b2d1f913e35fec00506d70aa2f8c16f2fc21b9bddad3f577fb2c445d42dc060f27deaf72fbd1af70fef120d3c5e9ab0aacebdbdc95820e4ec3f3cafa2c0fad202b8ded50e87f9c9fcbeeb9d897b386ac3c2cfe07413007067c2ff058fe5a854c274610a4290683bf7916210435ee19d138e8723210599bf7fe6cb183e88adb8da721b9fe45352fc0ee3d5d86e78ad3a766bae324ba416e1f58e89df9385cbd50dd58ca128aea83b461530733224cfb2d4b0b2023a800e8a339561ce0f9194d7c6960e8d6c5a840ac1eced2e1ac4110f9d43a26cb96c46a87b214fdc138dff7f8b658fe34ad0d226eb411efe40db5adfe872f0cc1aaa61c5b4db446707260bc7eecbb80305f078b8821d019447fb5406510d0490e1e9d9b554fbb0fce869375841eb7f19c79471331ed1d56d0cbfb83bdf360418e5db06df3cbdd180e17acd69585e89987eaaac2aa805fa53060dea480002a69b719b5f255cdcb93c0eb4984a2c08459c02d37735cfd953a23f6596887646bc014be805ef5ccb2bfd6398d0683118eb76330a67d52ae7229ca07a9acc9d97442638bb42a8f979a4aebf730a2fe4ea042eb48c1b9642e93c16e3b054c7b8ae458853356eaa350a207fd5db4ca660d858a016c5f0158ec1be2b6e8de69cade6b2dc1eaf91f782f7ebc2f106c42aed5a8822996912c06fd22dc02a8639feb0e5651f667f09b02505a3ce2850f979b781bd91698ccb3032cc674b84d6885defa0ec533b7db4881a00f974325cc256e0ca99647b35e41032c8406c80015d8cd7a2fc3ce709206f037f24ace5c5110e8ea97a78ea465e3dc15979ee594471625abe49b6ed1828f1bfbbde8e93278bae2167ab9fdd774df81b219ef78113571a2bc440c8d59a577bd86758f621ba6537e8afb135e8f2071f310293533c1fc3416079d325b2957f2c965b5e9270853ab07ba173dc8b0a38cf45a195be12ad0adadad478815ca0d81a2847d20badf00e9479389a985613a4d9829a4741bf9e7f46b77bd8ce7fb2779f55b666c4898353c46fc89391c21f5849724a5e207acc5bf4c11993715fc358fe84ecb288270d578c66a006ffe7c941d060f84dd498fc1716ae02626b2919e3d96bdf8c33b00dae137608ec921d751e6d2da38a38d660121ec375545e0d544cc8b786c241242d38b16789a8464edd17c52cee2521cc2cebcbe6b8224d907631449d737ca6a7e80be712ad052344772c6923acb1d7f0c6f46adb5224602b23f612a0632518b01199ff67df8b89ddb71944e568d6631cd3faeafee95f03db7b495bcef1e75cb38f5b83d93cd444251b80466e6239b250865fefdad5290c712f35bc0690f482961689f9de3a65d32d9e76b9a2750142e1135f199860301d030a1475f9c7d22286aab1af1e9460850a5ed40fb57cc814ec266c9ef5b4efdc7580874ce30470523769e20a4c5ae32a64469f2149b9e66ef8dadd8b7b7bcc7731d1c0ac149bb57d86d6c7d87ebce9167649ecab971be4d2ad989fcfdb54a3012edd3f6a6f35419ac5c2740d980464eeb70e312104d03994e9be2aca4ca1eacaf6741ec1a14a0aac8ca70bac4bfbebbd4907cb21b617ab234d5f6c583105db6be8ea07f50ff310f82115d742fb9b7370387f40585f32894fee50d176f8784e7ff118c5a227cac078e0c2390f1c199c1b18e73e13db87fd156cd040e9bd4e1a6bf70bfad4c8d61f122ab3ed537dd4ae4416f6b1c5157331b7e28e4c19b8f3aa5ed269b1186322cdf9c38c12aabc08db82846c6132a49d04ae7dc6566e1b7c3a46059011e3a6ff60684fabaff73ce6d0769f8c716c4a896c218664c0a1e9bb53b37504ee7f24061371d0e469c7624c07712a93236d4c663095af9fbbd6c82b50ce4aec5113ff7c85773ea41e3267bf03d384ee1b17ffdcbc7707761ff490c72d29ab922856b90e75e35a7b4164be4766a0934d7fa38ffa52f15031263342d036630447410a7a615bdbd6e086db80c14c22501bb4d14c54c6bffb2007dc8f019899cd14ae5f38fa4960b4a40196bf776d02c0bcfb44126b18541d32c0dc647ba1174b8b33c6bef1162b6023d38a0499a0dacaab57c7eedfc94e14109f0f63638a909918baf7f3124d14ea957a19e8f0f864c2bad21ddf9482798c85734a8a721f4c99d03b6bd7a6ec3bac3153e887d12987930bffc23e4d203eeaf37c344fe813b758c0e48ba693f7a8b59a19492c73bf894d5414887f3127e8b7def37692da67f1df9f52d2c6b8a1f6711119f221acbcc6b811071f5c1a7c2637bcafaacc531d4a30a485af931f035db125f8144cc945a8e36915a5146c35b0a5576a5901f1214c22e2c046dbc102791e3478cbccad1f55bcbd2c736a643a5d1eae752604a1e7dd080c29415a05e6ea0e700c21f6315694557fde80609ccf4a220d0004f2c6260bb712fc4e4bf47e45eeff177d45012e970ba9e02248ef3769597d51b0a777fd14a5c0390ea7827f8e7d5941f1f5fc7e5cb1cbc9d885df805e64bc802ca1d43fca10b2e64c4911478298eeb176546722fccc5f10125352e8b076e04533cc6e1aff2544a849c27c51beee7f4900d3d77b7c4150f2a497f7920db40df30db45c68c2f68252f66e0b9e1bd1f2b52d7053361ff8dc7d914bc9e489fee0322dacf7b88ea1a3c89ff9359201057e229a273f3f276bec49ee1b5458b1c482948f859132734a180b69395eb04cb532c92b0a3cfc9104aadf52087b31f94f80e47d9faaebdda2d6ee4c76c61ee986c2ed5fbacb7879a7980b04b5a962ffd537ae90a506888fe75e053e79bb182656272de326067d539e37bd614288eda90c54b98585b430486777a97a104a6290c1742cecbb2ecbf6a0f31fe02122c52b2d01c4d1230f4f8b3130cde0665c26eb2ee3001f20aa1c7ecfb733f5184a89e9d2b3a896de926d60b7445a7edc6bf2337df6a11a50677643779657e401b530d4d0d16a191edd19769277bb89dc203385d2e18697bf303b33c6fabce753aea4868ab501ec7071d5f40a9c97472221e401f4576a0732091484dcba7f7cf637085dc81003d4e4bf27bd188ffd18eef6950f0cefbe9c75e95e8fabe6ed3364b37d0a5c60e6a542974f7fa8a3ecfbc0a08ffddf53395f737622639cd353e301fed9a59afed8a8080a5bef936d1d25710b988f01234cf62319fb6344d2412be6d7a98be4cea3a29fff83f0ff0d42204e28f22062465fc1f54ca4d128af35ab4edc5ee531772227dd3b72f32658543ede79547f2f26b6f456dc8331ae85a259828f4531a0fd7487194e467241258544033918fbb81177cfad13ea131cbfbf0d7ff5962a445eaabb4f123775d35367fff50864e5501b14a689d152f839ee9b256214c8db335b23f04d6b353ffb42bd7e496a07e6aae511c9439922ce9792560d55993430ef557b908bd38f277e306b7d4d44e65242296ae354542ee710973ae59dd187baa5752c22a2ce9fc4a5f5bfa833fe1262093975050ecd4e8e3648cdeac1130c479ad350b82c5b5bd5f80264dd413b1ed17289ca520c303c582bd8be1abf9a25d7ddb524679b25f6aa838e3cf11fa2caff6230546bd416623cc16483cfadaaf10505171251ce6378bae6d1283ceeb44ccc995a9df0a62d8ac38fb38448635cec8df1abbe06ec405278213cb0d2ec87535e5c0c9adb41b735586c41ba8a8d070a7c2770401c10309bda4b15936e6585d48fae5208d6ca18d7f5927078fae4faaaf48d6eb5ed83b1aeda6398bd91ec55ab20b83e02375370a4f3c26f7e3ffc1ac64e02d67c1ce93f73b9742f62a30e4da98a6de6465ad0dae96d7b5a5978f5e856fedbbd1754f3c987268126da0abfa46f4365a2ff69d52c8376b8fce2d5d828f722f90d6b9ae3e57f066cd42f3a34628e3157e53d7b15321c98f2b4b5d7e62fb6f4cee00fbf5bfc614941947742a602dc9336c5b9a0b365391996b2f9ee6101a925b7c3de92908a90c43fad84b75a6f3558582667192d6811484359e0c70cf39a3e9aec2ccf3bb3d4e0ab3e942e6a0a7e05e50908028e73bce4099ff504780ab299cb1b2813386366958d883b8e6a9ce90417cef51bb3690abe81aec62f84a7babb4ee781e096670c41caa062d1e619a6a819afbce8dfb1127ec1ca9c9554512906625b9c80439d600fb5af555abb8bacee9f6a0385ab18543954a3ec255f4b78da87aaf864646ca85fbd217edab9d299bec4521b9e59f3ba9ee39fc2eb33ff8e9dd0e90c993be8fc3b4585da7b971b7d9da900007400e6b3d885fecbb126b69ed474677059f03c316f0b01ad7740af29646d8d86da1f678632fcd962c5a61ba3bddaaeadff324ae32efa0d7ef0463cbb1c78a7e2aeda6562df3979c96708e815203069292229c469b8c77c39110e476cd9f465e5837d1fcbaebf68139933489d83c1b37eb9052733220ee229e2de5ef3fa6d44443b0356fec457334e6188b62e797fd76ed74c4dedd3446426baf1ca9313d27872eef6717c7a71720887110bc91a9e7f00493ec18b40fe78a4ff3437b074f6dff5ced359496ca3f5b5770312f4376e7f7e10f385feaab4b401b9917f20ce8d5dbcea0f6b159e5ff9c1f7dce62ca6837f0e98b74992b809da0af87daee3f7ad0e1743f36fbdd416a6b69eb786592f8dd2fa18b1a85fc9085ca1b24649a24b55c3b7b35ad612920d846a5653ce81b26e98acff99378ff3dc0edfb92c0f2c9300ab8a311052d471a6dbf9c99d1705a959d6b1f10701d6aa8aab5787a235ae10f6fe54b423f7f4160251da3ae01c0813c5abbb2576277b8fd4ac02c199b0f329e1e2e10432f0f81ef7e26540fb6aac94cb598ee9ee2f56c413f738dc54491cfe89f9e0ead0a60904b33c758a812552baf1282eddb7ee7701f2d49d2c15c8e863039048fc287275363922a8859d1320c9b8188bc1854820c7eab343c58a25b13bcefffcb10b0ac5d16a95b362558b1d589259b21d39940fea2169e5b2a7f2bb1c4c16eab81b94c369ca24136865ba5cb9fe375d5ddc79bec8fee41c11fb6728ddd63084d709812a5c6f016ac05f2d32367fb2349122de7da82c3fc8120fe19566e5ce00c87ef0b8cc95a046b1c4de2a31b88aaf1108153f29571119a4d01acb4a45a52f3bce6ac3ca49e97fa6f0258e2ee0e96810c14f1c48038061b057305c1d9b615fba20e825c2a1c3d4321e94f418ce1cede82d950bdc7b1cd0e5c1c7dd04bc2dd296be3798d2fbc933654ac7319e49062f58874fad31b21bf38872b2bdc3e7040f37fbeafaedf3351bd865c1eb00f84c4a9ba55b33c8c1b9849891dffbb66241908078d6c1ebaeab30c158d0a6017582a508412846016c5c0d4bf8a7bb2d48dc38d41d004f7568b892a5a807cfcc0b7aedd7f98dd1655dd0671fe5852a2682a22e0fa11d488a633a50ae15b9ee037cdb3e06ca42edf30e49a3bb14de8da3836d07402864ec32eeb6cf9d22f6c258015422ca09f878a9a36a7cc86cc2cc524b8f0c829514475ae3819f96d54aa1d4a9c4140c7c45e17d4df1d27c5fea8a2defeff3b28301196a993a8f574fde8e2cd71eaa6dc1c9f134b8ac6196bc2986bac186b0e44d5758028419757a3c5c1b7c70f60b9e7a7be1922457e6c02ff53eb30c71cf2ffb789f7493196a058b6a42ab5ccceb7","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
