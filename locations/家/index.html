<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"fab992dad0198e95cd5ed8cb6c395f4ea6b733e3215381f28e338dc6771260ae8c842f3155c1c4c6d49f16648c5e65d590ea25368b08b0f98bf47888ca2166f1a44c008c66cb4b26496165d3d181c8c2848977675f02833f6675535ee87a0b54068ec1ecbc3132d60e0ccf13fe2294aa5acf74c0348e21dff7493226875088d323308286df90c529216a7e227f4fb0ef79009ca8d51f785c2b11ddc9fccf7d77fd232ce9dd2146fe9b8040ca626a7b6d6f7899afc310c81cb04c6559afc2df897e180003f8d20af9e0234f429d060ba63bc34217c4ae9e6fe6cbc01cf915c2d6775c0927c0f866c44e86063b51bffd6d1b50b3ff863c35194ab4b34c5c2585043933467503572f7283a687a84e62a3d7aad5be6c7a0ede5fd35e4fe371631bee0123961f4c76102250c52de8bb7176efaa8bc541985b748fe6b1e97a8c48e2e349cf27d511b34eb50718ace02473d6a7f117486ddbe26f564d06dece9d36c4958615848723fca1dbe14e12b44f0a22cb939197ff5c32f2cc6aa895fba1636437eb540062f276690be2fb4d5b24d14e6d6fff11252019bc84d5ffdb3bbf11a502e24ff97ceeceeb46d3706eaf23c8dbfac4b505c9717b1d3094b9063899478ab4c37e706b7ef01fbcfe71b8befb8b38207126ba531b8bdb20960de974c91dd356f4cd1ebc8ad15b3c6c58a6584172a735628c4a3b97fe93765baa7dc559b4bc8f14b1c83f2298b403c481c0928b4c14dac02d6c4c14375fbc0d425d02613df26bec8614c5745fe5864313b3ef4c5fa60de75bca7b05405c771b47b6c7301a46d226579a1ed6aa96e543bd74d82a6d8a6604597f575b59f893dc1991ef52e5711237d69bcfc57eaddeb207400429b57fcd1c6c81da017e5ea987c66cef35ce591c19c6906ff57dcf69b69aa58f0801262efd193eae93c1890f7eba4ee1cf6bd875899e6190df39211554ac6a9edc4e54c2166a7d6a50e3842f3b2cea094481e5e008e0ca3d85a6edacbabcdad3d0ff85b99193a630015590bc16209fc5d9701d5c4863932eb90be0fac8ae5ff46247c1b26b84032a375c20d01a8c636d22e86319500acb793e3c7180f1ba516d133d54ae59bdfc7e592d6717cbc72bb3c51e0c0a2f9c4962013b97e2f7d6af39b09554e5da1a97c8410e19ccb5c2b7c4782fb6cbe52c8c21909fc26e83423c5357b3235d417f7137dc5363b1ba043b8e931eaf7a1e636100375609a775bbdd19c51d8696faa3e2f5d318a8ff9db4425fc050fe1794ef32e7fb1383609423a99e01586c2a1693a43405264bc79d9614d881adbe9f7093cdb32f416805e86142e24ba3b1e98494d5f99206fb33d4f58c82b1bae18daee935694c81051bdf728248674d45239ef7e476db35011d0ee7a4c4e4fb2133d0249cdc152d27866ee80dc0e95e87f817bc55ddd41bacc5a29cd953d7e5f17cae3399cd59593bf51e5ea86ac1177ba179b1ce27431a9679e4c6696834b6ac37bb8dd6d9b3a6d135564bfb603bd80002abe805f1542ff08d256e580a9e57b9a9c6a9ed3b79c43406bc0c945f80327fb83b92954873d49c087aff4257cbea7e2d736f7529e197cefdbee8b3e347e880066ac55f49dc6a5f661740686fd254e817751c5b56b9373c5a35037c06693104e5cbcd644c485fdd46f3da17c4f393035e83aa6d12148dd5a6449b8afd766f5bb305bde9df6ba4d5840f674772e671f181e63b8b7915f6bce3dc49baf49eb02b7ca7e67a4761f394e29f8fa0520dce3244b36f4e8057f89da8e4ce4df4e1316d0ac0722f2b8f829509000039be9de5905881cb48ff6758386c11453bdf5987c7d689560a988c227ec2795c6b520043e125bae9c75a057369f67368cdd0e09363f363c3809f40417203c6d3ecf11921cdb3c127e51c3fd045afb850f0f1dca1088f246e5dd6f9b058c190bcc7a18ac2376dc60ac29fc4570723a61200472d1a22136b5a132238509ad8093e8ff6adf564c82168eec8f65caa2b1d94dbb9eef8bb3880f58317ad1e1ae61036a281f86d55b1a65ca15ec2521cb309f9a1446460f2431144210737e1af27018b3e28b1aef44eac180f943a5e320f1fa83957999580b589ebad63a35ce940b1d3e18c95cd73518bd4fb0892d76390fc168b6900caea0cea18522682c396a1724f1c2191779f25ffe4a93bc4b35128752532e626f2d4faa41f22580f6eaba257897ed0590c5bb2b9465f6b399ae1ab87ec78f4ae30ea5cbea0e88fda46046f86a22f493775ac6fee61e1575b99c1f06d32602f85a338cd1e0d4fee051eb166a3ffc701752b531d89b0a2dc608885dd287a4199af75cc7a93c56da2f354f2ca7572cb33e1c3478797a8ede28d40457005a63be818502177dd6a7bbcad47f451363933a088b189af362feac2f80417d53f6f0df30dd89262fbb4d19d2c1f88703ec7dc43365e187bc568da3845615ad41581a2a50debdec057fda4d70d3424ba41b768dd73bd473cc3594ae6747f6b35f68fff9284f92ef75ac047f8b845e65d171994d2e255327c73fa5fe590e872697c25b10547675203a1cc030aecbc7582aadc85debb6dd46e0831e40da05907f309633eb1e9395bd710e2790af4044747f59ff3af13d4227b93cacc0ac9dc3ec6616f88cd881150056a48e05484e73200f1e5955a71607471898050ba2753832aec36a929ed3a5e84a520987378eb4fcee034a045bb0138abfb9e016460bdcfb73d293690460629cb9f4ff38dc0142678eaba28f23afb1a86ca6f4f33c6de01d444036a0bab6812bf260da1758fc2f42e7921bbdbfac1e1b087cdb344eba7cf7bef999a5a724184e7cf069b5517ce6f02648acc7da90f3e1fc4678488b63096062121f4fcebefac62b90b257cc3a22f308100959a7c28c4c7501d76bb2388b63690c65fd439d25f05c9a82c35f4b1e52261f656b8848e90182c57a7983f1d348ec9d14976a19f5a24213b89c88b6127b56cdaea580096a7a81534d2576842967dbe89005b64fe6ad5bda3c7b01ecb65b3ece20652470c81a479d78e900891dc627e43f5681d1a0d79a5dfcf3283b361d3c852719d5224137af266aea6429547675adbd8f17566611ff6e8f91ab3f26fc33ffb01d4f52d7999f589bce3617d9202127726690039c685ba14303d1377ed7010b2e9166298b5985c3929a80d7856ddc83317c4dd263a745a6b2297d70abe948e6f9a0358fd8ecab9022480d4147d7af2fbc4eb01f551a7e35d9b3bf53fbfc116b7ab7bf2858486980151cad601b9255efe5e5c97cdf6c1efa062043d40d85e5a225229227843fb5ee23d2f21ed51190d88302e89c4b4c10691819a22d000add3378c7353e4939392b2ff2677c8ace5ef111508fe87f1d9a65d80833b62b977eeceab60a987c18571d68da660f26a1a16948422e8148e74bc2840ed6bab2c059ab6e5a19d319c662130b2356bc29ea814666543f52cfeeb24c9843c59c47520f163740d874900aef0980f85e6bea87f9df0e329c2c03f22491e59981b8b173fd7b1a64022f7757bb5b723fb28735a6322b542d577cdd79007877552d12b525b52f3cbf595e64a9a380780b66bb36828cfed4bdbde7624764671686ec7ec8b0e34e07d124024a5dd491614750bf293cffffb0a4cc9a7e844a24b843bcc5ba62629b9c36d601ad8c9da2385656200ecd3308b0d8be553175199f022af4941b7e22a253c50fb4b83d79b537748424d5fc9c2e77c1f08ace8147270ba94a1115813825a3411dac1c0441d803700e08e1009ca07d25b5f542a482e2022cd1d7dd06b06a0d70053f231e5a0e6ba4994378c389f354d96e73d66763a1c0376ea9424295ae4e9f45469c23c490d16d36d707b4cedc11e3f65ab36be7f9d58b54f007fa34566e4403ca7b4828e210909bfb19f51041ded72ef60d3cfe8c0434dc9c49c096f19e52ac66ce1de3b64375f83657035060e5d7c552f60b702301e119390dcabe79bdc7f786c0691e0ba9c3c2862eb1fa00171dd6d93c70b0ae2cd946fdb216499cc818278024b8f4ce6b8589640fe8910624970cef0d9902ee15e4db81642cc6195a27d747c7ebac91cc6f28b4e7222effa9b6ed2b114acecb4038265ddf5a66a48b6cf3014e402edbae223f5b893119f7c8439d2875a46f6aab08301d1ada56b06ee3ff097ce90affcabd01b21962ba89de717147895bbfa5a490cadd99c4ac33903b1b32403a699ba59aab88b060926c267bd5a1d85f9d769e7891acd92a24c3becf33309edf1580597a58e9f16840e9301fdb7c26dc539a799005bfce4921d871677261b5b79f3dc92d1eaf5e653e4805fb11ae330c803b22c6449f21eb7fc920a1265575a70e034db033e57b3bceb7256dc4de370c2b20c0bd26a10dabe3dffbd21e68d7195cf3812ac74f3d338633b328c23239ff6d651c7e67a566ebbdbf1b4cfdb9fb5389ae00a350f85e5f2bc92fedc6e77b9ad535a147086d5bb6f3b7a589d21262928ab9525b34f30763fe6a465acbab525bd3c40cd689225faabb255b4cb98149e745d733dd223b1efe5d0b87d3dc28b7333d809b6c4d916c5c1acac701cc985c026715bf05cb897b93c2c1c4ebfaa3bfb1caa6e52e5ba642a5bf5c5abe08143b4ab9358acb0e5dafbf567e06830826e37d5743d5cd23143f8da62950a05a6c7f1d58d6a1f3c42590bd979e0e7ee75af1c87b70bf90f2ea136114fdfd076fd3f46e2cecb9e2d38de886007cd0b5dd9fd7ce6afcfaf9e4782e14ce8a5ae7e916bf0ba45b7ffb5dd766f5328e37ebbb791d608c65f5e2c0e48559f71f7c50437b737aeb95c866545d723d9c45fa10565aa7ad5d43fc670216d70dcca92247df94bf2fb3d44c99e513b0a0ac02dfae6190c4c75af0a1f24cf6c7bc5a9c4343ae795ce2d8180abb358a236b47792d8f66ca55ed1e28a2600060017d65a117becd135485004d78f0310b33999655c65834a2169882a0afc65e712986ea1b703f658f987cf0fadaf44d36df206675c2d57aac43cdf54976bc29ac35e279b9b2433a5f1bde33e94c2a91974872f16d8190ee97fa5792408a05aefef874e241404a7fc0b84f0db9ecef3cd572267e536ebbc99e33c4e24532d1e1799e9acb60a2888efb1c499f0985c06d39d72fbe426d3408912dd1ac62ee1d4fff8a111e861f7423d38dd2c9b2eb52dde2d834a0e86829867ee75510c0e04f9f8722ae9be7a7e29f0ba47a25299393c462906c5b5bf171d88e314578725e69e5d376671666a9499d81daf69245ce62d10491b7d27c603b64d02828b876ae32abff20d292c8d497583acd88698a7323c03dea0a08b57396b581559b9a9ac2cbc9ea43d662472a1cd3f47b8c65b7d047e5a1043b1573bccc0d8feab363628757bc577cd9ef91671b04502bd7ea83dd312255f06c96be54e8cee938959809dce7fe8cf3f581afb65ad68200f5bcbc0736eb887e7adc89b018552e9881dc3e3415b3c0c4a12b1b3ab5ca1a72f3e785e2a511d316409be3904a4b829c85c15d036c6e66e00ad589c50983e4669e4e012d1820d427d9c879457d21be2fcd86bd2f833cd1e4de95d8c1cfdd60701158b8cee4e86ef98152a216d60dff2b7dd76a940febfc2002274bb78f5ca6e1127e84984eb7d41f7e1a35f57ed6697d716605c92458dc15dd6fe100a23f3d2dda20f6d7814af4cc9925c1f0c1fa9974628e34e0fc5cce5263cce5439a8e26ea65a563c0d131c42469096f262ea8fbe688149b8bf0e6c8202678e21215f994e585b7d7a868d05cfb0d9f37628d1959656e2a0215c4a44387df37812c6b4e88569d2567091460e1fab9eb7fbb3965432c1255d37a3fdafcafc592a309f8f1a7830fda4416cf84fe9656426057a8b0d2c26320c6cd1b8438f525079734d2b62395c4edce970489e8809c6ef613f2c35c44aa92aa44f21dcd26bd7fa3d6e9b14700d1054b99dc8a3c9d076e3a5c5eb70e8baf8fed4de73b7f9e178ba66c0c4638c831c0e57a0866078993ec60daf008235c4afe61350cbfcea8bc77dd368fba9525eceaa6d6f93889676b958c3e23124d4872f94b02c6a5b7a83830fb5332e6c38c3db9710c1908165a88d8b3e9933ca5d265f621fdd234a6204727a23a944cb5da91d57ecf4d7c53bfdb1320beabbe6fc62ff4bbd1c89fd3574b8bc768211fc3d49ad21e3009fe667faf28fb2c4e812e49005c109f7099fa5b129091c5e10866364a14ecdd9bfc36e52b6edd28af19e19eae2e39d1fb0a6d7a89b5d576b1d45889c42408e9cae47265238ff9ea11f4d56634d7ef1d11e69f4b6c96ba466a42000e56eacedb7b4c05a879e3f799c24e2c3e48eda4975d2f13aa8ab2e7568b5fcdb9dae7f05b439e7a133bafcfb47a4fe22c3ac32f298e1855b3c05564acb4a4073d683bc30b72155f0d6f732e4811d477b91b74b51d4a0272d8ea980c260d7f8c12e2e6715d53c97e2f8c63d9c11139de53a575b5fcc83aab23fab526f7bac60829bc93bc5803117fc71db2c6a8c9c7f7513990df9b26f6b9c7694e2090de482de10ce789ce43248cfeafafc1cc6b920656d245cd840aa752d17de41de597c4896183619268cd6471089118ae098819a2d723b445c6b968c6a36afaa0df21e274d85e228029e9550c62500483260ec65ae753ad8db986b7e44a1f293fb12a2603ef6ed66b77c7dd66afcc7066111636c621e0d8af0ba13ab7822df62cf807c45980d2cd46e4a56aad663d54197113fbdeb4d8f337d68d891745a43779c6dd9d2e891ac084bbd9f5576be9b4c8c47133e9b12c82f3d9948789b210dcd28b90cf11f1f1a4bb717a1a81fb790a49353a1ca508f4d53a87b29547d5551536c2121d7d5b11c2ad6e553d9da26f33c24108422295c528af68b81b48150108b986bb5bd8169b453d315038b36177c8d2edbce14d00875faed28f9745c0fe088b05bf472ba98ea612a1e367b6655b8001fc8dfad12fe9a96c77b722e45290c78c1721baac0e7bd1aeaf6fe8af19cabc843454073f41a356abf86faa40cba6b652ef5587ecc372827b3fb055616e6e6f5fd79043500b672f3441dda0f25420b1db5e02bb9092b9bbcae27ac25a51b2677707f1badecf9cb3e129d0e351e2f51ce9b54b1212fe561decc3bc9b6fc5ba3dec60f354c1d6b6ab8542fdcca504d429196379672372d5a72749fdff49332562c623c44f24afb4e091b094827637f4b338307e8901258b8d6f8f5aaae9f5de855bbabe04a16ed51e3d360ecc7210a0d2480c4ab3b18af6a68e7cd21992e9a6958f30e4b20d5fa8005871abe3557dcc68dcd6f65d0f8c978d065d95e42b2fc7571ff36904945c33dad6cca8cdfd814644140a0e4fa3a36a096370b220bfd52707140da7fb1c41f96f4ae60c74410b1f113e5536370d3ef614412ef8469338ce8942683ec130804b88f2d22254ad3bd61918630360fb11332c16c345e1723dabcd87ce43d45a3f7a8ac0a8abcc6aa34ae1dabb9d53608a8b3cd133ec81042c0ddc03a845f83427e6b099d76b8adafb03bf7378e8573d24c99551ce98e86ea7b7679eeccdee5c5030ecf1875beecc88bac3b8d442c60b30be9f055e91434a35892111b5dfc01a032652263df35754a518d4061326bc441b877d15475d4e7ca1a155fca3a4e8ed3c96f9d63173a4b2c545d6058f888fdc093b727d3207bf23efb0267848d9b878367d9bee920d62b38058c0d789885f8ca0a4a1a5e57f4b0c6db2ec0011178831edd5098300ea9c70626b6ff580355d7ae4ba1d26c0714f22c7f23fe4bde7f051b245905e8bc599fb7ad93fcaa17178dfe00901bc521159e28fe6b740e9149c399bdb2078b542ddabf37fe6a488216a13d527d0676fb93f87bcf1616522577b7e23072349faa9ee42755ba73b0ed7311e90254890f2dab0b9f96f88450f8f6ad125748596f3bc28d24a64c1afb624ea66e389ea8c6c90a5840fb36245b0f4fefbc46a8d0f3a25514a7067a07bb19a9344cf7dd8b0950d3e9000bee3256aa375b9bd6dfdbca1933ba8bc05e6ac75ed75c21a3502820d0008956247ee9b085361c6bb7a8ca6a7273a9f2370d8ecdc5c004d398a7ca22c66477254c7d4501ee7d0cabdabbee1b69c7a78e52331fd294d3310122c415caeec8c02dfdf18ed114217e8417e9ac880d4c050394a0439bfc21aa706ef7c1070ac02d912463b7f5f542d5d9fc0d7f301515981f19437008f9149f5a9cc5ce175df323e6e880559b671aa0a69111f55ffaa76a7b6ff314f10b3c3925f6470ca89736af772545bba9ecd26e65f75f63b331fc3c6b1a1b524b145294088fae03ca75dfd7cc43ae85a5d1aa047aa04747527959e3655b2b5082bf540e2ac56b2099c14f90d38a0969ae98888d290eba8a62c1bfcc6d95917d3f909551324a9eba007cc0e07ff9b5ce51b7acfd244479be20fcc828e2299277f5fa0c0493b6d9c343946a49a5dbfdcc356cde890fb00880bfdf9beead4fe69b9156e4a4cc86d6a191c47b2c657ca1083de413b4376186fbfaab3187b54454b5cbef87e22e451c8a57cd612d5fbf621209d6c40e1f448ba99f80020c15befa78f76a23c1a4feb976f4a7d9c7b651f6f7436e04d164180a56ee52f37ce8b73659098d3eca1e296c5c8a017a235b8f0e9793ab71cfad98c2b078bbf8406ba6908a68db59b84ca952eaab4e0bb5672e0b69072c4121dcce9cfab366e8dfd999310b86059b4bedb8bfe004ef35d9d09a4379cb2d72f29a16412645cddf77b76bab7865a224f934e84991b33afaa074a5a0a48cf6808eb08eaf61fc9e766bd68b6ca487898794a1014151dc7dbd81f489377ef0e8397e28a49dedc0c9b94dcb14d4ea3a6ba864210ecc47bbd62df026647223a85fdb7ec175f9810c83b10931835e0b96eddd428efd1ce843bc3aeb11ea800eb77c89e993ffa0adebf80738fba0ac25eacd39993491167dcbce26c259357615060cc98d503ee8add4399acb2c6ab0fc65ca52cf553dd66edcfede119227ec8d290965c835851f996de73ee94c0a70918b438154ead4c8fbfc96e4b944ff0b5ad8de417fec370b232ce7955dbfcc62439fe8bf7b23d6c16e827f129bf660a159f3ebeb04853123423ed9b8fecf1a0a50ba0e31ae2d0af394d6074edd7ddc0d88731fb49e3c994ce13b769bf2ab681d2889099a0d41463772274fcaed37478e1219bf660788b0c270e79234be28dcaefa57b414369eb86769029d7147a532c5e8042ec53bee2414958e9b76017bd5fe37153398a08246c82de6b87391055e6958f6c1d30be1ab8cb2c6c89c55f77e24f25a400b0094b04efa419b27e507f4d705b7402aa53684a875eace51954c6027ed703a9c3873d5ad7f2a09ff729ac5cc81c34ba4bff3d35199a14b747db54c6bbb2ec5600cd6d861f53cc613844cc7b7bf6945e98d104e83b3457052fac8fa9a1f13546d9ad8f8231c3b859aa22cac9af8583b5708c784027bedc18f9517f10af4792cef888f1e50de3946ef16a1993d8ff2be7414997b86527b7ceca75235ba84d518cf9b0b2cce6d4b3a87e6ac6457e6c376d15c2668af1a0117b18179bbae22fc1898dcae4bad8d03211dd12e5c53c9dcbb04f04fbf3b6a7448a5aa1f0c0bbc71cc7bf42e909b84969b70811f15335ecd5ebc23ed77b05a264ad50d981cc90505181ccafbf067c0d48cd2c658d5c3bdf69ca196c32ec9f8a5bc9847116b178b46b5558678b04a83feb4930fb3ba35a5fe2d3e82407e56559d9f77a477f00ec674375ba6674eee9a00335fd95a901a0f7fc36600e4f8c65860d4246ffe5be6608727cc86c27003b47a32ae688eff630869a34df77f733c738d6fbfc6ffc451ae51d76f967b9c616a997400091bb4a76c61d884f4a94214aa392008ad23624f61dcb5695a3518824e2505efd164a05126d344d935b88a3f770c710ea98029cc3894c14316474d71757722a1c1da99ad8f218a1128776486a5518a346047d753a11b19fc8424d6a71174924058f80dae656d0596df6bd52413b9ce937c20f254f4759fe12b40eda9c2e4da9f44d95289a18f9712fbf168bd2a4c34941c9cce8d388652ffbf9f66b68f6f5027ebadc32a64a3454445382f8393454db38df2719cc842509409fc243d13e443a976f7441ec896abca4278e672fa8fddcd53e51352a88d06dc3f9ec3000ea47fef4dde93b4c6fd10ca7494d5f9572a9e09bf0a96f34489562da0b9b881c5cd4fbc7cd5470e7e816ca5c4676539872224aa3c46c0233a1f48842d005d55d20f39868231047e1a86199eedcaa407b1dc992f8965f0534ac86120209cb4a3f9cb3d105d16e7051f0faeac63848666ea2bc8112e2e4d39c83df993a9475f9c855fb3fe1fa7885bea3d1ce2932f1d30d9de98c3127cc63c2ca54e64e447a9da7360e190267b02c04d29134d4624be00119d9dfddd621cfe43e01ee1bd894222da50acd8d361d3fdcf108d5b2cf90037d8be059a5ac1535db413e454b467fb35fb07a51fa0de875c6bf6f4b9ba4a45cf7f268b08825f485b8eec5c1557c226615d41026721ce82c4724aee328bfa2bbf91f28a1ae4e6c87d9fc6225f41e84e730b04a6d0bed89d0f52eedf3a34596f2eca0bea96bb99d00a2b0ca2c7e830f63b3b297a2d09e37a7d41450906a6d62b1db2292ed54755fa32d47ba16a08ef9661ed4aa7ce23d0e0503d238379b68360e2311ceebf9b98756a7f82bee30dc9dd927911104526e9d4f9aeb4a53f4a870341fc41255c4fa95825aba0aff9835601b809f6686d2bc81e276166c2a6f4dd697ef6fabb9576b64957e5af11097e8839d6253ae58b12811acc6a6ce76c261bd0a306815396383841d5dc4388e40c1f1d8dfe02c0b886faa5e3e7ee53c3f7ce4a986b636a85c7dfa04cb4445dadd84df4f2e62f27dda8ee92baf1821cc8c3975a0278a9334370b707d80d40a7e99e19f81ce95b3f32b87667f392a804324be3640fd063fea1d365e724a776157ec2a2e42a8194322d52b36db64837d09420b44ba496873b4d8aab52f8dd85ebe909f3bbc56394d0fa243a2978f571adffc65388c96ae1cab91687cc5ff55ac5f33856c9725b40c5e6c292ef97f913b1a51e8a61aa7c27c257c12213d91195d1339f314dc8535f21e1ad5e395684968cb1533e92d60a367a5ba9982d916571e7f26a78cd5ff514f54171aa9556e677300378d6729f758ff42478f1b3fd24d7d1f9c07402d6b9c21ea468a313b674bdc3b3398b3fa6a20b6283f7c6fa40af8fb63aadd9a63d4e2074226456c190c1aec9aa3e7ab7d9a05731571bdc1bb183a87145830a92932953bb3eeeb4f0d4d6de36caf36d6b6de83e3d5a57541dd970a5761bf3ecf5582c25c25c66153507bcb170e22be24491f0810a99781ed0e6f4bbc1b335cd5fdce28ea7d89fa2bd5ef710c2fabe70641552209c50d74a25c852cb8f88b280969488961cb7bb311917ae8f9aeffdd5fa48819833a42829c48cb299fba8cf85a507d45afcaa9d567bd00899f576f9f2901eed4f6057e7932658700f7c76e5f6757282af47bbf331ec80823c6301ba34cae58059564373d4b020cb9c1a9371300ded7f8037bfc91be8871322bd17a65c4ffe722fd7e067fe6bfd0a29fd7dbbcadca08468d771eb513af82b8ff8812b558593a65a2d144ad5d0714da89de6f30aa1e1a12c4a466b6cd833a9f49d3ed17e2d6d17304cf7dd978392f6b8e3a82523b9d45dc4ea644ece8f216aa5c2885dded75a8b794ca10c95a565ab0ae663c3e6c3f2912bfc2cd51f33de1d4e314eb846535e5a3dd49f68552dad48aa2af44b01a2d559fde6e62c6e7cb7abfce0ebd2a7aad6d9ef6aa861a32044803b086a47fddfab763d1d991e6799707f7997305b46f9ebd45ca6825efb2735f2a9bd3b2f49bad6aa5b2d937fba06f863d8f05ac5737e2e889067d9d594d7a93d1dfcee39c1a7bd37ca8cc4aa42208d989c766d1f9f791b379f23a6b395fb1d36a33815399aa1f4825ffb7f6c1a4ddb1d9400eaf01e3c4e08a7f046d25fd8039c155d3f52389c3be7e4dd02243e7533768c5fc8cd8c731dfa804f521c8a3175531a9861d24f18ddeed8453dbee96f7304faec176b1652bdeb9e14a4442b968a62149fc67a1ad32bb11de31466acdc9adc01ee50822922c2d271bffd14c197acfbb4e85c97dbab27e38251a6546e06e3811810d806a9ddae5f9af196014a93c6d7ffde8b768b99186108dd746f40bce0e4086be0777668bf306e89903b5dc148ef6915cf9b0eb7c7f0a804a3b6ed425a34173d2f408459d9c7302e7fdd75b7a27a9435076ce705a24462f0ba899646c6726736137de466daed2c1dd9ea68a997d1958450772f11055b1769401bc2f3ab1c6827a486ddf5d4437c16cdf7b57a55c78b00390d55d1180dcc72d0c677e43eb559d660ccdef07eb644fdbc0eaab1fef98d161d709d0c90e8bbde542caa322e59e6810776952e4e8ece5bae89f6c8b1b3776bd2b0541954526326977937585b96993c5a1a7889d8b1ba0b84fd21e63d1ff0dd036ae7d056dafe0ae607a85688148504da4ceab58aead53d14bbf13529353e56e42bc4cf98985769cba6af8939ea76bd0459269fa3416eecccacb6f0e12d8dbd99c37656a2b5da8698a26a93ba262121fab4f9ee972526552c1f2b3d39deeb4c8e7cc0b88c332337712bde1e1b659fe7e8fd5a9ec232042c205e5e5a0f2690f7c2577c321bedaaae2422f889fc1d563e82ae9770c160eded87b66cccee8bc49693a04c73c92eedf8ea0d4efcc84f144f129dbb7288ba9165ab7ce4e40911c86ed01300e39b1419d0e5406ea1174e121b4780b963858f95366c67fde5b767b4da7fb4bd219fd5a19930cc3e265e3cf60d98573f4a8f58eb60a589da3da164fac702999f1c9ce8c9bc72f946ee48cd5d8b8a41d0edf56cc32a8951592af3feeca9549c9a969bc33dcfd9449e84320b3deb740bc86ba78eac0eaf4f0622870d3383905da6708a38e33f891d6f643cbbfda099f07fe13f11e349dc7866ca30937938d92029f240657360d8616ff073d20b1a95221cda2c861be301487a9d369e68290d3812f878e922e4ff676ec218f4efc726593e39594c3ec29bec6e9b20b7f3d2d1f439733f5dfc0bac75fc7ce998f949499e6b77518985b8ae3ef467501f10bd2ab8be57dc773b06bd4623fd349261e930ab54b33e059898a19ebd87690aa2a2b0688c8be19fa7d557a4fa7735900d044b3139a9a4d127d01da8b8dd0db19ef422f659893e34b9ac7471356c63c55767d3f61b4998fca918f589a3dec2db371be186de3e5acffb7809b97e8619fa830919c963c06734f8d52d8646e4925c6cf3843d45dfdcf1eedc03c9146e53d8155d4e5022fd89b0c3a5cabdbb7b1c0eb854b1915e959a7e072875c2a630897bf02bf25ed1bf61f3bb431742293aecc37fef01d91c2c7940570e8aefbbe577be2d8ddeea01a28dd5d41237901d5baeddd4a2343c48c6f4f014244d3f41fd5040a17e1ce1bc4b025cdb2a473fbd0760a20e77c5f11d236369c35839b0bd70eb500b68d70efdc4245117772472549b271d6935527dcaa750e899a2e1a75c497a47d3fc4258280a0120384c1b13cbe5eb8f25002a944ad34f91132a69ac24f4fdde9d92c685676716c7a47e5057baee15417346ea9f5697c2bd657da3f40cd12386ed47199a121bf57b9ccbafe5220b9777371a55caf043d470d4b428bfb4c1359a8e53721214b0831a4f1a3ee5814d4f472ba5b0a564ebbabe56074cf871311f83c399edb04646dd9ab4536388dd552869a6a8a1b7ec4082797c707bdd302ce3fefb2a98d6e8fe86a21802cd84ba5fcd2063c1a74dabeb08a0357a66aeb0de35cb55b94cdeb6a5a95228bf1d005d6029c56f89c8f03447f302bdb7481f4badad5144f1971e38457971de0778ded9ad0e02cd8f14b8a2d69d3937a914ee9d84606a82e743509d873d382c466bf4fc71e36ebd3db9b68d0db4269160c00dc20d5d698128515c6f40ddfa502817a7a6b6e3d875398e8bf47103eba86799328e357d86da9c8573c3f1dace92345758a9d0b4e2b144144e5a85a6272e1bdc6207f481b17fdf6051bd9b274c1484b315e28760ee5d1e9585fcf9070fd81023b9edac3091b086c183b5ee2a3fa44888112df2af9cfd36113fae23c05975c8c1dc606a294291bbd082151b5dd83cec0d746db21bcc18d7a9ad529758a788fdf8ba805d1f1bad13079297ed3df6682649a1dfe568d9e82b7514d4d5befb66651b075e6a75b6b6c8a43a180a50d068dda859318f382ee390f323108475eaad75194a62d4c1b37f0ee3422f780689708f338ecb1b775d7bd51d8280eb599ab0155124de3a451efe91ccf66d8e2f4e81b97d545062d2e9f7ad8bf86244744e16998676ec239d6e9012233ee0ea7bf02ac79cc4abdad53507641a3776c6bb75d1d58ae4198069751a3f2ed37e407b1570baa1a9914c774b92b568c43e99f4c8309113085fc332d6febc761464843d19408c2349786c7254b8e2c9ea13df969fe949fe4bf170abf90d8153ab9059f57c6ca386db71a4671d5407449873eb9d3f75b5cb4363bd878038f1484bd975de6640fb4fc9ac7954c242a1a880c4a428fb030d1abae115f0bab363f765ee65ad2fb6b30683d9092ae5259b12c0dc43bb20872a7a6c7bc4003deb80c4aa4eb05d09cae460afef6eaa6a6894c7995bd4cae11163bfc6fcc66474ec4b79bbac54db525d1fb638c85cd6fb61919443071b79247b1f11ea5d35bc3773509ae7a2ccad206692c2b205dd39ba0bea1693e5f10ecff6c5b041f16c9f349e3d2ecea872ef2efe9dc6389462891617393e987fd36413651ec420bc2a581c527f9e2d505a31b2f8ec8b3021e22cc2ae0b1461cd8135b1de538df0802d4aaa51aa9d64d61c6037cb9a005c16f84f37dc866378190b28bcfe8792aeed6ed85d04c6bd86ee31013173601420904c339d817f04fa4671f3c9733c9d31746e4ba71002037061733e7cbf33ceb438f10f939fe35373ba0384cf7342c39d3e3d23fd0eec4eaf37cdf2baaa1fcdbd32933979395a5f1ca99cd0c48958b3a348b163d563988cde4ba7a546833d8ad1cdf404fb1c28cea71c517824f2c4eeba2789bc3a98c1cde05ffb36d010579e1e4c8710b6b0c199a6f7b04e2a13f13e61519047d3d03f1c8f606a13555019fdcf7dd073ed61b25c4ea45faba4f6b3b39390e3087f8eda4ed8908ea3eabca743588bbbb6749322a8bdc55dd6b22b929cb7b2530796486a103ccf69dfb8a5d3341c624183a36a070ff0aea35270598fa26ee006c74ab775c0d1f0eca50bb3a96dae5fbb19a0d4825fd7ca299789807a852155271ac6d95945c657cef3cded4b2bd5be04303bcaf219911da7650983c5117ff6871b07137e5278ede35867804da62b03afcabb26f6b6441501e838356cc1027a85fbafe0bd0ec8369f94ead197fd45e34c053381a312eb81d981aba195e966801dfda5ffbbd67053d3d131c90b1d4e127f198ea9b6d033714e1ea62e30e9e128665060616f38d93c0fa91eb8d5a4f426bf1b6bdba4be57244dce09cfc2766cd0cbfb0519f9f614848e7aabee672622d0698856939c4491148498c347ac68aa9a1c650354e4a0902202d1f8f7c2abdaed516aa630a643f8f491dd8415f0da31b87f868431091a519ec1ab4f81f197307ee4de23d2b438e04fd53efb24a2b5e0a8801faa7e4ffb6ba064fb65754a06d370b8eee603cd1e6e7feec9e87e385afa11192ab198bcb91c95807734a10e0c4101e519ee0a6c33d79ac912ca83772654c4f03870f01fbf5f4e793d80701dc1789a61e1c9f8d1d01b061f67e37a956cc635f128819dfa5ab1ad4553066a92077173b090909aacc6412ce12b045f8b84cced3d9fe07010bdb818776c758dafb058998fac6140297d51202d7500eeec153838ab648dfc03b04540b4c7cdfca9d24b49d0f5080aea96adfef781d43634ff3bf1ff88df0eded99a21d661c91074c908a2ee2c1678174bad10f37cbf02418fce2e56208d696a00cfb5dc5a6d66e05cca733f5e68b9c35077c9317dad99e64073d8b80083dcbfe514d6edb9b27355be3f09d5f1d9687e258a2738b4650615f9f183bb5aa9904d5a4b9ce2dc3204c15bd78b37c0da90339a4079cc87e546a5fc1434c91834f0ee9ac64acddf51d91219f85a40566e06c6b9e5301bc71f6634c604e0a71b9a9536cb0d2ad63bcf678b55bba1be38b86ba4138e79facf7db2c379749f54313b22d6625dff7d25a3d6a2ea6d2f0697d04fc9d78c69e0efa9ef8e91ea88c7eaf2349b42ec4e4cc195ca2970d0d27882747ee7b442cf058f8f21e2df606b43bccf2b280dfd3c36955cd74529093d147a3d5e1240046cb122867820a34d506eef077d733c7401d01fd6ecb5408083cd068bac7851a2275bc44ab0b9f56b7c8aa0eb84b2b833dac825946957197b945e46704c693cd960a42191ccb08483dfa1cd8b7742c817c51ebc1f44f2b071c4a9284cf7b86112baefb433472767d509c4ac1f9a4bd84c071933eefa279e0356236f5b498695c54b5d1b0c7e33fbf9c8c7fcaae81397cd4641f27a4a520035b88341aa1e029b5ab18e857db586ecd208ab85f5833276d48e326cd48e4df01999433c44a04fb5026535d5556d8b39271d83baf21adaf349ec893f20b196676465f78fcea5bbc63c61adfa7a85ddcad97015cd25af6adbf516eca49293bcaecc539997ad17261471d7f092da8c4269c3322214275e64167bf15171b6b25f8071f8bc927834aac4de21d3a9a4ae19ccdbfe4b696df15364605b412da792851fc593f01e3f36bb8115d1021a937ebffe94cc130e659aa4d1f7ae87feec57f4debbbca382b25014c7bac17c6fe8d0779b396b6ed6124653e2f876cf995343808f51a916834e515fd9a98545dbc158f5ba14b8c827577d868bcb97f49de2fa2f37d3cfb156756c5d9755304cee","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
