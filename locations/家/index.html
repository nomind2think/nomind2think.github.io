<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b49b93501b0880dfc3d1639e36e1c945faf41b53f36946efe4659049e1ed1a5c20ea42de0974e2cf6bd219bde08e3f9014ec1bba11d8eef104f5ca34a4aad7654e2e9bffd1fee4e722c7771d090e5080bd35935c8e1bf580a518d25c790e9f5fa364e6dd781d931193f9d70f67eb68ceca2591be44ad42f27607c58ca4a2e015b0579160c3a2b6dea9c897319877ea5e1b424abd1c26dbcef98757b3196586367d417541416cc6fff5efcd725e1fd1b6dfc50aab29df1fcbf357278bb19ec727dd26d4aa16508f54784c14ea2792ae2b74bf82644a0960bf39808ed0828321f69bac1c1df09f41d101ce45816af3cde887df1b2039c9966847bf3a0562970c8f102e87e265740df5de81ce46be0919114c564077c1a05d548c0546932605cb414a597e7d42b6628f642ed136eb758aa259ba648a445e818953d9aef9711dd04a307ee0981c3d3580f85d664f7c991162b500bf51a1813bb9c1c65188d9e4760d276aaf34d3a480a432ee8f26622c4a01855ed8b3be8af51a70fec29d5dd02b2751cc802b51917c3415918f1f593e95cc683855337e1656ca155757e1046915170bf516dee82e519bbc49dd926c0a5643d68fe17954ec616438c6e14cf169291d6a9f3071042b875e92d05b22ee22897936c50a46727b37908f7d28fd4386eb0e0257f8bcbfd286a32965c6dc62eae17b350f146f4451df4e6eb37e504397ac71651971cb89b73d7e3026b2eafce801b27ae3979faaf288e07a6f2cbcf6de91f2197cc00d07c36f0d63e363931453778ea2a3f73768031bc4b9a9c9b690cfa5a0327d9e04221db924e7d611d3dd88bb8a8d12512e2590c1bea02537a0d95dbf79c2ad3c405fe3a51cc3d24a5700bfcab269e3aa8b8434f49e07bbe43a6b1eeba19e585d6a84a34e205e94fc63eb8a4a1bf10711b212b2de24bdf042062974ce27d5d378ad910c9c78f4e3c7afda2bd9c49e90ed967e259e358d789df7af5799e87f657bd84ac4386c00246d1a3e38e7b1a1ef8459d15e92b13b95b9aecca1f920b23f13cdbce1f4548bdb52dc6f094392e2eb62a1749401a045558b58fb4e1f4dde5b86fc5c9baca3cb086323c7dea9ee9dce951f81846cd7c8d5f0186f4dc0042d8214af10964529d646318f1e1ad0566d72c1084fc7723baf44891219a7645b5b3f3ce9c706fce7d303062d844801cdb33ff3dd08631c7f7171d13d26afe49fc31384574561fa2961059585002e86aec9a06a4630ed97d094908d4f63cb18b327d65bc212b47ea45234e6c0f139367cd4e037e24941d8d9432b14b24e7e0daebcc61f0438431db9e80b914159f781b364c4f425804e14bbe64386a3074c0cbe5f753281874a42bcfff9c62afb4e1a0b49fbd1e1db9568003d4b75f175f043d8b969e152619fb50aefcc8cdcfddcbb1bed2174ace8aa2a06c838000ab11cd33f564d5aeb1b617cc5301c74fea3cf748731dcea3f1cb8ccdc59b09677ed36d7a2fcf5cd9c08e62aaff243f4aa60a3d6248da08c91d49f1489abce2efb1265a48181634ec944b643af3907fcf5f4a568e154a9aae42a7dc151d42418ef218d2361e27781a6d2ba8192f49490a4c8d707bd265a5ef1cf3b22ee7c5571f8796bc730fa2753cf95742c29d7482da9463ff86e8af1b4687e803b6cbaf3cdb7758b99ceee5b4ca4a34cfc424ac0881644a32995d8d6ce379855f3fefe2666f8bb26df8972c88eebb1e9d2f15a80d549e3dcb12f3330edc743917017f9eb816edd3f842b8a2c21048464b1ea4206a15d0d43d3a5d673130f84d6226012e95ebc3aff7f021652d0f02abd935d8a0a8b8e29e35689c007412d00222fec53fab111b4b0b198e18ba19d7f226e993a93701506fc948613b6ff01b626052ac13038a7df4fe7343cd1434696fdc6ddba91e796792542c2f0688f5c20d606321701774cf7db1782b14d6c391a5b9ae64aca53e196099d20fcd08f1dec0739717b072be2c520089b930e6f2dd8040c679264b05889df00191364c65a60a87bfe3bcfe5812f9431a67453e3f577c9bf3bf72451e5fb9b155e6ca84b406e76de80c640dbd0e8d9c495b9e7b78d1bf9d31033cd1ecd1cd09e1c4425b0472476b504a5ca78c4b46c8eee384108c954dff069ea24be4ae85186d5be3f2a8414ccabf53b215d822b1e6d81025834fa0c353197fbfd4bedb15c0d31ba54edc7bd1f3f5303c11ae7bd7825f52ffd9b619c981648883ae71112a2ca771a117099dfca906e352d83a1f6bbcc08ba0704bae6391d9c30b114bde91344c41862eb4c35a368c0bc2f13670f15498ac5561fdce7717e2901d33447e049ab3b0b56480b0a7a4df92cc60132f7ab302b84bb272a87731d309639f48da53eb0406ebc67369aabc8a5c23740588ef3f8ce4cc0906eebd44a530de3e1856b7a415ef0d49ecae734dd09aa1c2739021415361616470e2bcefca57338932a482d0e94d866476b557a5bfa1caeca00f84cdb7a37bc800d78b73b808082c5f6d8ac7da31c2071f8fffd5c93339bd768ecfa9f4221ed6e5b934312e681b86efbeb2d1cb5048b9d80d50a6ac7bf847dfd5827ef3bd81c1275ba9f374c1cbdb08d2dcaced05e2ef101ec771cf2fe48c8a09d247f5931b5e0ba180d9f715e4690e338b5c4fd1d41d098f17681c4e600d9503f33f6f51fdc54257c55c1bf5fd4826b43c8282a9abbdf3c34113564b0a750bd38323d23d2d786ec3aa5ee81e4cee5d71f7fb7c4be0ee1e046c3fb4b3d7904159f5ff0e2437e7ed106c2ce08e9acec01dd6c665a70790dd49b91bc29c4f1cfb1759d5a7552565690736a0c9739057c2ebea55b22342014c4228c6c63244d8ca5000f42be6cf87b9d052e591dafcdbb26ece4ad257c99cfae2eb6616599ace19efb98066f66185f32232184041847a077f14b5278763c5ada006f4931173c8d4eb0e1c1e4034d51d0f53e3a688841704bfcd85c1f8228bf1925b7ccc75b6d02a830fd6d7e23f1b31b84d324ec1cc118de92f58f1a60ed8a9bd844206545b825952aa178411dc6d14f134b4478113c090303e0fa185abc02a777a17f818600aaa0b24c9ea0c12eb5f4e0a3643ce2a5070d548cdb5acf7dd7771e97312a1fe298b659327d20159b02b48b6ef80939e18f041056c096d926f95f9d6d43a4388a7a969e0ca88c03c47bfcc09de60164c872a0fe8d11b06d8bb5c3ca461b25c1319e5ffad443580b33cb57206c0cc63ed2873c533d469f96a45d7d1d21baa38ed74171ad8c0374fd4a4b9fc90b3f55ce9f77818455168ea1a642ebd1fc8d8f34fa85f3407adc4704f65dd7c08eee81eba5bc64ee47c3137014c815767be656a5e9cb3f9b824465d6654ae6bb6ac30cadcbb34f04600b02dc40b160391458b4426112638bfa435912ee77dcbc34ea515f63ac0812aa6cf707cb5228b96c5456971ee508953c01d7a9458b40ac110cb90f5c50520fa896b7cbd3eec5c58b216866c6aa9e1259c62f205e0c6db25709550f08a7399540c1c1d45b380b9a940f06524abc9afed5163eddd4839ba7b1d49bd7d5d8fa2483a708173892daca87c5a00d131144654484713488b6d3adc1d19c66ce915c395f15878634f96e5e7b19b1a8b07911f9d70611be785e7a2563f2b2b11cab64a1d9ed4fe51abf49599f3dcbcbe6f8df746d3f9e19211b0d33f8b6f993413a14f1e2a2baf7304ca65a041948ef6e4fb92249fda056fc3957bc05e16643818a7c9de9bc1495a929f9674e45bd6b2ae49861ae7667569ccf2616017b521c56cf0d8b6004de1667d48c544d3c0f35bd1444878f920bb3ad137d8e74ef595a680225212cd94232af52e7020920c698b2caad6b4cf341a53f36daa4f303f10488a6243673f6a4446a811a72a9c9cd4f1120388cdf0339736e49c48e180101ccb18b347bb47d92170bb5d28dd6a7d7a7c168b77a68facb3ded27af0b55f3ba522f7d1042ca99628dc146bbe9b590321c1c3e9e146d8de20ba5acf61d315909bb41fd090758165ec8f9822dd10a5328759dd3c0f255994f3fbdcc3a83b4fca9aa3b980a2aaaa099b2c65ba51bf4146b4a5bc521f343b9c3b38e97ec2dab89e60f27f312599aa71a99ff6aecfd2a77f2b5867ff048d302f14452968512e759a4e17b58e4dc022c0488569f4570d0014d2783c393a39af020c39beebbbf9b38b7ba6c48e577b45a24361cb3063d0ed762d868a54e4ffaa1109afafde6e1ad294d0fbc376955182223cebdb082884b8da0f227ef629534bff9041a2402d50ef9c8aed62e478ad1784817b470e05911cb14d383b7fc30fc6031a73a37c297c3fe8761916a66eed14190ca9bf7a051bdeda838d9faf133948e25de5cb6358189e6f07b24c5e05a5ca41825b0827156fb19f01279bd6400ffeb230b6b79b6b03591a02c71f59e49c10db98c40bdf28c7ca946d3444c8a6d0c369d05e55749629b46028608aa8a6880547f3ed2f3d1e2c5bc267aaf0e9bf9babdfba92ef25f8a82e153616dc58d8ed88ff5c0bc758248b391fdee291e6999195e823f89802ce5248368e68870667a55ae4ae6d6614e8643f843d94e5cc2e713ad56944b7b0543fc767cdcf5c99cf8dc7bf9e64ae7a46da47793faf62fbefcb50f4db0e29577354cd31ad0c6cfc5594038fdb4cad6437d846d124025f4397f2073a01168b6d3075481d22b68c2324633eeae8b00f8b0eff80d9c95d2cf864e63aa6f240b8b67166b742ea0f26dc32662b90633b8ffb639723f01106d13b964f40fc137dca4c5ad065480635658b8a5729fa9b7d82f4a1727bc41810a5980f65ba98bab71ac991a86dc964878b67021725a03116ec71e9b3ba002589b47ea12d95dd0d9d9d005d5d050e25d5409497aaf77b8da66fdf3cbfb73f467726d1bde601b415cacf210acf720f09addccd340fd005d977e328ca7cd389ebc3b2c0f7b5b84071687c2f5955f2376e96df4d5edb4b67dc95ba1dad866039eb87a36836711ead6d72e7beb4a7e0f4733bb2af83031056f5f78d477b176e32f5bd83b8ad57453aa6803a0821510c6668e2aa1c8d8389a8726d0e3f85aa55a4d1fa56a01f7da0251e18dd5ff3e7016c67d7b6b9be49a2e1a2b31f84f9d04f861290eb78ab05168bbfdbc9f3752d23283f0e1262dec46d061919dfc7ed3854360897fde9e71b69a006929c83707fbec4ffc47d262fd5699c9886e2fbd90b573515b75b18e4ea70a5e5dd4dedbb7f013e2ad19c47a9c2043570ff95e6d051f42c908954f311e4cd1fe9d3c506d57f9f735cb1c2175784e74ff90d630412f7af3db66659e596f82a1cdb1055da5d2eb66bc94a4da66659d1618553e256dc55405d31f46b1a70a3e629fb39e6412a69422996a3a705644407876028cad58ae0ccb64c459d1f134848186e4f412a664951747891d135cf9f7c69c1a8d670b23f0a4cfe50585efc6cf4796eb77eb6efcaca9cfebe8cda19b04e459ff4e9accf7f028c21a1ed40ec718e989843ddba29d92179afc48151feabd17e79e41fe0fb43285067990cae0ea82f55481c88917adad0e60eb2d97f29651d0b18478ed91f1659e0dbfb72becf02022bdf4f04e431c5930e886a52a62cc56afaf7987e5a87b3c4f7f832e880904e275f52ffeda5bf61a824bbe3c6024f6170d4af09e7a848ee02e46772893e94089092a5549efb786fd09f697e4fcc32a1da643e607b670267efe50f73965361f88109affa39b1cdcd1f24cf2447824e665a6b0573785e682759256e74bd211abe725b92e5296311102fc89f9877f8d5415fd1206d4c427bc366499971dd772c9d7e03e6a688c129a92842991df7e87f74d12bc6e3e8d5c2fd72c0793ccae8d3da7c04b2830678578ca3c2f596754536499b71484ddd575c54a1f315e0e7d3955a86692c05191d2d616f0653f8ea9680be8ea44286efca74cda48dac675e52886df06f197a8ee39658cf6bbbc71a448d7f8aa93c9334865d1ac0d12b666bec166833ce304eb016df6edb15ef89e015a064f203f91ba23350039f525a1332f08ecd1860b137788bd1d1a7e09067768dac561c07fbc3a7ecdaf7bf27af42b5129e66d8ada9afb8e8ee62d0231fccfdc86599f4b4a269259dfc82995a62e109b8a474692e1674716e666d5570cbc405a8e71e7c3c08afa92357c58d86ab1c934b948acbf31189254400a24c4c2c6504673d35fb8c5f532f38eb404b58e3b3d2e01ac691f2fb8cb12f9c20ceb11531d9320898518923ba184ff0dad84670a2765cce39acf4aa89e381c654a5a18eac09c4d0efa230f4b361dbd44feeb02936fc89eed99d4a54dace848cc929cb98612cd5960129526be4661681786faa9d2ea8d3500c4648a37fedc806f5aac583309d524863617a49c4e6e554251b94ae8c1e76be6338059a51648f08dac0603cdc93f1b6a68d9458c9386f8b08f4a12fffba2ddaa6b568f07788e177b4a448596462479e1b460debeaa90a065241119abb7f96d92c1366d03f0faee452a3d74d008854e587824ee485e5e17d5407e8b6fdb9ba7128f423033fd20e951e1abe73565ba586e36384d241eba28366b5dc0190c7fd6e2256be79571b667700fbd8d31f3978987cbf5e1d084580bc8b876697605deb07f1420bfc1d425f2bf1b2a596132b24ef142d9674348a5b472f9a6d51273e54f2fa6d5909f36c46b4c781e0b3d12eb00fde435e5d7e429707e0ea1ccb74310d4bd960a7f5fc7eb6e621b77ea3dd4ee6a440cc3d9f05444cb5073a9f93fa883cf5bff835ee64c2c0bc230f1426671d2ca19605068c6a67d91690c5b6231be5cbdc689443dfaf28a10a395f8781ff75b5c66b6888f49e00598cec6a8d2a4436f00ed485effcb16173f125ed81f4e3c0280ee6f5e741cbb029fa0f737e561bc030a4556dddc5826909765b6fa85bb909b55891c932c6f137445963630f7bf107cdcae9414309cb0abfd47dba96f9f745adc7a1a5e1b3ea2642efd16cfdde62b5aa58cb70df0cae93ca8045ca49c69a37d807d807f95a0808d117c719d5ce64d09f86fb8bb846b72108f3874bd50c1b16a057c86fa790b46d475d98cc5cc7d5029d0d74d3e1f9bb76494fd53d3bb9aed5199d8ebe0392b105f0e36fd729f2551a91a4ef8f6d95756407b4941e0c9af8f393a9b4676725e3297ae44ca23a4c20ece006a6e1e8f3640e896bfc1fe06b180acb27381849482ecd74a6cab736d34b6442a96d16bd9f40dfdd50d89acd4af56b580d6ddc49b83c3041ae145c795992a119c69de56fbaeae055ef8a3e94deab6a8209cbbfbc07e1918d1e9408c3a33673646bac6bcd2db144702e680ad14ae7cd9f71005048c5c957a13942a24cbc65b51f9f748adb0c7fda0d1659cb859425f499c2765d78ae8ac885bfdbba9e8d49991c6f3a7966ac0abdef412112ce7ab3fb5595c7d7e9c5fe9f0712ecae3e077d0c52e64e8fca2dbabf5a49e7ccac31e3d9b1ce06cf9e1697087c551999104567f35c9e7f1a28d6a5454cd871ecd5c918ba457315fa24b4d283c1330341a5dbea59234e9833f83cdd7f665490490782b955f81dad48263905900e893d42b59e8b2154d2742707e69109cf9da2b2c1e1414ca13397ab8cdc227c55a236115adfbdebde80e80170852c4fb5b896d74b8fe3945647128bb7f647a376103c5fc1d4c86d623407033bca062cda49073f623b1b91d2128b0868a5b853f2eb8b9d0a4e5e94ab181152eef86dcf7ac4fab25b01fff701dd9532d677d2a2a731bcf5eccfb6816202a9130ff94aaa4754a24354c75ab4febdc5d9a1bb18e2f71b9f78c1b2240d34c37be0ee79a94c660c4a7e10f44d0e9137821847800dce0441e4237a5c893d10817a8f5fa0733e900049b6cba3f5220605bb0f189fe5d42a5940d99bd8edd68254ad3d83105ad4a7bab587187d517b8f283765d343cfbf4907b5be54c7da55846194b7d12da52b34413404f22acbf431acb6a9fbee70d1b63c630ffd72fbce525a531f7d21ecc23d6e6ef4a5f5b9e13d562eef2c2c5bd56b13c0aaed3dcadea54802a2b1a3a8d3826f20cdcde1d107aee90148cf50d38136fda01e45952fa9bc6c7cd9b9d706fc2ced06c57a30ae87a166a0de831203e0eaecac8b1295eb89f73f6b0150949f2fea90b399d2fd262d0b3d5e454c2b1e2d98d98a2f38d938fa5d17ace5da401c2a204c4399fb1daf2bf605d8c3d552e0336cb6401ae4abdac8f4aa3f7acbfb23fca37eaec596394ae8095f3c0694cbe87fd50a70f81dba7e63fca2c700a3215770265b5846cda2ed781dae39211852668c6c06d424eabaa02b7353d7418412b8cb2b11f7e40b9f76026bbd4e88710c507622ba098c9e6813eb32ff91a0c445a9811bb4f00ae86786660a0269d5513efd6298c1d561a7746b2b68cc7d740517a323296321e4c80533befaa768ec050ed4375c1c5f834b4b713a3efee763f48cb806f57a53871f6f30af8f967af4190eccb516d1672ce65c1a8543919c126d54c3cdaf95d93038027a44a06abdb5c656e63b49b43be7e5243028f2547de872330659f322f03a4f6aa632eb8316dd50409ace3fdeb83dffcf58c34ed0d9b7be75484f5de50eafa4902a8d40d597cbe59d79a5e2063aa042bcd0cfd23f3d7875a50721be0669baaa8565be74eff634d33aed987a07de6222c0dc52da99cf4e75507b4569a87c340d06a76fc915d6072d3f56f33c872b7e351fc9feb03705fcf4346aa68c9c5742e3aad48d5c5b5a8f9bba054556a23688f146f1462c887221f54e1f4d83c50075910bd38d3f6abca1757b50bbb7e0124470013ce899d09c1494f05b515084932bd9c31348a99c87f1a19cc37d436deac2059154a07eb64feddf3c07df181359bb8b7025ab205ca14b0dfb9764a009f1a9cf047845bf406dd9095801928126d3d7d579b020fb2ed732f0576d50a6208c17619e6a956fd8d794a6a170d61f5749d25f1b03ccac202702446bc0412a577ac8ba36ec0ccca7f3fffc7944e3ee1539870b2cd52f64b540a2521c46131adae38d16c93c4c5606b04bf2f2090ce0e56958466a17f0b815d7a3d226a35e09679371c961f4e9ca60c8274e139d9952b6923a0a560fdf9abc9b596e1332fee9349b02703455a52427f1c8d5c0b15f3c7e1d42b07f481ec0de5a0fe333ae942926b8b3cbc3e98f4982ca131485360825808ee4b33d6d8c854cb2efaa304650a3886804bafc14790dd429d391364daa8bf8d0f5548fb163fd6d0b7a40bea6f18105f2603cc49eff6f2d8c8c05ce9c5193a0660a81aed379e7944a0815ab7f838ea33b4828eef496f7b91fa50e54e3811c3cfe17a38e120d5eb22260632dfcde02a495b2b3eb545312f69f1837161a7bd77a28146811e05f9c38949f8887b73a170ef87a8d5cd6186fd55831d5bbb307d13e3b0db094c98879a009050460772cd017f08115c7a4033308d5b9f615463e998e0a47e764a3cbe992a1399c7b2e169518b1de86a9f2b19c63d57201f1a49913ca73dab8045f96e35692dfcab76bfb15d163efac6a709602a2d0715d018a50b7522c889ba4a9e033a0a23a22057c4c266258efd613499d36e209daad10759f6c64277d02d5a0b030cdc962c5fcc60c260e4a63c6ce8720e3bedf055d35637ab993a70862874336829ded54b4dc0c1d27a3bae9697d8a6524aadf2fb8d390f809d25a61eaf18a72f7a1e1ac6045c52ba76e582f0245b248caaf57040a41862260fa04c6d9d197697c8624dfd9f2959c890a771bc698e6970a87e2e1fd6c5297cc943203df07b38b979485d0dca4a060e1fb156593b60d605626f2220c56eb59e3b75e8e7bc20171980552206c5cb004986298d8bc2a571b8e04a48a794d8fe32aafcd8ce7bf86b44d87cc16c978836b6a61be6299e62dec402cc88f3f48b1072f599830ec7b321a4a59925af126c7e40cd191af4583900d13c4d1a1006e97d5f86ede438301016858021c87ddcf8e914ae52f6e42f235a201e8fc5a0836cb666826e29ccdc02723822ef47c2a73e6109a86072bd08ac78ce34be18dfeeaa68f9b261c2e0ceb09ee61ff0c2e95390606cca9583444b85752fdc749744430135a6d6c17a8d6e6c78d644dd1a766521dea82de5f5e64b1b9d677626baee2293481835e0b0f0dc0486a8a3bc0e3c3f53958c3f95d06ac5dc57205844edff63e6775da905024753d6f4c54d5982d05d5fd0735e299fc98ff456121da9bb0b9c0f11dece21524f13ae8348f83f5cf5f2c418c5e4090e6dda8150ecbdf234f7ce03ad9d20daa15eeda19cadc90a69a1b3cbfb6785302141fd0dd44635d567775de13f413949033b43b4b3ac5715b6421970842da5d19f8253eab5fe578d7b3707d761b62ca9624ed3408fea7c8553a1aff5b00806fa1000675c750d801fd99236fc0ac1c070f588f993137cf99877fdcb3464c803e8f734769835c0758aa167125739e66d2dcbf903d30a7131d199f01eeeac35db58fd646d08826fedfd79d3f337ff52abb7a4de8a0652bcbecaed57741088d78d1d8961e9fd48a48e6ce1bd87762a18051bf03ec4cddeedb56b4f1095df5db1a0a1173ac40d68b8964267655c2a5cb01c0de3dd5f1753974b3e77c251800a067c5954bb8817627f3a5effc20551e9f66375bcf92bba85c5e3e0534d5003fc77cfb011a9ef361572e17f40f54b42857baa42b4cccf4cb0e42372d4e6665b447ae4e2ddb42ca032f55c5f0ff520a00c1b891a330fdf5f6ddc88620f81d4eb949850bd5a2f7f1598c2c2382efa4b84fe8127d5563a83a3ad8ffd27bbac4f78772521ea261c8239e5d19bf59a662fd04f6df19513ebc982345c037698340b18504305130f168563f7ec003fd92afe72c0793c39a4f3c08d73ed4e9b345336f7328b8f2c24cc4fea241d0b80ebbd46f3a7cd7129a86ce042c4aaec2eb954077cde774d98d056571bd0c0198d87855cf786176e275230ddbd3bbc96f1854f5646d63171b8be84f055c987b7e1121af7468bd78ddbcf82a77554a7676dc8c5d8b130c64ac708c5e4e5b35c8f0b4769d1e9f6393afc3fc039670079885d9d5b35baf1062d60a992d1e9736056059c564ed2e8e5313106799f92c8c2e88d6df452c325ad8fad1d6287540bf3787f16d098f068c8b400294ac00cf71117bf4d51e701e6a2cd17e30a44398e82c8edc8960c8440b122381eca6841d6cf7b341c59cdd4521b9801c8fea9e6583ed9c753b1b6e3839612a5dc8704ea2ccee2e1828ef5fe788f00f329df4d851c043cb8af07f8f5795db963b382ab28a4ba533f352a7b79b2e38a2050d21a6621a0192afa8fe0e26e603681594e6905a3171151cc9a06d09fc6c118200aa448a4d0feca93724c3dece3fd85fd933f56f28152cb7c24fbd36fd90c0a9f8b48cfc488163c02072f74a3534bcd3047f43a1a2f7f0679e4205555b0691125a002aa28791c67d86e7e5817fb6cf2ad695cfb05bcd7464e973b3051bfb053c9748c30407c17a499813267a1569bb3e919e232c15014f12471b69207a58cca7bd3732583b6bae9732d2a9fd4148ce799c891e9b320da9c045da2dff034cb41d78f6a8e1bf2d36470768c4a82241d7c6e3404bdf931f98f268af6ace7bcd37d024d3c0da593fc6f2617f0e22d446b6b64423458736b58c5a9f5278e8f51f1128e6f7ce66124b6bbfe0dfe0b2a707c5a093910f78a289c414b28e113f97876ab4f17e820f24ca18b0305f10b0b7cf7decb0d09c13fffb71eac7eb68a0a18684a7f86b136dc2d57e0748cce740feecfc429aa499388686115858712ded81db51e96658c7dd4ba45723b41b2d28b2c872742b9fd97bfe74fb2cd734fd0163379e5c5f5d03892e92c9e729819d736ded5d2693b33c89f282c5b88b1be41ed5c522aa38504f23b15cb1cdd26d67946d03b1fbc8f9650a330fc58bb0e9abca99bade3f99731eb5cc662a2a273b3ce4efaa5042be09516d58e1ceeccaf4cc8e0179bf9b455af9e1ce3bd5e89b5906585f202f77ca867872bceeb16ff875c3811a37b60ac8818f97629f3b1e7bf00521ae6d2e15019461031a7dd59e61323b0c51d673079f1bb766c5a05d96c49b9595ef7bde29d21e89afb76b7d98417f90c8c2fa0ede1c833c6352339e5cc0eda0f1037afce74180ad30579a8a1d6a88e974063e192f90faa69ff67764a1a97c78bddb0e825b51be9293edd93d6b67cf712569a5349d4133bfde1547f5cd60409235d915d514cc6ca998fda285193af81a0c1dfa93f6e2088befd07c8b85262c7bd62af3221d139896a8fe614e478f5089b6e2faf37dde9fa437620ee2077d0b15a5f15167ae7374913cacf679d3166cf21b78d4d65c01b1b7f04bd15d7e6e1a1de4d6fd510338cb33f3252f7ff4b9aa0022d755206bd36234a49e90a353ac2b713e5bf8d6a63f7e85762fe53763dc4036a13741046f766083ae1bbda318cd55c5451e9c94551f8ca6f78b1ac220f649f5216924c77d226fa8b872ab5a6464f020410fe804ddfbce0ecea26786650b94dfa4d6476a5b55050e1f921af4ca80888ca352af2aba880428b77a1d04539251031ad94930c2f3bbfb60553cc1c91c2bc83325bdd0ab2295f9e759b0b83a02cf5e843d4a1d33aee8b6aafc2e2f8761422424937e6d1547ff57a5d8381e49c9fedce5cca9515c1bb0d785ed8b38e487b3839890b3f3050cd9f9038b620c41deff0242541f0cbb0450e51185b612e9889ab44b1cb36c6b47f22d731d6f5191714d15befc213ebd0d8f1e1d77b5774fb5fdc31e31e7d2fb92ba5ab14fb64cdce41a24ca26c45004b2af7db36f5e94b04729ccaddebb04a489e5bdace7b36fc39aabc8b73b1cc0809ff295ff5e7cfb61a675a0e55c2381b17c8e30c55db6c95bf525d43b30b89097be10053ec2af47067ba58b47771524b4874faf0fab2c19994efb40e06873f69267f372627e0c7020d666773252610d37ed209ccb859b0a3a4d69d1e960e5bcad4cdf8c89b487f2f12201d2b491b369de11f1b87f0724f9511920f9e6ce9a96691da85c3ecbfe4f02734b3881d568bd30ed218ccf53d18ffea34d335427dd3ebc2247b84a2c6ebea06d05ebd56d5ec25834e525193dc6eff4285ad468bec5318bb481cc14210dd853c36a21bf7d7e3ff20d324976e11ea838b4c4bf2ff63a59dc6f6253039ae261836464de383cd8eb5b7d2ed6e2c5b6c57ca1de5cd3e7fdc7d06be2f448ffeb63397ef618d9e798828f9da1f57d43effbe4a7803c398bf7959e83480281e1c2f4e000ee42b781bb51cf8ad52ffc4abf407180a60673d133c4e4064f535aeb95880a3e6f3232569c38cfbbb3cbc6142d9b319564df69323d1f93319750c664b352b918634d008d0c4f23576d373e4948f497e19e208dc4538273caf12b7fbef2f1cbbd218d98dbe738c11058d79c08ed064a96ee01503dfa75525002f233e745f927729cbb6e3ed35ffbd47268c748673017813f2f52a36db7b07376045da8a080d02cd3009fabed43d9d307187cc9365e2f66207c523c3d9cf554540802bf13057e8734d419306f0717eaabe56e3f4e8258966fae88f1e17f811d20ab2de84ff3c6786b98ef5b9403561a44458d5c82a6a64652f239e23fa400512b2574864b3300a25814f40f6185cbea02fc87caf45f23f18f472f1422c749d3179542bc60629731403dd2a8815a44adad90ca67984163c63fffd9dd011d740ad4a7d4f8c6c163a285793498b9aab3f84dcdeefc3a9c9443700950787b6642e8d7791050cb70a3cf888c41f6f387761fd0470c50f7a4919bf2bff1cc46e67144eb676156b81568916ad534216fb7ac1f7ed1d1b45e893d783a1b14d4a1e3281c447d3e9d32b27d0ec51e218a9a1c6e2050b0e64e58a49e5fcbddb3f5a5fe36f879670d8f8320389d9484b64569d1f0779d5cdc5858bdd250c17cc4d633de3edb41fd5bb73cdc719f0d5d9b4dcc8c3f5f658489990e34a6a003a53879577bd8e536fc70c1e8213e572a29f18381541993f8db36264d1d8098efd219e234e7d409bcb819f7cd3fbe5e0a4d3005217073cf98a0a4447b17d15a777ff310bf322533abdfd18a6178c5c53131d51633fd56ff5999a3a86b357bc2c3903f4c50a3dee7dd088e4d6e51b689814e39f4c964bc8eff32a5dab4f3d2fd2c5214863e61548553481514f5544fb743c7f76e11117a79b69a2abaa6699371792237861aa152d7c4e1e292b80f264734c54d6e1a85cf86176fd5fd78ea20bd228a7cf887e8d201d8e1f347b30a513884211f817d0c894f26c930c5657b3c2e6a37d8432172dc9a9c2d5d0c938d976f4c7bda4c80d12857376bbdb008a895bbb15e1552b51fca5f9dd89f218693b17a85715a4206eb285736623efec51dd9657154aff0748330b0a93775d4b4bfd3a95219ec364c5463805470c6f6877503e974dfb6c37bdad418ea05a63762bf0cd8f7e3623db056f3a309f42254debaf82d2e7c8cf2ec8297b9bbfbd49dc8846213abb76360f5dd6497d5b45d59febbc794ba036b61ec49d963f5951aa0253f08204626b888b23d8138390e6015c0072343ea01b98dcdae0df70369009e4f287a9c94dc415e23b3567951761e1a48e3520519835cd39c6ae4713382b727f0ff20eedbeb66321a9469d08e6b8b6099fbcda7317450bcb2059f2d9ad4dd0ee2093f6e8a89cc767ed82f9a2fa5b3e3416299b44b9136b0d6a2d07e9f94a21b49a65c07f2fcd4bf63e74844eda96efc613cf0a88aa96a808cd97443bd15eced27850d773d242695fcaf8085cd06686585336e01fbb713e96fa0931d9092a68cb0e6d0ba47c8568014b6606eeb8049f2a2277d003c691f44954f3c1d58f56f9caebbef6fa55c212fdba44eb4fc69462c4390c49adbc79c27405522e7105d4fa37bf4774536108f4b74d893c1261a48d1e37609ca0386e43aa1c8cd51d55b3d3290b4d533eb0bef7d7867258300cfafbd420b44d27d55ec6de154561fec1342eacc2c008d4cedbff84504cf7e37fc4791fae35f44caaa8898b483ac613b642be88aa51e6d8035cbda50e0c9b22ee114c8f181a76d40031a9eedb60d5a59cee1c2c738261b963ec7c9e2d50250400690b890abeca63dc92888c2525544a24c0703abc892c98bbb448a8699564e475459ff2eecca632e6ab73a8a498c54050f401f9ad9c32f3913ad189679c6d5bfd8c711d8cf10932f41c887fbe19ec780928d3fb31d2d3c89db03fd16a9245955672a28efb970d42c2793a88718bd117cadcc07209b992ae042030fd3ec0b567c440512958457310c6cd199fb34f3eba86d71ab07564ac1fd4845fa5111ea744f1f60f5e3ad5d06c43e688ed13c1823d9426e668b3e3f5a66d4b6df416b3dbd25c507d5651b35eb0b5e2f38ee52565f7b623f195451d591dd81efdf4dac265980812d7e603706813d51ebb8fe1f02565ff56153ac934a2c95ba3522dca2ebe899f640ca917d55ff4dc46b9e0fd2739cfb8d6a9303cbe99b3b0b86c38d4abf9f7ee0a0c75913414205f92b80cf71e6508a83ec9ce672f800259905e25fe210fabba3f1323d7a9d6302c61ed119e667f97bed83e08c6997936ffbe3af17ec429a2b6f12a2b14316b6df7fbb4e29353b8fae634ee543a66850d2673f5c6d62dda6c255516efa3127ce81999c2fc4536e4dd8867d93c6b894ffd4137d4beca58bf60075190f2f06a15d5f12c722b9e3c152b5653f63d86ad6bc59cef0eb43300a0c50e6ef6a3ec1c104ae2fb4a8761f2b3e83c7d7fb0e264766d6a15c301517f4c0ceb7804d9eed8ee8ae141dfabe4e18b9f20ccb02fba4d2fb6db25054149c65c8d99c1ce59cba6c25968bcfa5cc6e750f31b428e047e28a8544cb2a92200131c0da673dfa1f6e59c47bf8aaa461e8e57757bb0846d0047d9971abaf158ab191440418bb891555e900188b5999d76970efff3fa8e26619147f595d613767ec9f10812b3fb7cba752945f2520c61e9554fb5dbf6a89ecd7f81a77fd004e966368a2d391fb0845ad7e608c47e679f86ec98ecf21f1e3f71a70ec6ec9d99282807d52df1754cd8c397735edc9e32222967ba1928cf5a1b8266b00cd3f24190aa8bab82eb4278e2c746521c12ef6114143f40a37f775d0d533a56191c84815afa5c61711c3976c9f325b2cb28d3d184a0552ccd8134006b71a8bc96058059a7da5a6afa1fef6bb6a770b92179289f5f59d75a748413ddc5434a9cb08b4090a6ddc690a72939c25d546c6c0ef19227063ebe8e52b0b1f119d9a4662dd36f127ad4b04e0beb97c1974033775009eabd7a7f3ae006ed204b64bf950a44b83744c2a2ce8e05d094bbe24d486a559f3ee2e8b502570a6ceb1190fc29e8a011f82f3c3917f59a943c8d35dba8aaba2a40547fd8e4f31db5298137e203072797f75cf521924f1fa39080e4be9e087e55d1aa8b70adb639c9a67afa86145d94166d06e3fac15bd66742fa0b46075c303444628e690a77724dfc526fb5cc04398eb3a812160063473b2dab5c6a7a98f2d04a3a072db4416aea1665fa8cbd3d9abde74db20b7d9ef7018fd35fd9e72fed99629f3d867a403960362a286b21d98191b0f607e91519f5d74dc98344f86e69133d45155714ed4a43ee8e727276a44abe74cb1fd1fb96b4b1530f3f6578cd596bc56cc89fe3a0b04fa2bf79db7dcf9853eaed5133a1adebe3567d8552f4b598a3c2c909dc57e6b0dc531bf714387d18bacbecaa80376b4594909693c912dc6bbf2f1d6349d892694e1c849596cf9c58deff521bdcbec4e5e00884a8fbd245db1760aeed06ca7bbd74075cd48dac18d4ddc02f8bc297b3f9bae5bf237b83e1fb11ac911283e574d71d5dd9ab06935e97d4acb5b38dea1857381bd2215d5247817904961417b31308ffea5e455a8fc6004e13d689150f858eceedd4b39d034492ce2a414957ac899cbf9678a93559ba80c0ecfddc212bf51d82e7827d753b2c87a336b35de2d00502d966c4a710c93d82e2","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
