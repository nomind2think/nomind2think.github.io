<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"5f9d7a2a92c0c7cbdfb8e21866aa9aa1052804b08d8bb16308d8c6ed3ceeea626073f4a874a7970371e79c6d7dccd3b0e33d1cf64852dc984c782aec5130c4daaba07a5efd8a8556b52c42303beca2c556557cbcb02a7d6457da6e828d1919daf82a6fe0514f7761097d9dcfa6bced938e7bcc5136005b4228b62b0232f23283a66d89f89a361d96d3e356f84af6bdda55d0bdcd286f55e80ca11451d535e207c5e82aa055bc1b00bf298f331d5849560c8d849037c746031686d6b2ce89a547453a50be94c77a30a412120c117fae4e974bdf4771c29c15ca5b6464e3c31273304ed5fbd9219ef9fb0b7e15011c5027e1584ed867759a7dc878458eb850ef288c94b2c78e34d1ee55556e75617278f7008aa79d94557e40d190f767052747868a59cd2336992f479701a12924c953e4983c6cfdbda8a216bc0a600d3795660f8ef9b85e379c07fa80913b1a885bd954f6e585d6f827e2f853c210165e5d3f4930a49070eda7b814f5b0ce6e1c0305ace61d1552e4d9e408a342cbd0bebf4e475beaf7c9cf78afbbaed054be9161a40c6a55148592f68efce5388d39f84b13f86ab4d48c0d34b6c0f507fd80de7d10b7c9186a27a3874736e33fbf6e615aeed8498ec12c439b7075232556cd1c5b741c869087b35f09649aed367d2a624b32178ea587bac95fbc6fae34e82c61d4e247d5c12fcc529afa182c33d1d54e7323420672a42fef18c5e983d8364f5117d1c9521f1f8c47a03c54deb20f5b412eebbab83e27f9e9c49d3a8feb8357b5207e006df18d055a76615bd05920836b491873dab93a1f1c6f53a375530a7d1a87c4728ca34d339fb5fc612028dcc58ac3802484c0fa260a5a6548999bcaa39b84cad39d33ed1c26bd027aeaa1557ba192355dac97dc6f9227b4577cdd85f2be5a72cc43ef4c5c4680f2f4c8ef512e3fe03222a177dc3a1eeb3b8ea3529c0b291aacc08a75b0dbb18f9351c5c0cf15a036abef77f463c0941e7df0d2100299813701877b75ba9d38c83c1f1a17ea49d1e0ff56407cb686e6c094b2a94c9398987c14b296e6a1c81e9cb0154e70bd1b221e8e17adb8d54642ad670afbe36f9b925cedb706f4778e488bdcea9c0c8bb7e06031348637e992bf79979cef5a238bc282a201a7cf9c81d04ce30a23ed296aad851614a784f94e160c4164401fc8c8cbb55d54aa12cf2d2803a8994cda9e8477ff7b4f0c5c7209f7ae0da5fa0160aeb25657f472f6313f32a3d5483c58b67fffce9002756459c68da97f1a4e20c4f86e497aba4326f2fa5c0b120f8e9b256f8efd41847226c45180382b4361f785873b8a4be9c0d9008c2623ceb9b282fe595a8ab73ce9bcc4d699ee8e975fe86322f014bb0bc0dbac4cbd8d75840d1b9d86921a4b6f0f227aac68f41feec567c93173a46478880429aaa0bf25fa40ddef00810381ed685b17dee26ef1bc0c316a8ea002a351ae1a3b25e21b6e24cc5ec9d2540bd120ef42d33c9cae0cd708614def59d374edd958d60eea682236d7976fb7c1757d9dc7d992723739232a8cea6d83073fab087df1bddc1792ce233a60a61bf40c37ce0d9baadd7b708da980f3c38ccbd5b8f144e5fce3e2f631f8bdb11693306a2a290730641ee1913e867ef84e890a64213bd8f5fc9f7b5838bb63f8af8afa9f2e6b14ac423d91cab94afef57cead2ebe0c86a38f03154a71b5c3e4c894a13ee2f1dff60f3e8cc287debfa797f59cf132c2d8b3450cae639e9e95dd486b58c933df05c4a17962be1d8c984951a7771e90dbb6d8b0fd3e0fff7745228877429126a8676e7d111871b71e1462a5971ce3d0cc3e6afb0fddc5a619617202e605d99dd18982c38c681f968d22145189d22fa5272853804429d184c7564659040d1c535747677432b16395bfa5f6c029c22b11907e531b77634bd019dd0a9586c98e5e76ac37f1f49db16f8e9040da7c7baaf478cc768a23308695464839e275ae305347f0e19f0455bd0d59e14ec4b50548671e14f8b8bec31d9e61cb9ceb159b7daa099e168d34c8f6d2138272e800adf4a7b107548c4b33c4eb5585b68c7a0681ef0d801d378e9c422f5d88ff5cc7a8d589b616bbbe9561b83a3892fd92b0af308f1c9e30d08cf58288e18afe2a5dbbd7eed395283614702737cc847f4522eff2bcd7d296e241ed5032f26d7279a73757108cc3868c3390348ef235804fe4a290d968f5f9d084da9fdebf4f4b53102ca38aaa692180754390d42d0c8645be0cd8b37be88d5c79669b0ca01b31c3809bdae80034054b926fe4f37cb6adc23c8d2523ac215055aa3b1f5f3e2560fcce6f9a7ea47608b4e9a37068761b53bdaf53fc8d699b7e5aab5de67410a34f467dbdfbce7e874732ea2963261ed0e77aa457d229d724fb8c80e32c31f28f312053fddc3611f4715b75e39d3ff10987f5a6ca3422f1b0a11af40c682ca4a53a7a2ae85f5be7e1a44751a01f0c7b6f325721c4f5516d0c9ae7c274f30548af90211cd2227b9fb73ccb75dca5364dc42e1d2fa63cd481aad4a59221640dbe533a53847325cf9250a7846e037b0a41fbf400c6c9a1687af898965574d870566385c29c6246d6c5fb1a5d5846f0f4f04e666f0d0fe05fed5d53369fc152cc37bf722214fd1f03c3d7637bbc5044242e138a7dbe49c5b205c79f2dec4ef2b335ab410d3f02f98214568efcf68a58707df007b8d1e3227a765df6024c13911811ca7d6b10bf1d967ecf3c0c4e75d0540f7d018a8558c2f0a0b9c6a40d7223cac9878127c2ae1131c05edb33c55456dc173ab36f297e1ff23aedd911688d4a95bdd2c58cda2bbb78ca087aabefbe13902c25aa0e929052ae87f175454930a514c4030bf245dcc3188f835b5d94e87e8462c374d5fa2d2a4c2c78ce607137331c26eb5a32833d8c86c69669dcc1311fd5e76dab6b9fede7e05f15cbb220814be756e7b3950944297009de1e2f5672854abbe4df3c77bc17fb013bcbd042417a8afa3319af1ecd47b7d41be608429e029d4fcac7d0ee1fdf476fd98cae4762c22852a13e599d0c8d0c27ebff095b991db53f149cd9b7833849af03266dc7ba5e944e385b2582127e10d2ea0c015f9cfcad0b7bfa3ac16fff8c994fa7c8a3649ce64d842633b3006ecc265376b0831a9fbf6a660d443cc224d674deab7723f07a7d7d89dce9925a4a994bc295e879ff3623c5a2685f5dd32fc6708bf0b64126a53c262b1acf399ad04bb064c53d623a5f79221a51f80a08be2daddffc588877318bab15067296399b59a3ce4f73ba564a12afb4a6d8f54b335bf5877b1fe2a22b21101dafad3c4d29533baebd9da6fe7376682cd5939c23cab33f25073df923a38e482f880642dba5031bfa66adbe2c00fb0bc0557c01e2162c319465c9604115b64282e015c93e4907841cc26add98d40997a57c3e34cb5dbad09d57cc88a272247a117810220dfd2732743a5afc3f6c685225071df2edc23d4e188f88956a6e6c576e68e2bbf8c6fe593b85e1aea2a994dcb29f474b4dff95cd8d79c95393f2ddeead77c6533af11e6b973175afb86bea0f1224f0a456327ad3dfc453c2885a684caf49e0c3f0d8fbb67d36f01130695269f24c494c1fc1e6581b1d2ad569a56e07b899a3eb9bfc0a62620c33c52dc506c5743e4d72628aa013131080503e1d7bac7e280689e09781fe611cbaa9601c2f28818db49136a1d2a84fcb75768c368865fe4de9b6f96e12eb1881eccb5ab716b413f5dc49fc942f6bcc8bfcbe28a96a957bfd31dbef5d71cbefe46d5b1d026bfc63acd1d85aec25cc2877792e192d67f51c5e023f2e018ea324b635e628de4038cbe3f7e0bb2991449750a2903d969f3f8454d732a1130a3c8c7fbd4e4bf371898df9c93d44933e9fe9c4e7831be943aff5e84bba1cf5c553af0b34f844d283a03e8719a5c4bd8f6af0eef25e9b4f27016ce02dd282d2c0ad85fc1a7642480c76a50fe8806c6a3cd2a63f234f835c6826a889e017751b7f22f7bda04affad25f9073487b9594673930db38240ac9c48af02eaaecf085d4866ee28e3014478cbb26c0a988bc83b4aedce987ac1716cc23c50f6ee516802f0f6487e84047b2937db19935538f6cf0d245e1e29f0c92e00f938428e2396aed2404cf04c9ab4760a4c1ad01f8478c092b4231bff49de461d386dc7e3624a9b93a02677c74200aad673e54fb6fb886a9e65df4c5b33a66313e05e8e2f42a3fd27640fb49cbf930054c26e087594368415e49e1109099dc96044efbad8ee4493364bca6a1c68b1120a5f311d2835b515019b3f0a985d3e20dcc65681dcb3f919e52f519f2b2cc1a55f3b744cbd75d8ce9a060e8367cd553b96ad6739cc917be0f3fbdddc6f3ab57076b0862e8756cd079f92be292efe0e894afdb79bed0369d44d06e93727530198d020b4a58b85f205988d822df26f7b48b0a6451ff98a84f964e47c859b2ec7c1c476240c0bc310be07d5d60605d411918dd7c70100491498d625b21f48bd2ea4dd573231dcc6a0c00b14a8b8b698bc39270ad925f98682dc08f1a6f43487bb3c986f47a929a14a04f5229e1e85786dc9cdf2bda739f68a48ade4e8860ac493b7ad1bba0bce836308d873eeb95181e398a676ccd4f1e405cde4e6cf7801e3ef681a29ce54bab66d3dad3b789e50062e82da3c002313a8ba54b0d1916a107dd7947278875b800bc6f915672379f31e8cac1b2c69149cd86f1f4dc8e52dbcd808b26880e2263fdf4511113734ee4fe0acefe2b137fdd9a0743653a2390d9ff4d22a9b20bc18ad410b84857385001fe5a220bdbbf00e156153c378233a72391fc3c4c29cc7e9069a14fdc2a72ae4e28629afe6411082ab24c1b0706a283b67a9d24253a8de06a93be99b59aee43a122f2a5883db98ab67861ae836a50bf994c5a873791e429703ca175a6f99db806d93e5766bd00d772c7d11702b76bae58fac8740308b3142f968c7b4287a93f8245fff1c61b62d138330e1be35ddced540737c0c22f73d8e6f548de6d67c827d1c0143708b205947be1f52ad831e924f60ae9caa94bb6e1f943e97179d505c8124682eb8734a26960593630fee2f57b666abdb6b64406b777d0f34240e51c1449119ccb9ed77d3492b3e885f69b2cfb735fc34fcbf1c1bc77017f81d49d6b8c895c463e7e6144764fde3f535fa7090cf0fc87bcc4e8364b74d8453547adff0fd9d890619e0738f9ac0543eaa9e013591454e1ec1bf914b7248b3b7a5512ea91adcfe86183e9312250f38a779d8f12de173a04f6b914ffd5057312be89bdc2c424219b30067a477fd7aa0a7486ad336b2b1e3cd1517d66a7877c877608c3e98b3996a25ffee59dad28bea116d6e658ee85369c8fc40170c1b802e09f3c1c5fcf7a3ba72f933cf009b2696c327ae05c831d45f350e3ffbd6846785b21d20e8a93690283218cb3c52c88f281d935b533af04ad8b99e0f91e9b05ce5957047b46af191affc772f6fa395eb90ca0235a96748794bae905e629241c5ae2aa0351097ecf33c80db226ad60e49bc93b6340fc440e1fa4d0d533fd134ec3997db75b3d993bf870f04a507e90b3b56223c7e4f4107ebf102886caf73bb0beb32cb428f6626c3924de66c8d4ee36d823b9aeea89230b7a6c112cc1336f539a0e0975683102968d3132458c5e322a64d56cd40d09dfe51170219d4b88cfd2291f4881a31f9d916188ed4c760601b832c4b41d41c5b28dbed79d4236a85d322c673d898120c17ea01ed9fba27316e4c15458cac5f6c0f987c1cd52181c130b43ae5a3156eff96e8d6fe47eab0dfb1d855e527b65e4a12da342d05cc79cefd2470fe1d5519c838b027d848ddab3310000ef5bea4fd056100388db616bd15ed003a9f8b09b0a8d7c10ecebd13c858772a09f9aa92b979bb4c8c5256793bc78276aaa5052a419102762947f7bf515466928ff5d1df0d0e97514f4f1d2ecbb2502a55854ab988be197308a4c15805c35e5b0adb43cc65b7f67c1cdd1671214bbfab36b11454d7d2d8d2aa7ef427c62cd3f8688fb799b5f89654f0ceeef057f32a46562cb0adde3fd935df788f5a7cea72cca687ccf6da0e75b831a0cdc7153bca1803eff256b5519fb8f865581df675a3ab2f4c578ea8b1f084278839a1c687922a57d362288f118c7dd0a638e08f58344b800657761569ca37dc22d548039f5372c6afa6988f52caaf1eff9e582fa0bcbe326ef04cfc8a9b93a028a5996af38debcf6bba2192fec5988c48ab22891fcda82df14fe830764445aceb16c8f4301f255ba6f8481fcb67b40bfad8ac4d035f0d5f69507542adc1e4a3cd6994706ea11c7e7a4af488b719090b4f98c3203016afad88ae5a40e583771fe52ee623ec9b9e910759577f15091e54979a42ad1df612402ebee02edf23400b8f37402d56a1663e625b8acd4c2e4aa0bb413d93b77c858b9acd22d4924358a85192edc3aeb1b06d5f2a769de1c6eda20e79c1e6dfaaa82c68871b9f4502af269f7930a4ac3d79ba4b179f8a54f221b988e5b9739868b3359efba46e473ceb936dedbd70dadfd0be98ca9ce2fea9d41880330c9e32408a7a90fecb4a2eead105a29cdd43ff486f2fb9dad0cb48f04148c229e718abcb3189f0804814383ccfd82e81d9f2ef9eb6a4214b3963aa0dfa7f4596cc33c95624712b884e6ece19cf0eb885a3b4444c9dbca9063a24d0bde6ff44dbf84b082302cbadb5b3c805662476538c39572685efa80dd0cd35843a285960fc2844f840ecd4c21a0eded4d249b87faeb65f14dd3944f6190ba2b138a2a5273ebf4d328a6e45dba82b5a9d2e0960d96a3da14acf672778f868501883e92cd727454868ffacc6eb5ec364f722f66be974715c4e9cbbbc3b5d6513280a4d3a94c62084ad97307662d9294f7cac70e00fe386abef3d0256e64c8ed316d0eda92219d29e7b50ef3631fbb331c99b16df09050d466ce8d80524fdcb5e998d01dd3c3761ca4af366deefe701861ce5f8d29e84cc2302dc95d32c6d13a6f9e439aa9d41a4a0a5b573bced39ace91904940b581a831788192fd00d992549680e61f16cc5f588859229d1ec22b0ea33d1614b9ad85bec4a5c9cafc75eaf3b9bc330862d928e0f421b219bd9c513c605c4ac7109d9bdffd39e4ea3cb46def824c3ab466835560ac2f0a10fad2b26769a2be1ba20c54b44ee115f5cba469df8376a79930c629939226e5733a40000356f989aa58c4304271e5b56eabf6b65f59a1d2af3f6ac182b2828732a7e43e018993233c693a5a68c11e32ff57e1e936861d8a5ccb08378790031e65fd89e5b5935c2afc3014ed6b9ea2a58bef5f25edc5e7f00506ab429e88febaf5d2258b49b75c617c696753eb752bc34f0a762f5c342a57222b6459e4330730e8658b52834300263a94aa595bd27dd81a728e60340ee5e3878c0cf08ea161d2473e68bf5489281f0e570453de83e0c75fb34e2b2805dfbad882e548a555c30792bb7f4d992c3d0446e95c6642b8e59b7fee7227e29fbf6fb35d07a18a7fb6ac9ea96691b8076eb6834928f665fb003ebaa59d3cab20b3c2964f91aab712102ffaa46170025c64d41dff0142f9c15af54ab949c34c70c191963fd4dfb7b8b09d7fe94c7c0a5b1563733c2fbf43dec982911d12e2d3ff343874131e39a592c28bf0899421e88a707234961354180ffdeac18b74430db2d7d0f326e192dfc636162d1aaf088ff43eff02eff6b3326e70756602abb3cf3512b9b4aa831d0abf207902485f3f31b5bcffe309dc6757ca83ce50da01873256c67d5a2b8a3139139bee9abeff2eda842b842a0d418742686ea10d0390a4843b7afc1c2faebbd685470b53d594c7a7e86b8f8ed13695e2f93db394d49d104de9d34b16dc3bb36e001c6f84f41b0a1d9f38bfa759ab6ae97ea7accdad32b4798b7442ea97f29003ff28d10a4842fe03bcc04ae17c668b7ae5353d8a8e8f927df8d2213903606e299feeef51c60ba3112d31819e1171585979ee7ba742b186af1db73a70122d0922e7a1ba3d61978b92fe0921617932783c70c6119c61c2a9c4226eaa5f4c19178f9cbbf29713e828fa20c3559adf3d6757f785a13d5e390f25777eee6f08e794a6ab629232459dfd1189b83fdc85d2b2d5443f1a9626fbb7589c4c85723335f06bd71ad0c53a871f37708c60cf0c37681863c4181e7f763bad5788705ee326954a2bfe465a5105b39ea29ec06a4ba98e9a8ee845ec9673560ede826bb05321355967394fb62576cb758e1eb8805ae1df8e8b1997e5d105135de378226fda81e16971781cec503cfbdefe404cbe3bbf083c0e14473dffe88a86aa8922ef059886f8dc579ecf608307a7a01c2f85496f2c7fa1587378a19aca077857d8d81474f86b7b9f0cb96de26b4e7ca6f08befb63140002971abedeeb3206089bcd30f56f4cd3cbcaea72e811c55258a49f72b42281a51066f8d7f51c40210f4d8cc75fa41aaa1a9e7e4fb3635ea1e250117eb96045c9e3c19d67d05289e79d59878c80cda1f1e44058a35c4b67c5d7117b062dc015b2af306c21a0dc66cefe85785eb5db7b135fe9f070a0a2e1a4cd4d4c6c2f0fd9135d7f39ebc178e6d97015ee3c0f5a65f96ac020c50f5c19525ce0dcd475085e38db8f902b58bd4508ca3836c07e9859e396e9255fb923bfb7f2ea34516132d2e913f86d363cecd0cbaadb531484ee2a24573964c321103c975c4acf6168f818e27f36c06e9d1978a2a2c73415872d718ee2b1a838d50a9d23341128f88011b586f2e7081c889173dce9b03f28e8ac317c4e0dce9e1da0e06d472327e90752cb41d7a8307c5aa997de232522f27184b6e75a3404106743a3a07b687227e3fe9aba8b21db639d8e060dd183c0d6f1dab1c35e93b39c7d0c97c8515c18b7936db0c718d20d723104148e990a2936b4325211f7fb2d5e1deb056d7c4a5f23b6f9ff7b07c4ee56b798b91440525870bd5b296d52a7a1b0f7f0d92c7575c0898628d5b51e4a6204ffed1dea60062ef0fe28722fecd7f1cf4f37be676294a0012433aed4a6e2399772e625005a69a969d48292a44a6c14d569a1f217196fd2cfab0b7d14985f73b245ddfced80fc8eea5facd3764eebe22097635c4778c5f242aecb9428ac3a454b7833c8131c186839780acbdbae971e264339ef110844d46c4f6bbf330a714168cd8e415a65e6e1912b0f0ff20617d08236d45d57b530df178c5338d1a12d4d861e75b3b8af01d1966dd1bf1a4f6521ff6d6f6921e5fe6dfceceb6058355324973b11d9425072b1f9e8da52aa7e72ea782594485da43169b46a0d6d33a05a12aa7c08963c1969e08643899f03dafffad4af09c5fc9ff1fc921ff89d9b8d801f387fbc37b9fca4fc0a2a3e42522d66cc1dac16d14dd35ec6b8ee6107766f13d798b8e0d487c63712f96129a73f666632c55f07e0e49488016ed99707292581a451ce880f2bcd7db9df03635ae0e60ea35307c88b325006192002044d344d3c022cabb472c7fd25e0dcf8ecda2a99b00245db19d3911ef7c1d556adeb3ec7e24ae76faab481f6edc27c6ffe3af8d7879e5a8aadb9d172b84443e4415ad4e1a446cf12899d3c219b82c753e646308a863627eb1c1d82cf90182a4befb1860c8029ccc81bf3fb7522a0eab2d7cfe3f5304891670ea6b850a196c065d8b72274b0ed645ea8d3e625d5fda6c03bd2bd58a3deeaa191130ee6732f300e02e60dab543f879eada172f7977fa9f17e7c583c38bb5a5e4cede6d37f1ff780c2aefa0db736be65e55b0f9e0289169ec7af76ac178834e0f2e2441866aa4ace13c0963c41942785aa8ee93a7efa26deafb236facf444454de221815324612ca314a7aa135fa06280324183fbae73705cf87b52212224d980e55caecaf94f99c5dffa5abdcde16ac4808f870557063082ca2bbc2f99bd53ff9ba6a23f05127420684e6a102c950a496f82f48387f3374a36d634ac6d421e6d6cce92c8fbeac6cbb46e1fe25defa8ddebff1bf0a2f2f5f5f96856ceec45ccd3d87c55258a1628623f8dc40eba859642e48501d42cc8c0687393f5eb62df251d85e4c59204ceca3cf742c56f21100f2b9830183a2b206aa0e64650c292d0e505d7716b22318bbe9ded2a25a13e1fb40121663f0c7725168d84a53111939df4e38bf5b2c5692b5cdefacee76f33d2e4656089e106bf263815273ebd43c36c950a17af9ef4a97ac342a1076a7d0e67f3377ca8bf95673f790bd2467521b11f15337ead9997557f3c0130b663d49be340dc266b64a1932f3e038e181aa283b58fb6814cc32be8ea5761b66bf01f6f196635a1f41d4aa20660af9da636bf2948a61e4a1c2bc5d26b2726f5b77a13f072f7b5c46b41bcfdb285389c3adc296469b3bf5d85072cb88d0a5aa1fbf75e6da7424e4adbf9fdf9f2369fa6eec8045489819d3415e4e3e7d41b31c80daa1c74a39483fd1d5237db835ceda7887b780762837969a6b4f41be5afe7ad90c3f6de13492589718dcfaaf61643292f2861cb8a6d74248c7b904a0a78476f5122823addfc328e58fb0176f493834839ce87084d0a9d52d1888ff181c69239961cc74ff6cb97b357c62aac3b2a6c9ea6f19597e13437d4a3a5110349b35ef98f9907d539c4aec8718cd823fac99e9e1592786d58c9c8d6b17e8d45f87379c7c92d5f20ef70e7ed5c0253703adb6c85b45f250bf4f346e20ce57cdac1f94c1937252e838f11f671d940c8c000f92bfad1f643379c6c6e6245474ad785718e908b69d6023f5e2ffd13a9fd14dde3226b8ec631fb033df44d9ad79304f73749e7c0ac9f59e3b43ce1cbfa7912ca3bf7cda199e662cff9b7d66567c7f918bcd0e0657c7aed27fbdfeb1512cc0542514f271172efbe25e37e04ad43cee11d80a7dc9cb81b64244130f0e06340cbfa553bed6e9f6e6d025b58bf2a06f59a9be5bc608306ca13e075baa5dedaf1ba75057fbfb73279e2de18e3c571491792fdcb5bddf9f977c1ea1c5e4fc31afc7a6116299c0225abad1ce3f8a43787057d9609e70e4399896d544b123dcd82dd60bbce6f332acc495761d41325b1f0ce4cc8c7c42e605a6e230d5af1f24cd78f4421ba2db2eb2d67792e33487063453b42b9b9e39ada1263f870ecbb157004ff3821574d56d2c4f22f82323d96b67821d31ebe1e5eb8713dfcc54d44c0117c2d73b52e1e0fa9e070e38b5ae2398307ae55e4b93b2f1d31487de58e3dfe14b41aba67bd1372247109419773ad1d267c7e3f14709d5e1444693dd72edbfcf8b64086b84723fa15190f35a0fc3339090c46d3ef56b55786aaa0311c8dfe51ec6f5757d0f6733c27f970d7ea31ecd4b82835b1c23e3d3298f41b00bf00e79f6939efb22e5fc2c190f24a7c6f376685425471c47a63a18cec6a00cc89371e5b3dc433b69b5166f6fb2438fca4405604b4439a48481dd2fe3fb61e72c4b8b9f72c260634d7e5a8f130b9c49c34897150304ad7d20b3c187e46ce7bc72fa68083f07ac7a89764db9bc11b65f919eb70ade2b5ddd3b1291c1b1e335d9b719991ad92e3ff4529e1420c81574f14c91f0856d2cef0adc32586551a7233583b18fa7a8ba42c66de69f379c621aad6fe41275d4489cfebdd4387044c1b82a8b32ed795e8e0c7d85e81f2d89b3e138dbcc53ee2f8883d893d4eef28122d7fc824a08a316659d99216e2fc55de2e824a08834f96a1a04e07855666e44181be8299abdcc709994215b53ddf983c5d872fec450ff42dcc9fc1d1e895cb49da7191b58506de59360a24810254b8c54d952a344c8184ef2fc713fac4b462fc3a7dcd882a2b92de3f9ca1e539b29f3a4977f5315b09ac811c644e7e1bfed336ed8337b8c85a9777c3267f40322b143128ee92fee523364532a0a352ca2c3a3e4f9bd407117e9e2c2cd1a478173a9cfa2a328a33607eed168da3ff75fe055eb3b66cd481a7544397a3103c9830148928ddefc313c62a3236cfc29d761fa227d6c1590dd5df96e70aaa4d0eb8c694ff259ba91e1613b656c9e7718ec823db0915944e31635c842c12e3c7dde22b2b3b2fb1b65c43e10b2f33ec5125d1f2bc8ce3d136c12721d6a01b52857407676ed88581f05bed9aa5cca8c089276a09979f168a7f559ff908cf82e34e51ae9a482b4e8e36bc503aa431387b9cb8eb3e97ee2a539ab55fc809f095080ab3799b86716868480670d54b28b69ab1dc8783585f03e227acc31068458ca15e931b9ae7fe1b24bc831359e22bb13c197aa38a2f27a79735724310fe0fb7d13d58f386b012613b0dac1e75865d8fe395953c2a76eea65d3dfaf4b7114f41904429794f8df617064d3a11a6f2d72b36cc7a2416058a95ef63cfac850c47e88d950d28f8d6c0c07f2e68552e493c742817c55d1f981354a6e36b193898d32a4a03b9e68852c1b99bc18b093c0410c1e2ce6aa4c026b066ba7bbded1b8166abc6322e2a461d56f47fe17454edb3769291ea23183474733b01cb9db3fc5964e49ee25645249b68f732f7050aa9f9798b7a991a586201559e78e5bff3cde31107f42aeb57ada0ed28140488e23bc54a8d5a939bb8370d6560c9f42454e05f498c0f8fa2e27ab1dbb931363ab64d3bd208a4e2fc04637ea89db28eb40d305e504fd8911170b1e265ce511fef349e680c74f1d94c16c99a62bdf96a9a0d13d74efb2ed6251513857ecabb3337cdb2f34010dddd355ec01772c058d934ec244141843b800347a064cb58735c7ead35ed0d22c92afd002cf179d6b32e240b4718bb66781deb47667982a8a511275cbc0d97f04180fc70c46ccc57cdd680d199439338ac1612e9bb002d4efefced6c6ec01628aa3eda011540302f1fe593c51fe986a96f988a97688a7e9dff216fed6cbaa7b90da9445ba36d3df55a45c8f1e714a9c3d42788d8c8aa6e6f0968fffcb5470801ac7a07cd21c2ed91a0054e8b1a323cd3a0b0dc24730b0e3a1546e6ad14cd3b4543a60ef390867aefad6d37bd2a2535bb203b41a38cdf656ed9756ad182d740de0abb7bd3a460d467e52dabb6b696af69ac636d2a44e5489d850ab86b99cf9a1a2afa9302cbdc6cdb87d1a5d30d084d8efcf054a26cbd25b9fac3e3a2563c5232e8893c7f3407322fe9ea3fa23c6fb511bab3d2fd3eccd16cdbb50738518e6a80aafda55c60286865108b26c9ecd13a1cdac9fc406fdfa89adb105cefc28f81a388224781099251b414529ce1fe5bee7a64ba7b4caca814dbd86acd1966a9ad04005bd844030b3147797f03f9f3ce0c452f7f790d69f8cbcda6317e0768e4c0b118a5505e98b7684aaa5990a7fabfcd15ab5d2302b42f78cf9161ddcc2dcb37b0a2e6c3a7323250fb8d83c7016d34edf5fd5b2053fe2f46f8e39196f796270e26aa3659f52ac3a53cdfca810480941ceedcc4d85d524c9a3b871507972eb9260415f107881ad45ab23985cebd2d117f7000161033cb318f8175e1c054df7cbef1d236fab343f0d6769c48a69f2924b30cfaec520d5baa7de78c2aba89d41dce2f08aa31575f3ec6893684911df72eb8c908b8f675d9d207e64d4a760098ef9a8528c7186cf8795d0e6f1831e51357d1c87ecf194b31db3b7f62440611b6201250d7183803a79135add99e63e165b94f257ca9117151bdbc8704d04b80d0d4f4d71d8dad2d6bc204788c647134f1f1e1b076ec0ae0c548eab50c1223902d0a6505f033d2b9d36eb3c2edcd799d2061108a3306657294fce7710db327f2b4b12fb33856a7981e9dbbb6cf711e930c2375fc841978006c7e36bc357b5a220c8a18d092e308ab5bd45bbce11a07641db91dd2fe50ec014262660ff963e9b0635f6e2befebda9344cbc17b47cede208e86282c2fdeef48b255c1aca3329cbadd46430a14970e251a8621bbd433e1bfaa933cce2dc7e8563eee5a024d02a4fbd0c6a6973e8e155fe8369a139c59914c2285a13327c390ab467c7dda589e8c8e348e0a7f514e9fb72d1e4c451e69441b92b09affc0714b0b537910ac8526a4800b7993b7745c4d1ee294a64c123c2a4f222d3cf491b37a40845afb26b1a1c22c540612728d512d7a743124c69ee4b04889f55a40660990cbf998457c553b620c81336af441a71852c4627067b271331677f4c01b4b34d903a467ab92362e5fad7cb57431e6297281f1e6276ec53bc86b7421c93726d988fd6dd24693e2a4e470a3bbaa2c52f8987e2eb72c671d52e19e04f8fc7f250c46c2fee9b068ce978618557d0f588fc075fab7b69874899aa5bbb057360290138ff273aa707cc88c9fc001775ba5382f4e36092da8a7204c8f7e2c8837231f461f4c89b38cbf5b052b3a07f3daf9435e11278762aaebb06a46761af7e0bc73f2f368e15fa426cc6dfadf6364370051a067fc3101c4bb695474b28f1746e605ea4e5461d221ec78e90627a6e0e04b9caa25a508577d743897a106565607fb610781282587fb8f1c5a57368f9cbfb52f2106eda09abea95dc3d312b7b8ad20237c95cf9b3bbe6a667edbd5e23d1fd2a348b5e393910bb1fe5689bd0f710661cc26be249d8b08cc4cd7063eb38e30d18a0012a7747973e3025b2ec1422f795d6eb0c9387da5290cc176511b70a938f8f666a33a15a88b809097ffeac9d3a18e65128db3b842c0a3eb389c0178ecff47b7d113498153180f3ab46e0fb19cae50f43567490f40da1fed0c6cdb5fbfdf4ddf9e28567d2e90d679bad81716bf8f92d85bf7f68d7bad728722cb68f9230062e7895f3b8793a7ae3335aee4835ad84f5a8780197b8551b72a8e2b9c19308bc28c7e82c33424e30fe0c66b76da4077814abd0df62ec37490915dcfa72b78fa65ec16e9d8e8aa38e9637e215e372cfe46268cc32e1453fe63a761b5202c1c3c5a2885f3e54c22a6fa2ab9afc932e6b16df0ddfe6071a99cb8f089889dc0a2d39478e8e6480dd3496869ef48eba775cbde1a9a57c7b97d1e82e67c4ed4934b9cf8b4338c9fcba0bfcd73bec83b828959d513f3e80be8d9e62a50eab82e71676ed4896800ed0e5546c973f3e110654b2eae4fbe5ab6fdcc8bcff06bbe2cb798eca3b850d6e687902f0ae9096aa27c7aa05ad8b01b213da2db9774d51632295b0b1073161cf12e82999c8df6d3fcf0b14332f4a01e894c46b51b625b63a9cec256bc919a15268d1d8fafa0934c10ce6dea46a55e70aceef9c705a1f76b35c852b1b4ef19f6c9271412f216b62930c588a506be03874b24f62d84ac2b928467b3e8a0f4aeaa5a540889badd58680986dcb4e3e3b51429b4839a2f2b5d76cca391067ad09af21f19c9bc7e218ed9614e2b4a2fad7d13dccbdf04ac2e21ae71bd8cde9ed8d795a3123551d6bdbf518944bd25f24b2273d6a219b1e999cebd7c4c9ad972ca6120fb911f915db0deef772d2b78197a254523e1da2f1a5526063bb10ec79e15001a8a96b61df629e7a8fd3944acb3f9d87879a545726ace75d6f9480a4f7ae7da463eb2573d7f0ca0bd6b8d2940887441832f9acee670216a8cb8b42c85a4293307d3a3318174f4e17d8cf76ca9d809f943c0efdb18710ccb602196334f19d8ea9e3c6e32aba8cc6791a1063bf077f73e2fcc318af678d1e8b125cba40a5c588729680dd898f615699c5dc44198495d6e3333068ce6847a9144ab42b2ac11b81e8ce3f817be920eb042d80893fa30f4ce5e99a3aa8176c4aaddc0a604bf2ac7896802cab2ba49f88c98adbd81a58676a5914f24a5cc5ca88555472ece12727658a791de9cdab396f86358d1dd9a792b3a236ab7f1de88b54191f132a49d9f577e76904f93d34f0dd39852f1c151405d27caa55f069a8a08957b41fc27a04817c0459846e9bf5197c5ad006304c5d928cf08126e60d7c0822a0689d3b592abc2fb915062843a86382bda54a268053fd8d91d9d06d33019f48f79357a578a2448af1ddf73b81292766663596fc5e020d86703718d2762b36e920e4f9893849c7e15424591e3f9aae1b7c496a608217f2419d8f59d56475aaf9fe9e8dee8bdd36e633e66aab7050304fd0d793db32aeef0e726f96f5d272fa446cfa24304922924c7877a89f0e6fc1edce135ab7653cd1fa81a627643c668765377f2bcdc1d54992e281e889ed61028fedc864cf7472f9d91518888ff177f8f926bcfbdcc56982323dc91a8d76b54d537413048784bb41c7590e620038523541aa37138220100137571dedba5fa2134199745541428acd5313ed55c33c92760fceb2972e2d5b5c797d268b2939bc47e38106d966a0b4b5c69a5225cbb09e7fea7711d0931e943d7a9f1b8d079971802f724490d449e24e5a3afd4d85bd2311040c4c716973378cc38780f551421390081681799ffd3805e25212b890f47f70442b1285e6a25d0af9fb74edb734a9497d6591bb97fcdd14d7e9cf825521cbc4df7980d417c441c726eb1da2595b2c1fcd7f189e010f3d23f613cb30dc9630d6074055f46f219218483f707e6af06543fd9e0d78f1f6eb2ffb04674485cf76bc9dad88f952b8d10a277a40962643e4ae4f9fef6d709f4300cf090fa275cbda59027d51d7ef0c6c8ee4f8087c3f83b43faa5fbf9f751106abfc038281ec7a6c844d48b105b6482474b73be30ef14d0091cae0f19d41c02e493dfedbdac51b7fc6e27db5480d12105ae805f806d4800aa9808c84be2291b7ca0cd5ff0156c51e6510d829fc44e14d2205ef52bba969b56e4919b2b5420024259009497e674f405adad15536a2663d5c70e0b44ac14c64001c01b941a169bf2e150ea99c37b346324668c05a165e2c1942f58cf1f74095d931b9326bd58941a38fcd7db0951731124baee26f2f1333215064d13b481b5d35d2bd68ec09277cf55e494648be8610765851117d583bd0aa63fe4510514e3b1b7a8810fc219ef77bd90f845d8474ad5fcb9209e3398b9e7882a0b706acb7727d263c8e00e62ab2eb5","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
