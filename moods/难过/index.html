<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"33ba53fe6daf32caa0cdd95e1cb7ea6de6ff620402059a6b3011b45983bb2bac9220276fc1f72258e2b739a4d43a9bec81a3bd035cc825e76bd7c976171b2795ad6a183f22174d08642011b05dc198da8d89485d263c43f616c64026e99ff471842c10ee77d08707c1cb0567bace597bd40fc9f1320c04719286b60ef1aa5b735abdd0bb4c69ba5f32fafa358a58b7983996751eceb06024c64d337eb7e9e91713109f4ce4981d879a7e52ba27447bf214cde0228bfe7882b1cc58f7d591456e8462c0d0036a0ce3bc8742f27024e8010e9b5fec8646f96d25df4f5796890288fa8d3fa2419469d1511e1fd7a39f7457c7072724f575adadeb81150af412d34a3d84e857d97d34a4390b653fd80a6bbfa245007075f1c9f42baf55cc1ab49317690d3ac726d9a4686ce4c824af0c76c75fc6269f1494cf03741702a94a865b144288977f361523b8de886c046951e6b3995e27627ffb1292c507a97e72edb539f5e22d785cf66b22b9b550041f8781407d3150c2e8ebab8b1c1d7e778a8c1fd7860c95a1da139c5f4f8534255c467db5ea58bd28e3fc4d773c4e057369dc8efda84c6246fcb726985efe14f4a324a7954aa6b0c5a85a2feb3754e1e37570c76eaf261bb0c729d4bc19088077805dfbac36f819ccb40af3876b791b07d98b8b486a87fa17b5e0ad54396d2f11895d3eb86bb19ca05946f0498b6bf010af8153bb6cfdb4115bb29a1d6d785634bc9fa66dd8e90d864b42e41dfcd9e6c599d4261d232a7b6644c760a4995e6a544869eb5caf66ba793cc95d5286c6d53e23f096b1f94fbe437f57cc464107a253bf3e2201e892f2a2fa2dd354166f3aa35a66b83e9641e52fe80b3d215087fca935b24e6cd7e3cfd9698e3b6ea2052c5727e939e2b824273973040a483fdf10b212aca2e62d8fef3278525190acf0116afd3cb7740e2893ccb1e420a866d7f803e5e1d0e13e99fbd826f229509173d7a43eacb0be3591c8a4ab1159d3c5d76911320e5e208b6e3db94f67e79baa0cd60314331c808c83cbeefdbd0b55959326233e6bd13f1274f735dc387b173015a1b8259faf3549093b906e9354fcb1f91be2ffb40a52762b6fea3ceb8f68de4107d7b1e2b1560b39eedd1d67eedb7de802d2dd2f24c350bbb71a9952565bc4217060ec8515693f312520516e8e8fc1c6fe0010bcd35bb60794b0f2a7d22b39ae35e671cd95d2a72581f360eb2a0b71083a7d52814b8a0df581089f8fc6751826f3fffad58a585399c00f46e9c83e45676cabbfc939751fd852461164eaff90428788dfa5dd7c2f7cf78c78796a15a15b448b546791963a553ccc3f6574898e2774c2c3f6e92434fc54f470ff69f11816beccb070036d754c51ff9855166707f185cc0bbabbaa4aad0aa20815d62bf49d0e42abdd565cfc5dca04b748574105a84051c175b4e16ca1722b99f1abae6b5b1133fce86529f85efa10f2d98d6bdfd72eccfa53da5e80e2435dae5a9e304890a306baf562f845a15921f3deca843e409d3efe2a7879e489b586c3f2e1b1f5da8cb8ee0bfd527454879665efa4b383f6e5c93a53ed0909452c2c1b660664797a659a2185e9e5b3f79c5677ee2286dbff38ba6e618dfe433279c832ffae6f598be6c1a21e43f107cd5ab90349071fac908a0b2bc69d159eaa7f01eb2c24d0b96ea9a6d42f124b82e40e011538cfbb468dfef3ab296b3a82c19c0a95c5b936274ceaa073e1c8b1a0574abd7c6714ac872b71f7f303ba0882ed9a4c7a81438ba8a0ac0a79cea5743c3abdacb306878741d737422f2e94ad760df8be6b45679bf77f2d214921c8f0e89745fc0e88a3a6f2c7dce720fd382cd35a04174527cd2a9b377b7cdd2f95a863892b9982bd006cbf5c2d1f9650c2182b89f39cd83424e784b6a1e8e6a13c89b81f8528045ad800cad624f233c01fef7b6e4bd15975e28f54cf6fa7f6463debc8c1bc659f38d606d4cdcb779dc08d168244db29e8235bc7d465deeb4cdb724f26e6fe1bed64d7e8e27431207524b9503ddc34238177854e3fea29401358544b38675552274fb88ccb7f1d3ff1919a6e0f6686cb0e4694c2286d1c9ffb4fb43de0b4f96243cde217800b67231aa874973c7a017813f3b38b3e397cc1a3798cb6f547c9a17d1db9d5c60960d6cfc355c9849e1c222e2a4862cd1d9c09226cf8812667626c3e0cdd93b72733f7c3628355f810daf7b2bfa9088f9bc5ec54f88fa1eeb1d14432be510ccd12a9a782f1cda88679909a128509158bdb9877b23725d387932f3fd023793240d5f4bd351e56fd97837f14515e61b88a1d0bc378932a52d76286c3fdf3b1eb2ba592601675cc49a0b03009c38197adfd3d222f7e0da0045ad277894ade51dc86b16e2871ca5396369f9793c3d8826d0bf517614dffe9473ba83fad030922d6962a54b3936fe562e8a53f1a44512178c0cd7816e343f2e3c11b7f9b6b9c57a624ea770ce1fb2af5ab4bbd9ef1c17da87cc9711d50300339a2a979e1d448f96287575d960e4e0a430400e0ee75a2f32fc52d572b5b7e9e700204874c89bd4f14f28408980f3e0d4c5e447f4c3b9ce633685a52a7b4ca137d39c228bd2d9c89face3b79fe47019833bf0c637dd57922f9069971bcc6d6135143dc95ce149e8dfcf4ce9115b78d69048d4911f0faaf403c7ede898d9ed61dcf96d7aee021dddecf2b05b3d725a2a549a371c0c094a8d97a1406ef6668cb307c63b1808e9e5d8b9dc10a41f60c468f328fb86c2e3f052dac9832da5108af7a8d5a9c49705cee20c0e1028deb434276e0a6ecb1f8ef37281d37fa2325a6b8a93af7e4aafacdd236e4fe10043889e367cdb1b8419a5b9fe7ece815ea7bf9c117dd8313c43c5238332444fd8ad413a2581a2a801bb2039741c8b2ac5fc00d339ffd8df46a92443b740ea3b190d165d86d2b89235d0a46329eef74315fd02d62a34a0eb934c48741a0d763dda9fe88b8a462da06395bf6f2c4ec57271bfaeef4dee632f6c667c0fa1ce3032746ddd7491868074b5405897cf82d1b5581f14290a4a794e30a514c016f57662e2a34ca38abdc6b87cb78868f85cd58861ebda172c0ac32b305e1500da53554e655bc73ade7eace3f061ad0dbfc643b19e1f1c8b07b2ada3964ba1affce7617ff0729eac6b068b227efd62e6bb1f0160e4e916283a68f8e5cdcfdbe5b8e515b6b792eaf10c09de4e8d1813bb80de18d90c0e41b2aa83310a6c5dba3a37ad3cbd1071304440fe3e8fbe83a07a4e9ce2192bf70ac51f8a342f8f1766431b4110f0c98b7a7af0c0bd37e7f4af28ae0977011a34a999ed21f70cd1116918d8cd7af9c497466ad1d73144f3cb6fc2d6f3c113a72b1094482096a06913a39102b7c9d0968ca203a1667cde3da25100460cbf370741bc2e8fac1c12c91de2dd4201ab52011c66752a8008a904e5d11919d8c4d3c196b78890925a7462412dd10ff33b50e0b250e854e54d2532c3369632747ffcaa2200fbec9193f3923385992d27a6a86c42ffb4fc3d7bda9fbe30c03ff7400d6b2821c4559b08515eedb40da6252bca931e29b0403f5c66cb2b20f54c2876657e9885b21b80b4941fd3f399fb5f4793e4d41a8469e9ca3c319693a1c19a925af98007e6a2b644972d221b7b105bf40910f2190833e69df44b9547c5ecdc7b885ebffd7185361a107bf45718c696474b258bcee420735d65fb85331d6de3d74b6b89ba257523a5f65a8a04755ce9b818b85f59158e427a6a3a01924fa2c0e521bd78242f0c3cb5b24a8b2b08d3ef5dbb27c8538269b458d9535978ebe11d26af2a56e09c6574eb0571743818e1e4138410064feaa902abc63b682148641b6ff8e654b39060011edc60e44b52ea2b3de902132c5722a5aa95091bcd9e2b10ae94b8d711569aa42efa3145d82b559aea22ab28a65d150d8f6a82a9dbb6c2effd0ecd8af1511b51453334f6ca9154726d26d7e850827ef27688f3f352f8166dfac542feab829b947515ae7010af45917e01faf36dd70e9989bbf7a9a209c7ac23fbab6bddc455aa655e22f4fd059a33957e69245702b4216c35a5933b3d0a76120b4395075950ceaa2bf363a500ac27f2be7ba4ee4c1baf7dd06dbaccb86508d4294ae6c12d7047425493b98ef6ce539e03b0ef4a85efa83244ed5dcf955cd7adcbe96476bef4fd050f0d26f74861fd5fe6d02f43325bf737407c3dc0ef96e23ab627cd7549d39e985832c05e604950d77da8f67f62f9f4793189a0e2f523decbc7978eef39dc2b63126b05168210f36af85c832b5792652a07215ac701187437c7751846d62722b10ce406b943467641a7ad0d84ef03a5d96f3d7b5363f71e73606a62b3a1b9463b27d24a45340e40c693cf37fde7303bd4bf71b22d86764d2d10b7c3eaaf8d68e94e3f1fb03326429002f9115f5d5d50949cc0e1711dd5c2506f4cb6849f99b965879cc68d8292550a2bc304c0882080a1399e22a304b42c934197f6b00aee8c785a08dc8e24005f6fa9bca30d8d1c9c562c562a77508cd6b1796b034cdcd6ad55edc3f33824add51f40f6a05cd49308c7ca1c59799b35d2c5c5d016c5a8d2ff357bfde9679eed4ad6a4fb4b7455aa8b6e7903a54ec0c09beaba4fb01c94fc2744cf4c28bf75690d3791807b2df59f6da7ada0760aba5b636f02c5b4b2fdabb5f64c6b78b9338429f060b8fad3e0fe4867961778bafe4fcb60e404eb475c31c4b5681f2eee2b8bd893c23419f8997cd72b77cc433818309b23d70eef1d5337b6947c54faa9fa393e1ec4c6255c3d701df1fa8fb4c97284ea8505fc6662386f96ed179d099e73fd9c5d5278c47d52d498085fbdaec8fa8385159cee3f0334c0e95f72d086138a3c8dccd87ddb66e66013527eec4ce1e6208ecfc0ec23d19d4a3b6c8c0012448f1842c5b352f0f9ba9c579be7f956f15c81a19a10ca90e750c35331887f2eccc089196a6abb707091b044074223c4172635b5048ccc16eb4e2d3a837061993bacae759a0582ca00ebe3c7508927b9c6da5277e80bfd4fd1e8107436c076d6831a3328943fad6e04d2a48788994d02a204cc2cab2937b5b56935945b450d3eb9ef75e79898d526c1204c237ac7cb1ff84e64005a404a2b07e1ec2bf3795953b667c1aafcad54cef9e3f9d284f55c4146f0ed71dcca4d78f9d02c0e9481a20bad5c4200238d98ebbf8d98cf7ab3c4e5e6606663cbaecc6c6ceb4bf5914b36198ba5a842c70a8e1187db844b495cb9d5ded46200cd7399b99bed190a9dea932ea3552c11f10bf0f6cc71d1e96d53a3c0286a67a633c5f284e8ff37bddd28800261a9188169a8e6f66ff48d887e1cc92328c290fb6d06a7f18d761b7f1b42fb9e4f30623f2d79cfce820599fa69fa7af614bc854f02ba32313f60c3561f2c56a74aa722cfe1705a30ef8d7a350228f4c82bc378b01dcfd9496d52b6c803ad5693e83875303b53e2a9386ed642ac7e7214c532fdfe7bdc35cb60dc065232876ce39bca2f65fb8018018ee0ef38bcac04d96b196bd6eb5d8802fbd49dcecd70031099222edb3f8762ead398620804c28a09abdc8630d7fd277c4b824d504a4f55c9edd1f1d6d6ff57d1d77c61f5b1cb5697a6198578117961b29eb34284a40931e1828d4faf1a2bfcef3f1cb750894aa4a69b4b9b533cc9dcd6f7311a7eb9c6c26fbfdb2ced7d2ba72969b5cf2029fd3e6943c8b5306c15d1457555a0e35e60f57d029a2a125131dfe626fed78b15d29953a795f1681e63b2b30eca218c310213b8441730b612e2fcb2c83acf95155d71e8273b0018e8f2511209bc9b410a6ee69f249cadf44b2a6a385c0d264d593d1d62d8b0469da6afbf8f133196c5f19b7d6ff868935ba86f3bff0449169376fdacdec285c2ad234590374bc220ab87df0f6b7bbaa4a862ea79faed12af24deb6485a8c1e7b8620b5493fbef0eea4eccf05217481a9316c6f0ec961eb6f3655144ca3ec7d299d0b3dde1990a71b8435c69ce618f48b0c710b27ec5860d09e0ef56f2dfce2b15c86187edd6d3f9bee63fa6c60b2ebb46bbe0e649fe6b51a865da7902344cff11db9d3bdfafb19d775f6873b45f29179927eb7a7a2ad2b526b08cc295e02a847c4687c2c44a61e509aa0fc9e06e18b9fad742eca7808f8c436dfa4d877eb7bc2fb01455d6daeeb7383d190ddc9e697905d26e7f466f156108169910ac3b78ac26747465b34a30affeb53760474ee338ec597bac8a622bf5bd8de0f5894f535ce878306c8093145a0762ff45d5fd65bd281611191944cf2f639e388d5fd09f3fd7f5cb263ffb1e7aa494255f7bd0835d56b032fcb1cca953bb455422ac8e0288014175d35fa72bfbf51499038bbaac9b540317399a82f92f8a0aee38e9bc1b734842cb05e09c3c12051ec6c243290bd2019d1cc1fb267e805367c26ef381e296669f064aa61b1edb7d6303167e009eb2da9737f5bfe5f07ba2ccf01f15bce8073d6ad62a547306f36435b931ea29dc17a33abb6f3c2ff37a816c835d0905e5441946853cbf4dc9a76426b277de2be443686032ea23bf87d0293d264382e48bb93188b3ca9aa8c07a5e772b3cf27d4a51d67ab169901b81f72756316a88541685597f7618a1759caed849ecbbc16515df37d2877ef8388db0098f85160c6701e59148010b57e555fb571a09ad2186abefb9c794ac07029c235b9f224babd420cc59ce9733883f24800dfc242739c6ced80348a8dfe9dafdc7cbe68d37d770cd4dc40c758c388c1a4d68b9c5330096ebd1af407b10ee178403b97fbb813dcad564f2c6556e97429cd3b42614d3c1cb5504965486cd6d6ac09a4e332d8ba297eda11a58931ffe1520d313517aabb18b2373bce64834bfa72980a7dd7eace429fc9ed750dcb8cfbcabaf5080fed54b03562cc5014cf97a92152b3546d1d0536c626738c6a48e048792736cc04bed22ec55967e2271944abf36c11acbcf7fb14eefc4dace75ebb2c4e9f9bc5694992915f3a2f768deaf59ab6253bc21a86c2d8a87821f3f385b1fa8541686e15d658fde1509e9419c0731d614c22037249e40b7ef37918b04aeb0747608faf00ce957dd7cf52396ef8d5b28f8ec101b7bba160bcea1112dab5215aea133ce9d3104b32e6160985515acf0837227afc598eb55987a72a0c1519a46948edaf499662a57e3e66c977e1a2367ac3a3b069b3142ea21f61dfd75d54d92b56dd0624bc1266c6c404cd08d0027216cedd729c950c17fe369f8849482b2deac20ad5b86e2b5cb2a38be840699c6f3c9d9762a5c82b2c9182c6557f36b1b1237a12aeeb2724e8918b1a0bba26144e5aa52dd69e6a4158d923491986c1198190afee21cb1d2f49f2b00ab25d7d7faa4ec01604d46e66f6acffe973cd716ac2aef193ca0f5cea1719932f539ecaace6233c62d532603aba81b7586c4d43b6b1e03e55f03a260cfc4de60320f9e8670fa49c6fa6a04fa6c47e81b47e301fae2d4a2b9ae46c03c97fbe31c17cb9918df2a5caf963fe22f50323efd5b33d8fd997a657aedbc67c3f47877f533b80c3de47deef0117b5d2934bf099a00f1a7ed93133a3bc63d6773d2272c784400decb0d4cbab5e1b317ce28aeccdf38a6207ccbffa2b31e59d26f2e18a1439a9d690c00d2ac3fc7b9708bbb2c17eb84f6af8400a90b0b77b1ff801d75760f8c1a448c99d436c81a10a306515b469372f1713e925dd59282ce6022eb2a92c8910ebc3f45058c9bae7e73420d82b482c21e04cc5f40a466ae7132574a8650699a273f05997a1be8b35c0d1b1b7861f0ab80d9719d26a3fca63e320586700adddd200d23cc30bf5fdd94e28d7983709edba4f9ee727e961721ab46086939350b52e5ce5ca8021282722a663a9f934f819e84c32a305dde78add811443a9ac215501e661ae35689b038f111b2290c8b38e2c8240455e64bcba3d2ff99a6cde0ea111c1e0ac4a68c718b19a7bcaf1a997d778cb0fec673474cb596f9f98d23f782601e00af882e268f13c4ac2d7c055f7a977790ae3abed08fd7b089ca79f4f1b58691d0bc1529299807560ba7e3891fcc89fc47fd84058a6b579bf21cd91b2112c7b21f70c5559baebc2c2fd346c70f2d05185270e81738c7262836779d9d11f1dc9e1f4fcfac1d41ea71ff43412325738e5aee0061ab331ee7f9d9b4196ebd5e6aae469edf18e7f4a038e85a2e8b41cf1a74acd261e4b34c0f08bff1141a735c3bc81cfb942b0eb137f869f40643e0a7b5c0be756729540a7bbb4e45859d53de781dff6a0b6c7b70b9214f07f6b7c6cb8d4c46651b789cdae0cbb857ebbe8dfa1f73089a6bebcbb7e5b6f56761261e77fda81b39606a876ff292d58781c05fd24e7ecfe29e1c4f89b2710863b0ebb1e10e926ce9db8fdb7dc639f94304070c2e68859fda267500318559755b944cc46275fc66a208d07fb2db377497901093a6955e4495f2752fc152d877cba8699c49e1acc1c5c77f4d82df797e21c680ec6e4d162e4e6894f6c221c904eb0a37dcd6f129908a536585eb069e11a349dc70cdce2e1b62cd2d74b74e2eb6375ff6778035e13e1bc18426375a5dffdd2ec74d0339736617a6fcaaf6efd5c2fb1e8be7127a0fd0cc7cef839cd6f55df427937372338bb80b9071fb83c59b709c3538cc0de064c90409f06461f6be0a5accb8ce21ba2006f509f2461921ac3281de543f95cf6f10febb24d7dd996758561c42105c6e671003ce885cef0086d923eb8f37c546601cc3b3c49671df8aa21c09eafefd7bdba2fd9d91d380a7c5f32a208d098bfadf9a77368a1a68f13aedaae5e30ad00d7969544daced2e60e6eb890b2c862cdf1513158a1c0298f03a4efb2a7db91593132faeb5fb3ce591a5cc328ac38f3e3d88cde8a0d4c8470d68224911f7d137506a13e797658cc3093e5a85e43e811010ce7f0325a40f943c829054f90a4db87d95b3a064147831201ca59660f48a02f2b82451fe66f94d552572a420dbf53c5e91efff5f354ff1ba9e1316454a06509f3f5959f908edcfecbca4a8b43013ff10d2dc41d76b320eae7750533ab831d634a39ba280f359f41bbd9a6b44c9487789baa23bff7ec02b53c29e5d0c965cc4c531d35ac23d443ff44192180c579c2160eab35b762b74cefbab2d5c3236ff86f05efd8f6b8a6526a94034f0d5c236fc8aadb30803b5aa83053b289a97d5ee92346df0c07561c0bbcef49bc99c82d7726ab498ae66083385ff72f5c2aac79191c0c8e41e104d112dace7ca6963eac51f516146b759440d766caf132ff675268f7c38445fccf290d548720959041479a6b452610f0025380a84db84cd1ae6d8b693a48da05e9050cd4396887f322b0c94e8437dd96b481ab60ff5820035ce4bd8731b50653e7969716fd4509042dcc6c36162c30bf1d38f2cc53845843ecae5911a2f1066aca4687135fba88014efecc6c150aa9630cc3a8722323bf0b5bcf99bc24adb5bf653a334dda513e3fb83c8881adb70f62385f850359f1073e8914e45ec8a084aefdc8a2b3be030e835e929e0a80d8932632dbc3daee4ba5633edb17314e61f57bcbcc437676a10b6a7b29cc9cd3ff79cdfa51066c125b55363a982c6558871caed59f322f667c6ee58eaac6f135334a23a6183d3726d0efa9b9ec2c9bc8a7ac138d72c9bfa1eba5a734d656aa875e42f831d89fc61b632bfa31c79cf48813ca432e180b5009dda0e31832ed0e62895005c0b829e9bc6561f8cd9c84fa17dc467db1462c9b73aae2a9edff893e983c99ba596503ff65c09b91859f6d03059b535e89247e76d94efaca3eb9d0bac55684c868e1b7a4c0e47d4f1ef8d3bc653205262240c2047a269a093028d85342fc2eb34fbf15a7840f7b0f3ea7739676594d69b1345b6a3d7f57bd3a0a37a6d25deda16b34d1789412b327c57b314b499b6dea4207ff686e7736e70e6fbc73777f5d52c156694598cdd0ca4b7de9162983ce50074e19877c62d6b6a03e6472ecbf238eb7f0abee4a1726e396308ce2bb2dc573ca5e58cfbb3e66ee0aeda5df4d471bee1dcac0649c5234717f880bd793c4da86145111b80d079b016ad597913719904dd7e84bb4312e0e42d5221eeb1fe4fba4a26d400bce5f15e387f55388a7abb9cae9c7bdbf9fb480a6a92ab668b8da0a41dc6a385933d2ff98ccf783f91d56a310dfafe7195ad14e6a7695596fba440b2386b1ee73c9edca81c3da3cfc5f1354c89c270fc8e74c178fafb7bb2388a5a409082b3cfc070b2c1f5213a29b257d55233b997bed8205d991448b8777f4279cdd12543e1767d003d1a38b327cb28bdaef9277563b13477fcb0d55763c7c9fe558bc29d4c71de83542ef39665fe76b30c033f0d03590ef5ede4c13bce6138e35e62c56c33404fc864c8354278432231e523a966dd3319e273ed5e9c380ef5c64af80270a07806455fb0590586ae154d777ca82a13c2031d53a972356f9a5e0ae3cba8a95a1e2775d262d4b7c7df4c09d29a55a28a3c7c9e1186f8a80d270fb76f9e1202fae92b49430a287c245431810254ca1cc1e25d6878b9a40cc203ef0a9049767d477f2f9b3343b5e709057e789efc0554f0d5c7258e74e0e8c349358629548799d3d3b5b809f79a9cb38bc76c92f9e55ac6c96905275b28a968b65fd96ae1d2e54475a5b035dfab92f6be02ef4e549255cd4acaf803b02d7750f371afc54ea7376dd74879a12ff28d136d17f46c3c0b767405273f78029013daf7e1c25de9eb85fffdbbd3b1885c3ad38d828307486eca7273bba4f5bb213bf9fa5af85b821c4f78aaacc276487fd7507914065e9ef34e54fc6e234b22be80bb0f4adab2c080d277f354067fe2a676364e322b887b8d5af1eaa77bb57d12da80318d5cd2bba05c7cbd00ece1348b240c96089d905fa3ada3047397bbf34b4bf2929e7885efc3adf34a2ee133babaf8d6c4db0343b9902dd758d2e12d47050acff266f341cb9b03fd20c5a3e932ff4c7d77d8783b6ec9029ff411a0c63d7c43c56f35b6c0523997c78063b685dc995e0e5f8c45bf1c45ace7a6a37d6bfbc0a9046b8810402f22e631173b35087b6b45ea4f74f081825e697cab0d349a210df31e2fad9bdac68d7324227fd1a906fa661a0de00eed6d75a7d107688a8fb5640525654079445f25bda2129e8a5bc92817b8d9ce4f129a52aa30c16fe75bdb1e182a9f467b7dbf3cb211d5b07737e29b54818a2460fca70f90146f10d1f3be2946d60933392ee8daac7726764c118e4194b632e710d5bbb5adbe88e763e004338357ed84c7a66cb7080812db152cd5211753596d54b30fe1168d14da191b069c55c659c65a991aa2eff6dc85da068716568beb767e78a7034bf75d2cb551d4a2343424db6b0a2a14b8c1ab27c8ada67e3ea213925577e84610e4f5c35c785ce1c1b7578b9faa7d65916e7a57de8010c493a0c1ce9d5f0f622bf16890177779744d539e1592c931cf557396f7cc4159fe582a5a4005086d10ef76dbbb423ab5f427c38560d6f53f1d8d71bd0196f8f495dc543ac99b487bd528bf21c16cb960971401ddd5b5b84d15327ae292f495a435ac94d97d0da8b004e6464310da2fd4ff809080709798b40602b6ee55525f83e9f3dec1a7269889acb43ccc224a2a1952f2ba2845dcc856d1080bc101e4044dc6257728805d59067a73d4b0f06efb362aab19bf8ed0d2e9c03dbcee75d3e36cf287e9a844a94156533a12c111a11b3ab6c6c20853c38ead630a6ad1c6a3f735976a9469f05bf5c3f267b17928ca6b1b1925888f66ca5bb92dace918898377cdb1f3cfdb4e6deda2d23706e9a07734cfbfc8af08e4eb2a8d0c223431afe7325a107c2f7423db7d5b4f4b367cd0c971174f56a2aa56b1937ea559c1a2691b6c44a2a397d4a5805ed6d8c5b119b0e272a330147df00979f71d03bf858da8c4b15b9641f72f4a48428c43d10cde4c582665985eeca2f79c1766687e25e68505054a9b6ca5d56cff1e551ad4d0bf8d6559d583369c53f03330017c9062fafeafcf077cae2ff6928e26c665cbb4776f573ebb7e1ba2b687c992e4ecba9f46626d3ad705b18155e24b74687654e2f8c9697487be8996fb565e70bea881262a06c4733956d3b0cbf97cb025a4930ccc50401e91b6fd9705e476d0e1d9fe5ba75dc15599fb09b6c63bd7211861d1c8e68d914e26a3a9ccc28e6ce91d9afbeb0be3e33a1004366cdf748c4d217ed79565e4803bfb59c8c752e74ea37b611b754d456161b4dbe4649ba5a769352be87c4c14063067cdb17b50ca7cb0913fc87fe60b0ebf41b1ac96c06ab97db88a4cdff868bf5520703d08f51b98c8d90efddf3246cc587ee345867e041f2cea003e151caf06a8bd9e1765d664f376c3ea1073a0b997b386794149896f88a36d70d8c806b5894e92ef7fb7afe96b14c1919b5797dfcaba272c7cde0150a3b51ce33cfea665ce7c839ff9b3f28e06f0df8914383b04eb0eaf390ea615172bd469b661eeb774111bc76de6614259458ae7400dbe6714fd94b6a011be3dbe9f5feef1fc0e85643d5b969bf39c19c9ec1bbf33f5b0374570046a1fd55ca6be69f282a66e4d957f151ae13f3d2c9dbd5c7ff7c8b36c1fe358faab5d9c1c8c0bef3b5773ea8f10ddce9a2dfe207015250355362702279b7fc889c0ddf0dd3c9b5b2e1a6e32a5e89fc868e26efaf0ddc82bf656715cb449c139c718aaa59f382a794cb704757122dfcff3d336e82798325432ebf243ae502abe513edd3faeffe9e08919249991f92fea17ff316451eb795b8b65bc0cc12356d0338d854743877685170dcf0772142ab6ec0d1a96b50e7e2c78a626ebc6667cfc76db27445c824723180326acd37503f32cbf6cf97959ca125388e81dbfe37559557a6b025a183a97ea8febbdd7dd44ddf995ddc69ddc108c2754c4590e5bbfa62dec19719e089e4d73fcc03504210566bf06f4cf2aa74904047b2a238c8e75cc94c4c011bcdc0fbd5f18f0236af6c483a33cc6e3bfaee9a3272bbaac424c52b8030f60ae4a21ed429f6ffa5060ed14f9041cad83b8395b4acf2fbf9657affa170f820d8fb0e5ba628a592cee0a79befa61c4115d4f48f01e0285ddc38ead7b641dc34c151be00a2f5f5f800f17a42759c1a875b891e870641d8ecf5f0d5d6a1f6d32b126a2b323783e2071d64309a10e2f37ed85a41b0c99e725c3408ac2b8046aa1cec5151ba9529180666fac9dc16e88ac11c27d24e5cdf1af514d69aea7e2ec4d13c9b375c067f99132e86f2133c85e4a7ee5a627ec1d9e7556588b86a4b5693b5be3ec26c8ef6e7b65f679e8d9a910a879fbf9ad53d8d84de4efc4b9d5c34b31af958e4df2af1a544a0a721be63eb1c1fb9df4c396b43fe9017760afd91a3ecef0b4a196884a87025252fd6f7c081280fe9c75db5d78a8654cb539c7d8bf2ac94991f4c76d2edced0c68a93b5cc7521920d8b299abf5c1d2e172499b9880db95ac126c3854c0b184ba52519f76936e8967b49f63b24c65665143986a2e18a4af86f50ddfd7be3502d213f350e0e812f29f2e6fd4e7ca0c8cf79aad5923a91bdbc0a029628cdb1e4a48edff0dc1176fa7e64942aff83394e6cff417791bd2686c39b40b06ee4f0f38073ee669c83248904f613b5b4bf8ffce43c69291bad7e2847f3050b77e1cf130627546759a407cc20167951c26616d007cced2b5e30015ab5509c4fc1e73f028d2f1f80ea2d913f70f4c16058f8ed6360d7f1b1262c3adea32ee89472fdc5599be693167480099cfc14f64f5866c7f879f0c6f428880b37f601ec46c68015d149fb2c79a829b4d50e4d053a56023f6e52a29d58a00b12fefb2115db81710657b3cf3715245290373b66671485aae1492c802a7e474f6a02e3bb1b777b916be36712e708f9100d7acc03a2fd2a3b27e21e28e012b736131b355f8b35308636a861a1a8243cdceb2cfc4129fa36131cefda4c141513032e41adedbcf613f7b82a0ad03e412c42f60a425613fee2680e3599f76be7e4b7752ca3af1f880792d69c59cb77619299f9c87fe22945a78f9d16799d5cafc2868ea9c91c78e8f270efd0a7bba6079446314d3418f56c9bbb1dfc795025c5df03966e271e73d9a5910046b6e7be727a704c63cb2387830bfb0b463626df6fbd207657ebf060fee92360f0ed31a2c7b97b06a1d0ff6aa7d291a86fa607c23c947697c1a99ab1a9bd61fc7e055b8ed8dac6dc7ab116ce09d767a0c194c8abf962c165f4ed764bed491d3afef6b7c3eb9d7c3bf52223e68fb38cbb0cd795fb2accce5d8ace4a807cf5e9110d32ede423672a8f3b702a852c066fde1ba1aa9548e68bd1008110f159292a4efef24d842a823439070f16255211d8f6417ee7003a7900837ce6caa8bb92f99b35c23ee05dccdf0a84e7eafdcd4418f1ad19d47b6c6bb3e6b858c7950e4fbfcc6f4e053c79756d382600b1742a8acb4c58c0cdb8e19fb7268aa24fae580563f5043ce941033731fce3471324f7a987c7f54eaf0601094a3e7035987bb883a7ffbf4486445811fdc85bde77afcef857c5e1fd0638a8cd0cd7adaeea790369a49980b2fc15995594120372970c07c3495c1ca636d2636441de411540f193bc29f1d4b32bcbe5b8ab071efcc434cce2c36f9a41a0f2e3cfde241ec107f990c07b60fc3e8913d5d6900dea9def1d0145c679d231d54fa95f33a5a09b9d38cd714793250c2cb19fb95f72bec268a4a04c9180d72a2e516d1fc2cf3707385596c05b4297383dfc895bf78ead9e611c5ab50691bf069108047b6f8554e799b41ff02f7f45467e9b57beafc7e74fc60796f32d7cbbf878722a4b03d6a67b9bcf84f01876087e3a56633a3be467ad4f0fa653f5b0f947726e0da74b99f6ba0a4dd488ba9f2ceb19bbdecefecebaff4e9531154d3c2741d0d5ac9a92ed5688da959ee184e055f25fbd8be7e3f753b2463acac5a7a80ff289182159904e420263d5fdb386573c80d1dff889c886e3ac57a7ca17de98cbd46226f9283650ae168875ecfd26b92f3cab47ca94317bf2de0846831f9de919fd67fb4070fdca505a3b5992e1334c85b0fe32251a85850f5248c1f3a20d85d636427cc02b9dbdd888799c841d7fdfbe98531f391b4c807d56dec486ce69bce39a352836d6a4ae360818a9b5d3f72e55b2678f03712a30b698bca912a6f23a8d3a95e185258569d928ccaadfa85e4c62e47de515f0a9b83eb45e0cb7da7aa5b6a304ef52885406caad8bc9f215b8fb6de007c33d805a31fec787858f14e3309524b55e19fb12359dc5ff3b59af2301d4cd04e777f814d90ec32a3c80986d1b3d40c23c5e7ece45ba5615ef90eafd6232637893ca1cc518b98a4ca365e541eb352b2a51f52b9e1a45445894962de0fcd86b861a17b0023b235a6f2e10ac21ad8bfccb8d46ac05001ef010ac54c78499f1337b98505e8e1b31ccc43c0bc4f972e1dd72d17917be37071b00b5311f0328c28bc50d90822f50e38308047a22673f7cd0a90d142f513bd972cde6fdfa01ceceffd006238d9ca8e33fd1d28d27b996273b6db8ad79571377979a9698233ca4ecf3b36c3094b499bfb8332d69d522631bba57a0270e44fd6093ad0fdfc99a7629463e164771339cadb640f22b36fec39f1d11c6d4ce29286a2f8812a918e0d007ae86c495bcac09c8abab0aa7425dc5da17a9b1f5395f2f907a4965d342fe3ed8137cc1db76bf4721a22275026282561d7c01d1b5bc2916b122953eb9d351669a27fa12c7c32d46bf53d4ad3a7e3c743803354f3e64d3cac92a659f1f2e3d60bb6ccd9b36a308649621e01fe0cf2c2e7d8ce11b363e000bf4ad885970eb411ba67eede6bd36eba79a2f651ec35389594be1a2292915e39990c5e7b7a99d4940c55b08ba20b5a53cbef6b85bd79d22198dd9c49f4e8ba91c1c949aa38aebe45f67626fdc25c4c1a1588e5a1414cbf6019d05ee39211a47c709e0a35ca72a0b7ddb6c39cb9d589905dc7c4af629bd2e92e61550c2762fd1122658ad41c65a744225fd301bf0d660101ca02a9ad611840f9248f97a662876e845b6a5f1434bf4eaa8d92686422d2ec0bcf199fa7f3ca14c642c68e4e89ac4c24b52e5ffb15d4ce83a23d49f8393fb05f26de1796fc447b65d460c099a573b59f0826d7932ecacff8aa1034ba525254168529625492c3c1e66b030c050919146066f61160708ce100928140cd8f3dd08144114b2a4f9595033e24eafabde780ed6867fa34b140292d49846c87acf19ed71ed7829cefe4c824b705860923ca38dc85ecc7bec4c3e37bafdd6ead39da6ca4d4b8028870abf99de966df0f297b5de12e0520280a6819c4061ace5f78640af37bf9d91285e2f9029695cc18bf697f696e1b4071945b2e205cf027cb6dd89f9e425da8893ed5e915c3737678163e072f90ffcb41a32870d8363d22eabe723f782c688aafe42665f72d83849f881cfa02b10b2008a2d64936e4ad1ca85bb5941332b5325662455b548e8c64d55f6712dcaf5fd99a3924838fc288f7c5d70c1ed69b5af89364e9cd1b8c38cdbd880997a084e6d91757aa7736e01dd34f258e37dc9f9dba5d3e041183278b19e1358c1d41293b23ea4363a76257948928d129fdae3a40c8b60ebf7ba7ec9b64ac231c1e5a896c4083547ff4da2d5057dc4804ea15023ed401df638d228079edce44a9e0ea16b34e97a87660849b6ad84a4d2f9ff45bb9090c509f489c06287357d20e73917d26c8abc2a2cfa82f588e856c5de1dab6c27945bb2a49bec9be47cf17293f9e7380f99b6077d77d228e75672d8b2254a46c6a5c902253af1c2faf641b1172f8b09f1f4ec64090bf6630d808b8c8969a7b8e04f3a92b75a484a69ab4c759050f1cd699c3a5b833c58ab57e7dbb3e6cd522e5ebad8996458557440daf284cd17da46b7ad4f574da8e3b04f53ddd958b9b0ba3beefc3242bb41d923c51909465f0393f8fceffd62864cbcadde7404a20815c662aea16885246805ce17fa1a27c3a24ea2b36204b1bd3b7f07b477f8d71da2ced9aec088d18496ec391beff0810b4ce990b997f2495f7576eafbb5dead4e35f0335bf31d0464f7b16d7b56fdbfc9fb8ffee308365cc206f239e0c53eba99c01a88fcc1e23c0e7e365e34ab04c44fd9785b208ae8841de342ad0522c680a2d68cd69c62ae4b09a0470f3b862329bd41c372186cbf09b27cf2d768dafcffdaa16f5029524e6e8251ef135bb61dbc86d1efb3bcd547d13169c8080a1438ada956f249ea719506024d1d6f5a9134d9d0e3c159b3bf5154b13f25b45106641e28ef84c9845beaa99a1d5507998e09565c2d97a8c62cb41c0b1aa8f8dafdad87040ec4520db7b58c9fe84fb252c0dac3c27610af4038cfd64a20b6abf65be390409f1d9a5e5eec95bf6cd9c21c747c053fabecb1f8c6c1e36d1ddbc5bc867ee89cc3bd51c3b4912a1f61134e42d044dfa1fc02a0a9dd1095e3cb99e520483cefdef061ca0391aecd2a5a82ba7965a71dce724bfc83e7f9e3b6ecdda55924d7151986adb12c601a9fff027963a9c73fc5f99e4ec1034c07ba256c6732fe82b1a2ad5af8f4dd6ea91112d4710b80faada67efe7697714ee97f651ea60d20a2346055ec0f60b249fe7a9ba3c0a1df677731c8e25253672fb64831944166336b0ff601483b7ce613c411fff633ddab0d0acf6c92a184be9affeca83ce9ab4d7dae1ccf322c1025f0a60489653344093f49b15c646ceee2218fd8607505e3dd362ec7be4e2a383671d7269eb33255baeb63bd7243c15e0c6f52a3f1b6a41356e676f9b945a64d8cc26b67f3eb26f6230a7c031e9c74279134847e752eb2ef61e43fd2fbb11edef7d54480dc6b66ae7acb335fc795ce764d4b0aebcc79b70f6c19f0a5fe2c7ac5c89089d93bc58c28b180d3462b10103b99567bdfe2460256e7c2b62ce4503df6bf5edcafb8ee35ac64a3f6ed1ff395632e4fdc92b98b8329cc9e37208795457bf9f48f4cedc6836f10621dd011bd3e8fc7b44ec8484e56b111e8c23ac12f5a2fe22a7bd79c485055eed1ba9352dd07011fadf20722fe3e902375c3330a9132f86b1abb965ba43a8349360b139ac1c0bc3034c1363cdf20adf9000adb762e967097485d4449fbc9db8e767417a6da8fd50730ef9ec1adebb525565b85f88054a57e542229394c00ac000a95133b95303e1dab4c258333e460c21354140e26c6a652a08edb489086332e57da2e54cc125ac1d222ddad4b5e048bea4efadfbfd7cc0330764143d85047fb4eb4b49879b4f2b554b162ca6b6e564fd2c1ace3a705283046dd21f16555af4c67be629c943a63249d0ea01cc86a00d7b2f869a64bec2d2c85740ed5c82136eca337c9937807e893ef0f2df22d973cabcea1129de96a1902d45359020b3974059e5819d73ee0c067422eb4cf87ff1d9c2150fe78cc50d9106ec72e94aaff228b902e67f9089e884c61a684c1bc1194fdbc6f070917d8f81ed31b4c1e3d0c2f917b75f993f6510f60ad0685647c9e9f5b3f593de8eee32cf38dba63ea9766ea37ad894845e9ec627748936ff5aea7dd84bf99b47bafb9f0f63601f3b89592d37b38338f113a2bac6c60e698553e64e2012ca55f32f7dea7d3fd437f3f2ef0adb01c454414a3b03a894ac40682ddb6c638db7a0247e434eeb00e80c742d5a1932ea050b7c488e28b2a89da8ecd84d7a5427aa57a10e723e353c4909b42c732b9859c6f2e0abbf8efeaae7d1c61b05f7c230b438a76fb62f34af16f0e331c4255ce90defb4c6cafce5f29d5ececabd6560279d2dee76afb86614e785f00f36bdafc858a3da77a0bf10dacd485fff1bfe1fea9b26bbcc08bce5d5bb7d36bcac0a3db75003b71b521d9ed65c38445d199c29f1f98fbb3941b96339055cb4888d148ef2c37b3b2a67f631daceb8cef623cb7ef93296f09b6141751c2decaffb1c6461714314882e8b6a604631ff6ae6e1cc0929b653a09b774dc49127d3767aa20c90542364298e341012ac66b94cd850aeb45c389b80c6ce30d9f83681080ddc4d46a872dc8a030de0e1d05958583833473aa0d23db1973d01f21881c6a4fb15e017d5ea48129dcff039643231ffb427c7d71bad2031fedcf8c54b632af1d7323577a5571ec4c776bf07ca988041411149ca6b5bca681965572e3509ea05a5903ffd3d1638ca36114eb2c8c171d391959e9fe0a41264fd7430b2a98770881c0d7eb90f6b895380c2bb5d78fcaddc986c520995e251c8cdc2d0bce6cb4ab862bc237a75ec3427b0764cf35e4cf86f87b3f17803b2099ca53abc68d4727a52b41413f03f6f7e1c049a7b5e8d3ea0107da37d80e4f300e45ff9ee44632749e23969b1e10a5157543106ac95e1501e5397fe15605f14ab6681d7e75e447025e94fc278500283a7784d4e138ed094ece8c701db7599fb378a006ea5aab2d5a0654d9251f3440da59ee64eb4e8eb0d043bb04bd67580c64185bb73537e88db39c823b439a2ff88b63a27d1e4efb3b1c3668e8df606d18d5d47ab97be3941379460de4c38c522064be2fa9c145aa9daaf781a861114fc2c9eda3b83517cafbaadbd656fb2b2100ad76a3b6dccb619a13de5fc567135a943c955db94465ee2a56a8011c570de7ec5aa96dc1c9217b63e0abd1ee8186c79db7a4f26f661dcd5925416aec97511654560c4fccd913a33d6a23451572f0736207427e0b5e34e42b2fde2e373fce4472fee68ceebf079e57563fc7ac7909a654d783248d84294490ac60db5d166916f3bd7a5992a0cef1a6b8d839dffb9dc16ea4aa6bcba49a1773047ad612f2f6fb0da37a6f88d941f6ef5f6152e65bf7907b43942bff422173f0e6dc911d044b86d86396183b3b87a31297a578529c063c7bc7fefb475073879b7a4dc796b2869d08be6df410a4eb7e166a4f91039e84014c12712e1cbe7801b26dd9fcc4222effede1b439ae382c22accf746e41f54cdf664f5c7d446c9f9d47e5a353133983243140c5d9c98eda56e8968375d49e3b517ca731d3431e04be40952f3d193f6322781f1b1a5a2e184d2e39522479aab9fc78f34c01d517971179c22c0b7e0847d72a09cb4d15aaef9a69efc9758be04d1e590a1ed56559fc5b4aa7ec2c7da1a0cf22bd0f41b95366799558ea6094238bfe0809bcd","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
