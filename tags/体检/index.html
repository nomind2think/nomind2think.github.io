<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"e656614d370887221f5ce4741a966fa9fea361f061663cfe24bf3ee5260678ec7bd8da5dae3f11a00b06f1a2bc5677adf2867ba4c3856654d91e99c740a4b696900c97e08dc6cc9ffecbb516a97831829a20289a1e47ccfabe2fe30804671bf488961f9350a795ed8ba7abf3fa9b612a335e93b38d841351e8e7df28c3e3c55685441c345f5734d13076790359f67a5d2ec775718da93b6942f57e4016acb7b424f30e3d75cbb4cea60b6f9ad0cf7644dae4229f945dc2600f7c25bd08c9994da46592d37a078271a504ef91e7bdc6f74138d69a19b36fbf589a68f7ff000d4e79fbe28a2410044092e90925ce6b9e3642054efacad9b5802849860f7e479fcfd2dee4fd19ad6d86741ece84b43ff95dbdd68035a73fb70286482a531578b3c2e64148ba677b6dc68524e66f5a5faf9533b02837e90e4a2c2429261624f48d38fe055aafc70e52ec159880102df868149d234d00a9e640bcdead404fe52e77cac3413c4320aad32d002c06e74f0637d4f418739500a3295287040b21682f6af13d51cbfe707684175fae8558fc66246a7319389ec16833f3a637eb43ec21bdced8a28626698df82f47fb87c2ee6abeaee034dd23fe460a958e994e11bf2ec3914eaff5a98cb46c98760a9799a31dea1a8076bd292ff7abee58038452f1c45675aeec6bed0d18edc96df88a9972da45f664b170bc161ab54d11e08c083a2a07f23bddb925fdf4f82de7a4abc675797e9681197658d7831e53c66050cafc132a132d0e2d01b10d1c08a794f169bc66e06f817010b680082814dc6c1e3c0da4e28b53ef87ec1336216971f0caa1de2ce68fc270c47422719ab168b38784efa850b3978fcdd071284b3e19b66e8fbc2a0323cd291fb5b55427d169e54c95dfd3257b5dae08ba6d48497ff226e191f5a9f8b873981191f68b2107a9127f1d809830d41bd778758afcefaa576385c09f2b0febaafc7bf05d664c3cd4029a119a60a3befb2ace6c34aa7fdae947501ab2df5e51fb139ddceacd29dea2c6a4cc9b634e0aa21838b92bb9d8a35043166598c5a9b4d1adeb2b776349340985eedcb21f8e8c609dd9b8fd3ed25af4d3d2a124c6a9f04c4cbce193cbd5a9cbde001b573713991e480d041bc6492e981fb823c3f48185bd5ed3f2215a3f437190711d678dce053649a2f96aa68c941f947f6516d93ed6baf40e83f1e9a8909676ed093651a46554c39fbb88b15b3b990cc6742417e1b66af4c15087c8ed6d16e1c8904dffaf4deb1784d0d1733ef7c7ed0ce1d95900523e7db61d6dc3b36dfa60235d65c2e32388850b50b42d4dce54d571f1cf46d5f972ff18959e07bdad254d85cba797929c3bab2455a15d9b5551fb4b5fedb5a5790535695eec9116b6b7c5b17f8089b43622337690c87fa4b6fa93558490cec899ab227574b1a8f368ae7ba40e3ff05f2c4f6316a44e6c7528e3c17da93c70947e6c865823f25013b5a31f43bc085279cd729eaa0684099a1bd735378ed162689defc0a2dee29b2bd3d4dff1ee5fdef567934549dd2e64e952d1b5751ac30bbc9cc811c681c55f3d6629909592a57eff312153f685101273ab81c392115bb5e4d8142c2928ef9f26607dc6e542cb343efc5d4239783856b00b56a27399fb4aa9f20db5d5ff05a800b1e4f286e3bfc264e81569512e62aaa15b0c92de157cf098552b0adf8fe701df5a1f42f24c9cf81e646831187e048f98bcd029163bcd27263a613e944aee8f920df785d401fced2341e46d0ff6583bd88781fff3c8c6ac69893f814b58b9ac90f3726472544c7a70b0caf939d20fff1a220e3854c0930b496818b21b1b6a066be0c326fb996af11b4d6d8ac9701bb503d9c2bc7c1bdf203cc2008d577cc7f3964b3bc6edda5c3c974b464eaffe1fbc029d5c5b5ce8504a9d671739f98612f006a08dfda0858f234b6b4428a55c06a6117576654141c198b5e5c5c552ecf5c09ee6b03cb05ddc383e8569d2ef87d7b32a9308fc9f789b4f66320d7cc49486482c03bb640013a567502be60c6ce726836871304096cb753ece746bbafe3cae231075a2b58005e14041697152e57d0cca98268ccb846b46d9ae89d4fc08fbdee360a069329c828b256b0fdc670867ef1e8e3f3d4e62282bc9a06aa5c5318b217bae097a9813923a934d819fe621fe151873df572861761920d20146ce3c7594c606b7a31ba0b1d15a0b77080b296fb8518eb4dc04f0522212339c111f02472d55eadcbbc96b79d27241f3587b2ac66e3a822531ac3437185bbabc660bdb8a6dd233b5b6d1a68e29879aef7753e2c21f7f7289d980c7d8584ecacfd4008ad390ac78527e449c0f6be83a21a0a637c49df75ec0fa4f3c70c658e7f1fad5928268b71f67222da5f8d4b53e183156f37c5b26bc61e37b8718becfb433793f0d477fb96b23aa3b8bc6d76b74125f385373058df90e778f06026f7dc88ed12ac0ece6b6746eb6bd72b3a3c6b2f84e3dd46b99c4e9c47607f4c6747b09bc9810af1e629820cdea29f49ff37864ab512696836116deba96e27d110f60fdc707fcba918eb1a97605a49677ed286ebf138813ef83f45a2979410f57d3829a618268e5e7f62d4204f644214ef808a5521edad2157d468612b720aceeaa7fb31cb35f86a6a62e62481aa2e6320be7306e092dabcdcf50014272d22b4d7fdb19216b1c05fad76c714d628e41282029cbc976f886156eafa016d72a755ba266f840aa2d45d7c69bff8f6dd00f2055dafeee715211dd9e20b89d3c0cbfe7aa0e49022083bf090d3acbf8e498f51614860fbe1d52b15b3302ed9357e4f85d09ab46af9d80ae017623f17463db4e4684ad967d558954fb43ad7a1598bfdcbf1522f267641fa60709ceb57c909c270529f8bbc500818b5aad21c7100a37888780cedd8280dab3711b4db1d5ed51bbc4007d3f2b969944517a85c83ff4e98c1a6eb3d1ccd3ff0303728e3235783d12b5084ac3b0a12ea8847a29c9750488211ef3172df813c248e1db637873e7dc4f57c5a7a7f41ebe15472c7d0783acf3aa446f59404143a231f58cfb6a33785a85c234701544a30aee06d9d62b44d0eab7aad17d7680d56db4131c74e56ebde7af4ad3966dd12d1d99a9a2da70aaf3868b20a3fef15c4e9a497003a9ddae73cb88315afcf1af1ce6227b6a2752946fd5f7d8d17c0260f5e6d05b2d1142abf70fcc44166f701a2152749ad179e326542f7e30f85cc6f0cdaf722f2800db54674e64ac16e3389fce8d7b705c5b2eb121a8c37ae4753eb398533bdfecad07903839f8c3801096e05fef8da4196f79340b72b945e157ed9ae4a1aa9cb53842dca842f57cc5ece7b804d66abc3023acb71d934c0971fd993dc6379ad80a0d3a199550c10d4b36edac389c4905a314231f47bf8ddc65620344e774577665159c7e9df6ac9e10bc025059beec140c297313c41dea48b7c1ab94d9ea73b23a2168c08d75adccb2b178f600b14d1e98fb66d3cfe8772fdee4eebddd2676a6dd65d45842e31e36530c5e6e50e26dd6e9ebf217aa0f3700fe1b4f86da7cd9ddba55f32a76af84632b68ece37e7bf54011d5a19a10ec5c36d1db15f26e8266126956266ebe36711f8309ff6bbc399f3a35262fbd99f003a84f921e833324c05d981f5e4390485d56a25c0c1435dea67bf8eec7916b6522cddd8ca3088fd1f9ef4eac3eb5c479c35888dc525c401aeaec1b58ad6267823538996c63c98fddd1d563aee185009636c4ad2f3b91e0baa199096019cb1362e59bd58e47f8b4e15e692877c0538f30eb84f33bdb857fe0947b08641c61041b9c903146d1abfe3a65cf8a6a35c366c007a027d2b45b3340c3246580af4f2e2f8aadc0e65095627decca179249820f8a6c161c01d903169547ae54152c3c38bc9d5cb85e56811c9cb5e94ee1366602cb6210d0a5ae2253dae9f3e180396808db084659568b02346c456fd01eb837c3c7d204a02d87df30bc21c1ed7c6d66a252c21a8a26fc4b1a337f8b996f94fad08f12c04f0d28c58153e2f29b0ee658e24576e62c2842157ec7498f3e8fdb15cc6360007f1ccbd32de64f779086ca7b7d38c5a1b24c6b5b5bc1e894a10b20417ad58240c81f85c9e5a143b321c4cbf9f2ee6fda14a0aaec477f1907e2117cd1134cb715fc7ff7785344509d623e47cf258d74ca79f939ef4824f86acf83e1c707f8cefd45fe21e95c42011a26c7c68e4b0127aaaa8bcc641d6665851a1725b2cd3d735ecb4e65b43aaf4eb5a64a345e1cb7ca0871ef560c9bec7f876838408f9b1260f907cd83122e88710883dd335580a9ead0719b0b24d8edb5af81e4e675e55811b236b1701114a35df682d5f7a6608758b11bf068f4fe8f6256aa4bca7f69577dfbba8c327df76e77570f2401bde3cb9db2d55a06b7f0e4226730e08a8b2d7391869e6a389f61919c8a3e6ccee98434b84f1ac1094a2538a14f0091675c84a17d21141f1fb1eab83444ff75137ef424665a631f2ecc377efe2f633920052c09188b4a259d778fbc424a751a8c960a3d810555017d462153836b429dfa37eee51d4550d58ed3f59dcc2390d20705858cfe9e4efafd1a81284b55d38f4f69bbbfa3f35e77ded0fd5183915dd2dd81498b4611b26b8e08dffd3ba5c5c9625fbdf7394dff91a8fa43fcaf840f4f25ec71fb509196afddf5da356bafae506bd9c848cc57ef6a0247e1e0d2734e9428292a63b9fa450f46e83e0731a92461cbb9096eff4defb23f1c23a822cb8db656393a764e7ea5a033354169d8cfc188f94726d307fee27bcf21b996960cfb916ebb261a1aa425da6c2695305e9a9703863773e111fe88e20bdee832e4667c323f317c6b9722b628ec04b42429d85de0c66f5d6a1019304aa098ea52e06d80748df8205934d35db7dfa0c629ee6615fc4e4543a1002f9b5fd6ccc8fc5f62804e02ac64df23bbd4a8037f27857261f1c6ebae3487187ba3eb25a290a39d0ed31bf8de41e69fb06f7c53f4cb5f689c8a2ed3fa731fe90c4e00f797434c7d45ebd04203a76c0a7788e5a2e3636a309ea6145e3b5ab69b7ce0b40d0b088adfc261f3fc639c06e628ba2d1988728e640bd930cef19126940280e6726271aec5838122318488888b36d3b8eecfc4d86508a037dc03f96571aac3b655f9f2a162fbb068d5d42eea7e7a07b36045e71dcfbda1beb4d7f93c34bbdf1f0b05cf6d7bfed2ace4a4e01dfabdee6283e63f7cada4afd478fb42d816c85823e355017063dfea493a9d52e42815ee2fb168e432e93181fbf893d953a7da230c7463b8ed31c501ba4918f6cbb1b5d5fdc07c6d34ed792680d8e804354900e4d64b2979765d4f8277fe467a14f4c53301796b5aab830843cf371663e41bd3a4cdcd4988537a9bb6a6da81dc5b5c3b671947fe5844851c663a071261088c97411cd6fc2383e7385a8bf9a46d24b4f12b296e8d21f48bd147eb7534d58982b755cf8fd8f02453c8aa3022cc793ec4ae9974b54de41abd9daf152124c21a65e31bf09a18f3cca955e18fede7ccf6f878555c5e60a3fe6795818e35951af5458454cc113490bedab14cf0001fa2f80b6cac810481032b558fe05116fa48fbb4f83478e1edf920d02fd18dd046cdbc98c991a2fbd7bb54bcb5254cf7bf59b6f2788a6a95add48dd39a807a8a12f63d31321c1f11d7c0fce7701f4e03a13fda09d2920585b47b3eef0be4406679420255205efd555cfdb56a4ad2fe8b8b36a17e0efa547fb34d13f95c66920d36f6d2820c7642d8b71498d3c1c3cb75723cf0975114d493d32606b08f2d17356d4074d3e0c00644222e95b3e07dcad436ea799baa2530df0189dec6aa10d67238d19d91cf0612d5e477fff4647888d2e76686aeaeae908065b772844a57e1a18f515eb8ebaa381cd69e5c5188f81283d25dd4438b9dc420799c6e4a6fc2301c9366d03c30a019a3f406df4776182e6204e47bbe265e1a7281e6c86f5b538965caa433dfe87ee6845d44d588b8a1a430959535983107fcc4e312bffe562371dca9a91eb26fb5ebd44326041f9c473a9b8417e381509677d00205e1c4c9b9a04e687ad5d3cd3d2e08262f82ad405510fc8a2687c286b44b5c427a8663e85468b399d223ffac0debc4e9bf999b6ed2b32e0a73f5e602c4afc8dcbece1f806126e1d3b359667919c527b0168fd16eaa644275167e32f570785cc79a3a392a55ade24852cf5e00a9332f226bfd24163d11db76bf0c7e035bca6b11f56b7815e8f3f1e2b3f33942bdd8659c7bb4e8f0fbfecfa0e7b8b0a7091c3578ef478c3b96b2c586a7de09c7b8d59911de7a3c1f1b3962d05c1440c8fe664adcacbc0cf44aa24567e6983e88d73e37c4851c20444d16b506e630e629e682a83d6480c65ce6fba90c5bf4c58cad2633db1f9f5676caedf5da401c2cafcc31a0d4185f95bc647fc07aa8ff1a6c9a3ee195a8d80fe978ce577b7dfd2a54ebf35955260c94137ec964f0968afe29a85d89a563f9233fe0c823b37056e9440e572d21e6f5190b8f2414a3e415c4f67d075e2d974ed95f5d83dc89a08484560ecbc2ebafa08e23dc7f502fbdb21d32d8d4f21c02b4e64f269c89534492bbcb658ff0b24a099e39bdd7dbc9769fca1a8120ffb805bae748e2884e5055e7043f6e2244348110882353a92a3d2af580351782e71ed33433c9424b8207a12956af285c5f62dccf4230e18329b466d15e02b70efd468fbbc6598b078ffa978703e0468f99edc8587113933d2dd4e751a98f6bb047c17c6d866bb8a7422f9fc772f83e272e6852d50ecb9e0d546049f914739f27ed6f0c8633304334d46243bad3702696727e9a572a8b076996e2de9870b6be556fb378c1d6bf7746f37b9e5c69a5131828425fba30016b7aa898aaaa9179c570f08f12557c3a9efd2d1f293c523737284b15ee81c3e5666bc607f6e33873b0fe57daa8c5cd9842872131907ce158afeeee9ad256d0a4cb811a0fcc47e17e50b3d2daf9f411da7eeef43a05ad794a174922334f2ecef8b9f7e391cd382547c1a5932133b467f70fcc92b7e8bc3021f0cfe6c97bb095749f7104b6079638c4fbe269452ea94cde626c1e86d0b079c6af5d411c2fabfaef47193db6cf278485c6015fd27d8203803dfe70ba070c99bf2e0c23ad28f0607bd13e23ade28e62092ab4909cd977a645c43bd766a53b650ff930c11d0b0d85ab71f01177c18b2e35bdad40c934fbb06b6044647da33f2e5cfb806609ce3ad0efd7f2474979626c602772a7e784ca1c2db6939cd051808e93eeee94aa0cd0117daf9ec27580c69492ebcb09132d18beaf591a9619e0eed1044bf8da5e0cd71b392ed650bf147996d288a8a719b5f4a105f800d3954d7ef2ede5289fafb0492cfad5b5b070b36283ba320ccdc20ebf7eb5633ad83a29cce7fa498a0a3abb12531a5c353894514d5ca480183a1b7caf6860eb9e2748f01b021da2e81f9dce3fa0d3c62e2552d39ac0dd880130eb6d362dccd1cd361f8506b707db208b4d04c2f3dd8402afe039959bae9c20199b9e401629e0d8728cf47d8f5d808b76c02e47725e0e5e2529dcc8dd9fe3592736b50d2dd20f40d823904d0fb926177c1e4f592fb9f79f91bb1255899a4a57ce79f5bdaa1eeeb38bf6db09029d0d83ead176cfab712f8f15f18a1745d157f3884e183ccc816f50fb097676f47daece7347d159114b189017cfd481dfca5c558b2d76b73b2e48d6b932cf4006ce72a4f778ddc821cdec9a8d0aa656dca3387863a8c47da49687a402915d5d128dda609fd548be3d9a986bec60118744439813ec1a70a5b6ccebf925b2167375503060cd10353c3f9e28526e1d571f42f83ce1af15d13ab953011ebf1324bc5f660dc740da50a6636398389e7f75411d6d9aaf56f52456df9806eec1b6d02b1cf52d377072b45408b6dc70b872a51bd5969f5c504de135b882f4c266ecd0c70ce582f6b8c19e8e1b9dfb577f427576201bf19ad95bfdf21ad1db7eb12d64995936adfb4726fea541cb7ce3597664c06fe7c98b191cbaedfe4e3a54fff222d7547ff15156fe34e4bf927fc3da63e405ead706c22f2506ffc543d8933ec7310077576edd9cd0fe938c8e5ab944405d3cd9901512b156752422e82ccc4a4dd1b8e80591d9fa69a5161e6610fc6bed889d427553336c67370b055ddb32f4ec27820b0cd6a77c9841f686d4095d3814680ecfc2a6a9f56178e26eff4ea47f58447dd8978d213b799373952bc3f45cb1ad803775c274cfb2cbe3c43d307a219804e1afa9e0bfa910a3ab0315a2195b6c8274f67f547e14a16748daeeac3681981421d2077e34e93bca9251d323dbca2d05d9dbcad144ee87674d59d56ef42af740bdc17748e8db740f66ee0f85d6b5c0fe60cb2597eb5d8743f3fd1cd8910646f4e3ec6b60eb617c447337525861cdfe92d909129dd73566d47f6cf147a9414cd2cbf3262614d0ca91d6ff85254def7ffee7c5302890cf17b13d48debd75b5dea94e7ea21c169b1b0a01a2da92885d940aea5bd411a31efec501e2f27332b46395a9d0e34b966da9dca2e4c204e972b222b639471493d9b3a72bcc91af5e9f17990cd834127bf6684cc84991fdb8d8a65a40751264ea7288bbe2e103c5370b32e53200cba9865df87951aa3bc14ae4d41b3234208e1f0df589ddbcad344cd74f1eda3a25344355a39a8185dc8cd72da3377a39c590a6a9f3472d98ae8ee1589e52cbf396473d450c75358c6166db532e773c9cf8585d8b0f8748bfb23f8d9bdaadf5588bd3594afee5d0ca38f72824ffe0e4e2581f366abbec6b6431345817e5d2703a51fbc99a8873181140110e03c09c6abe3b831434e45312c92524ac4a8332e24d7ed091f1176998d77e0df5834acba8d96d828d55c7e8d8c554f5f630d082afc44ca224eed1f98b46781039691bb8ff580e995f2bb7b7176daf7849947141d76697a199164ea02c9615c6a0fa94f91d2064405db23eee6bf2915d3c0872dd47fae3bccf977a3991904bf9930c082534697906c4b198d5ef7c2d69923c8d292b1f46c670c17adcea9fbc96740cc8422e5f7dc19924435c6cafd38a152aeb3a6293e01b9359feaf7033e9735b61f9870c1940340a50c9e605abf66e611d3efedc33b95ebc42f88b2780a5c5957af7afe531f699b69f30ab0dc11d5d466ce55d88452fcf571a4f210facbba5379f502615758ff150a73b05f268569560da25be2757a4c1cd9e5243777b8587230a31383bd9b45aa07cba748c017859efcb147c18a96b9ca70375ae80a72bc3c1b3bc5395851bae4e19eea39d9d140049efdb3b0c1fbf17043e6bfb8123abb9256f40e4772025866a1751de7166f539e8fad3cc2e6a239339fc6d8b82d6db560abba0458e93c198faf3d6a14bca7c249ae6714c4d84ac4c5b2bbb7d77dac1973e19dda6ffc7ce891cd08a04ff4874f7181062a5a6d464f23c18495dc399bb1833bde151ed747d12e34f88af0155a8825db888cc18fbccbdfa1447e756b099d7541d8687a14b22aea8789c7f95198b86bc079bb2d733f7e519fdf6e3f9866786799cff0ae3914425df460011a5c1cd28fec48a8458018f2ea28769a7ef173da5c7bfa3838cb91b1a5d42f57ae4698bd92aece133c970de064474aa48d35028cad1108d078910517e2a0eb48785b07fd2964702219b454fdb16c725608d4d2bc57e8c1b037fb2faad10b4ed56a53f2e0593783c05b295fbbd859504982594563d793a400c03a318220ad8d25f3cb248ec7a5c93affdb48a132ea1f07ab8e4b37fd0eb0a4a89a7801e5424221321037f51efc3f84d8318adb42059af36332c316453583b4c2622f9febf23be54f05899e15017f67f97d42e6c5564e025047709c02a3c85bd233ee153fa0ad48d0ef733b426e02ba5137addbe9aaeaed7a8bd44af3d0a6ef19740be73cedc101423ecda93702159c1f29b241d2198ae6309abca9b27194849854a802ca6a2f2267e5e6aa459a32484e885057c3dc424bc7efd13b5dd6d00b3adc919f8bbddd9e2e6a836ec4030be04bb9fd026b3d589dc5d05859df0b3612f19f708d3f0c906bcff5755e94913d3bc5dad165ffba05a8ea949e3b3e330e82a61aee60a6c116320414ae3242d921659c2cf226fa67931bc4db5ca010146ae0eae6792a08c7ef7044b1e067d1f620feeaee3625d26b56dfff36974852d31fb0fbbf012f4456c3e1d70800790890d100d309ac4f96508754a1dd2d027451df13ac0fb86ef8fca64fe79e8179988338f9463578a277dcb154318882bf65dbf6d87cdc819325973c568aa31f524c309567caf6b11f22f2cba3c39a633e2b011cacfff8b792df6ddfa9ffbb7cb3592a541279a836b608587afef02d5cb4c4bdc1241b612bd6d26a166dd4c65d092a625ab9f0e61c29a93c2e8eb77af3f8d6b0433397ea9094445b34289bbe00d4918088ba9b0c03ca295226d7c8741c8b894ea345f2e4eb663643257744ec5802426d73610fd64634eb18af2dd9ef004467e8b12cef11065c08b6545aa65feb03bd76ee95fd37218d313b9fcc5c0b826a1d37ec39b03ca784071ac4b81a62cc4130c982015872149589e6dcc44a0960d0a4452959e4aa50b4120f4822379242b49d267d1cbd02d09227dc33348ccaa17cbe04fe210ff5cd4ff78df51aed3d64ab1706ce9ba9138d3babf28ad7a06e95bf1a1f106734ec93d623912bdfebdb24c34585773b63dd5530cd243bd600e8c0acd9be43911e7c918493de2c941d0d4b63b1bda9ce54ffea559e70aa04b7709c35d82d30e77f59e8d6010df858d50b5b1c08385ae84035d2ae2a08afa71841469b88d907ed3626acb0c4fb6fb564b44a00e7fc51615d19c563f8cb53962d3ddaec5820359d7415447f975be887cd75b223d95e3af7537bab5452f861fb8e3cf6153acbeb406022e4c850235d6dd9d203b7421dcc9a17c964ee86cdbbed7776ba56abb257b03d4e5ba4989082f7358f1eb2a002fd21324f44f5b484acf9cf9b12323f3a42290ddd0f15db72508f9009c01192be38e8d344b5d0ec75d5fc08b70bc099e7c3c893769289ea731e900cebab3493d2c399bffc08db955af0c68eed57e68cb5cc8aa7c5389b62fdb482f0bf1467246ccef6bcb8cdd04019b6e440236aefc43874de7f6aee5a73cdce4e2b60ecb1711cfe413289731c1d9589afc4e563123fbd6c6abcd6b54c93821358258651605550d05f7ddb1462a90ba4741546d2cd274270b79fdd6a540de681943f38f408e9f523c6cdcee0599b2b251b07defb03bba9147fdb9340b532e7c25cd2394e8bf21d7021c6470a12322f7b1b0e3e93a0facd5cd059b46e7ceee1117d64ce60508e21355b56230bc31efd46343493f47926221419b72d8d3dd6247a7f41851b6a4b5721f14bdb499beecb0a274a94ba87deba90d4bbe4b88cb57cc0fe974999358a98a36decf35f4622af87b6605433267b8a319647e432a1de0a939b1944fcccee2f624ca73f19bef07377f954899e9f81d899c935af4bd797df949dea6cea838b5775f73fbb05fba83188c65ad7e0f69e4496836919504e6d545a9a1fb93f3cdb2c1af47e95d257ac3b2c433b2f8afcc378665d7bfa2da12b3fcb5f5671ca0f04f38f955df7b7f6af4634913a0ced4b94a32a803a4b811164db87c960c35dfd536cf8c831b1d1b3c5c1ef98446a2077df2f239adc39d9237d786b8ca269a96b11b1bf8b5efd0735bf4c3932f11cd82ae63188e81367d31bfe6de498ede57bb7f768fea395f22abe09021cfbc488cdc1546dc94311c69c41e75bd95fbd9f684795c636de5078b42e18f30553b55ae39f781a39da51ba7df8fc4faa7a93b7e94730c130cbb5a7c7a97e4cabc18ee91229194d0661e2e95d516585d957622b48619fcc7fa2239b7a601b8759310c31eaa798db7c79a174851c42c2456bc4e71a1e28e027776c162b679e5342b418ef1ed2b9881b00add8132888c590c7837d3b78d52d64d60046a12ffd8214b54cb28d9cc726f944fffee3761030dce186556afd6d75b748bddf7ee34ca5627688f7682cb48238724092d084c2d6a6e85a0dbb04129601e1dfe47edff92eb8af2bdf94e370ab020d795e60658b16a2c7cbcd7ca26ffabbdc005c17617f37d2a9f973e9ea7d478ef497b6d4a01d578009500c23ed6665c47cf32ef1ab3e8f38d6caa2fe39496d228156f3b686699024601f936f902abb98e5bccd403bd27c4a5684e9a166a9abc10da99c5f39e4db7e32580c444eb196ecf4185bd84d68bd0b43aba7b755ba4f40a8d01917d325041c09af116fd103cf4d7c713cad2c8c03cc8287fb9200be94febb51164130b56fe277654c09504db92be17b14935039d897a11c1d8fe0c05e62a6d0a457c0e3226a3b8dcc4e87f42de9afd70deb7cb99488e3c8914e4f56de2d368ee52ede1e2eb57ddd08b66b59d81af3c7ae880c5756f472639c52e075071628d0d61e2bc83b7177a9e2c241a3b9fd6e7c2728b6cc22dded06cc569c99c3ffe8b5c4dd23450bfffd0c8fc6a0e085b74677da6b93a1645195e68aa26f555d34782234b21f71f668beb504e9dd55678572970081a419b3e94b7eaf2d0b020b3436d5fe5c2de8a875252c45bd33411da9c8204c537d3d9e81ee08eeea1fc3991bf719349a60bb1a70f1f221b0ce130e9985c0a4663059fd3b0a05f47702c6c16dc2c51e98f44eff94111130828819b2476562ccceb2642e3ad5eacd4bbe78460d0eb1920c3f1304040f3377cc46459817f2bd8b727e7b56f8a440b1443802a82c67fdc61f5e2a6f6c0b464d5da77df39f90f286c3fa364b53f341c87ee05381f6a8a15b60f6395fa75f0dca331a5d968523fb06935f50648af2b59ae01021ccf085ac3a3702a94ac6d4e4e046b5e8429568128ccf10dcbe933587a92f2cfbe872a7d0c3050893022802b818dbe66ef2e87bf5915d7299b5007492de082456f76c65364df29a830717bcb0f396be8edcf54a35745be58b5d4d02978afd9b906a6eb38a544ac6804a7b16ae9f014d6bd119fb914208a2c87cf3827db4f25104201170b1958e9afa878a71c5b9cc72886afb5e8173ebc4ca8b4cdc263863b20f003e059fe24a04e2297dbdaa1aaaae288a470511fffe1635b0acd5aa0a4c2c2b6a9e946bc3be0441da8d59c28a69be4279d9cba22b9e0abdcadb6cd5e5c3aa2627546bc2176a816e22fbea36c00739c5f071c641c21c836310a9ba13135a56ce18764c64474338b2f845486d80090958e70c7df23ec31386c28e6729f01393fe7d1b72e129726b88c1e34aca8743c5cc09c27da7c308ad67dd9510d2aa3b74d1c15d5126854077543cc307f154022fe7f013672faa28cc57f9381afaadc08c76e50357244595f8c2aef1e0cf1e72cdc216605644285eff94c35c365adf56156a2ef59507c55b5f00223b99464b60b1bc8e23eb86b25f506b59508b2bdbd9916ef365582135463e9fb3032090509694724ee06d015972958056f63dfd57168c545c642e74688da37acc5b86e074fdafe1ef5e5303de57b82412b2a2baf7aff589af43bf45e48613e2a3c3b30a7f245ec4daa0a446a46bfbe45553dd98db731121a75219eeb0f22ae5ac821c3bbccdbb2a1e3837664e773e99c9a8b21fc9c18d10e8dd1f217258f7cfa8a6bf3d5d0730a0925f0addbdb34b2de40b0af986e76e3bce1806dcd6a996d1941b3632154f0e2c037231b7117eafd3f293f0dfaacb7466c133b664db35eecebed21f3a815f544e7b8ad609c7c52d03bb21e4da9c6a749ca64fff14544689af90f547c93e5d2f3b096b68836815cd86340e7b5cbb667db088c944e169ae656116d541c440cd8e3682dbafeee9ee70d0fd2603d2b20379b5200d34129e7ed55d94be1c8fb13972ef0e6e234cbe8876629072cc5fc7e3a6e50a850c92e1693eac0d79fd4768a228ca7fcc93eaf4b540f2f7f06113eae4e2ccb07e66127880d6dd9def92ce9afcbefcd1faad7a57818d94dde0e90b8eed39a86f2afe2b33628db26fe4d020638468a7a7c701ecca735c78cd79a69df1f0230cba0e24603590a4f02fbce4186944f71189c136cfe5e132d245a83103dcbb149b88f5ec31fb090a14096846be3385e689ae0f5e262762eec519a521db2263d0ce9670f63487f85c04530e40c35e9a44b7f6de762b483b8efce5adf4f6d14fab9bcce07dad0baddeaaff4f7b8391b4c7fd44da0a1b5e794c1e8d57fa3d33b18d914a297bbde78b7e63b72234fe8a801c89a1a61fea9626ba02b1651b62bddd57caa2b2e401d5318faf68cf90e2ad090e96f57b8a01c2ecb50c636aced36dc5577c87ede31d9dd23be9534f041dc423d826da965ad1943f713f2504411f55f60f7692a130a90c1fcaaf94574abd9520bba13825b733911605104e9a46d1bfb4fb614ed99e5824f24819898e0c7324d939161079dcf3d3f11179be1bd98dbc570b14150c304f01b62432cec6b03e3cfed20818d6905594268494930ef113af3e5a657b4d397545602b6d90f996118af324545e2d68fec2c73de1e8a82bf7b87a286c555197645a05a1ace2def3a8f989d12a61b3f889ed82b5c7f4b43e7012aced98caaccb1e1b08c29fd72363249fb7c670babc43d608f3a9571a5062cc494ba89eb1c3a8fda8a766dc817062bc78c012bb45acab41921875f7f2898a061d9a19db9ae562c7a5dfb7c402f472c01ae8491959efb570eb41352facad5ced266284046c12921c06cdf6c4e9a0ab7d6a8c12cedd22617a189f6a0c2dd52917ecc1c6620970b3bb0a7b38f71a48c6b22aee9d311180dc2ae0ce0a3fdef9daac5ff2a910c2fa1ee25b383d8be4ce52a265d5e33a3c2959e6af12c18a6b31bd46c6dc880e452ee9f868695afa38bfcd4bd0199e915d6fed28e23e7f4f7dc7a8af91568f1e9744702768fec1d784ec9a0d3387e5dfe8a690f86959b5c81e40a30a0f29d10cc0bd0aa4ad0f59dc217d92e43ba32d6b772e9c12ae7005f89d8f33d6db327bd66b7153785eb6fe4ec2c663de5338d44f503386212b5dd36200c3b01453dd955d12a356745295d65ebf0f20639ac4a4f17a9d197fcedb74b731232de7ff0898b991762fcda15bc945e8d4af035785733d5a79a8bcb82a29fdd24ae50f6b01327e4c39ab44c9b5a7acdc783a670974d8d5c0006543ec269b1ab79e4e9af51db9f59ba7bcbf4a7bad7932981242b4fd7eb4c1d04b5f252779fef6f411465cad90ce14e23545d4c4ec113e4eb7165e6a1763b6c046f3a584b491aaff121d731bca4bd33e04863d71d87c601b8474a1a8cb1f152901b41eccacd8a86fbe022392c31a74f76a68df8e7d0d86ccad60e7a002a55aaf57fa16eb949d3f85c8e2041d967ed4c76d0bc4beacb0d46a709aa584dc6d0167261d1dda8939c33ad8941e8812c0477c09dda75f2b45873c871d1a587d5bed3ac9eabe790240013eabddd82f39e0332f18a00df19a9c20a0190f9fb8f1ac11e3171612a086d2b473af19df36ee558ddb1c325d615827f1f23e3b5460c40322c92c833b2b7fbb67d753e8180b62e1045b4c334c99d1b78da0bcd2b78e3ecc7f3342c98f01da77094ecf8fb15d3500faceca23f36e18981a69d8875e4340ebfab842d15f9cb9fa488de266f403f1009eb154a6514cc0804cbd89a2066112c88bf450b5cb2abaa73e20a202eac11c9a909982b1810831325793e81ff0c5cdcaeb09389deb9c7e618240bdb7209490113fd4b7ca1b7ee18c8cf49947da3512810640c97f3e562d9b342432ad6c38658b7d0f99ade91ea67394ca2ba8d1780bb0282116a3f9dfcad29a0ef49a273fff232e5a5856f7f4f58b84a27c13884d7bd49586fe6188d562d615c369aeb78198e63796d7dfd70f2c90ab2ad156447250613b61797760829af004e323710feb6a0c417e590fbe1e2db74ac83f5685b5a34f3da1c672942fe5b854f2bf9038bcb17e4ac6e5b1f63509e4a110f92b2705f00d9ec549427664b59caca624c740862793460d31d1c810c66fd6805054e9ca0fdf0e3f4e0fa8f36111a4b76e394798160872d8d672e70271a2e4d4b844a0ca2f167491c686aaafc04fb85ea8cedcd4678157443fa808b521244995e3f8fb7bbde30230f318a4208b7b0d110a062ff2f9dc172fc844b46aaf8b21d56a1d4a7c22d1184b64cb4645197ff23d51632e1f80af53e1ba6842963b4396d9e524f819e13a6a6fb951f9b291709af89254f9b0ff4662ea7e8408592d79fbb2caf5e332d2c3552e1406545ef82093a2b6e2a95a0843b00ffdd34eb2daca5861eb9246dd2302c67a932e8afd5486b1584261eb54b1ff4e111b048c642119787bef02f53427d86bca06bf2c70f08510b3b6f140f525a310fb7b7421794bab508da1fcd8c71db84f8322320eb609797a6d42148d4898d34994ff07e0b17dc5dadc9c27ea2772d55713dd3edb608cd29ab38e4904e30bf9b98dea7b717cc83270aee40b5d15244f4dd43342a394124b5240252eebdeadb61886cbc4ef95548388e31004286eae8997a7a5170e53275e1c4e6fb751e5bc41c4094d9c1d6572f1a0d129f8beea0cbe63afaf9f1ec17faecf3c23f4d1f8db87039aafc12b75492fdbfa71c2431ff3717e833b1757253f8137d54c697416f5f9fa41b7384e8861bab52882066ca7230ce7038093f33ef820ec3da847af1ceb6bb5bc92581bcc005f136c05d99c430c402cfab85a74ffc56b32bbe01cc30dc7007545fcbf2a00550c9dd34ab2c9f076c41176a4112d816ae4cd3d029a5a9d511af0d1f3fe0c1cbcf07872b2a47b9ed34049a23d026ada661e9bde32673680957ff8453584f81eb730960a6e7e722e7da188eded64772070ce19ac168328c8104d04f45d945b22a7c59cad92ed4250d67a7d8b8011e7914118590afb8ca220e4d34f45fb3dc6aebec9dba0540601011945b1d3b51b516d015c9502d","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
