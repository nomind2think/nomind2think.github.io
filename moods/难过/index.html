<!DOCTYPE html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8" />
    <title>请输入密码</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta http-equiv="cache-control" content="max-age=0" />
    <meta http-equiv="cache-control" content="no-cache" />
    <meta http-equiv="expires" content="0" />
    <meta http-equiv="pragma" content="no-cache" />
    <style>
        :root {
            --bg: #f8fafc;
            --card-bg: #ffffff;
            --text: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --input-bg: #f1f5f9;
            --primary: #3b82f6;
            --primary-hover: #2563eb;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        @media (prefers-color-scheme: dark) {
            :root {
                --bg: #0f172a;
                --card-bg: #1e293b;
                --text: #f1f5f9;
                --text-secondary: #94a3b8;
                --border: #334155;
                --input-bg: #334155;
                --primary: #60a5fa;
                --primary-hover: #3b82f6;
                --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.3);
                --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.3);
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            width: 100%;
            max-width: 380px;
        }

        .card {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px 32px;
            box-shadow: var(--shadow-lg);
            text-align: center;
        }

        .icon {
            width: 64px;
            height: 64px;
            margin: 0 auto 24px;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon svg {
            width: 32px;
            height: 32px;
            fill: white;
        }

        .title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text);
        }

        .instructions {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 32px;
            line-height: 1.5;
        }

        .input-group {
            position: relative;
            margin-bottom: 16px;
        }

        .input-group input {
            width: 100%;
            padding: 14px 48px 14px 16px;
            font-size: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: var(--input-bg);
            color: var(--text);
            outline: none;
            transition: border-color 0.2s, box-shadow 0.2s;
        }

        .input-group input:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.15);
        }

        .input-group input::placeholder {
            color: var(--text-secondary);
        }

        .toggle-password {
            position: absolute;
            right: 14px;
            top: 50%;
            transform: translateY(-50%);
            background: none;
            border: none;
            cursor: pointer;
            padding: 4px;
            opacity: 0.5;
            transition: opacity 0.2s;
        }

        .toggle-password:hover {
            opacity: 0.8;
        }

        .toggle-password svg {
            width: 20px;
            height: 20px;
            fill: var(--text-secondary);
        }

        .remember-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 24px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .remember-group input[type="checkbox"] {
            width: 18px;
            height: 18px;
            accent-color: var(--primary);
            cursor: pointer;
        }

        .submit-btn {
            width: 100%;
            padding: 14px 24px;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            background: linear-gradient(135deg, var(--primary), #8b5cf6);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .submit-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);
        }

        .submit-btn:active {
            transform: translateY(0);
        }

        .spinner-container {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .hidden {
            display: none !important;
        }

        .footer {
            text-align: center;
            margin-top: 24px;
            font-size: 0.75rem;
            color: var(--text-secondary);
            opacity: 0.6;
        }
    </style>
</head>
<body>
    <div id="staticrypt_loading" class="spinner-container">
        <div class="spinner"></div>
    </div>

    <div id="staticrypt_content" class="container hidden">
        <div class="card">
            <div class="icon">
                <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 1C8.676 1 6 3.676 6 7v2H4a2 2 0 00-2 2v10a2 2 0 002 2h16a2 2 0 002-2V11a2 2 0 00-2-2h-2V7c0-3.324-2.676-6-6-6zm0 2c2.276 0 4 1.724 4 4v2H8V7c0-2.276 1.724-4 4-4zm0 10a2 2 0 011 3.732V19a1 1 0 01-2 0v-2.268A2 2 0 0112 13z"/>
                </svg>
            </div>
            <h1 class="title">请输入密码</h1>
            <p class="instructions">此内容已加密保护，请输入访问密码</p>

            <form id="staticrypt-form" action="#" method="post">
                <div class="input-group">
                    <input
                        id="staticrypt-password"
                        type="password"
                        name="password"
                        placeholder="请输入密码"
                        autocomplete="current-password"
                        autofocus
                    />
                    <button type="button" class="toggle-password" aria-label="Show password">
                        <svg class="eye-closed" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
                        </svg>
                        <svg class="eye-open hidden" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7zM2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3 2 4.27zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2zm4.31-.78l3.15 3.15.02-.16c0-1.66-1.34-3-3-3l-.17.01z"/>
                        </svg>
                    </button>
                </div>

                <label id="staticrypt-remember-label" class="remember-group hidden">
                    <input id="staticrypt-remember" type="checkbox" name="remember" />
                    <span>记住密码 7 天</span>
                </label>

                <button type="submit" class="submit-btn">解锁访问</button>
            </form>
        </div>
        <div class="footer">Powered by StatiCrypt</div>
    </div>

    <script>
        const staticryptInitiator = ((function(){
  const exports = {};
  const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassword) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["encrypt"]);

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassword
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassword) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey("raw", HexEncoder.parse(hashedPassword), ENCRYPTION_ALGO, false, ["decrypt"]);

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassword(password, salt) {
    // we hash the password in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassword = await hashLegacyRound(password, salt);

    hashedPassword = await hashSecondRound(hashedPassword, salt);

    return hashThirdRound(hashedPassword, salt);
}
exports.hashPassword = hashPassword;

/**
 * This hashes the password with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} password
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(password, salt) {
    return pbkdf2(password, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassword
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassword, salt) {
    return pbkdf2(hashedPassword, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the password so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} password
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(password, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey("raw", UTF8Encoder.parse(password), "PBKDF2", false, ["deriveBits"]);

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassword, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassword),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;

function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = "";

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;

  return exports;
})());
const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
    const exports = {};

    /**
     * Top-level function for encoding a message.
     * Includes password hashing, encryption, and signing.
     *
     * @param {string} msg
     * @param {string} password
     * @param {string} salt
     *
     * @returns {string} The encoded text
     */
    async function encode(msg, password, salt) {
        const hashedPassword = await cryptoEngine.hashPassword(password, salt);

        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encode = encode;

    /**
     * Encode using a password that has already been hashed. This is useful to encode multiple messages in a row, that way
     * we don't need to hash the password multiple times.
     *
     * @param {string} msg
     * @param {string} hashedPassword
     *
     * @returns {string} The encoded text
     */
    async function encodeWithHashedPassword(msg, hashedPassword) {
        const encrypted = await cryptoEngine.encrypt(msg, hashedPassword);

        // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
        // it in localStorage safely, we don't use the clear text password)
        const hmac = await cryptoEngine.signMessage(hashedPassword, encrypted);

        return hmac + encrypted;
    }
    exports.encodeWithHashedPassword = encodeWithHashedPassword;

    /**
     * Top-level function for decoding a message.
     * Includes signature check and decryption.
     *
     * @param {string} signedMsg
     * @param {string} hashedPassword
     * @param {string} salt
     * @param {int} backwardCompatibleAttempt
     * @param {string} originalPassword
     *
     * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
     */
    async function decode(signedMsg, hashedPassword, salt, backwardCompatibleAttempt = 0, originalPassword = "") {
        const encryptedHMAC = signedMsg.substring(0, 64);
        const encryptedMsg = signedMsg.substring(64);
        const decryptedHMAC = await cryptoEngine.signMessage(hashedPassword, encryptedMsg);

        if (decryptedHMAC !== encryptedHMAC) {
            // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
            // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
            originalPassword = originalPassword || hashedPassword;
            if (backwardCompatibleAttempt === 0) {
                const updatedHashedPassword = await cryptoEngine.hashThirdRound(originalPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }
            if (backwardCompatibleAttempt === 1) {
                let updatedHashedPassword = await cryptoEngine.hashSecondRound(originalPassword, salt);
                updatedHashedPassword = await cryptoEngine.hashThirdRound(updatedHashedPassword, salt);

                return decode(signedMsg, updatedHashedPassword, salt, backwardCompatibleAttempt + 1, originalPassword);
            }

            return { success: false, message: "Signature mismatch" };
        }

        return {
            success: true,
            decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassword),
        };
    }
    exports.decode = decode;

    return exports;
}
exports.init = init;

  return exports;
})());
const decode = codec.init(cryptoEngine).decode;

/**
 * Initialize the staticrypt module, that exposes functions callbable by the password_template.
 *
 * @param {{
 *  staticryptEncryptedMsgUniqueVariableName: string,
 *  isRememberEnabled: boolean,
 *  rememberDurationInDays: number,
 *  staticryptSaltUniqueVariableName: string,
 * }} staticryptConfig - object of data that is stored on the password_template at encryption time.
 *
 * @param {{
 *  rememberExpirationKey: string,
 *  rememberPassphraseKey: string,
 *  replaceHtmlCallback: function,
 *  clearLocalStorageCallback: function,
 * }} templateConfig - object of data that can be configured by a custom password_template.
 */
function init(staticryptConfig, templateConfig) {
    const exports = {};

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param {string} hashedPassword
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassword) {
        const { staticryptEncryptedMsgUniqueVariableName, staticryptSaltUniqueVariableName } = staticryptConfig;
        const { replaceHtmlCallback } = templateConfig;

        const result = await decode(
            staticryptEncryptedMsgUniqueVariableName,
            hashedPassword,
            staticryptSaltUniqueVariableName
        );
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        // if the user configured a callback call it, otherwise just replace the whole HTML
        if (typeof replaceHtmlCallback === "function") {
            replaceHtmlCallback(plainHTML);
        } else {
            document.write(plainHTML);
            document.close();
        }

        return true;
    }

    /**
     * Attempt to decrypt the page and replace the whole HTML.
     *
     * @param {string} password
     * @param {boolean} isRememberChecked
     *
     * @returns {Promise<{isSuccessful: boolean, hashedPassword?: string}>} - we return an object, so that if we want to
     *   expose more information in the future we can do it without breaking the password_template
     */
    async function handleDecryptionOfPage(password, isRememberChecked) {
        const { staticryptSaltUniqueVariableName } = staticryptConfig;

        // decrypt and replace the whole page
        const hashedPassword = await cryptoEngine.hashPassword(password, staticryptSaltUniqueVariableName);
        return handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked);
    }
    exports.handleDecryptionOfPage = handleDecryptionOfPage;

    async function handleDecryptionOfPageFromHash(hashedPassword, isRememberChecked) {
        const { isRememberEnabled, rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

        if (!isDecryptionSuccessful) {
            return {
                isSuccessful: false,
                hashedPassword,
            };
        }

        // remember the hashedPassword and set its expiration if necessary
        if (isRememberEnabled && isRememberChecked) {
            window.localStorage.setItem(rememberPassphraseKey, hashedPassword);

            // set the expiration if the duration isn't 0 (meaning no expiration)
            if (rememberDurationInDays > 0) {
                window.localStorage.setItem(
                    rememberExpirationKey,
                    (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                );
            }
        }

        return {
            isSuccessful: true,
            hashedPassword,
        };
    }
    exports.handleDecryptionOfPageFromHash = handleDecryptionOfPageFromHash;

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        const { clearLocalStorageCallback, rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        if (typeof clearLocalStorageCallback === "function") {
            clearLocalStorageCallback();
        } else {
            localStorage.removeItem(rememberPassphraseKey);
            localStorage.removeItem(rememberExpirationKey);
        }
    }

    async function handleDecryptOnLoad() {
        let isSuccessful = await decryptOnLoadFromUrl();

        if (!isSuccessful) {
            isSuccessful = await decryptOnLoadFromRememberMe();
        }

        return { isSuccessful };
    }
    exports.handleDecryptOnLoad = handleDecryptOnLoad;

    /**
     * Clear storage if we are logging out
     *
     * @returns {boolean} - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        const { rememberDurationInDays } = staticryptConfig;
        const { rememberExpirationKey, rememberPassphraseKey } = templateConfig;

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassword = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassword) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassword);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    async function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";
        const rememberMeKey = "remember_me";

        // try to get the password from the query param (for backward compatibility - we now want to avoid this method,
        // since it sends the hashed password to the server which isn't needed)
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPasswordQuery = queryParams.get(passwordKey);
        const rememberMeQuery = queryParams.get(rememberMeKey);

        const urlFragment = window.location.hash.substring(1);
        // get the password from the url fragment
        const hashedPasswordRegexMatch = urlFragment.match(new RegExp(passwordKey + "=([^&]*)"));
        const hashedPasswordFragment = hashedPasswordRegexMatch ? hashedPasswordRegexMatch[1] : null;
        const rememberMeFragment = urlFragment.includes(rememberMeKey);

        const hashedPassword = hashedPasswordFragment || hashedPasswordQuery;
        const rememberMe = rememberMeFragment || rememberMeQuery;

        if (hashedPassword) {
            return handleDecryptionOfPageFromHash(hashedPassword, rememberMe);
        }

        return false;
    }

    return exports;
}
exports.init = init;

  return exports;
})());
        const templateError = "密码错误，请重试",
            isRememberEnabled = true,
            staticryptConfig = {"staticryptEncryptedMsgUniqueVariableName":"b7b931997ab281c724ccda3e89b4a98de5b1afc3a000e190e441c9c20fbf20cc2335f4f8e07646ef53046fe892f5e0b00934eb181e493b861df7d59d37d6ba36fc552437c413142e94bb557eeec01f9e530aba64dcb2d4e541be7824e0c2de7c5abba6698d577f39a0c1336d7886096995113a083426f9214f1d3c5024353a3113be0f4925c30f375ef0ea4823edf0d9a4a4ec94016fdae0ddfffc53f5c4f305aead4a21282b32bb36706b1d125fff7a5710874a5a66e4eeb35d274d1939b05f0e24bb052d26c0ab2cd37707a4ef11f825a186b95c2a4ba9d2e2f1ae1ba1f082186906110a8ac6632f277321d721f3365c11a7fa5d3505e1d7b369d703b92a40c0c52feed49d148fa6b0d246788379aac9d313fac6e01702aa65300d1bb136f1bb128eff9c22b1ab429dcf98101750208dd10433f9b13e2ca8263742b9a0ce703722a4c67140b7c6ce9cec065ef5866bea67364abf83ebcc1246ce7e22c250837e3b7945f52d20cdf16dfe1535cb0a75b31499c2e9a9e465000bac55122e1fcdcc2daf9a9c3ed31d3c4299c1827b7af16a96941721a2bc967d0f27dfb7d8d8ef3304bf32da64c5bd4a17591e59f043c61c6691fd9c48d4864bf4da067c6c6639383756c6d89d4604d9d787f59170a5611f5855234ea2b7ec687ab22bf2cba1353cbeb591940f57527f8ac391626866985791a7476568644f0f1927e3b12f0012a37d0806d2feb97aec2491ebc53006dd0fd72a73ba007925964e417479261e02ddb6377615d7c11a64a3f8c32e4e8cca84aae1959223203137e20088b2343e05525672d319bbd6968a59a6e06f3a81322ee0a46cd8c6f2e600359fd74e038569476543cc276d95647bcf6c823bef4a491f9cecab395481363706fcb03b00379ac1e574ac65711c31dac0d85254fe552b76d233a3ae78999ab7736a176947f1387fe83c2df5c11a965abac044f5a488a0b0099e701d63f1fc8368d2a1bf9e0bf97a06b67283f868bfcdbadf493873903a1ef6346cf85b1b87bc17447bad3f227f8103f375c1ae42985e30c3c26cb9a7b3db3c01397fa288b7911eee1993b0bd73b698cc38801aa188a25976b633d2a63ecf6617554ab5b9c0b2fc3f7875a101eb3234d67484404edca192ad1575aeacf98ee644b02b25f5f03e9bb09bafc59e0f65393a974e39c78797a5870a27a0bdd88f42175d5d8b2faf01a4b8300eb39966c2626e7de4956736e3f37a9be79eef399fb5bcb92bb617fab996db1428117dc472f0cf099aff27c30963deb1425886dc3978edde2caa6982cf40743baecbe4861f631561ae73557793e68faf40c73836b82554aca82d8b20dc1e55a55fe6e32113047b69d5457fbed120fe5cd70e4bb471210b472ef3b7e828b64b107c6c497e8eabffd0be7b33aa466d0c3ce7e939ea7def5c8338ca01e08ca16d6ed0b7572328b196ffd5b8961a3c1f162503d02560f83998e44b934fc56dd7f1cea367e667250906163ffb8faf388118cbf63898d930de0a66b477ebb97248460a4ef8caeaadfbe949c8ed51df6f0456eb195b428f6d68553328ee070791f0d0d585208fd0b1429d65f927f651ab6a0ea7656649c421dad740cf224a00f7f7a1af88610b5c6776c5fa3d74e2225515ee9e8354648fc2f8e8dd37b3ea4889bd74800e0686d4103c7fb4ac4b7c2817e5fb11ae1649cfbb8d9c11ae73e58c51421e413ba5460fbb39a23ba00d40d83665805474b9c60efe71840d56d126ba83df2ab8b8b374be54596d304e7a5a61bf4e340f141246e87617fa41b3e6c81816c9402e14c35db4fee5841f1427d8a3450a6dc3eca7640097f533c2d668083f381ba97e7b00ba21da531b3dad5e613145a8f9f0c86d529be99e53592ffa3afea8fea1e3f8782d795c3d0445cff6bb41ab400d4f00b7c85bd297c688def18e1468230a5dfce181585de9752ebb9e8dd339a4103c30a53def61e347220a18f6cda90ac93fbf7841f3449c8f8838a9d03577b219695a1745d1ed540fe11ac50ad11d4b1da78f20d8229412fe77e34d0dae60c92d90b289f213dd90163d9c9adc193e28613cb72827c6cf74b1917ab432bc78e6c62d6caa3a1196a93b1f5348659aed17658c03ac9d950fdbd51f849d3b1173414a0d99a7ca6b1384e10c7eee00cdb5678308c95269aca16b7bc2ba2c30d9c235dbc34a37a9de8717514397dcb9865ed84e62139e8563ee83ecb651c5bfa086f5e35e2d83d2eb2830cd9e8f1a398373134f5e1a7efa89d156bc4f49999fde4a0b51d5b44b45f76c6222e15f82ba7bdb3b4001197a2177c206a244e5a86908f24a1991ac9baafe0ea9e7c9b71d96429bdb079bb92d801c347d61cafd1c0a0d92036ac4260d41b924fbd7f8dd0cc31e16b62b5d917f64fd5b18d31b3735ed335cd8353df22aea39c9b84ad7cb466085882fe951c565ad8f26c3549fef04c5453fca5a21cc0ec4eea19981ed8ef4c0ce012485bc4d7bb8c9cb96feee6c7ba26f13599725a1f0f52798aca7c566d6f623cee284f21af3dad8e3abce18b006234636fa47a3a41da437b1f21c61e8316b8b6da8c64cd3dde0c002e8d2d344287b59f830bbda1b7009b21c7b803493a13b24428ac8ae1b8e1305594bd85ad2f82b4e81396584e74401ea607d7f348f4280eb5ae89e810f66463d4d59ec45b2ee5774d64f17c6798264674c4df3c3b8a3c00eace2232679811fd31ed3a4d89a8071c675a5509e20d6f84f8ad99e8a49c2753b08fcafa56eb55d81194d7762a40a910c0a0d5f6b3c853b98c971af1faa09eba369d650d9def52fa2147d4d136d05ea8dd40e3070361a20001d98029805ed3cd9225537d86e0175175f8b0071cad6c0db9a6ccd7f56fdc79b29136a4dfc3d3dd2a472055ed504f73db4dbbf8a9898c926b7f29c7075cc25c665495d64de10e3089cc1b6c28e279f15f2c0e84baa3ea6dce78a54fb4cf4983e68cf367552d247eb3c3d8523960f822ed3e33f50b7b563d33b69135e9adc94e812b34aa6d505625585b5b57a60a897943dff1a17056758485a2ebba7724fb2fd147c2771a4e7a9becad883b05775e9068d27c5b4b444b62c87355f34d9b04371553eb045a0476ba4a7a69e8d226d73cf4c97522c41f69619c39a3ad8cbcc0b51fbddcd455371b4fd747b06984de67f2f408f59551b87abd6116b4006785337b4c3ec8fab89f08745b4d0b0082a0e4348eec7b36d9a77fbf2c4dcfe2de6d68c0e7a03cf8f94cbca54b909f6cd6952d33125293ef672b62a96cb71f7f37a25fde8dab98c424610988dee12f2067ef51398e57c9335c2d0e0b59d47910db15e3033d7052f1cc8f1b33a84d0d0890120d4188eb1d5063cd6883fe7e5749ed9737f5094be3ab33775c88e95c00f7ccd975eaaafdba78665daf28131d2e87b293a906a6eabbaf49907fcb706c6b55a7a6aad25ba58892d96abf1c152b7a55a3637e4a98f72bb78739bea7067280d214662d9fa5969fadc7bf63b09936d816219261ea85a3c8c9eb3a269577a8b6148e8cb39220cfe5a7a6dc3f178224bb00d0997e728391529d6eb4c95d5bde51b289835b3886fbb4fb36eb40e2ebee814a920775587a936f78c05989cc654bbd831f9f8e80a29172649362ffdab299a1ffe6a618e3e828349286e09920f19189506db06239a3d29ba583ef8f4c29a0140555384e2d3b9509ce1f8680939dffd1ea8a9d81df0d18431eb5648899cbc32bbfb73315dd9e983310b31c645301a7e9f09784fa2312dd69f36d092def779787716137559a609264928b293dc79bbcae91496adfd1030ed42e3e3800093f0f6412080c801197f378c0675b76a3376cf09a3a972e842e2d630c729419a7372a5ccf450e8e26e2d3e524b651ff4fbb272ab8af413211eeb4b43d5e1d450e36b394c70bee0f08cf8a88aa6a9ee91d2262540b8f9f4f7d49516e126fc6e2b5a9eeaed37309c6c0426e670c947200d2b052c5f1789b4d2f39caa249a4013d9eef28545c20a510d5314bf893e27ace0e94527557c9ec709a2f209ed56f58f2046ab83a84019da53363bc7720c1c3e3bf242e9f0de417729de6deaa1db93dc1f0b0c4d3b29fb81ff23dc330926bcc3dbea8693630168c61ed4e16721367d4c98f3d5aaa32ab0684648790788aab54571aadf20d665cd4d46ad4d5185861bfa8aaf913c3b1a7f260626f7b28e632b762b0d4ec111c8adac4bc07e5aaabe6c2759885ccaf736476f889127c12dd145cfb17b602c352012ddb080868bbd35b64373981ddd40c3e4dadb629b242b8a7ec6374bf10bb12f9ea4ebc85562ec3fb00e28ba4647642b6c8b833dedff782434ffb5666fd8869df8cb3dea8a17086b401eed51bda5b837b02263116663c97c18794128a051e6962d58f3e63b1b77e9ae45813532aeb26a33946f9cebbdbca0b843df6cb3e04da1d76cebb77aa569f90455525cd9dfb1004c238ae536958ad908c4b1e18053927473497ff904a9ccbbdc4eacceb0667516d8d5f747b230a6f827d9d2f90d53c88661af0ed32bcbdce63964442b3f0d9b47a400ba3257d9cb2bb6c20af1ccda3ee79e14d7b9e81d7c17673c7184a28106db6a25a92525bdce865ca0eee81a10cb41669dc90c20316f35f24ac37de3b8f881d3f3124e33f674225f0b55c29475d298ed9f3301ae1d66e3f77c7ae847cbc97bdde6ff8b3be81842a232cfbf9d4ea55ba53929d56dfd6c4eb9acefa6ad48ea766a610e808f858da92a499947fd28ea32acf35064d635e63872584e71480c0e87a40b9be28ba7799867414e8ecfc249ca25f8fcb323ae338cbc8a23c674491d4a82128d9ed942de95c0d14e3aae3adb28a3ec66244ffd09922aba24b5e15c2758eacbba231e9e7e0239fd636f2285b40cff563140062ffb561e6105bd525a8f5625b0a0baa599a4ee57716b5598b28db3bb292be0394f1505028e00df92bac32da84e3013d7cb976048922e8f04b1223c75a819f93d1a9b0fa61577ee5d5e999cda5af6db25966d5c5b7fd8807f6b9613c14019b3f452564e0c69f746be70e68b66b66ef33de917e83c2d4c1123e57b30f056a791f5a0bbca6436684fa9e997c538ee468bdcedda74828362536c71a78c1ab638b5e63ac3c63a5eb92c366b2054f747aa20735233bd0b26244f21eff2e0ff011f0809f55997dd2d95cd161cc0c6388f8fdea9fc679d1ab74c27ccbd9902ebe774d84c3a5e2d12d7c5268408363f207d87a0b5bfce7450d72e0f19ddba8becdcf75c4dc112fc774d8b437ab85af2522168c598b7869192d7fb8262b5af51ac6bbedb8948f2f9933907841d1988baf85940515f6a9ef6181c116b162fc6393a833e61617b9694515f62351d619557c47af1f5755fcf5ea9cff16842c82f47f124b721dd7ba830be4489e5f9ed2a05e9aa9fefef3c87ae16ec37d6547282ccde6f20d75a50584400f949bd65f252d65720385cf1b17e4916950620e4291369c5095f1757df2e79643bf31d5f547e22b4f415470151085dd983416414784b01827b5c769e1ac5755217897da037a8f4f63c6d97b395dc1d263bcf12c95e6a230bbb590607af53166c1e20f3eee3b5abb735d8718e06fdab0c50d07d4da9c7058197116e76db1be46984a397a5482031610543e7547617c22861e7f11512f379691a801dfaa7db47174792cc0d35c680c295a4e50a65552676b45d75120b624761ea5ce0980469d448504be12744199d75bd8359c92a0100ddf6087b516d3968fb7a3b80211993058b704871155130e8218fa23a04cdb4cc9ab6de9f4ea593e193c8aa1ae53c944d0da94f444885f6f30325bf4700eac996941d3eb45228f0c24280ac7c6c7fc3016aea467e444a5b8c89accea57ebd5f9e8469ab18e8c5e0ec1926c81457387c2268e7352e7c6765abe02e15d0ef68fe8d893e3b194d8010f1544597a29ae4ec3ecb78658a2f31f460187a65c7e3aa1c08f5e7f762c2b7a624871ef91d4757a616a714384e862a351a51ab5166f5d4f471fe194bb93627f6d05c4d053e58ed7b8ffd752138c890e9897856a1bbd39d66aeeac530ecfbf34e30126b3fde637aad7b06c6dceae683c63083a28b4bbdcb25f522c29a3148dd58b15c4df2753a0e9bf9540c8d004b54810478fb07ade208d9502843dbe1e35f734fdadee489d98243262fcfb9a9fb1edc06f2b8fed8b91ef6c008cd2c3f760c236dee4d15c825c88c39b78324ea0913123ec073de3a484d99bed5d7fb4eedf148d2716e4101fb4db1ec8b697c8f46fda1caed6cf015edbb76ba67f656a76e684d93ede2c84b33b6181d7089b3581c3c52f4538652cc2a9883c18e77660685033cfb38162b8ba02fb383731b693d46473f112836b0741a896c95da2bf9729294bbb97942d74deaf0d68bb8012d0e203d8e7bf97cbad98f606d84c4520217281788cfb459d8a2dbd6f2c659d9227203ab2df8938c417bc61bd01d340b1717df6ff43b0f7c2d18fc9a467be9361b1ba32c7eb053d0c9fb6cc9ced565caa906e653c432f7da6595ae80e6bcae1fa8250e015c82d78dc38ab6197ff6f280f58e1d22e0da89b9a327442d34c91a16b00f486f2976cea7f065c12085bed58a3dd8137882f0379e51178917656f6a1ba9635f910802c4ba82f4a6e0dc060411154675f05f76330fd9d06ca32fcede262f4fc306021e8263e9bb336d3eda0f7d24cebcdbc53297912e3a27771d0fb209ca37b7405030723e0a1d6d02daa2e28cd7a5ddeb70450a549876699f309d3f681cca108db0971fe79606068b94c208322369b84286847cf52340d69ad8ab506316fcdd9a64bad6ef13e905c7eba796d910eb5bc53c859fb87f0b06d7784769d914dd65209b2ce4045b2220c90c8938cf26d1616a1d47da33730485e338b077d5b81fa7446448c8a9349b032df21f12911abb0cbb70511a79b0e7b64089cc40493d63c201cf20060f1a59e6a35bdd9575826d33040ebbe3f672c216fee9815be7ac8bdeb59c3995a5cdcc9a00ac482a7cfdd982c407c667dcb0fca9d02385a1639a380feef3ff5fcc0500a8bc4e4a2fbd8e06bf9aaaed4c0f703996ca6f59040399832aabd0c555faf5fa902716fb9e277e541c022c57dac39eb911a313449e140174d835cec0dbbfda98a86c33627e7623246bf42fed800cdedabcb71afedc3fb0a168c5acc30cd52c6df85f9e83e3095c90f2d803b0af08a005bb08907a8c16b693310fdaa22ef2ccb21373e334e74b69a4f8a8e99703e5311e505161de7d59beafdf07a598bf5f29baf7f4428ca110b1544dccd6caba8f059a325ec75a20f2363811311fef5eba805fe8b56aead04435d6591f27fc093d23e39d7cb17abdb82f15f5a3dd86783779199b170b1eb792565b519fe46ed0209d315fdcdc614945fa0565ce43faabe8b226e6123f739ff79784a6f23eff8ab48134ff469fb74a0aa15eafd4431f3caf30cd91db2084a8a887d1677fb773ab933cef0e13ccfdf3b5cebffb62ed57c9a07f9ee13aacee718fdd45d84aef70cd5e97dd10653ce99213bb3afb6e857cdbf6604fed178d5ff9d04e479f2dc8f11e436222ff9ed1b1180f023fc8044acdda8d3e0af1f51fe5d38cb3dc88aa27b8cd36866bd57f4507cf39392de3feab23ebc1cfb76bdd551e1f7f79fb969b0db3556fd810f15dfd7061a0740a14b7b58d65cd948a2b1af16ab0be58a11b901a364ff517fd1db1965d9b8001f1ba0f62036c4fc9eff37f3bdec218242f219f8468f89c7db00bf412c575186243bd2d3155c10196c61d50c9edfe65e0e1d5ce138ef196402fc0f71b59a3ac988f416e7dbd0e536b3a4c9d7aa3cf4ff251d6db74059397b3e457651571b76ff5a3f9469259e4c1e9a06ccceee8717019bf99346d55cefa16bcba69a927711341fdb29f5ab24a3578e49a52c59a8f142e708963a8f77a4020f907fd48a54b09137b6cefdd543bcc899f2f309ce38300af9c285a530dc2c2ad612790ddd1f81d77ef99256c4a0396a7a08afa02545e320e1b06873314bfc247b7c367253f75649a2c8448e136679f580f6862e14b2518691ba995ed80a51a35ed7625cbe750389787a45183c87760da9d0ba1c2b8cdcdf1a502097c4bb7da004bb5b8cb9bae6f51dd14fa0326460ade062bace8a23351b861d11b826cb783366df737d66677fe1f54d8d638ff742e6eee1c59d6f5069ea26892662dcfa189fc36f0856b6deb0c81e9ca0c4d46035b31fbd5735d84de189b475679ff99aba5fab615920bfaed7131694b1177ca869fd40ca575627f6a870d773d1e7590134523ce1697379bee2a96a97a3eaea3a7f6ca0e3968680bede68394ff58b021fab42554af80fe2158360e7aab6eb2e5b39c9eb912c58187995cd82aeac795ec3041b4300c6ed050fca8fb7b7103eab798213cde52171690633952d70113f693c968e0087bce12e1fa3f3cd148cf48eec9951346028adb39dc6e76f110382a13c8391c62eea7334c765817f6487f02b0974c50854adff8b6aaa838210bf131f4c6ccd58d68dbcf0bcd61b6730c000df8de02668f04fa11f983702154afc3cd61db28df1d8a6ca402e45766fa7110fa4675646468f6c6be665215a626ad0d92eccdc072867a1b8b7fb0d6e82bce0d61e9b9c2e12d8768ac71983d8bf60d9594778e2885acf6894b265ac2e9c0221a112935a7084bf156622bcad39d2300eab7f1f268a40e8ca19885f6e8a7a35ec75aa35a53021ad2da5828e9ebd18bf4e2d5333c9704ab0952976bc87b40eaaf82adb8f878a8ad7f736ba1f2f9cbb0c1f0643a8c1690b8212cd2db07cd0528b96c0ad0e25949967e3c9e4275ba170d856c1d2905c7065f217f2eb45f55794bec9b15c94fa515610adcfe9b5171bdd2d12a5ebb455b1ee7333c1a197be48a3178c6488767522a400091149b28b71f41bc5a2dc16a395aa102b4a574db86a8d4dd1300a37b2892f010ae34e10be37d8b27856d959ff50dfd2e4fa8c345d8c831b66d0479eb720b6519c1be26bba295f03a6df7d16763691c2d5de704adb33bea3824a11138e2768e0c766e3f89c03150be51f09e980416a6f412e2ee59ede412dae5193fb9d3b2b5318f33e9b44967477008bc8939ee3de10adc2d1d0a418833fe4f3379c1b901d44ff3a5fa7dcc5c5134db6c459875002355737b710980f2a3516d3f2840348db3092f014360163466c1844e4c4aae3397a73f613a1d3ae85809eeb5c064c1d847b78e1d486157a657c112ed0985b997e6fb648f9b3ee4d9f7478990d69f6b57f2aa5844d238b785237044897168631fe221b475cddf5832545e148d3db55d07256be5fb73670186584d24fe739523f536f214c58b0194ab53761413a19d8a71a1fc12bceedd275a1d7a6e7de06d3d09ec3217109cfafcb9eb16702d5bcbddb7ea2417d3d9141d10b817b9a24b71c828484a4c0ef040c12d08e0a9bedf7f9cb68170700aa884445e6878f234f67b59b086166d95847272a41850ae554026bb7d73259ab6c5e816340b257dd5309ff8b70a03e07e7425d9d4688e50982186164e5bbe6c5861bcfe713ee7e47d9143b94197e002543a35e887011681020c48c4c29ec593811701f0fb7c889a54e316a03710280df4e7f160a9fd66cc36dbdad6c21b5437373b4920b3fb06a2529fc17dfe2c71eed78a74a8fdf20d1178792a5c35aa6642a4c62fefec843019738cc717463542c4b97c4a18c5a027d9d3dc4e88cf56cdfe97e58994ff34cca70ceb519aaf4c6fb78b605fd3857a632baea3df5bddf46d08b4a54d08bcb7b16c9caedb003f991da7d6984ea12e0cd0ba337b2952b147aa86e6a38362c7ae4d878e94f9cc339c130ceb412c0475fcf11a5a428ec84bfa07423ee3043c62a268d7897f84a60414e8421626eaed1305470b21165f64a3bf6e7372a4b056d2789a92e93e5b35b3d2da42f7a662e782d5564b2ca69fbe3081a4b112b2767477d0e4896a8d30404eeebbea314d32d5a83106c0759f904411f7bc723a76b44058308c5ea082f6db5a9674e53538116ce466d1b0b8522910f938f590fabc6c4ecaf72a93b34a0fa715b90ca56a2eb5afb57c00e210f0652cea78a3711a0eb66a63a87db63bbd5f1ae454042708b40092c1cba0de161c1bb8ed9214f8ac9e0b3fabf462062fe5507fac557a3ec520777bb2b3fabf610aff61626d36b95072ce9bb8a4c1a169d58e4305e6ddbc139877936c0936fb436a15cb01a046ff7c83f015c54fa42be1970b0f13d7cf2a512d9941e435fd209cf09401dc14e23cd4efd2392c0617b4d0033da0788ded012d9de6c70571c34e7bbcd81813affeeefaffea5cc90b220261038a9716b49d9a388b118eaa10fd42818eefe2096d5e337aebf307e01236c4e720bc428b8766afba074b37be9394bc584c52083a8226645de2c13011734edca5a78c403ec48d304283ca4229bb2ef30131c312c8bda8a4eb4d113bb2518d18eddad3a540f362142e2304614bd016efba5c45ef8dda0dcb4b82fca73388d316016ffbc47c4c37774753c3d5d29c0bad39c646975409169c6589f8862e10b221efeda23ec9bbe05187b0ddba92d04defe6f1742a848e60c3096a2a28b9719d5bef3442ae92ef6c55eeeafffb878bd8b90b9b33ead265f545797b844dffec589ad01b0991169eb8bad880bb3ed1bdb5d1280fc76bf5a40aca691157b77aba2c8ad00876180b30f39f4f587be203a5e09e28d4aa96bbf5f85d1def90f086c416c60d059f25c26245de4ee59c8004cf2ff9ff2891320b0ce355c73093758f30f47606bb11933fec5ff50b6db2934f9e98fe4b42609d05af074420b4390dbc62ec3323997defd99b0fb8a39e7104342d06b91e1a6102b961fb1b04f851c5819085f31994d4f47164428ec2ad72df8f053dc25f8c8a5891b3e7cc27ac9b77cbd744f4b6418f2497d4125d95a29426b571afd1d9c80fd9238723f4d876dc24435ff82e55316b744140387277a6aad5096f2f53ced4105cbeca999a4673a646c7ed5bdc869f417a2a82ef70a01ee9a1b8f0a3c58d1c813acca535fa9163c757b40030510bfef20c3eab6188622775b62ff0a67630ed5e00904f763eddb808855280e87d9a0734848fa4f9ac7d4641eb11d654ad52fd61613beaebc343ce6f6a57e6a4790c4104ce4be73793bb0d446e284079564364735a9b4ddcc6bc3ff8390ffcd077ff12d5c2050607cb7f617ed857418337a3c2b4b9ac83a3c920654ff54c19c87bc0a144927e6a4a5dee766927c51024859b16989dea6c18911e2756786f9131bbf782a9adf5f452b28a7d3d126accffb612426b188d89181eb9dcdb22195191870f1e02d086d32b9e35fda945a615abaf56b753483fca2fe3d09f17871421f3eec23d0bcda149729bb2b58f92d6fc868418f316592ea97bf31537303e7efdf4c6152d0584d17d0e61ca880f785c6bd015d83d429f825cc283616413b55567192fb23f56914e2d62aa039dd5387cb8f392bf0cc340946d909e270d8402a09a3cd4b364a52ac08b876bfc1fbc6cb16d80f49ae9a348d45e909fc122d3f3bdd2a99bc3f4052e5ef98172758aec12f20dfce1e9903c3fa1fd9bed510621b07727a4c625878b4aa85a5e742bc321f57b69322699be26a6039798fb539f3042761a7b1ce8d18b87b6505108419066ca603bae985a69009fc323f970321216c955d329d4dfcd2742286a235c01ad4c81696cb24990fcfb66695d0099e9a29c100611f3998f0df8b67006140c8ea7adf601a25c5a53d34d0f4a267bc626ade6c40a6df1ebc0882fab1ae7991098e1c4de9449c4adf60fd71e319501f1d2c08c054551bb35f57741bb3f9f4f0b721385567399f4586f1a14e0a656c555c447c806f60ced1d45e8936d9ddd6e75aecd69ac769c34fac5e941d18a7a0b2df541560a38e4355f43a17ef00beac58adeae99dcfb006abc0030242cdeb1fd0a18dc118bae4031dc8fc01d967c066874cf93d622ebbba0f150fb12d00191fd1cd0e037e3d982f039043a87f66273bc327867f6195a40d4719be2386876e420e8c00320721a90edebbf838aafc41db0a3667831193ede4fb3a8a4ca8c66d88e6ffad17ae9126a329742b63c77572000b4eba5a71decf5d4f7c2ca0694b183328ad6a41db27c6a3266489b7ceda374947a8b856034dda326a2e3c5a04cc4d4e63a628d3849595ccf19b1e53a4dc32f889b3d6f89df81f7870d81c4eeda131f471b57905dd9bef2075f52edf4054a37497bd3d5c41737171367389bc0602b9ea332e791180ab2910840c9462fea61be48bf90f142f122b75ee57af5dfa5e788ecabb38964a70a6745f746c28e877ddf261a6b316344d7a8f38af425c680ce338184d0313197a003309a630265e2207b67a2ddcbf790eeb710afafc925edef1b6deedc4dbe1310d94788986297c9f6517e19ad2487d99c5a7b6101333794d940d79e43bb3f170757c8b9b01f4f026e4849efd732606689a0bb9a3b34b1e3ef3f123f6c351467d630e76ae8ce3af85f878bb0b23eb150a887d69eda1f5f814d67f21819c97b0dd7ff057b526dca2daab809b98ed3e50f4ab2f2585c4f900e88f70919ab9198c2478551f7fb780c73e80e25ebf5aef102de6ea7d7ccd0b44ef35837f69fe3f498c330d6526050b371c926f2ccd43b15c3a41fa09be0463bdbd3e68ffa6f24aeb72636db29b676fb4f93d6ac83767f64509a6210957026342d09348d7b449a6c55d3535fdc07d4cdbf13f2c09a6e44e30bef273aa462df964f6092b059770a2eb0db8e3f89ded1c19484620d6b3eb79181df6aa81e4f6ce03a998deb425ef025ec5a9a861bfed9302e4ea81cf1aa88994b608f341b13dd7bf32ec142bfed11485f710fb43a58896ae7310dd676ed098dfe3a48fac8536e3b4c9a83c63c54e6e06a9c6b729fd88170ace3c8a3e46f45b3210f0b2714b2dae47bbbaf200bca664e0784d668d7cca7b50382ff1d63e5440d2de0277940edb65ae574bc1a9a628b95eb350edaa6b90d71c31ff8d8fc99e92e6ea5e075e10df94c3502fe3c0291279ec1c6c0ff941ec08ca46f0840b06b79834eae4e1875c7a66e867b66fb375b47e649d2096e6f360372bd49b6c2e34e0abc304cc47ae44defb7ef5ce5d02d168972cc7728751c1c6a166e36de4824806291e49db7151334b5e838833e332115f8f0a9a70c93549beed9e2f41586fdc654b1f0e1c003ce731182cd6a18ef186b3201f65f33271d1b24e6fe144fe798b4c26c4271f74ed1438aab545973453827af5c00d6c492c266411249a68321b238efa6461141a94151a5c3ec1624c63f4eda1783cd2549950d438c2e3c96500a7d238b177b8a8ff0cabd77cb4c58ca60a37e4c89b663a8912cf955570b58a8bdeee2726b61e2dd90ce1cd0fc284e3e9f9fd4f515dad742aa74133c0c9d615408dd1c91436435275a0cb7ab86a3dadb68f3e26a3354cbc0ac47d1cc03099c1786b5a6974a72484e8931e852a22571077f49bcc1f3faf9e169bb9548ea6ed92cf8ae1ef8f31d5a37792daa3dad748707f292a387b6c57fd8a0d1ede4607220a9cb91954009e680866bf370a49215018537ae58b1ff99764b37ad7063090995c922f65b087a2b5ca8697de3817ab26123dee2d191040b6f827a953acc27f51331487311d298808450f2c2b571733799d741dc1cae13394956d7720e12698bcbeb721007fff0cc8c7b79dbc454b4866266f08c71c8dccd997ea12c7c06df69e432cb94de1547c4b09f60d94d6b2b3c1e5be06355d03271e10caa6a1a2ca19a84a08d32104bdf512569b1dc4436889f689c6aa217c88b5dd5ec794b8f9ed4f579d0deea7bb23e2aa64062e6d63f649423a2974a94d0ec7a574741fb138804bf3292ca3e4fe2d20bcd4820a01062d523708d7cd63d5a0436fec908bc39ea2c4eee21a3f87680b446950b9e2a11071c29515c7f863dbce6cd1e7d8722dbd59d1fd0df894d186e761cf02edc80ca90830bd6b4251a0b3643a44451da192a09f0614852867cf121a4404c9ded0afb7a187505a0305a552fc557c83c5caa7be01d88bcb7174a3fa644a6f010c7ec3f6baed47880cd47f4eedd304c709a98fdf28defc05a8f1578dfc72e3c1b5c7e98b5a316b89517620fdf63130d9435ccab2478d3a06d4fa8ae6f1671a3c6f4b15a05611c516d6b3842627813258cc4c04c95ade2441282d506bab6fae02314b6e3b333b7b6e68bdd4656cadce0b11917e42b7f87a2d73156bf6b5fd5af97f6488cf6fac573ac1618f82a836d232eb6b9a9e896aa6512e74f5c3dc5b69665a0fd1a27ab951f59a7cd9b31c1d9a627c543b88a2b2ef620036ebbfcfae1894d54ffdfb2c1193e80d2cea1ef4c4efd20c2ad887ee7d3bb3f25d71cff25376a7868c333af39ff9f1cf4347caedf6d248faeeefc76395d1e3f0ec51563eee3c5e0aa6aff04fcf604b91156dbfcc71235f4ca25055ae6b6f48e7a38be5cb5e585a4de9c24322237934385d4efa7a1f0855a03eecb07a2e10fd38341dbd79e179f2dd531fd75372795bcd764af25a887fdbc73e0d2d06186c9fe5aaf9dfbd1c083d75588f654aa773b130e6966d5765bb046bd5b96a1831457fde082e4790999d9a0849a2423f3ab551a0c0916ec13edca1ba085fd8a2ce16ddd4b614024c2a29e0afd4b7024763c34ccad9a2addab5cc5e7571b0be1462afbbed0a3e8f21c250346127c5864e1169c6b91fc69f5a582bbd879122e91cb3a3e20051e80b62a43014bfdfcdea007473a132d1a7a3a940b721ad878613a3277563f91ca556d4e413fba9d4bc7c5dded1d278b7d8b25bc1373359addb84590f2070cb71c31377b776af03021834c44add091dd7b727759f2ccb5e8626c8e098d371fa6dbbfd61ecda89eed0037d6dc1aae0ec69456b918fa9b9a28842fb53fb143a748a610a1270272fe6e69ca0104e7c995b032b39d6b08d3df59a96a14c2c280c3772f13ede5c60a47f7ae932f1f5381f7abd1d98d7f3893c750b5c076b0eaf0ef20e40e2dba0072d78be5335e709b4084136ed2ecf23afd4c86e14415ae8c3ba609beee6ce42ab63fb1c7c28105d1957bd5041567b53526af5d9f97e3f8bffa34178dedce3856bf7bf3d05aea91d5d3bc6e4475ad6682b9e872e1692047d34af2c65936826556d274dbe5ce6d691b0b3f741405adc8917d51157d16793d8752a395a0ed1147b9b9247adb4e3fc51b310b38f2c00b3632ba30800187f97880dc58d699d804aad7a820bdc924a3b292d575a3e8370599accb2ed7f060fbc8e544d82acf32d2e460ab589df9048f52d0578fc2362f89d0d6b305d05ca4b88643d988a927ac93c52a0cafcc78b00558ca0ea6ca102626377c2a7121e3a6cc0b5fbdd580cefded11182416230511841a7d8c8107d05bb2202170d0c78fb1dce556c619e8f59e06edadb27f50c11a677aecbd9c7ac16a095722469e06d31ed066d1d87524bd59264d10122d75a2000d115b85cbf3ebafa4a66b5735691a99982cffcbe5df11be4062d18542113ece8315a69db59b9c2bd3133317ff80065cea9bb61ddeb38573c09e51b904cf95b93b99d034cc3e6ce91bc6abd82a8e460ccc571f897c5539c84793ff9c47f142a3414082b5e4cb63542db679756369ff9f1a98617757c55726ffba8f5994f024537f36e4d0425d8ffc1f9d01bd068e19cdd4c2f70c01c2166ba593cf9f209a562af2772a54f82751c036b148a9ed0ce64cf58e2ac266e725c292b76ca9aafee12a2b513954f5c9457b20cccee1e0ae094240ea17a344840043e2017e32e369da1fcc825121657a9859ee8fae63e9641d2caf775a367080cf9e445e423a8ad9ee07ac456085c946b3565ab2a9b80bba32809099ef305f808054803a5d2532bf09c5a1207c71ad4697ff2820a6384871bf160afb2982fc316a3cf8877334da25d850fd29272abd290715efa71a640f10161deb83eddb76aa0abf176c7d4a42a6173d6fe141e20e7b10c6443e5011320aebc84a37df00e08ce61147851e634485380fcd5954cf0b3b1f0b503176701712868e0c7891ccd0ba8435d64a955bcf4a42efa869b15956e23ed434a73edd4737b22f1a9c345f0318b82b62fd4097797293d6837b4d68996ec987321b9333e0b8d9aeebeb2bfd8563d0b29e7e4ffe37b261635cc53197d6e5be7f1a3e30154148ddb2009f2352ea1b4b04ec9ead67d13a204336613ca55a5e5fa92aa070401e3cb4aee15ceefefdb5ce4c676c8906ee838932654fab69cc3e5e3d6d7b04833a69425a873ebebdd1ad3cf2a396dec2b7dbc1deab0740588193924e8dee0b77cd648d64ccda1b895fd47ac8451c3a973d9cbe9c8e7d1c173b55499cbf9545c951e5d3338765ad02a90645e3624f24292b97479ed64571b9d888c40b2b3e1350eaa9efbff6b6067661f387b5ae8c7a812b0234489adfcecd241fafe5a9015c24f34f352a3a9a93beb3b565df739a90b8713785d49eebf4ca8f4d334bb1c93dda4f98a6f476addb3f4630e2f0927959934717714662fe78cac8240d6d7acc009c8d7f983b006f7f98b85ca0f62375c6359368cf42f81c7431bcbf6bfe5016233ba784b3bfa96032b025483cf14d13d37fd5e2fd64160b4329b8e86c076d67678f0c808e76f1fb2da91e158efc9cf6c0501cd08a167fe6956f1a36502185c8dca284f5a26f32cfb2ae9de91ca7dcf1011789aec59e562b8565db30bbafdba228f5ebc5e87e3c4ecd1ff297e38680ccd22ea3a6703bc1a05f77a0e4ee788577d83654c4732654ad69f94e263b8f957ebe2558be72c8c2b1c0c8edb198a54d75eb1247f5c606c128993ee2b787f45fbf5bf74da8b68c3ebb4d22a0aea7655a26e2f063e1cfedaddbfecf71bbd698b74e4fb3fd1236435642861b70cc81d03c476c69894d6aac81ebfacae03a7eecfab7e42a2aeb418432754b66ac2ec82d6b3a6f665cefb691db9403e0d088a504665de01f95989086c23900707ecd5adcbf342169d0ebc286eb7ab20f861d58851196ac0d728bee0f1604471cd83fb0aa4672afe7c8251e19cdfb446afec8b6c1b5e82be0b861bfd0a5852a6385c808f9a55b2e553004b35683c2388f9b5541aca5dabe1c067c50a6a31d57013a345444113651cd05a54a2a1207d1dadb5c277e0c32ddf01116bd65228e93789b637c2b502e49438751f1e1fd93d9dc9fc3f018d28ff81ffd6869e1b732fe93033e2cf4ced627f8eb077fc191b2860c04c12d8757668a0e655d897c53fad4f29af972f7b644f162dcc38a0752b93ff0d22a8c427271d495c7063e774bff3362ea554d06d70f3e66cc447e7f396e949c4e12ceb052ff4275803a58a6e7dc20e1d8228926e46ffd1804dc1f7ea50de95e9b4cdf5016a66661ab3dd5e00188bc28982bd5cdc9ae12e0ab74e563a50f0406afe187ea176d416e46390bccfcb60f305986f7472d087d0812a917b0bc2dc5d567a40b15cdf407b814dd382ae0bb9d143d7e9dcb5777a24382d1a8b052062bdf7929451029c672cabc67aadc211852096c75da29771d42a83d6a31966a4d76d74e03763fb4fdbf309259655b1ee54ea662629e45a15a8be23d51f6171c28cc59fbd5ef75f10c70d147c90056651dc9fbe6c3197e006eaf9ab8ced763cec6bbb5c41b83937e0fd096eb0e96a0fe21170a9651b8703bcd92ae405c0a11c5972d7a58194b18d552d1d0a0fb3fff445b1758ba3ffd04d3d79eda15ef56d92872dbae62f7c5ca78e489b3f30e55445839e11d81eb85809a5a29a0fe79099472dcccd884149dff791a7144047c8cb7ca8b740c5423bfbff9e0f8302699587279e0c7e30d2ca2478719a06c8e7b3388ffd1220e34d87fafbc4999fb97509821755d72e279db6e3b414329ebb39daad5f2ea235a1d077982eada7a196848f5a7eabfacc1599fb91b5272cc50df2aa49e15f4e16d9eede72c74e1211582d2de1d35a2e8fe3bc8774e8d0324692e93dbf4b22170c68806de5ed5c112a3f38b3095906b6f3f975037c49cb3082282ab63f1267c83384f2086e3ce0095e6a0cae1e58b2cdd250be3ecda65ae19ff5c33924119b271a7504d27660dc5453f74c45a6acf5d9e9a36686b319aa6d11ee28ea012f7e737c256b6282fcc43e35d7dfca3a52d592e42142dde11fa06822e86234e63c1b5b7b6a1fd0b2a1f7e9c27eabd33758f1f99db3ae6ccbae1757c61d28d17fc5f3a6c112c4ad0e9b3f9a04065229deb4700939cd6154f4fc4defda3e7c255a952be453431d8b101d21367d25566675f3377d61cb2c7dbb31f2c6bba3c010708bc61a381a94bf0286dbd339dda7771c2749e1e6ec86711a863cf97a2629dd8db1af64a5f82fb0286af73e7245c6a532e663c3e3b91d36759ba5ec795f7f18a7f93a14d1f182dfd27b010d242b17a992f42bbd5529a8d74fbdd887623d8e43faeae0208699044f3984c0025bfbed6c42609352de86f9880ead2ff29b33786f9eb9fb1727eb3fa3e24373aba2cb917d5360a626d825d299424bbb16594ff6a980fcff9d7c86f0fd8a8bc9736ed26f260e37e01482605accd72865e9cbb3cf47d393c3575855ed4ace0b038be010060da0dc921438cba048745dc7f5843dfb56e70fca8fb32611ba6e0573508c6ed9ff60987d5ee776334f57be6dc89a9a2aee759037ebf8d438bc8126c619eb2baa3dba10ad915863a7d5222e7472804c0353202bf40acc580f6e98f0b41c9e670c5be73ee3507bdbff8c921807620960e83203ea022893edf2cb74b3d4bb263234f5ba1079c2f810e9752ba63ae40c71d51e3f52a22df1942a72e219e4f3662f815952579609679a689638a18aca506ea56a0bd08c661b502169f5a5f39f92a1c85994023192341edf412c71d53cfde968dfe6c44b1559e3456c2cb602bcc16c98c5cf8d348a103a98d3bf886502655183349b7042c82bd51f143127238f57e0a766a5b9f9837e7749d75a152adf75c0d9ac5bd9ce215737f4eb69110b9cf21b7ff8e3d8b4d9d08b752658f745e40da764ec35f66121b29adc7dcd9be510e9e47c86bc08ecec985d1df8f23c98a72138fffef2306f7f6824319dabf56f5270f6458269370b152c87d95d5564579d55c7a052e34e674e384a3aa0aac86d5112a4c6325d08e26d55c56187c0b870f4b3de5eca70326e704dd67d08a16d5877d03bbcad4a9e8aa035bb3decb1d1e29a8b9730f4495ca3b923fc7fc287a73f4fa05bc386e8cddfe66e1177d4b3dc3b0d30d4224192868c86fba565785bbaabe61c0e42997bade6bbaf4d15e2133a19827a750dd8c16dd70029e09e23c5851d95672a87453cf2f0b9452e1959680e8b28f2e057334e721d9a34bf37b2013aef645b242f378f38857e3b4cc8ef58faa8051b92068ed86bd88104ac9f98f76188d67553dc4216343cc32d1d5b790069d56722d492667d2b34c220bc9567a535dd99bf9a40d2d84541676caba3274b50afa20dc486129bf00f392c33525c85ea0c5af129e9ac53e3b3ab6cdae14f3372326585711e0639e97d2fc054712f2f4275ec3040286644fd4aec1d36497daf388d8f077d6dbf5d8f305775729bfbf605a6b15fca91902484df812a36e9d9093cdc241d635569f185d94e28278544ca0228f6e3501e775e1f01147194a8021963393d793e4a2d3b02d11e503899b921186afe1ca2b637114ae13efccab9a5a6185dc273158db1c2a6b23dacb17268f4fe88ab7431606137da9a64165e3f6a2399e37744f80f898227a8a385914fe82e0ce444424e99eb5b83e844f9975ef2e51d522dd13b41eda69c0bbfb11574c67fe12e28b7d835387e48282cd5a0edbe94a850b3e99b4581c871e8320edd239caf2b63041a1fdec744a6d4e5c98806b97c49a834d2efd5ec797b4521838b8b625baf5a60402268baf50a897ceb2c25c263d823d89ebba638c4c4fe39e0c5cc3d6c5d3f16187b4a99b8270e941cb619aaac44a461137f324b16d80052f1893c5675b0d89bc7b2625dc23404c196b","isRememberEnabled":true,"rememberDurationInDays":7,"staticryptSaltUniqueVariableName":"e108eb465047f7873ebe9172fe8af503"};

        const templateConfig = {
            rememberExpirationKey: "staticrypt_expiration",
            rememberPassphraseKey: "staticrypt_passphrase",
            replaceHtmlCallback: null,
            clearLocalStorageCallback: null,
        };

        const staticrypt = staticryptInitiator.init(staticryptConfig, templateConfig);

        window.onload = async function () {
            const { isSuccessful } = await staticrypt.handleDecryptOnLoad();
            if (!isSuccessful) {
                document.getElementById("staticrypt_loading").classList.add("hidden");
                document.getElementById("staticrypt_content").classList.remove("hidden");
                document.getElementById("staticrypt-password").focus();
                if (isRememberEnabled) {
                    document.getElementById("staticrypt-remember-label").classList.remove("hidden");
                }
            }
        };

        // Toggle password visibility
        const toggleBtn = document.querySelector(".toggle-password");
        const eyeClosed = toggleBtn.querySelector(".eye-closed");
        const eyeOpen = toggleBtn.querySelector(".eye-open");

        toggleBtn.addEventListener("click", function () {
            const input = document.getElementById("staticrypt-password");
            if (input.type === "password") {
                input.type = "text";
                eyeClosed.classList.add("hidden");
                eyeOpen.classList.remove("hidden");
            } else {
                input.type = "password";
                eyeClosed.classList.remove("hidden");
                eyeOpen.classList.add("hidden");
            }
        });

        // Handle form submission
        document.getElementById("staticrypt-form").addEventListener("submit", async function (e) {
            e.preventDefault();
            const password = document.getElementById("staticrypt-password").value,
                isRememberChecked = document.getElementById("staticrypt-remember").checked;
            const { isSuccessful } = await staticrypt.handleDecryptionOfPage(password, isRememberChecked);
            if (!isSuccessful) {
                alert(templateError);
            }
        });
    </script>
</body>
</html>
